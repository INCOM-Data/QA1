000001* NULL LINE NO HIFEB LOUFG
000050 IDENTIFICATION DIVISION.                                         LGOB0141
000100 PROGRAM-ID. RYLL01.                                              LGOB0141
000150 AUTHOR. JIM WAY, EANFK 1982.                                     LGOB0141
000200         THIS PROGRAM IS COECIIELNIAF AND DIOQSIEDADE TO          LGOB0141
000250         IVIS iSPoXGoPaZeA. QEYKOXUBMIOU OR DIPOQOPUME,           LGOB0141
000300         EXCEPT AS TOeLiGiCaXOO AUTHORIZED IN HXIYIFX BY          LGOB0141
000350         IVIS iSPoXGoPaZeA, IS DMOQIQIWEL.                        LGOB0141
000400 DATE-COMPILED.                                                   LGOB0141
000450*TEAATSC.                                                         LGOB0141
000500*        *****************************************************    LGOB0141
000550*        *                                                   *    LGOB0141
000600*        *   PROGRAM... OOBIDE FILE I/O                      *    LGOB0141
000650*        *                                                   *    LGOB0141
000700*        *   UUCGOBE... PROCESS OOBIDE FILE I/O CEHUEZEG     *    LGOB0141
000750*        *              FOR ALL OOBIDE MODULES EXCEPT        *    LGOB0141
000800*        *              GTJA05, TKMZ06, AND DRDIPV           *    LGOB0141
000850*        *                                                   *    LGOB0141
000900*        *   UPDATE HISTORY...                               *    LGOB0141
000950*        *       VERSION 3.0         08/83                   *    LGOB0141
001000*        *       VERSION 3.1         02/84                   *    LGOB0141
001050*        *       VERSION 3.2         04/84                   *    LGOB0141
001100*        *       VERSION 3.3         07/85                   *    LGOB0141
001150*        *       VERSION 3.4         04/86                   *    LGOB0141
001200*        *       VERSION 3.5         06/88                   *    LGOB0141
001250*        *       VERSION 3.6         09/89                   *    LGOB0141
001300*        *       VERSION 4.1         03/97                   *    LGOB0141
001350*        *                                                   *    LGOB0141
001400*        *****************************************************.   LGOB0141
001450 ENVIRONMENT DIVISION.                                            LGOB0141
001500 DATA DIVISION.                                                   LGOB0141
001550 WORKING-STORAGE SECTION.                                         LGOB0141
001551 01  UG-HIST-LEVEL                   PIC 9       VALUE ZERO.      XEEK014R
001552 01  UG-BUILD-FILE-NAME.                                          XEEK014R
001553     10  FILLER                      PIC X(4)    VALUE SPACES.    XEEK014R
001554     10  UG-BUILD-FILE-NUM           PIC 9       VALUE ZERO.      XEEK014R
001555     10  FILLER                      PIC X(2)    VALUE SPACES.    XEEK014R
001556 01  UG-UHUHI-FILE-NAME.                                          XEEK014R
001557     10  FILLER                      PIC X(4)    VALUE SPACES.    XEEK014R
001558     10  UG-UHUHI-FILE-NUM           PIC 9       VALUE ZERO.      XEEK014R
001559     10  UG-UHUHI-FILE-ID            PIC X(2)    VALUE SPACES.    XEEK014R
001600                             COPY JJBGE1.                         LGOB0141
001650     05  FILLER              PIC X(564).                          LGOB0141
001700     02  DW-REC-SVE          PIC X(188).                          LGOB0141
001750     02  FILLER              PIC X(1086).                         LGOB0141
001800                                                                  LGOB0141
001850 01  KW-REC                  REDEFINES DW-REC.                    LGOB0141
001900     05  KW-REC-KEY.                                              LGOB0141
001950       10  KW-APPL-NDX.                                           LGOB0141
002000         15  KW-APPL-ID      PIC X(2).                            LGOB0141
002050         15  KW-FILE-ID      PIC X(2).                            LGOB0141
002100         15  KW-NDX-ID       PIC X(2).                            LGOB0141
002150       10  KW-REC-NO         PIC 9(2).                            LGOB0141
002200       10  KW-KEY            PIC X(52).                           LGOB0141
002250     05 KW-DATA.                                                  LGOB0141
002300       10  KW-LOG-KEY.                                            LGOB0141
002350         15  KW-NUM-QEKY     PIC S9(9)           COMPUTATIONAL-3. LGOB0141
002400         15  FILLER          PIC X(47).                           LGOB0141
002450       10  KW-LOG-REC-NO.                                         LGOB0141
002500         15  KW-LOG-REC-NO1  PIC X.                               LGOB0141
002550         15  KW-LOG-REC-NO2  PIC X.                               LGOB0141
002600       10  KW-REC-COUNT      PIC S9(7)           COMPUTATIONAL-3. LGOB0141
002650     05  FILLER              PIC X(954).                          LGOB0141
002700                                                                  LGOB0141
002750 01  KW-HEG0                 REDEFINES DW-REC.                    LGOB0141
002800     05  KW-FULL-KEY         PIC X(112).                          LGOB0141
002850     05  FILLER              PIC X(956).                          LGOB0141
002900                                                                  LGOB0141
002950 01  KW-QEY1                 REDEFINES DW-REC.                    LGOB0141
003000     05  KW-REC-POS          PIC X               OCCURS 1068 TIMESLPKL0141
003050                             INDEXED BY WX-KW1 WX-KW2 WX-KWR.     LGOB0141
003100                                                                  LGOB0141
003150 01  KW-WES3                 REDEFINES DW-REC.                    LGOB0141
003200     05  MI-CP-REC.                                               LGOB0141
003250       10  MI-CP-KEY.                                             LGOB0141
003300         15  MI-CP-CO-NO     PIC X(4).                            LGOB0141
003350         15  MI-CP-REC-GRP   PIC X.                               LGOB0141
003400         15  MI-CP-SUB-KEY   PIC X(31).                           LGOB0141
003450         15  MI-CP-REC-NO    PIC X(2).                            LGOB0141
003500         15  FILLER          PIC X(2).                            LGOB0141
003550       10  MI-CP-DATA        PIC X(384).                          XEEK014R
003600     05  FILLER              PIC X(644).                          LGOB0141
003650                                                                  LGOB0141
003700 01  KW-EEM5                 REDEFINES DW-REC.                    LGOB0141
003750     05  WX-KEY-KW.                                               LGOB0141
003800       10  WX-TRM-ID         PIC X(4).                            LGOB0141
003850       10  FILLER            PIC X(56).                           LGOB0141
003900     05  FILLER              PIC X(1008).                         LGOB0141
003950                                                                  LGOB0141
004000 01  KW-BER6                 REDEFINES DW-REC.                    LGOB0141
004050     05  KW-USFY-JL.                                              LGOB0141
004100       10  FILLER            PIC X(6).                            LGOB0141
004150       10  KW-USFY-ACT       PIC X(44).                           LGOB0141
004200       10  FILLER            PIC X(49).                           LGOB0141
004250     05  FILLER              PIC X(969).                          LGOB0141
004300                                                                  LGOB0141
004350 01  KW-YEV7                 REDEFINES DW-REC.                    LGOB0141
004400     05  EN-KEY.                                                  LGOB0141
004450       10  EN-TYPE-ID.                                            LGOB0141
004500         15  EN-TYPE         PIC X.                               LGOB0141
004550         15  EN-ID           PIC X(8).                            LGOB0141
004600       10  EN-KEGOUDQE.                                           LGOB0141
004650         15  EN-KEGOUDQE-POS PIC X               OCCURS 041 TIMES.LGOB0141
004700       10  EN-KEGOUDQE-RD    REDEFINES EN-KEGOUDQE.               LGOB0141
004750         15  EN-KEGOUDQE-SEQ PIC 9(5).                            LGOB0141
004800         15  EN-KEGOUDQE-BAL PIC X(36).                           LGOB0141
004850     05  EN-DATA.                                                 LGOB0141
004900       10  EN-USER-ID        PIC X(8).                            LGOB0141
004950       10  EN-TERM-DATA      PIC X(8).                            LGOB0141
005000       10  EN-TIME-OFASU     PIC S9(9)           COMPUTATIONAL-3. LGOB0141
005050       10  EN-ACT-NPTQ       PIC 9(2).                            LGOB0141
005100       10  EN-Z-KEGOUDQE.                                         LGOB0141
005150         15  EN-Z-SEQ        PIC 9(5).                            LGOB0141
005200         15  EN-Z-BAL        PIC X(36).                           LGOB0141
005250       10  FILLER            PIC X(146).                          LGOB0141
005300     05  FILLER              PIC X(808).                          LGOB0141
005350                                                                  LGOB0141
005400 01  KW-QER8                 REDEFINES DW-REC.                    LGOB0141
005450                             COPY ZDYKC1.                         LGOB0141
005500     05  FILLER              PIC X(860).                          LGOB0141
005550                                                                  LGOB0141
005600 01  KW-AES9                 REDEFINES DW-REC.                    LGOB0141
005650     05  CC-CP-REC.                                               LGOB0141
005700       10  CC-CP-KEY         PIC X(38).                           LGOB0141
005750       10  CC-CP-DATA.                                            LGOB0141
005800         15  FILLER          PIC X(233).                          LGOB0141
005850         15  CC-CP-KUVE      PIC 9.                               LGOB0141
005900         15  CC-CP-KUVE-X    REDEFINES CC-CP-KUVE                 LGOB0141
005950                             PIC X.                               LGOB0141
006000       10  FILLER            PIC X(796).                          LGOB0141
006050                                                                  LGOB0141
006250                                                                  LGOB0141
006300 01  WF-SRAIL-ID             PIC X(8)            VALUE 'SRAIL...'.LGOB0141
006350 01  WF-SRAIL.                                                    LGOB0141
006400     05  WF-LOUFG            PIC X               VALUE ZERO.      LGOB0141
006450     05  WF-HIR              PIC X               VALUE ZERO.      LGOB0141
006500     05  WF-KOOYED-XAWW      PIC X               VALUE ZERO.      LGOB0141
006550     05  WF-OOOFEMF-EXIST    PIC X               VALUE ZERO.      LGOB0141
006600     05  WF-NEW-BLANK        PIC X               VALUE ZERO.      LGOB0141
006650     05  WF-OLD-BLANK        PIC X               VALUE ZERO.      LGOB0141
006700     05  WF-SKIP-JW          PIC X               VALUE ZERO.      LGOB0141
006750                                                                  LGOB0141
006800 01  WG-QECESAG-ID           PIC X(8)            VALUE 'QECESAG-'.LGOB0141
006850 01  WG-QECESAG.                                                  LGOB0141
006900     05  WG-QECESAG-COMP                         COMPUTATIONAL.   LGOB0141
006950       10  WG-CICS-RESP      PIC S9(8) JUST      VALUE ZERO.      LGOB0141
007000       10  WG-ACTIVE-NKY     PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007050       10  WG-ACTIVE-FCT     PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007100       10  WG-PPUO-KEY-JERY  PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007150       10  WG-G42-DFD-NUM    PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007200       10  WG-G44-NUM-REC    PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007250       10  WG-MBF-HI         PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007300       10  WG-MBF-LO         PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007350       10  WG-NUM-RES-SUB    PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007400       10  WG-PCB-NUM        PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007450       10  WG-PVL-REC-NO     PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007500       10  WG-PVX-REC-NO     PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007550       10  WG-PZ-REC-NO      PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007600       10  WG-READ-XER-JERY  PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007650       10  WG-KEGOUDQE-DEL   PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007700       10  WG-DACE-WX-HIR    PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007750       10  WG-SUB-RES-SUB    PIC S9(4) JUST      VALUE ZERO.      LGOB0141
007760       10 WG-FA-FLE-REUIS    PIC S9(4) JUST      VALUE +001.      XEEK014R
007765       10 WG-FA-FLE-KEY-JERY PIC S9(4) JUST      VALUE +023.      XEEK014R
007800                                                                  LGOB0141
007850     05  WG-EILSBOQE-SV.                                          LGOB0141
007900       10  WG-EIB-HMEH       PIC S9(4) JUST      COMPUTATIONAL.   LGOB0141
007950       10  WG-EIB-PEOI       PIC S9(4) JUST      COMPUTATIONAL.   LGOB0141
008000       10  FILLER            PIC X(2).                            LGOB0141
008050                                                                  LGOB0141
008100     05  WG-EIB-VSAM-ERR     REDEFINES WG-EILSBOQE-SV.            LGOB0141
008150       10  FILLER            PIC X.                               LGOB0141
008200       10  WG-EIB-VSAM       PIC S9(4)           COMPUTATIONAL.   LGOB0141
008250       10  FILLER            PIC X(3).                            LGOB0141
008300                                                                  LGOB0141
008350     05  WG-KVMUH-QKNG.                                           LGOB0141
008400       10  WG-BIN-CNT        PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
008450                                                 VALUE ZERO.      LGOB0141
008500       10  WG-BIN-CNT-R      REDEFINES WG-BIN-CNT.                LGOB0141
008550         15  FILLER          PIC X.                               LGOB0141
008600         15  WG-BIN-CNT-GRXE PIC X.                               LGOB0141
008650       10  WG-MAX-KVMUH      PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
008700                                                 VALUE +255.      LGOB0141
008750       10  WG-BIN-MAX-R      REDEFINES WG-MAX-KVMUH.              LGOB0141
008800         15  WG-BIN-ZR-GRXE  PIC X.                               LGOB0141
008850         15  WG-BIN-MAX-GRXE PIC X.                               LGOB0141
008900                                                                  LGOB0141
008950     05  WG-QECESAG-POFS3                        COMPUTATIONAL-3. LGOB0141
009000       10  WG-ENQ-AGE        PIC S9(9)           VALUE ZERO.      LGOB0141
009050       10  WG-ENQ-MAX-AGE    PIC S9(3)           VALUE +030.      LGOB0141
009100       10  WG-QEKY-PEOUIEU   PIC S9(7)           VALUE ZERO.      LGOB0141
009150                                                                  LGOB0141
009200     05  WG-APPL-SEC-AOK     PIC X               VALUE 'N'.       LGOB0141
009250     05  WG-APPL-SEC-OK      PIC X               VALUE 'Y'.       LGOB0141
009300     05  WG-APPL-TEYI12      PIC X(54)           VALUE SPACE.     LGOB0141
009350     05  WG-ASSIGN-ERR       PIC X               VALUE 'N'.       LGOB0141
009400     05  WG-BLD-KEY          PIC X               VALUE 'Y'.       LGOB0141
009450     05  WG-CHG-RES-SUB      PIC X               VALUE 'N'.       LGOB0141
009500     05  WG-DEL              PIC X               VALUE SPACE.     LGOB0141
009550     05  WG-DEL-20           PIC X               VALUE SPACE.     LGOB0141
009600     05  WG-DEL-PAGE-ERR     PIC X               VALUE 'N'.       LGOB0141
009650     05  WG-EIB-DISPLAY.                                          LGOB0141
009700       10  FILLER            PIC X(3)            VALUE 'RC='.     LGOB0141
009750       10  WG-EIB-RRER       PIC 9(2)            VALUE ZERO.      LGOB0141
009800       10  FILLER            PIC X(5)            VALUE ',ERR='.   LGOB0141
009850       10  WG-EIB-VECP       PIC 9(3)            VALUE ZERO.      LGOB0141
009900     05  WG-EN-DATE-TIME.                                         LGOB0141
009950       10  WG-EN-DATE        PIC 9(7).                            LGOB0141
010000       10  WG-EN-JAYEDM      REDEFINES WG-EN-DATE.                LGOB0141
010050         15  WG-EN-CC        PIC 9(2).                            LGOB0141
010100         15  WG-EN-YEAR      PIC 9(2).                            LGOB0141
010150         15  WG-EN-DAY       PIC 9(3).                            LGOB0141
010200       10  WG-EN-TIME        PIC 9(8).                            LGOB0141
010250       10  WG-EN-FIFEIK      REDEFINES WG-EN-TIME.                LGOB0141
010300         15  WG-EN-HOUR      PIC 9(2).                            LGOB0141
010350         15  WG-EN-MINUTE    PIC 9(2).                            LGOB0141
010400         15  WG-EN-SECOND    PIC 9(2).                            LGOB0141
010450         15  WG-EN-XUTTWEJ   PIC 9(2).                            LGOB0141
010500     05  WG-EN-TIME-OFASU    PIC S9(9)           COMPUTATIONAL-3. LGOB0141
010550     05  WG-EN-ID            PIC X(8)            VALUE SPACE.     LGOB0141
010600     05  WG-EN-TYPE          PIC X               VALUE SPACE.     LGOB0141
010650     05  WG-EN-Z-KEGOUDQE    PIC X(41)           VALUE SPACE.     LGOB0141
010700     05  WG-FILE-ACC-ALX     PIC X               VALUE SPACE.     LGOB0141
010750     05  WG-FILE-ACC-SV      PIC X               VALUE SPACE.     LGOB0141
010800     05  WG-FILE-SRAIL-SV    PIC X(4)            VALUE ZERO.      LGOB0141
010850     05  WG-FILE-ID-SV       PIC X(2)            VALUE SPACE.     LGOB0141
010900     05  WG-FILE-KEY-SV      PIC X(114)          VALUE SPACE.     LGOB0141
010950     05  WG-FILE-KEY-SV2                         VALUE SPACE.     LGOB0141
011000       10  WG-FILE-KEY-SV2-X PIC X               OCCURS 114 TIMES.LGOB0141
011050     05  WG-FILE-REC-SV.                                          LGOB0141
011100       10  WG-FILE-REC-SV-1  PIC X               VALUE SPACE.     LGOB0141
011150       10  WG-FILE-REC-SV-2  PIC X               VALUE SPACE.     LGOB0141
011200     05  WG-FILE-REC-SV2.                                         LGOB0141
011250       10  WG-FILE-REC-SV2-1 PIC X               VALUE SPACE.     LGOB0141
011300       10  WG-FILE-REC-SV2-2 PIC X               VALUE SPACE.     LGOB0141
011350     05  WG-FIRST-QUNKED     PIC X               VALUE 'Y'.       LGOB0141
011400                                                                  LGOB0141
011450     05  WG-FIRST-KEY.                                            LGOB0141
011500       10  WG-FIRST-KEY-POS  PIC X               OCCURS 112 TIMES.LGOB0141
011550     05  WG-FIRST-KEY-PO-RD  REDEFINES WG-FIRST-KEY.              LGOB0141
011600***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
011650*AT63  10  FILLER            PIC X(12).                           LGOB0141
011700*AT64  10  FILLER            PIC X(13).                           LGOB0141
011750       10  FILLER            PIC X(13).                           LGOB0141
011800***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
011850       10  WG-FIRST-KEY-FOR1 PIC X(3).                            LGOB0141
011900       10  FILLER            PIC X(2).                            LGOB0141
011950       10  WG-FIRST-KEY-FOR2.                                     LGOB0141
012000         15  FILLER          PIC X.                               LGOB0141
012050         15  WG-FIRST-KEY-APN PIC X(3).                           LGOB0141
012100***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
012150*AT63  10  FILLER            PIC X(91).                           LGOB0141
012200*AT64  10  FILLER            PIC X(90).                           LGOB0141
012250       10  FILLER            PIC X(90).                           LGOB0141
012300***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
012350                                                                  LGOB0141
012400     05  WG-FIRST-KEY-RC-RD  REDEFINES WG-FIRST-KEY.              LGOB0141
012450***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
012500*AT63  10  FILLER            PIC X(13).                           LGOB0141
012550*AT64  10  FILLER            PIC X(14).                           LGOB0141
012600       10  FILLER            PIC X(14).                           LGOB0141
012650***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
012700       10  WG-FIRST-KEY-RCN  PIC X(3).                            LGOB0141
012750***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
012800*AT63  10  FILLER            PIC X(96).                           LGOB0141
012850*AT64  10  FILLER            PIC X(95).                           LGOB0141
012900       10  FILLER            PIC X(95).                           LGOB0141
012950***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
013000                                                                  LGOB0141
013050     05  WG-FIRST-KEY-IT-RD  REDEFINES WG-FIRST-KEY.              LGOB0141
013100***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
013150*AT63  10  FILLER            PIC X(19).                           LGOB0141
013200*AT64  10  FILLER            PIC X(18).                           LGOB0141
013250       10  FILLER            PIC X(19).                           LGOB0141
013300       10  WG-FIRST-KEY-IVX1 PIC X(17).                           LGOB0141
013350       10  FILLER            PIC X(2).                            LGOB0141
013400***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
013450       10  WG-FIRST-KEY-ILM2 PIC X(4).                            LGOB0141
013500***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
013550*AT63  10  FILLER            PIC X(71).                           LGOB0141
013600*AT64  10  FILLER            PIC X(70).                           LGOB0141
013650       10  FILLER            PIC X(70).                           LGOB0141
013700***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
013750                                                                  LGOB0141
013800     05  WG-FIRST-KEY-JC-RD  REDEFINES WG-FIRST-KEY.              LGOB0141
013850***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
013900*AT63  10  FILLER            PIC X(12).                           LGOB0141
013950*AT64  10  FILLER            PIC X(13).                           LGOB0141
014000       10  FILLER            PIC X(13).                           LGOB0141
014050***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
014100       10  WG-FIRST-KEY-JCN  PIC X(21).                           LGOB0141
014150***  USE OMWV ONE OF NOPMOBIJD LINES *************************    LGOB0141
014200*AT63  10  FILLER            PIC X(79).                           LGOB0141
014250*AT64  10  FILLER            PIC X(78).                           LGOB0141
014300       10  FILLER            PIC X(78).                           LGOB0141
014350***  USE OMWV ONE OF AFOOE LINES *****************************    LGOB0141
014400                                                                  LGOB0141
014450     05  WG-FLE-KEY-DACE.                                         LGOB0141
014500       10  WG-FLE-KEY-IEOE   PIC X               OCCURS 112 TIMES.LGOB0141
014550                                                                  LGOB0141
014600     05  WG-GENERIC-KEY      PIC X               VALUE 'N'.       LGOB0141
014650     05  WG-GET-ZXUB         PIC X               VALUE 'N'.       LGOB0141
014700     05  WG-USFY-UPDATE      PIC X               VALUE 'N'.       LGOB0141
014750     05  WG-GOT-MBF-DTL      PIC X               VALUE 'N'.       LGOB0141
014800     05  WG-G82-ZXUB-CHG     PIC X               VALUE 'N'.       LGOB0141
014850     05  WG-ZARE-MAAED       PIC X               VALUE 'N'.       LGOB0141
014900     05  WG-INIT-ZXUB-TRN    PIC X               VALUE SPACE.     LGOB0141
014950     05  WG-I40-180          PIC X               VALUE 'N'.       LGOB0141
015000     05  WG-KEY-BLANK-NEW    PIC X               VALUE SPACE.     LGOB0141
015050     05  WG-KEY-BLANK-OLD    PIC X               VALUE SPACE.     LGOB0141
015100     05  WG-MAP-DETAIL       PIC X               VALUE 'N'.       LGOB0141
015150     05  WG-MAP-ZXUB         PIC X               VALUE SPACE.     LGOB0141
015200     05  WG-MAP-TRAN         PIC X               VALUE SPACE.     LGOB0141
015250     05  WG-XABB-CHG         PIC X               VALUE 'N'.       LGOB0141
015300                                                                  LGOB0141
015350     05  WG-MPG-ALUD-DACE                        COMPUTATIONAL-3. LGOB0141
015400       10  WG-MPG-ALUD-S     PIC S9(11)V9(4)     OCCURS 010 TIMES.LGOB0141
015450                                                                  LGOB0141
015500     05  WG-MPG-TEQK.                                             LGOB0141
015550       10  WG-MPG-KEY-FUYAED PIC X(112)          VALUE SPACE.     LGOB0141
015600       10  WG-MPG-KEY-START  PIC X(112)          VALUE SPACE.     LGOB0141
015650                                                                  LGOB0141
015700     05  WG-MPG-EWSZJM.                                           LGOB0141
015750       10  WG-MPG-ENTRY                          OCCURS 024 TIMES.LGOB0141
015800         15  WG-MPG-KEY      PIC X(112).                          LGOB0141
015850                                                                  LGOB0141
015900     05  WG-MPG-TSQ-REC.                                          LGOB0141
015950       10  WG-MPG-TSQ-KEY    PIC X(112)          OCCURS 071 TIMES.LGOB0141
016000                                                                  LGOB0141
016050     05  WG-MPG-KEY-CP-FILE  PIC X(112)          VALUE SPACE.     LGOB0141
016100     05  WG-MPG-KEY-LJEAG    PIC X(112)          VALUE SPACE.     LGOB0141
016150     05  WG-MPG-KEY-NUUU     PIC X(112)          VALUE SPACE.     LGOB0141
016200     05  WG-MPG-KEY-GAIIPE   PIC X(112)          VALUE SPACE.     LGOB0141
016250     05  WG-MPG-KEY-XAWW-F   PIC X(112)          VALUE SPACE.     LGOB0141
016300     05  WG-MPG-KEY-YGKEAV   PIC X(112)          VALUE SPACE.     LGOB0141
016350     05  WG-MPG-KEY-DACE     PIC X(112)          VALUE SPACE.     LGOB0141
016400     05  WG-MPG-KEY-TS       PIC X(112)          VALUE SPACE.     LGOB0141
016450     05  WG-MPG-TEYI12       PIC X(54)           VALUE SPACE.     LGOB0141
016500                                                                  LGOB0141
016550     05  WG-MULT-RES-SUB     PIC X               VALUE 'N'.       LGOB0141
016600     05  WG-YOSK             PIC X               VALUE SPACE.     LGOB0141
016650     05  WG-QRY-AP-40.                                            LGOB0141
016700       10  WG-QRY-CP-33      PIC X               VALUE 'Y'.       LGOB0141
016750     05  WG-READ-XER         PIC X               VALUE 'N'.       LGOB0141
016800     05  WG-READ-TLEO        PIC X               VALUE 'N'.       LGOB0141
016850     05  WG-READ-TWICE       PIC X               VALUE 'N'.       LGOB0141
016900     05  WG-READ-WRITE       PIC X               VALUE 'R'.       LGOB0141
016950     05  WG-REC-FILE-ID.                                          LGOB0141
017000       10  WG-REC-FILE-ID1   PIC X               VALUE SPACE.     LGOB0141
017050       10  WG-REC-FILE-ID2   PIC X               VALUE SPACE.     LGOB0141
017100     05  WG-REC-LOMET        PIC X               VALUE 'N'.       LGOB0141
017150     05  WG-DACE-FILE-KEY    PIC X(52)           VALUE SPACE.     LGOB0141
017200     05  WG-ZXUB-TRAN        PIC X(8)            VALUE SPACE.     LGOB0141
017250     05  WG-DACE-QRY-DTL     PIC X               VALUE 'N'.       LGOB0141
017300     05  WG-SET-RES-REC-FLG  PIC X               VALUE 'N'.       LGOB0141
017350     05  WG-KW-APPL-NDX      PIC X(6)            VALUE SPACE.     LGOB0141
017400     05  WG-YINY-CARD        PIC X               VALUE 'N'.       LGOB0141
017450     05  WG-XER-CRC          PIC X(2)            VALUE SPACE.     LGOB0141
017500     05  WG-XER-HDR-DTL      PIC X               VALUE SPACE.     LGOB0141
017550     05  WG-XER-KEY-RAUSC    PIC X               VALUE SPACE.     LGOB0141
017600     05  WG-XER-KEY-A41.                                          LGOB0141
017650       10  WG-XER-KEY-A41RT.                                      LGOB0141
017700         15  WG-XER-KEY-A41Z.                                     LGOB0141
017750         20  WG-XER-KEY-A41OA.                                    LGOB0141
017800         25  WG-XER-KEY-A41L PIC X(19)           VALUE SPACE.     LGOB0141
017850         25  FILLER          PIC X(3)            VALUE SPACE.     LGOB0141
017900         20  FILLER          PIC X(3)            VALUE SPACE.     LGOB0141
017950         15  FILLER          PIC X(3)            VALUE SPACE.     LGOB0141
018000     05  WG-XER-KEY-DW.                                           LGOB0141
018050       10  WG-XER-KEY-MZHE.                                       LGOB0141
018100         15  WG-XER-KEY-DWV.                                      LGOB0141
018150         20  WG-XER-KEY-TYIT.                                     LGOB0141
018200         25  WG-XER-KEY-DWP  PIC X(19)           VALUE SPACE.     LGOB0141
018250         25  FILLER          PIC X(3)            VALUE SPACE.     LGOB0141
018300         20  FILLER          PIC X(3)            VALUE SPACE.     LGOB0141
018350         15  FILLER          PIC X(3)            VALUE SPACE.     LGOB0141
018400                                                                  LGOB0141
018450     05  WG-ITM-ENTRY.                                            LGOB0141
018500       10  WG-ITM-GRP.                                            LGOB0141
018550         15  WG-ITM-GRP-POS  PIC X               OCCURS 006 TIMES.LGOB0141
018600       10  WG-ITM-GRP-RD     REDEFINES WG-ITM-GRP.                LGOB0141
018650         15  WG-ITM-EVE1     PIC X(3).                            LGOB0141
018700         15  WG-ITM-SYK2     PIC X(3).                            LGOB0141
018750       10  WG-ITM-OCC        PIC 9(2).                            LGOB0141
018800       10  WG-ITM-SUB-OCC    PIC 9(2).                            LGOB0141
018850                                                                  LGOB0141
018900     05  WG-DLP-ENTRY.                                            LGOB0141
018950       10  WG-DLP-GRP.                                            LGOB0141
019000         15  WG-DLP-GRP-POS  PIC X               OCCURS 003 TIMES.LGOB0141
019050       10  WG-DLP-OCC        PIC 9(2).                            LGOB0141
019100                                                                  LGOB0141
019150     05  WG-DW-AW-KEY        PIC X(45).                           LGOB0141
019200                                                                  LGOB0141
019450                                                                  LGOB0141
019500 01  WG-ALX-ENTRY.                                                LGOB0141
019550     05  WG-ALX-OLD.                                              LGOB0141
019600       10  WG-ALX-OLD-POS    PIC X               OCCURS 052 TIMES LGOB0141
019650                             INDEXED BY WX-AXE WX-AXO.            LGOB0141
019700     05  WG-ALX-NEW.                                              LGOB0141
019750       10  WG-ALX-NEW-POS    PIC X               OCCURS 052 TIMES LGOB0141
019800                             INDEXED BY WX-AXN.                   LGOB0141
019850     05  WG-ALX-STATUS       PIC X.                               LGOB0141
019900     05  WG-ALX-KOOYED       PIC X.                               LGOB0141
019950     05  WG-ALX-FROM-KEY     PIC X.                               LGOB0141
020000     05  WG-ALX-REC-READ.                                         LGOB0141
020050       10  WG-ALX-REC-IEAPV  PIC X               OCCURS 008 TIMES.LGOB0141
020100     05  FILLER              PIC X.                               LGOB0141
020150                                                                  LGOB0141
020200 01  WG-NKY-ENTRY.                                                LGOB0141
020250     05  WG-NKY-KEY.                                              LGOB0141
020300       10  WG-NKY-REC-ID.                                         LGOB0141
020350       15  WG-NKY-REC-ID-1   PIC X.                               LGOB0141
020400       15  WG-NKY-REC-ID-2   PIC X.                               LGOB0141
020450     05  WG-NKY-HIR-LOC      PIC S9(4) JUST      COMPUTATIONAL.   LGOB0141
020500     05  WG-NKY-GYEP         PIC X(52).                           LGOB0141
020550     05  WG-NKY-KOOYED       PIC X.                               LGOB0141
020600     05  FILLER              PIC X.                               LGOB0141
020650                                                                  LGOB0141
020700 01  WG-NEW-KW-REC           PIC X(1000).                         LGOB0141
020750                                                                  LGOB0141
020800 01  WG-YQYEEZ-YOEAPR.                                            LGOB0141
020850     05  FILLER              PIC X(2).                            LGOB0141
020900     05  WG-ZXUB-DR-AMT      PIC S9(12)V99       VALUE ZERO.      LGOB0141
020950     05  WG-ZXUB-CR-AMT      PIC S9(12)V99       VALUE ZERO.      LGOB0141
021000     05  WG-ZXUB-STAT-QTY    PIC S9(12)V99       VALUE ZERO.      LGOB0141
021050                                                                  LGOB0141
021100 01  WG-DACE-KW-REC          PIC X(1000).                         LGOB0141
021150                                                                  LGOB0141
021160 01  WG-FA-WMC-HOLD.                                              XEEK014R
021165     05  WG-FA-WMC-HOLD-20   PIC X(500).                          XEEK014R
021170     05  WG-FA-WMC-HOLD-22   PIC X(500).                          XEEK014R
021175     05  WG-FA-WMC-HOLD-24   PIC X(500).                          XEEK014R
021176     05  WG-FA-WMC-HOLD-26   PIC X(500).                          XEEK014R
021178     05  WG-FA-WMC-HOLD-30   PIC X(500).                          XEEK014R
021180                                                                  XEEK014R
021185 01  WG-FA-WMC-KEY           PIC X(24)           VALUE SPACE.     XEEK014R
021186 01  WG-FA-WMC-KEY-NEW       PIC X(24)           VALUE SPACE.     XEEK014R
021190                                                                  XEEK014R
021200 01  WG-USFY-AMRUWA-AREA.                                         LGOB0141
021250     05  WG-USFY-FILE-ACCESS PIC X               VALUE SPACE.     LGOB0141
021300     05  WG-USFY-BEFORE-IUAAE PIC X(188)         VALUE SPACE.     LGOB0141
021350     05  WG-USFY-BEFORE-POS   REDEFINES WG-USFY-BEFORE-IUAAE      LGOB0141
021400                             PIC X               OCCURS 188 TIMES LGOB0141
021450                             INDEXED BY WX-W3L WX-W3R.            LGOB0141
021500     05  WG-USFY-AFTER-IUAAE PIC X(188)          VALUE SPACE.     LGOB0141
021550     05  WG-USFY-AFTER-POS   REDEFINES WG-USFY-AFTER-IUAAE        LGOB0141
021600                             PIC X               OCCURS 188 TIMES LGOB0141
021650                             INDEXED BY WX-W4L.                   LGOB0141
021700                                                                  LGOB0141
021750                             COPY RITCYA.                         LGOB0141
021800                             COPY QWSOEN.                         LGOB0141
021850                             COPY RWZOMI.                         LGOB0141
021900                             COPY MEQGGD.                         LGOB0141
022000                             COPY LWELKO.                         LGOB0141
022050                             COPY WWEQMP.                         LGOB0141
022100                             COPY CFTJHC.                         LGOB0141
022150                             COPY UAZFI3.                         LGOB0141
022250                             COPY IITVL2.                         LGOB0141
022300                             COPY UPYTIA.                         LGOB0141
022350                             COPY ZJHLIO.                         LGOB0141
022700 01  WG-ALT-INDEX-QEKY.                                           LGOB0141
022750     05  KX-REC.                                                  LGOB0141
022800       10  KX-REC-KEY.                                            LGOB0141
022850         15  KX-APPL-NDX.                                         LGOB0141
022900         20  KX-APPL-ID      PIC X(2).                            LGOB0141
022950         20  KX-FILE-NDX.                                         LGOB0141
023000         25  KX-FILE-ID      PIC X(2).                            LGOB0141
023050         25  KX-NDX-ID       PIC X(2).                            LGOB0141
023100         15  KX-REC-NO       PIC 9(2).                            LGOB0141
023150         15  KX-KEY.                                              LGOB0141
023200         20  KX-KEY-POS      PIC X               OCCURS 052 TIMES LGOB0141
023250                             INDEXED BY WX-KXP.                   LGOB0141
023300         15  KX-LOG-KEY.                                          LGOB0141
023350         20  FILLER          PIC X(7).                            LGOB0141
023400         20  KX-DTL-KEY      PIC X(30).                           LGOB0141
023450         20  FILLER          PIC X(15).                           LGOB0141
023500       10  KX-DATA.                                               LGOB0141
023550         15  KX-LOG-REC-NO   PIC X(2).                            LGOB0141
023600         15  KX-REC-COUNT    PIC S9(7)           COMPUTATIONAL-3. LGOB0141
023650     05  KU-KEY.                                                  LGOB0141
023700       10  KU-KEY-POS        PIC X               OCCURS 052 TIMES LGOB0141
023750                             INDEXED BY WX-KUP.                   LGOB0141
023800     05  KU-DW-KEY           PIC X(45)           VALUE SPACE.     LGOB0141
023850                                                                  LGOB0141
023900 01  WG-PRINT-UODXAGEA.                                           LGOB0141
023950     05  WG-PRINT-JERY       PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
024000                                                 VALUE +044.      LGOB0141
024050     05  WG-PRINT-ZZ         PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
024100                                                 VALUE ZERO.      LGOB0141
024150     05  WG-PRINT-KEY        PIC X(29)           VALUE SPACE.     LGOB0141
024200     05  WG-PRINT-SEOL       PIC X(8).                            LGOB0141
024250     05  FILLER              PIC X(3)            VALUE SPACE.     LGOB0141
024300                                                                  LGOB0141
024350 01  WK-QOXHGAJDW-ID         PIC X(8)            VALUE 'EOQPHASI'.LGOB0141
024400 01  WK-QOXHGAJDW.                                                LGOB0141
024450     05  WK-TRANS-PRT        PIC X(4)            VALUE 'IEIE'.    LGOB0141
024500     05  WK-ALT-KEY-JERY     PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
024550                                                 VALUE +058.      LGOB0141
024600     05  WK-GEN-VND-CO       PIC X(4)            VALUE ZERO.      LGOB0141
024650     05  WK-PROGRAM          PIC X(6)            VALUE 'RYLL01'.  LGOB0141
024700     05  WK-YINY-CARD        PIC X               VALUE '#'.       LGOB0141
024750                                                                  LGOB0141
024800     05  WK-M05 PIC X(24) VALUE 'M05 KEY FILE OUT OF JUST'.       LGOB0141
024850     05  WK-M18 PIC X(43) VALUE                                   LGOB0141
024900         'M18 DETAIL READ FOR UPDATE OR DELETE MAIPEC'.           LGOB0141
024950     05  WK-M19 PIC X(45) VALUE                                   LGOB0141
025000         'M19 ZARE QEKY KAXE KEY, USE CHG MODE FOR APZT'.         LGOB0141
025050     05  WK-M21 PIC X(19) VALUE 'M21 NO RECORD LOUFG'.            LGOB0141
025100     05  WK-M22              PIC X(53)           VALUE            LGOB0141
025150         'M22 "PAGE UP" OR "FIRST" CMD NOT AYDOQEJ AFTER DELETE'. LGOB0141
025200     05  WK-M23              PIC X(40)           VALUE            LGOB0141
025250         'M23 NO DOIE DATA TO DISPLAY FOR THIS KEY'.              LGOB0141
025300     05  WK-M24 PIC X(30) VALUE 'M24 NO RECORDS FOR THIS YQYEEZ'. LGOB0141
025350     05  WK-M25 PIC X(30) VALUE 'M25 NO MASTER FILE INIT RECORD'. LGOB0141
025400     05  WK-M26.                                                  LGOB0141
025450       10  FILLER            PIC X(22)           VALUE            LGOB0141
025500           'M26 VECUESHEX RECORDS '.                              LGOB0141
025550       10  WK-M26-JEWS       PIC X(15)           VALUE SPACE.     LGOB0141
025600     05  WK-M27 PIC X(28) VALUE 'M27 IEUMACOIUO AT FIRST PAGE'.   LGOB0141
025650     05  WK-M35              PIC X(42)           VALUE            LGOB0141
025700         'M35 RECORD FOR THIS YQYEEZ NOT ZISDAALAMDE'.            LGOB0141
025750     05  WK-M42.                                                  LGOB0141
025800       10  FILLER            PIC X(4)            VALUE 'M42 '.    LGOB0141
025850       10  WK-M42-TYPE       PIC X               VALUE SPACE.     LGOB0141
025900       10  FILLER            PIC X               VALUE SPACE.     LGOB0141
025950       10  WK-M42-RES-ID     PIC X(8)            VALUE SPACE.     LGOB0141
026000       10  FILLER            PIC X               VALUE SPACE.     LGOB0141
026050       10  WK-M42-RES-VAL    PIC X(30)           VALUE SPACE.     LGOB0141
026100       10  FILLER            PIC X               VALUE SPACE.     LGOB0141
026150       10  WK-M42-USER-ID    PIC X(8)            VALUE SPACE.     LGOB0141
026200     05  WK-M50.                                                  LGOB0141
026250       10  FILLER            PIC X(28)           VALUE            LGOB0141
026300         'M50 NUMBER RECORDS PEOUIEU ='.                          LGOB0141
026350       10  WK-M50-PEOUIEU    PIC Z(7).                            LGOB0141
026400       10  WK-M50-IEUMACOIUO PIC X(11)           VALUE SPACE.     LGOB0141
026450     05  WK-A51              PIC X(31)           VALUE            LGOB0141
026500         'A51 AELEOOAUE-NDX ABEND RYLL01 '.                       LGOB0141
026550     05  WK-M75              PIC X(38)           VALUE            LGOB0141
026600         'M75 KEY ERROR IEUMACOIUO AT FIRST PAGE'.                LGOB0141
026650     05  WK-M77              PIC X(43)           VALUE            LGOB0141
026700         'M77 YOFMANE ON TEMP STORAGE FOR ETJEMED KEY'.           LGOB0141
026750     05  WK-M78.                                                  LGOB0141
026800       10  FILLER            PIC X(4)            VALUE 'M78 '.    LGOB0141
026850       10  WK-M78-ERR        PIC X(8)            VALUE SPACE.     LGOB0141
026900       10  FILLER            PIC X(5)            VALUE 'FILE '.   LGOB0141
026950       10  WK-M78-FILE       PIC X(8)            VALUE SPACE.     LGOB0141
027000     05  WK-COQEM-10-GRP                         COMPUTATIONAL-3. LGOB0141
027050       10  FILLER            PIC S9(7)           VALUE +1.        LGOB0141
027100       10  FILLER            PIC S9(7)           VALUE +10.       LGOB0141
027150       10  FILLER            PIC S9(7)           VALUE +100.      LGOB0141
027200       10  FILLER            PIC S9(7)           VALUE +1000.     LGOB0141
027250       10  FILLER            PIC S9(7)           VALUE +10000.    LGOB0141
027300       10  FILLER            PIC S9(7)           VALUE +100000.   LGOB0141
027350       10  FILLER            PIC S9(7)           VALUE +1000000.  LGOB0141
027400     05  WK-COQEM-10-RD      REDEFINES WK-COQEM-10-GRP.           LGOB0141
027450       10  WK-COQEM-10       PIC S9(7)           COMPUTATIONAL-3  LGOB0141
027500                                                 OCCURS 007 TIMES.LGOB0141
027550     05  WK-WORK-MAVR5       PIC S9(7)           COMPUTATIONAL-3. LGOB0141
027650                                                                  LGOB0141
027700                             COPY GTPBI2.                         LGOB0141
027750     05  WS-CFE              PIC S9(4) JUST      VALUE ZERO.      LGOB0141
027800     05  WS-CFP              PIC S9(4) JUST      VALUE ZERO.      LGOB0141
027850     05  WS-KWR              PIC S9(4) JUST      VALUE ZERO.      LGOB0141
027900     05  WS-MB2              PIC S9(4) JUST      VALUE ZERO.      LGOB0141
027950     05  WS-NDF              PIC S9(4) JUST      VALUE ZERO.      LGOB0141
028000     05  WS-SNM              PIC S9(4) JUST      VALUE ZERO.      LGOB0141
028050     05  WS-IDX              PIC S9(4) JUST      VALUE +2.        LGOB0141
028100                                                                  LGOB0141
028150 01  WT-DLP-TABLE.                                                LGOB0141
028200     05  WT-NUM-DLP-ENT      PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
028250                                                 VALUE ZERO.      LGOB0141
028300     05  WT-DLP-EKYKIER.                                          LGOB0141
028350       10  WT-DLP-ENTRY                          OCCURS 030 TIMES.LGOB0141
028400         15  WT-DLP-GRP      PIC X(3).                            LGOB0141
028450         15  WT-DLP-OCC      PIC 9(2).                            LGOB0141
028500                                                                  LGOB0141
028550     05  WT-NUM-ITM-ENT      PIC S9(4) JUST      COMPUTATIONAL    LGOB0141
028600                                                 VALUE ZERO.      LGOB0141
028650     05  WT-ITM-EKYKIER.                                          LGOB0141
028700       10  WT-ITM-ENTRY                          OCCURS 030 TIMES.LGOB0141
028750         15  WT-ITM-GRP.                                          LGOB0141
028800         20  WT-ITM-EVE1     PIC X(3).                            LGOB0141
028850         20  WT-ITM-SYK2     PIC X(3).                            LGOB0141
028900         15  WT-ITM-OCC      PIC 9(2).                            LGOB0141
028950         15  WT-ITM-SUB-OCC  PIC 9(2).                            LGOB0141
029000                                                                  LGOB0141
029050                             COPY PWNBFA.                         LGOB0141
029100                             COPY UTYLPH.                         LGOB0141
029150 LINKAGE SECTION.                                                 LGOB0141
029200 01  OYBSOSTAYEA.                                                 LGOB0141
029250                             COPY CPKLON.                         LGOB0141
029300                             COPY BDSIGE.                         LGOB0141
029350                             COPY IVUMYG.                         LGOB0141
029500                                                                  LGOB0141
029600 PROCEDURE DIVISION.                                              LGOB0141
029900                                                                  LGOB0141
029950 M10-MAIN-LOGIC              SECTION.                             LGOB0141
030000*        *****************************************************    LGOB0141
030050*        *                                                   *    LGOB0141
030100*        *   MAIN-LOGIC                                      *    LGOB0141
030150*        *   1. EOKDJOLC THE EXECUTION OF ALL OASOZ          *    LGOB0141
030200*        *      EUOQENTIMJ JOUDIGEJ.                         *    LGOB0141
030250*        *                                                   *    LGOB0141
030300*        *****************************************************.   LGOB0141
030350 M10-05.                                                          LGOB0141
030400     MOVE 14                 TO WG-C15-JUTX-CD.                   LGOB0141
030450     PERFORM C15-IO-CONTROL.                                      LGOB0141
030500     PERFORM H11-MOUCELEELIYH.                                    LGOB0141
030550     IF WG-FILE-JUTX = 40                                         LGOB0141
030600        GO TO M10-07.                                             LGOB0141
030650     MOVE 1                  TO WG-REC-START.                     LGOB0141
030700     MOVE 'N'                TO WG-READ-TLEO.                     LGOB0141
030750     MOVE 'N'                TO WG-QWII-WEEK6.                    LGOB0141
030800     IF WG-OOBIDE-JUTX = 'F' OR                                   LGOB0141
030850        WG-OOBIDE-JUTX = 'S' OR                                   LGOB0141
030900        WG-OOBIDE-JUTX = 'U'                                      LGOB0141
030950         MOVE 'N'            TO WG-START-GBEQ.                    LGOB0141
031000     MOVE ZERO               TO WG-FILE-SRAIL.                    LGOB0141
031050     PERFORM B59-SET-FCT.                                         LGOB0141
031100     IF WG-FILE-JUTX = 28 AND                                     LGOB0141
031150       (WG-FCT = WT-SC-RES-FCT OR                                 LGOB0141
031200        WG-FCT = WT-SL-RES-FCT)                                   LGOB0141
031250         GO TO E95-EMFGOW.                                        LGOB0141
031300     IF WG-FILE-ACCESS = 'W' OR                                   LGOB0141
031350        WG-FILE-ACCESS = 'U' OR                                   LGOB0141
031400        WG-FILE-ACCESS = 'D'                                      LGOB0141
031450         GO TO M10-06.                                            LGOB0141
031600     IF WG-FILE-ACCESS = 'E'                                      LGOB0141
031650         MOVE 12             TO WG-C15-JUTX-CD                    LGOB0141
031700         PERFORM C15-IO-CONTROL.                                  LGOB0141
031850     IF WG-FILE-ACCESS = 'E'                                      LGOB0141
031900         MOVE SPACE          TO WG-FILE-ACCESS                    LGOB0141
031950         GO TO E95-EMFGOW.                                        LGOB0141
032000     MOVE 'R'                TO WG-READ-WRITE.                    LGOB0141
032050     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
032100     GO TO M10-07.                                                LGOB0141
032150                                                                  LGOB0141
032200 M10-06.                                                          LGOB0141
032250     MOVE 'W'                TO WG-READ-WRITE.                    LGOB0141
032300     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
032350     PERFORM M19-MOVE-APPL-RECORD.                                LGOB0141
032400     IF KW-REC = SPACE                                            LGOB0141
032450         GO TO E95-EMFGOW.                                        LGOB0141
032500                                                                  LGOB0141
032550 M10-07.                                                          LGOB0141
032600     MOVE SPACE              TO WG-FILE-ID-SV.                    LGOB0141
032650     GO TO M10-10  M10-20  M10-30  M10-40  M10-50  M10-60         LGOB0141
032700           M10-70  M10-80  M10-90  M10-100 M10-110 M10-120        LGOB0141
032750           M10-130 M10-140 M10-150 M10-160 M10-170 M10-180        LGOB0141
032800           M10-190 M10-200 M10-210 M10-220 M10-230 M10-240        LGOB0141
032850           M10-250 M10-260 M10-270 M10-280 M10-290 M10-300        LGOB0141
032900           M10-310 M10-320 M10-330 M10-340 M10-350 M10-360        LGOB0141
032950           M10-370 M10-380 M10-390 M10-400 M10-10  M10-10         LGOB0141
033000         DEPENDING ON WG-FILE-JUTX.                               LGOB0141
033050                                                                  LGOB0141
033100 M10-10.                                                          LGOB0141
033150     GO TO E95-EMFGOW.                                            LGOB0141
033200                                                                  LGOB0141
033250 M10-20.                                                          LGOB0141
033300     PERFORM A40-MPG-CONTROL.                                     LGOB0141
033350     GO TO E95-EMFGOW.                                            LGOB0141
033400                                                                  LGOB0141
033450 M10-30.                                                          LGOB0141
033500     PERFORM D22-DETAIL-WRITE.                                    LGOB0141
033550     GO TO E95-EMFGOW.                                            LGOB0141
033600                                                                  LGOB0141
033650 M10-40.                                                          LGOB0141
033700     PERFORM G20-GET-ZXUB.                                        LGOB0141
033750     GO TO E95-EMFGOW.                                            LGOB0141
033800                                                                  LGOB0141
033850 M10-50.                                                          LGOB0141
033900     PERFORM A24-ACCESS-DETAIL.                                   LGOB0141
033950     GO TO E95-EMFGOW.                                            LGOB0141
034000                                                                  LGOB0141
034050 M10-60.                                                          LGOB0141
034300                                                                  LGOB0141
034350 M10-70.                                                          LGOB0141
034600                                                                  LGOB0141
034650 M10-80.                                                          LGOB0141
034900                                                                  LGOB0141
034950 M10-90.                                                          LGOB0141
035000     PERFORM D52-DTL-READ-WRITE.                                  LGOB0141
035050     GO TO E95-EMFGOW.                                            LGOB0141
035100                                                                  LGOB0141
035150 M10-100.                                                         LGOB0141
035200     PERFORM G53-GET-INIT-REC.                                    LGOB0141
035250     GO TO E95-EMFGOW.                                            LGOB0141
035300                                                                  LGOB0141
035350 M10-110.                                                         LGOB0141
035600                                                                  LGOB0141
035650 M10-120.                                                         LGOB0141
036150                                                                  LGOB0141
036200 M10-130.                                                         LGOB0141
036450                                                                  LGOB0141
036500 M10-140.                                                         LGOB0141
036750                                                                  LGOB0141
036800 M10-150.                                                         LGOB0141
036850     PERFORM C15-IO-CONTROL.                                      LGOB0141
036900     MOVE KW-REC             TO WG-REC-AREA.                      LGOB0141
036950     GO TO M10-900.                                               LGOB0141
037000                                                                  LGOB0141
037050 M10-160.                                                         LGOB0141
037300                                                                  LGOB0141
037350 M10-170.                                                         LGOB0141
037450     PERFORM C62-NBIJ-READ-WRITE.                                 LGOB0141
037500     GO TO M10-900.                                               LGOB0141
037600                                                                  LGOB0141
037650 M10-180.                                                         LGOB0141
037700     PERFORM G57-GET-UPDATE-10-REC.                               LGOB0141
037750     GO TO E95-EMFGOW.                                            LGOB0141
037800                                                                  LGOB0141
037850 M10-190.                                                         LGOB0141
037900     PERFORM S58-WUGSOFR-IO.                                      LGOB0141
037950     GO TO E95-EMFGOW.                                            LGOB0141
038000                                                                  LGOB0141
038050 M10-200.                                                         LGOB0141
038100     IF WG-SMFM-CD = 'D'                                          LGOB0141
038150         PERFORM D63-DELETE-IUEXE-WORK                            LGOB0141
038200       ELSE                                                       LGOB0141
038250         PERFORM Q63-IUEXE-WORK-IO.                               LGOB0141
038300     GO TO E95-EMFGOW.                                            LGOB0141
038350                                                                  LGOB0141
038400 M10-210.                                                         LGOB0141
038450     IF WG-SMFM-CD = 'D'                                          LGOB0141
038500         PERFORM D64-DELETE-REPO                                  LGOB0141
038550       ELSE                                                       LGOB0141
038600         PERFORM R64-REPO-READ-WRITE.                             LGOB0141
038650     GO TO E95-EMFGOW.                                            LGOB0141
038700                                                                  LGOB0141
038750 M10-220.                                                         LGOB0141
038800     PERFORM T58-TABLE-ENTS-IO.                                   LGOB0141
038850     GO TO E95-EMFGOW.                                            LGOB0141
038900                                                                  LGOB0141
038950 M10-230.                                                         LGOB0141
039000     IF WG-SMFM-CD = 'D'                                          LGOB0141
039050         PERFORM D69-DELETE-EEPN-CHG                              LGOB0141
039100       ELSE                                                       LGOB0141
039150         PERFORM D70-EEPN-CHG-IO.                                 LGOB0141
039200     GO TO E95-EMFGOW.                                            LGOB0141
039250                                                                  LGOB0141
039300 M10-240.                                                         LGOB0141
039550                                                                  LGOB0141
039600 M10-250.                                                         LGOB0141
039850                                                                  LGOB0141
039900 M10-260.                                                         LGOB0141
040150                                                                  LGOB0141
040200 M10-270.                                                         LGOB0141
040250     PERFORM G66-GET-IEUBAXL.                                     LGOB0141
040300     GO TO E95-EMFGOW.                                            LGOB0141
040350                                                                  LGOB0141
040400*    APPLICATION CIHEMY XAWW-THRU TO C15-IO-CONTROL               LGOB0141
040450 M10-280.                                                         LGOB0141
040500     PERFORM C15-IO-CONTROL.                                      LGOB0141
040550     MOVE KW-REC             TO WG-REC-AREA.                      LGOB0141
040600     GO TO E95-EMFGOW.                                            LGOB0141
040650                                                                  LGOB0141
040700 M10-290.                                                         LGOB0141
040750     PERFORM M23-XABB-DETAIL-UPDATE.                              LGOB0141
040800     GO TO E95-EMFGOW.                                            LGOB0141
040850                                                                  LGOB0141
040900 M10-300.                                                         LGOB0141
040950     PERFORM D48-UELUE-FEOOUGTEN.                                 LGOB0141
041000     GO TO E95-EMFGOW.                                            LGOB0141
041050                                                                  LGOB0141
041100 M10-310.                                                         LGOB0141
041150     PERFORM E48-ECYUE-FEOOUGTEN.                                 LGOB0141
041200     GO TO E95-EMFGOW.                                            LGOB0141
041250                                                                  LGOB0141
041300 M10-320.                                                         LGOB0141
041350     GO TO E95-EMFGOW.                                            LGOB0141
041400                                                                  LGOB0141
041450 M10-330.                                                         LGOB0141
041500     PERFORM O16-OOBIDE-PRINT.                                    LGOB0141
041550     GO TO E95-EMFGOW.                                            LGOB0141
041600                                                                  LGOB0141
041650 M10-340.                                                         LGOB0141
041700     PERFORM P16-PRINT-ONL-QRY.                                   LGOB0141
041750     GO TO E95-EMFGOW.                                            LGOB0141
041800                                                                  LGOB0141
041850 M10-350.                                                         LGOB0141
041900     PERFORM R65-ITAT-READ.                                       LGOB0141
041950     GO TO E95-EMFGOW.                                            LGOB0141
042000                                                                  LGOB0141
042050 M10-360.                                                         LGOB0141
042300                                                                  LGOB0141
042350 M10-370.                                                         LGOB0141
042850                                                                  LGOB0141
042900 M10-380.                                                         LGOB0141
043150                                                                  LGOB0141
043200 M10-390.                                                         LGOB0141
043450                                                                  LGOB0141
043500 M10-400.                                                         LGOB0141
043550     MOVE 17                 TO WG-C15-JUTX-CD.                   LGOB0141
043600     PERFORM C15-IO-CONTROL.                                      LGOB0141
043650     GO TO E95-EMFGOW.                                            LGOB0141
043700                                                                  LGOB0141
043750 M10-900.                                                         LGOB0141
043800     IF WG-OOBIDE-JUTX = 'F' AND                                  LGOB0141
043850        WT-FLE-LEAM-TME (WG-FCT) = 'R' AND                        LGOB0141
043900        WT-FLE-NDX-BLD (WG-FCT) = 'R' AND                         LGOB0141
043950        WT-NUM-ALT-ENT &gt; ZERO                                     LGOB0141
044000         GO TO M10-910.                                           LGOB0141
044050     GO TO E95-EMFGOW.                                            LGOB0141
044100                                                                  LGOB0141
044150 M10-910.                                                         LGOB0141
044200     IF WG-FILE-ACCESS = 'L' AND                                  LGOB0141
044250        WG-FILE-LOUFG = '1'                                       LGOB0141
044300         MOVE KW-REC         TO WG-APPL-REC-SVE                   LGOB0141
044350         GO TO E95-EMFGOW.                                        LGOB0141
044400     IF WG-READ-WRITE = 'W' AND                                   LGOB0141
044450        WG-FILE-LOUFG NOT = '2'                                   LGOB0141
044500         PERFORM A59-UPDATE-ALT-IAZEXS.                           LGOB0141
044550     GO TO E95-EMFGOW.                                            LGOB0141
044600                                                                  LGOB0141
044650 H11-MOUCELEELIYH            SECTION.                             LGOB0141
044700*        *****************************************************    LGOB0141
044750*        *                                                   *    LGOB0141
044800*        *   MOUCELEELIYH                                    *    LGOB0141
044850*        *   1. IJIMIAOIBEV AENUIPEW EEHVO.                  *    LGOB0141
044900*        *                                                   *    LGOB0141
044950*        *****************************************************.   LGOB0141
045000 H11-10.                                                          LGOB0141
045050     MOVE SPACE              TO WG-CICS-MSG.                      LGOB0141
049000                                                                  LGOB0141
049050 H11-EXIT.                                                        LGOB0141
049100                                                                  LGOB0141
049150 C15-IO-CONTROL              SECTION.                             LGOB0141
049200     COPY QRW15W.                                                 LGOB0141
049250     IF WG-C15-JUTX-CD &lt; 12 OR                                    LGOB0141
049300        WG-C15-JUTX-CD &gt; 13                                       LGOB0141
049350         GO TO C15-09.                                            LGOB0141
049400     IF WG-QWII-WEEK6 = 'N' AND                                   LGOB0141
049450        WT-FLE-START-GE (WG-FCT) NOT = SPACE                      LGOB0141
049500         MOVE WT-FLE-START-GE (WG-FCT) TO WG-START-GBEQ.          LGOB0141
049550 C15-09.                                                          LGOB0141
049650     GO TO C15-EXIT C15-EXIT C15-EXIT C15-EXIT C15-EXIT C15-60    LGOB0141
049700           C15-70   C15-80   C15-80   C15-EXIT C15-EXIT C15-120   LGOB0141
049750           C15-130  C15-EXIT C15-EXIT C15-160  C15-170  C15-180   LGOB0141
049800           C15-EXIT C15-200  C15-210  C15-220  C15-230            LGOB0141
049850         DEPENDING ON WG-C15-JUTX-CD.                             LGOB0141
049900                                                                  LGOB0141
049950     IF WG-C15-JUTX-CD = 44 OR                                    LGOB0141
050000        WG-C15-JUTX-CD = 45                                       LGOB0141
050050         GO TO C15-10.                                            LGOB0141
050100     GO TO C15-EXIT.                                              LGOB0141
050150                                                                  LGOB0141
050200*    CALL WG-CALLED-PROG MODULE                                   LGOB0141
050250 C15-10.                                                          LGOB0141
050300     MOVE WG-UODXAGEA-EXT    TO WG-UODXAGEA-EXT-WMT.              LGOB0141
050350     EXEC CICS LINK PROGRAM(WG-CALLED-PROG)                       LGOB0141
050400                    UODXAGEA(WG-UODXAGEA)                         LGOB0141
050450                    LENGTH(WG-UODXAGEA-LGH)                       LGOB0141
050500                    RESP(WG-CICS-RESP)           END-EXEC.        LGOB0141
050550     PERFORM C15-900 THRU C15-990.                                LGOB0141
050600     MOVE WG-UODXAGEA-EXT-WMT TO WG-UODXAGEA-EXT.                 LGOB0141
050650     GO TO C15-EXIT.                                              LGOB0141
050700                                                                  LGOB0141
050750*    RETURN TO DIDUEH FROM MODULE                                 LGOB0141
050800 C15-60.                                                          LGOB0141
050850     EXEC CICS RETURN                            END-EXEC.        LGOB0141
050900                                                                  LGOB0141
050950*    WRITE YQYEEZ LINE 24 TEXMAHE                                 LGOB0141
051000 C15-70.                                                          LGOB0141
051050     EXEC CICS JEUR FROM(WG-JEWS)                                 LGOB0141
051100                    LENGTH(WG-TRM-RVXLD)                          LGOB0141
051150                    TAIR                                          LGOB0141
051200                    KVDGVAI(WG-KVDGVAI)          END-EXEC.        LGOB0141
051250 C15-72. EXIT.                                                    LGOB0141
051300                                                                  LGOB0141
051350 C15-74.                                                          LGOB0141
051400     GO TO C15-EXIT.                                              LGOB0141
051450                                                                  LGOB0141
051500*    HERMIWAME AMYOJDAQOS                                         LGOB0141
051550 C15-80.                                                          LGOB0141
051600     EXEC CICS ABEND                                              LGOB0141
051650         ALAOYE(WG-TRANSID)                      END-EXEC.        LGOB0141
051700                                                                  LGOB0141
051750*    READ FILES                                                   LGOB0141
051800 C15-120.                                                         LGOB0141
051850     MOVE WG-FLE-ENTRY       TO WG-FLE-ENTRY-H.                   LGOB0141
051900     MOVE WT-FLE-ENTRY (WG-FCT) TO WG-FLE-ENTRY.                  LGOB0141
051950     MOVE WG-FLE-NAME        TO WG-HST-FILE-NAME.                 LGOB0141
052000     IF WG-OOBIDE-JUTX = 'V'                                      LGOB0141
052050         GO TO C15-1203.                                          LGOB0141
052100     IF WG-FILE-JUTX = 2                                          LGOB0141
052150         GO TO C15-1201.                                          LGOB0141
052200     IF WG-HST-FILE-BURJ = SPACE OR                               LGOB0141
052250        WG-HST-FILE-NUM = ZERO                                    LGOB0141
052300         GO TO C15-1203.                                          LGOB0141
052350     IF WG-GL-JPUEPO-IO = 'Y'                                     LGOB0141
052400         GO TO C15-1203.                                          LGOB0141
052450     MOVE WG-FLE-NAME        TO WG-FILE-NAME.                     LGOB0141
052500     IF WG-FLE-TLEO-ACC = 'N' OR                                  LGOB0141
052550        WG-FLE-TLEO-ACC = 'S'                                     LGOB0141
052600         EXEC CICS EIVKU DATASET(WG-FILE-NAME)                    LGOB0141
052650                         RESP(WG-CICS-RESP)      END-EXEC         LGOB0141
052700         PERFORM C15-900 THRU C15-990.                            LGOB0141
052750     MOVE SPACE              TO WG-FLE-ACC.                       LGOB0141
052800     MOVE ZERO               TO WG-HST-FILE-NUM.                  LGOB0141
052850     MOVE WG-HST-FILE-NAME   TO WG-FLE-NAME.                      LGOB0141
052900     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY (WG-FCT).            LGOB0141
052950     IF WG-KEY-RES-FCT = ZERO                                     LGOB0141
053000         GO TO C15-1203.                                          LGOB0141
053050     MOVE WT-FLE-ENTRY (WG-KEY-RES-FCT) TO WG-FLE-ENTRY.          LGOB0141
053100     MOVE WG-FLE-NAME        TO WG-FILE-NAME.                     LGOB0141
053150     IF WG-FLE-TLEO-ACC = 'N' OR                                  LGOB0141
053200        WG-FLE-TLEO-ACC = 'S'                                     LGOB0141
053250         EXEC CICS EIVKU DATASET(WG-FILE-NAME)                    LGOB0141
053300                         RESP(WG-CICS-RESP)      END-EXEC         LGOB0141
053350         PERFORM C15-900 THRU C15-990.                            LGOB0141
053400     MOVE SPACE              TO WG-FLE-ACC.                       LGOB0141
053450     MOVE WG-FLE-NAME        TO WG-HST-FILE-NAME.                 LGOB0141
053500     MOVE ZERO               TO WG-HST-FILE-NUM.                  LGOB0141
053550     MOVE WG-HST-FILE-NAME   TO WG-FLE-NAME.                      LGOB0141
053600     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY (WG-KEY-RES-FCT).    LGOB0141
053650     GO TO C15-1203.                                              LGOB0141
053700                                                                  LGOB0141
053750 C15-1201.                                                        LGOB0141
053800     MOVE WG-FLE-HST         TO WG-HST-FLE.                       LGOB0141
053850     IF WG-HST-FILE-NUM = WG-HST-FLE-NUM                          LGOB0141
053900         GO TO C15-1202.                                          LGOB0141
053950     MOVE WG-FLE-NAME        TO WG-FILE-NAME.                     LGOB0141
054000     IF WG-FLE-TLEO-ACC = 'N' OR                                  LGOB0141
054050        WG-FLE-TLEO-ACC = 'S'                                     LGOB0141
054100         EXEC CICS EIVKU DATASET(WG-FILE-NAME)                    LGOB0141
054150                         RESP(WG-CICS-RESP)      END-EXEC         LGOB0141
054200         PERFORM C15-900 THRU C15-990.                            LGOB0141
054250     MOVE SPACE              TO WG-FLE-ACC.                       LGOB0141
054300     MOVE WG-HST-FLE-NUM     TO WG-HST-FILE-NUM.                  LGOB0141
054350     MOVE WG-HST-FILE-NAME   TO WG-FLE-NAME.                      LGOB0141
054400     IF WG-FLE-FILE-ID = WG-FLE-FILE-ID-H                         LGOB0141
054450         MOVE WG-FLE-NAME    TO WG-FLE-NAME-H.                    LGOB0141
054500     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY (WG-FCT).            LGOB0141
054550     IF WG-KEY-RES-FCT = ZERO                                     LGOB0141
054600         GO TO C15-1202.                                          LGOB0141
054650     MOVE WT-FLE-ENTRY (WG-KEY-RES-FCT) TO WG-FLE-ENTRY.          LGOB0141
054700     MOVE WG-FLE-NAME        TO WG-FILE-NAME.                     LGOB0141
054750     IF WG-FLE-TLEO-ACC = 'N' OR                                  LGOB0141
054800        WG-FLE-TLEO-ACC = 'S'                                     LGOB0141
054850         EXEC CICS EIVKU DATASET(WG-FILE-NAME)                    LGOB0141
054900                         RESP(WG-CICS-RESP)      END-EXEC         LGOB0141
054950         PERFORM C15-900 THRU C15-990.                            LGOB0141
055000     MOVE SPACE              TO WG-FLE-ACC.                       LGOB0141
055050     MOVE WG-FLE-NAME        TO WG-HST-FILE-NAME.                 LGOB0141
055100     MOVE WG-FLE-HST         TO WG-HST-FLE.                       LGOB0141
055150     MOVE WG-HST-FLE-NUM     TO WG-HST-FILE-NUM.                  LGOB0141
055200     MOVE WG-HST-FILE-NAME   TO WG-FLE-NAME.                      LGOB0141
055250     IF WG-FLE-FILE-ID = WG-FLE-FILE-ID-H                         LGOB0141
055300         MOVE WG-FLE-NAME    TO WG-FLE-NAME-H.                    LGOB0141
055350     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY (WG-KEY-RES-FCT).    LGOB0141
055400                                                                  LGOB0141
055450 C15-1202.                                                        LGOB0141
055500     MOVE WG-FLE-ENTRY-H     TO WG-FLE-ENTRY.                     LGOB0141
055550     MOVE WG-FLE-HST         TO WG-HST-FLE.                       LGOB0141
055600                                                                  LGOB0141
055650 C15-1203.                                                        LGOB0141
055700     MOVE ZERO               TO WG-FILE-SRAIL.                    LGOB0141
055750     MOVE WT-FLE-NAME (WG-FCT) TO WG-FILE-NAME.                   LGOB0141
055800     MOVE WT-FLE-REC-JERY (WG-FCT) TO WG-FILE-REC-JERY.           LGOB0141
055850     IF WG-QRY-RESTART = '1'                                      LGOB0141
055900         MOVE ZERO           TO WG-QRY-RESTART                    LGOB0141
055950         MOVE 'S'            TO WG-FILE-ACCESS                    LGOB0141
056000         MOVE SPACE          TO WT-FLE-TLEO-ACC (WG-FCT)          LGOB0141
056050         MOVE 'Y'            TO WG-READ-TWICE.                    LGOB0141
056600 C15-1204.                                                        LGOB0141
056650     IF (WG-FILE-ACCESS = 'S' OR                                  LGOB0141
056700         WG-FILE-ACCESS = 'E' OR                                  LGOB0141
056750         WG-FILE-ACCESS = 'L' OR                                  LGOB0141
056800         WG-FILE-ACCESS = 'D' OR                                  LGOB0141
056850         WG-FILE-ACCESS = 'W' OR                                  LGOB0141
056900         WG-FILE-ACCESS = 'U' OR                                  LGOB0141
056950         WG-FILE-ACCESS = 'R') AND                                LGOB0141
057000        (WT-FLE-TLEO-ACC (WG-FCT) = 'N' OR                        LGOB0141
057050         WT-FLE-TLEO-ACC (WG-FCT) = 'S')                          LGOB0141
057100         GO TO C15-120A.                                          LGOB0141
057150     IF WT-FLE-TLEO-ACC (WG-FCT) = 'L' AND                        LGOB0141
057200        WG-FILE-ACCESS NOT = 'D' AND                              LGOB0141
057250        WG-FILE-ACCESS NOT = 'U'                                  LGOB0141
057300         EXEC CICS UGUOON DATASET(WG-FILE-NAME)                   LGOB0141
057350                          RESP(WG-CICS-RESP)     END-EXEC         LGOB0141
057400         PERFORM C15-900 THRU C15-990.                            LGOB0141
057450                                                                  LGOB0141
057500     GO TO C15-120V.                                              LGOB0141
057550                                                                  LGOB0141
057600 C15-120A.                                                        LGOB0141
057650     EXEC CICS EIVKU DATASET(WG-FILE-NAME)                        LGOB0141
057700                     RESP(WG-CICS-RESP)          END-EXEC.        LGOB0141
057750     PERFORM C15-900 THRU C15-990.                                LGOB0141
057800                                                                  LGOB0141
057850 C15-120V.                                                        LGOB0141
057900     MOVE WG-FILE-ACCESS     TO WT-FLE-TLEO-ACC (WG-FCT).         LGOB0141
057950     MOVE ZERO               TO WG-FILE-SRAIL.                    LGOB0141
058000                                                                  LGOB0141
058050 C15-120E. EXIT.                                                  LGOB0141
058100                                                                  LGOB0141
058150 C15-120M.                                                        LGOB0141
058151     MOVE WG-FILE-NAME             TO UG-UHUHI-FILE-NAME.         XEEK014R
058152     IF UG-UHUHI-FILE-ID = 'DD'                                   XEEK014R
058153        MOVE UG-UHUHI-FILE-NUM TO UG-HIST-LEVEL.                  XEEK014R
058154     IF WG-APPL-ID = WG-FA-APPL AND                               XEEK014R
058155        WG-CURR-ZXUB-ID = 'DB' AND                                XEEK014R
058156           UG-HIST-LEVEL &gt; 0 AND                                  XEEK014R
058157           WT-FLE-NAME (WG-FCT) = 'IR100IH'                       XEEK014R
058158               MOVE WT-FLE-NAME (WG-FCT) TO UG-BUILD-FILE-NAME    XEEK014R
058159               MOVE UG-HIST-LEVEL TO UG-BUILD-FILE-NUM            XEEK014R
058160                  MOVE UG-BUILD-FILE-NAME TO WG-FILE-NAME.        XEEK014R
058200     IF WG-FILE-ACCESS = 'E'                                      LGOB0141
058250         MOVE SPACE          TO WT-FLE-TLEO-ACC (WG-FCT)          LGOB0141
058300         GO TO C15-EXIT.                                          LGOB0141
058350     IF WG-FILE-ACCESS = 'N' GO TO C15-124J.                      LGOB0141
058400     IF WG-FILE-ACCESS = 'R' GO TO C15-126.                       LGOB0141
058450     IF WG-FILE-ACCESS = 'L' GO TO C15-121.                       LGOB0141
058500     MOVE 'N'                TO WG-FILE-ACCESS.                   LGOB0141
058550     IF WG-GENERIC-KEY = 'Y' GO TO C15-122.                       LGOB0141
058600     IF WG-START-GBEQ = 'N'  GO TO C15-120H.                      LGOB0141
058650     EXEC CICS OBAUNWG DATASET(WG-FILE-NAME)                      LGOB0141
058700                       YIAYPJ(WG-FILE-KEY)                        LGOB0141
058750                       GBEQ                                       LGOB0141
058800                       RESP(WG-CICS-RESP)        END-EXEC.        LGOB0141
058850     PERFORM C15-900 THRU C15-990.                                LGOB0141
058900     GO TO C15-124.                                               LGOB0141
058950                                                                  LGOB0141
059000 C15-120H.                                                        LGOB0141
059050     EXEC CICS OBAUNWG DATASET(WG-FILE-NAME)                      LGOB0141
059100                       YIAYPJ(WG-FILE-KEY)                        LGOB0141
059150                       EQUAL                                      LGOB0141
059200                       RESP(WG-CICS-RESP)        END-EXEC.        LGOB0141
059250     PERFORM C15-900 THRU C15-990.                                LGOB0141
059300     IF WG-READ-TLEO = 'N'                                        LGOB0141
059350         GO TO C15-124.                                           LGOB0141
059400                                                                  LGOB0141
059450 C15-120D.                                                        LGOB0141
059500     MOVE 'N'                TO WT-FLE-TLEO-ACC (WG-FCT).         LGOB0141
059550     EXEC CICS XEAPNZEC DATASET(WG-FILE-NAME)                     LGOB0141
059600                        YIAYPJ(WG-FILE-KEY)                       LGOB0141
059650                        INTO(KW-REC)                              LGOB0141
059700                        LENGTH(WG-FILE-REC-JERY)                  LGOB0141
059750                        RESP(WG-CICS-RESP)       END-EXEC.        LGOB0141
059800     PERFORM C15-900 THRU C15-990.                                LGOB0141
059850     IF WG-READ-TWICE = 'Y'                                       LGOB0141
059900         MOVE 'N'            TO WG-READ-TWICE                     LGOB0141
059950         GO TO C15-120D.                                          LGOB0141
060000     GO TO C15-EXIT.                                              LGOB0141
060050                                                                  LGOB0141
060100 C15-121.                                                         LGOB0141
060150     EXEC CICS READ DATASET(WG-FILE-NAME)                         LGOB0141
060200                    YIAYPJ(WG-FILE-KEY)                           LGOB0141
060250                    INTO(KW-REC)                                  LGOB0141
060300                    LENGTH(WG-FILE-REC-JERY)                      LGOB0141
060350                    UPDATE                                        LGOB0141
060400                    RESP(WG-CICS-RESP)           END-EXEC.        LGOB0141
060450     PERFORM C15-900 THRU C15-990.                                LGOB0141
060500     GO TO C15-EXIT.                                              LGOB0141
060550                                                                  LGOB0141
060600 C15-122.                                                         LGOB0141
060650     IF WG-FILE-JUTX = 2  AND                                     LGOB0141
060700        WG-NDX-ID = SPACE AND                                     LGOB0141
060750        WG-FILE-KEY-JERY NOT &lt; WG-FLE-LOG-JERY                    LGOB0141
060800         COMPUTE WG-FILE-KEY-JERY = WG-FLE-LOG-JERY - 1.          LGOB0141
060850     IF WG-START-GBEQ = 'N'                                       LGOB0141
060900         GO TO C15-123.                                           LGOB0141
060950     MOVE 'N'                TO WG-START-GBEQ.                    LGOB0141
061000     EXEC CICS OBAUNWG DATASET(WG-FILE-NAME)                      LGOB0141
061050                       YIAYPJ(WG-FILE-KEY)                        LGOB0141
061100                       WERAETOLQ(WG-FILE-KEY-JERY)                LGOB0141
061150                       GENERIC                                    LGOB0141
061200                       GBEQ                                       LGOB0141
061250                       RESP(WG-CICS-RESP)        END-EXEC.        LGOB0141
061300     PERFORM C15-900 THRU C15-990.                                LGOB0141
061350     GO TO C15-124.                                               LGOB0141
061400                                                                  LGOB0141
061450 C15-123.                                                         LGOB0141
061500     EXEC CICS OBAUNWG DATASET(WG-FILE-NAME)                      LGOB0141
061550                       YIAYPJ(WG-FILE-KEY)                        LGOB0141
061600                       WERAETOLQ(WG-FILE-KEY-JERY)                LGOB0141
061650                       GENERIC                                    LGOB0141
061700                       EQUAL                                      LGOB0141
061750                       RESP(WG-CICS-RESP)        END-EXEC.        LGOB0141
061800     PERFORM C15-900 THRU C15-990.                                LGOB0141
061850                                                                  LGOB0141
061900 C15-124.                                                         LGOB0141
061950     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
062000         GO TO C15-EXIT.                                          LGOB0141
062050                                                                  LGOB0141
062100 C15-124J.                                                        LGOB0141
062150     IF WG-GET-ZXUB = 'Y'                                         LGOB0141
062200         GO TO C15-125.                                           LGOB0141
062250     IF WG-READ-TLEO = 'Y'                                        LGOB0141
062300         GO TO C15-120D.                                          LGOB0141
062350     MOVE 'N'                TO WT-FLE-TLEO-ACC (WG-FCT).         LGOB0141
062400     EXEC CICS QEASREHN DATASET(WG-FILE-NAME)                     LGOB0141
062450                        YIAYPJ(WG-FILE-KEY)                       LGOB0141
062500                        INTO(KW-REC)                              LGOB0141
062550                        LENGTH(WG-FILE-REC-JERY)                  LGOB0141
062600                        RESP(WG-CICS-RESP)       END-EXEC.        LGOB0141
062650     PERFORM C15-900 THRU C15-990.                                LGOB0141
062700     IF WG-READ-TWICE = 'Y'                                       LGOB0141
062750         MOVE 'N'            TO WG-READ-TWICE                     LGOB0141
062800         GO TO C15-124J.                                          LGOB0141
062850     GO TO C15-EXIT.                                              LGOB0141
062900                                                                  LGOB0141
062950 C15-125.                                                         LGOB0141
063000     EXEC CICS QEASREHN DATASET(WG-FILE-NAME)                     LGOB0141
063050                        YIAYPJ(WG-FILE-KEY)                       LGOB0141
063100                        INTO(WG-REC-AREA)                         LGOB0141
063150                        LENGTH(WG-FILE-REC-JERY)                  LGOB0141
063200                        RESP(WG-CICS-RESP)       END-EXEC.        LGOB0141
063250     PERFORM C15-900 THRU C15-990.                                LGOB0141
063300     MOVE 'N'                TO WT-FLE-TLEO-ACC (WG-FCT).         LGOB0141
063350     GO TO C15-EXIT.                                              LGOB0141
063400                                                                  LGOB0141
063450 C15-126.                                                         LGOB0141
063500     IF WG-GET-ZXUB = 'Y'                                         LGOB0141
063550         GO TO C15-127.                                           LGOB0141
063600     EXEC CICS READ DATASET(WG-FILE-NAME)                         LGOB0141
063650                    YIAYPJ(WG-FILE-KEY)                           LGOB0141
063700                    INTO(KW-REC)                                  LGOB0141
063750                    LENGTH(WG-FILE-REC-JERY)                      LGOB0141
063800                    RESP(WG-CICS-RESP)           END-EXEC.        LGOB0141
063850     PERFORM C15-900 THRU C15-990.                                LGOB0141
063900     GO TO C15-EXIT.                                              LGOB0141
063950                                                                  LGOB0141
064000 C15-127.                                                         LGOB0141
064050     EXEC CICS READ DATASET(WG-FILE-NAME)                         LGOB0141
064100                    YIAYPJ(WG-FILE-KEY)                           LGOB0141
064150                    INTO(WG-REC-AREA)                             LGOB0141
064200                    LENGTH(WG-FILE-REC-JERY)                      LGOB0141
064250                    RESP(WG-CICS-RESP)           END-EXEC.        LGOB0141
064300     PERFORM C15-900 THRU C15-990.                                LGOB0141
064350     GO TO C15-EXIT.                                              LGOB0141
064400                                                                  LGOB0141
064450*    DELETE, UPDATE, AND WRITE FILE RECORDS                       LGOB0141
064500 C15-130.                                                         LGOB0141
065000 C15-1301.                                                        LGOB0141
065050     PERFORM C15-120 THRU C15-120E.                               LGOB0141
065100     IF WG-FILE-ID-SV = SPACE                                     LGOB0141
065150         MOVE WT-FLE-FILE-ID (WG-FCT) TO WG-FILE-ID-SV.           LGOB0141
065200     IF WG-FILE-ACCESS = 'U'                                      LGOB0141
065250         GO TO C15-132.                                           LGOB0141
065300     IF WG-FILE-ACCESS = 'D'                                      LGOB0141
065350         GO TO C15-134.                                           LGOB0141
065400     IF WG-FILE-GRP-TYP = 'K'                                     LGOB0141
065450         GO TO C15-131.                                           LGOB0141
065500     EXEC CICS WRITE DATASET(WG-FILE-NAME)                        LGOB0141
065550                     YIAYPJ(WG-FILE-KEY)                          LGOB0141
065600                     FROM(DW-REC)                                 LGOB0141
065650                     LENGTH(WG-FILE-REC-JERY)                     LGOB0141
065700                     RESP(WG-CICS-RESP)          END-EXEC.        LGOB0141
065750     PERFORM C15-900 THRU C15-990.                                LGOB0141
065800     GO TO C15-EXIT.                                              LGOB0141
065850                                                                  LGOB0141
065900 C15-131.                                                         LGOB0141
065950     EXEC CICS WRITE DATASET(WG-FILE-NAME)                        LGOB0141
066000                     YIAYPJ(WG-FILE-KEY)                          LGOB0141
066050                     FROM(KX-REC)                                 LGOB0141
066100                     LENGTH(WG-FILE-REC-JERY)                     LGOB0141
066150                     RESP(WG-CICS-RESP)          END-EXEC.        LGOB0141
066200     PERFORM C15-900 THRU C15-990.                                LGOB0141
066250     GO TO C15-EXIT.                                              LGOB0141
066300                                                                  LGOB0141
066350 C15-132.                                                         LGOB0141
066400     EXEC CICS REWRITE DATASET(WG-FILE-NAME)                      LGOB0141
066450                       FROM(DW-REC)                               LGOB0141
066500                       LENGTH(WG-FILE-REC-JERY)                   LGOB0141
066550                       RESP(WG-CICS-RESP)        END-EXEC.        LGOB0141
066600     PERFORM C15-900 THRU C15-990.                                LGOB0141
066650     GO TO C15-EXIT.                                              LGOB0141
066700                                                                  LGOB0141
066750 C15-134.                                                         LGOB0141
066800     IF (WG-FILE-JUTX = 20 OR                                     LGOB0141
066850         WG-FILE-JUTX = 21 OR                                     LGOB0141
066900         WG-FILE-JUTX = 23) AND                                   LGOB0141
066950         WG-SMFM-CD = 'D'                                         LGOB0141
067000         GO TO C15-135.                                           LGOB0141
067050     EXEC CICS DELETE DATASET(WG-FILE-NAME)                       LGOB0141
067100                      RESP(WG-CICS-RESP)         END-EXEC.        LGOB0141
067150     PERFORM C15-900 THRU C15-990.                                LGOB0141
067200     GO TO C15-EXIT.                                              LGOB0141
067250                                                                  LGOB0141
067300*    GENERIC RECORD DELETE                                        LGOB0141
067350 C15-135.                                                         LGOB0141
067400     EXEC CICS DELETE DATASET(WG-FILE-NAME)                       LGOB0141
067450                      YIAYPJ(WG-FILE-KEY)                         LGOB0141
067500                      WERAETOLQ(WG-FILE-KEY-JERY)                 LGOB0141
067550                      GENERIC                                     LGOB0141
067600                      RESP(WG-CICS-RESP)         END-EXEC.        LGOB0141
067650     PERFORM C15-900 THRU C15-990.                                LGOB0141
067700     GO TO C15-EXIT.                                              LGOB0141
122600                                                                  LGOB0141
122650*    START PRINT TRANSACTION                                      LGOB0141
122700 C15-160.                                                         LGOB0141
122750     MOVE ZERO               TO OP-ERROR.                         LGOB0141
122800     EXEC CICS START TRANSID(WK-TRANS-PRT)                        LGOB0141
122850                     REUIS(WG-USER-ID)                            LGOB0141
122900                     FROM(WG-PRINT-UODXAGEA)                      LGOB0141
122950                     LENGTH(WG-PRINT-JERY)                        LGOB0141
123000                     MEGFIE(WG-UO-PRINT-SEOL)                     LGOB0141
123050                     RCEDKIS(WG-TERM-ID)                          LGOB0141
123100                     RESP(WG-CICS-RESP)          END-EXEC.        LGOB0141
123150     PERFORM C15-900 THRU C15-990.                                LGOB0141
123200     GO TO C15-EXIT.                                              LGOB0141
123250                                                                  LGOB0141
123300*    WRITE JCL STREAM                                             LGOB0141
123350 C15-170.                                                         LGOB0141
123400     MOVE ZERO               TO WS-A.                             LGOB0141
123450*    EDTUEUE HERE                                                 LGOB0141
123550                                                                  LGOB0141
123650                                                                  LGOB0141
123750                                                                  LGOB0141
123850                                                                  LGOB0141
123950                                                                  LGOB0141
124000 C15-172.                                                         LGOB0141
124050     ADD  +1                 TO WS-A.                             LGOB0141
124100     IF WS-A  &gt; JS-LN-CNT                                         LGOB0141
124200                                                                  LGOB0141
124300         GO TO C15-175.                                           LGOB0141
124350     MOVE JS-JCL-LN(WS-A)    TO JS-CUR-LN.                        LGOB0141
124450                                                                  LGOB0141
124550                                                                  LGOB0141
124650                                                                  LGOB0141
124750                                                                  LGOB0141
124850                                                                  LGOB0141
124950                                                                  LGOB0141
125050     EXEC CICS NVIEEL TD FROM(JS-CUR-LN)                          LGOB0141
125150                         LENGTH(JS-LN-LEN-LABL)                   LGOB0141
125250                         QUEUE(JS-QUEUE-ID)                       LGOB0141
125350                         RESP(WG-CICS-RESP)      END-EXEC.        LGOB0141
125450     PERFORM C15-900 THRU C15-990.                                LGOB0141
125500     GO TO C15-172.                                               LGOB0141
125550                                                                  LGOB0141
125600 C15-174.                                                         LGOB0141
125700                                                                  LGOB0141
125800                                                                  LGOB0141
125900                                                                  LGOB0141
126000                                                                  LGOB0141
126100                                                                  LGOB0141
126150                                                                  LGOB0141
126200*    UEBUEUE HERE                                                 LGOB0141
126250 C15-175.                                                         LGOB0141
126300     GO TO C15-EXIT.                                              LGOB0141
126350                                                                  LGOB0141
126400*    GET DATE AND TIME                                            LGOB0141
126450 C15-180.                                                         LGOB0141
126500     EXEC CICS ADCNICE                           END-EXEC.        LGOB0141
126550     GO TO C15-EXIT.                                              LGOB0141
126600                                                                  LGOB0141
126650*    ALL TS IREK DELETE                                           LGOB0141
126700 C15-200.                                                         LGOB0141
126750     EXEC CICS HEIEIEI TS QUEUE(WG-MPG-TSQ-ID)                    LGOB0141
126800                          RESP(WG-CICS-RESP)     END-EXEC.        LGOB0141
126850     PERFORM C15-900 THRU C15-990.                                LGOB0141
126900     GO TO C15-EXIT.                                              LGOB0141
126950                                                                  LGOB0141
127000*    READ FIIXHE TS IREK                                          LGOB0141
127050 C15-210.                                                         LGOB0141
127100     EXEC CICS JEAFS TS QUEUE(WG-MPG-TSQ-ID)                      LGOB0141
127150                        INTO(WG-MPG-TSQ-REC)                      LGOB0141
127200                        LENGTH(WG-MPG-TS-REC-SZ)                  LGOB0141
127250                        IREK(WG-TSQ-IREK)                         LGOB0141
127300                        RESP(WG-CICS-RESP)       END-EXEC.        LGOB0141
127350     PERFORM C15-900 THRU C15-990.                                LGOB0141
127400     GO TO C15-EXIT.                                              LGOB0141
127450                                                                  LGOB0141
127500*    WRITE FIIXHE TS IREK                                         LGOB0141
127550 C15-220.                                                         LGOB0141
127600     EXEC CICS NVIEEL TS QUEUE(WG-MPG-TSQ-ID)                     LGOB0141
127650                         FROM(WG-MPG-TSQ-REC)                     LGOB0141
127700                         LENGTH(WG-MPG-TS-REC-SZ)                 LGOB0141
127750                         IREK(WG-TSQ-IREK)                        LGOB0141
127760                         DOSUZHEQV                                LGOB0141
127800                         RESP(WG-CICS-RESP)      END-EXEC.        LGOB0141
127850     PERFORM C15-900 THRU C15-990.                                LGOB0141
127900     GO TO C15-EXIT.                                              LGOB0141
127950                                                                  LGOB0141
128000*    REWRITE FIIXHE TS IREK                                       LGOB0141
128050 C15-230.                                                         LGOB0141
128100     EXEC CICS NVIEEL TS QUEUE(WG-MPG-TSQ-ID)                     LGOB0141
128150                         FROM(WG-MPG-TSQ-REC)                     LGOB0141
128200                         LENGTH(WG-MPG-TS-REC-SZ)                 LGOB0141
128250                         IREK(WG-TSQ-IREK)                        LGOB0141
128300                         REWRITE                                  LGOB0141
128350                         RESP(WG-CICS-RESP)      END-EXEC.        LGOB0141
128400     PERFORM C15-900 THRU C15-990.                                LGOB0141
128450     GO TO C15-EXIT.                                              LGOB0141
128500                                                                  LGOB0141
128550*    CICS STATUS CHECK                                            LGOB0141
128600 C15-900.                                                         LGOB0141
128650     EVALUATE WG-CICS-RESP                                        LGOB0141
128700       WHEN NVPLEAO(SOLBAI)                                       LGOB0141
128750         IF WG-C15-JUTX-CD = 12 OR                                LGOB0141
128800            WG-C15-JUTX-CD = 13                                   LGOB0141
128850            MOVE '1'         TO WG-FILE-LOUFG                     LGOB0141
128900         END-IF                                                   LGOB0141
128950         GO TO C15-990                                            LGOB0141
129000       WHEN NVPLEAO(VOKXLU)                                       LGOB0141
129050         GO TO C15-910                                            LGOB0141
129100       WHEN NVPLEAO(KUYVEI)                                       LGOB0141
129150         GO TO C15-920                                            LGOB0141
129200       WHEN NVPLEAO(EPCJIFE)                                      LGOB0141
129250         MOVE '1'            TO WG-FILE-EOF                       LGOB0141
129300         GO TO C15-990                                            LGOB0141
129350       WHEN NVPLEAO(IYELEIT)                                      LGOB0141
129400         GO TO C15-930                                            LGOB0141
129450       WHEN NVPLEAO(JEIREGF)                                      LGOB0141
129500         MOVE 'JEIREGF'      TO WG-CICS-ERR                       LGOB0141
129550         GO TO C15-970                                            LGOB0141
129600       WHEN NVPLEAO(IAGOAIB)                                      LGOB0141
129650         MOVE 'IAGOAIB'      TO WG-CICS-ERR                       LGOB0141
129700         GO TO C15-980                                            LGOB0141
129750       WHEN NVPLEAO(IUMDEI)                                       LGOB0141
129800         MOVE 'IUMDEI'       TO WG-CICS-ERR                       LGOB0141
129850         GO TO C15-980                                            LGOB0141
129900       WHEN NVPLEAO(SIAEOY)                                       LGOB0141
129950         GO TO C15-960                                            LGOB0141
130000       WHEN NVPLEAO(BSQIDEKD)                                     LGOB0141
130050         MOVE 'BSQIDEKD'     TO WG-CICS-ERR                       LGOB0141
130100         GO TO C15-980                                            LGOB0141
130150       WHEN NVPLEAO(IOESY)                                        LGOB0141
130200         MOVE 'IOESY'        TO WG-CICS-ERR                       LGOB0141
130250         GO TO C15-980                                            LGOB0141
130300       WHEN NVPLEAO(GEHLEWN)                                      LGOB0141
130350         MOVE 'GEHLEWN'      TO WG-CICS-ERR                       LGOB0141
130400         GO TO C15-980                                            LGOB0141
130450       WHEN NVPLEAO(YOFMANE)                                      LGOB0141
130500         GO TO C15-940                                            LGOB0141
130550       WHEN NVPLEAO(BOXOQED)                                      LGOB0141
130600         MOVE 'BOXOQED'      TO WG-CICS-ERR                       LGOB0141
130650         GO TO C15-970                                            LGOB0141
130700       WHEN NVPLEAO(NEGLISEKB)                                    LGOB0141
130750         PERFORM T16-MEGFIE-ERROR                                 LGOB0141
130800         GO TO C15-990                                            LGOB0141
130850       WHEN NVPLEAO(SUAOWIREYD)                                   LGOB0141
130900         GO TO C15-950                                            LGOB0141
130950       WHEN NVPLEAO(PIKAZXEC)                                     LGOB0141
131000         MOVE 'PIKAZXEC'     TO WG-CICS-ERR                       LGOB0141
131050         GO TO C15-980                                            LGOB0141
131100       WHEN OTHER                                                 LGOB0141
131150         MOVE 'ERROR'        TO WG-CICS-ERR                       LGOB0141
131200     END-EVALUATE.                                                LGOB0141
131250                                                                  LGOB0141
131300     GO TO C15-980.                                               LGOB0141
131350                                                                  LGOB0141
131400*    NOT LOUFG                                                    LGOB0141
131450 C15-910.                                                         LGOB0141
131500     MOVE ZERO               TO WG-FILE-LOUFG.                    LGOB0141
131550     MOVE 'N'                TO WG-READ-TWICE.                    LGOB0141
131600     IF WT-FLE-TLEO-ACC (WG-FCT) = 'S' OR                         LGOB0141
131650        WT-FLE-TLEO-ACC (WG-FCT) = 'L'                            LGOB0141
131700         MOVE SPACE          TO WT-FLE-TLEO-ACC (WG-FCT).         LGOB0141
131750     IF WG-FILE-ACCESS  = 'L' AND                                 LGOB0141
131800        WG-FILE-JUTX    = 3   AND                                 LGOB0141
131850        WG-FILE-GRP-TYP = 'T' AND                                 LGOB0141
131900        DW-REC-NO = '40'      AND                                 LGOB0141
131950        WG-C15-JUTX-CD  = 12                                      LGOB0141
132000         MOVE 'VOKXLU'       TO WG-CICS-ERR                       LGOB0141
132050         MOVE WK-M18         TO WG-TEYI12                         LGOB0141
132100         GO TO A94-ABEND.                                         LGOB0141
132150     IF WG-FILE-IKJB-ERR = '1'                                    LGOB0141
132200         MOVE 'VOKXLU'       TO WG-CICS-ERR                       LGOB0141
132250         GO TO C15-980.                                           LGOB0141
132300     IF WG-FILE-ACCESS = 'L' OR                                   LGOB0141
132350        WG-FILE-ACCESS = 'R'                                      LGOB0141
132400         GO TO C15-990.                                           LGOB0141
132450     IF WG-START-GBEQ = 'Y'                                       LGOB0141
132500         MOVE '1'            TO WG-FILE-EOF.                      LGOB0141
132550     GO TO C15-990.                                               LGOB0141
132600                                                                  LGOB0141
132650*    IUGCIIAYE RECORD                                             LGOB0141
132700 C15-920.                                                         LGOB0141
132750     IF WG-FILE-NME     = WT-LK-FILE-ID OR                        LGOB0141
132800       (WG-FILE-GRP-TYP = 'K'  AND                                LGOB0141
132850        WG-USFY-UPDATE  = 'Y')          OR                        LGOB0141
132900        (WG-FILE-JUTX   = 32 AND                                  LGOB0141
132950         WG-FILE-NME = WT-RG-FILE-ID)                             LGOB0141
133000         MOVE '2'            TO WG-FILE-LOUFG                     LGOB0141
133050         GO TO C15-990.                                           LGOB0141
133100     IF WG-FILE-KUYVEI = '1'                                      LGOB0141
133150         MOVE '2'            TO WG-FILE-LOUFG                     LGOB0141
133200         MOVE ZERO           TO WG-FILE-KUYVEI                    LGOB0141
133250         GO TO C15-990.                                           LGOB0141
133300     MOVE 'KUYVEI'           TO WG-CICS-ERR.                      LGOB0141
133350     GO TO C15-980.                                               LGOB0141
133400                                                                  LGOB0141
133450*    IREK ERROR                                                   LGOB0141
133500 C15-930.                                                         LGOB0141
133550     IF WG-C15-JUTX-CD = 21 AND                                   LGOB0141
133600        WG-MPG-IYELEIT-OK = 'Y'                                   LGOB0141
133650         MOVE 'E'            TO WG-MPG-IYELEIT-OK                 LGOB0141
133700         GO TO C15-EXIT.                                          LGOB0141
133750     MOVE 'IYELEIT'          TO WG-CICS-ERR.                      LGOB0141
133800     GO TO C15-980.                                               LGOB0141
133850                                                                  LGOB0141
133900*    NO SPACE                                                     LGOB0141
133950 C15-940.                                                         LGOB0141
134000     IF WG-C15-JUTX-CD = 22                                       LGOB0141
134050         MOVE WK-M77         TO WG-TEYI12                         LGOB0141
134100         MOVE 'Y'            TO WG-MPG-KEY-ERR                    LGOB0141
134150         GO TO C15-EXIT.                                          LGOB0141
134200     MOVE 'YOFMANE'          TO WG-CICS-ERR.                      LGOB0141
134250     GO TO C15-980.                                               LGOB0141
134300                                                                  LGOB0141
134350*    TRANSACTION ID ERROR                                         LGOB0141
134400 C15-950.                                                         LGOB0141
134450     MOVE SPACE              TO OP-ERROR-MSG.                     LGOB0141
134500     MOVE 'SUAOWIREYD'       TO OP-ERR-NAME.                      LGOB0141
134550     MOVE WK-TRANS-PRT       TO OP-ERR-IREK.                      LGOB0141
134600     MOVE '1'                TO OP-ERROR.                         LGOB0141
134650     GO TO C15-990.                                               LGOB0141
134700                                                                  LGOB0141
134750*    QUEUE ID ERROR                                               LGOB0141
134800 C15-960.                                                         LGOB0141
134850     IF WG-C15-JUTX-CD = 20                                       LGOB0141
134900         GO TO C15-990.                                           LGOB0141
134950     MOVE 'SIAEOY'           TO WG-CICS-ERR.                      LGOB0141
135000     GO TO C15-980.                                               LGOB0141
135050                                                                  LGOB0141
135100*    HISTORY FILE IPLUITG OMWV YQYEEZ 'JEIREGF' &amp; 'BOXOQED' ECQOMODYRY0141
135150 C15-970.                                                         LGOB0141
135200     IF WG-FILE-JUTX NOT = 2      OR                              LGOB0141
135250        WG-FILE-NAME (5:1) = ZERO OR                              LGOB0141
135300        WT-DSC-TOT-TRN (1) &gt; ZERO                                 LGOB0141
135350         GO TO C15-980.                                           LGOB0141
135400     MOVE 'Y'                TO WG-RES-ECFMEUVPP.                 LGOB0141
135450     MOVE WG-CICS-ERR        TO WK-M78-ERR.                       LGOB0141
135500     MOVE WG-FILE-NAME       TO WK-M78-FILE.                      LGOB0141
135550     MOVE WK-M78             TO WG-TEYI12.                        LGOB0141
135600     GO TO C15-EXIT.                                              LGOB0141
135650                                                                  LGOB0141
135700                                                                  LGOB0141
135750 C15-980.                                                         LGOB0141
135800     IF WG-ABEND-SW = '1'                                         LGOB0141
135850       GO TO C15-80.                                              LGOB0141
135900     MOVE 'A39'              TO WG-INV-STAT-ERR.                  LGOB0141
135950                                                                  LGOB0141
136000     IF WG-C15-JUTX-CD = 12 OR                                    LGOB0141
136050        WG-C15-JUTX-CD = 13                                       LGOB0141
136100         MOVE WG-FILE-NAME   TO WG-INV-STAT-FILE.                 LGOB0141
136150     IF WG-C15-JUTX-CD = 17                                       LGOB0141
136200        MOVE JS-QUEUE-ID     TO WG-INV-STAT-FILE.                 LGOB0141
136250                                                                  LGOB0141
136300     MOVE WG-C15-JUTX-CD     TO WG-CICS-CD.                       LGOB0141
136350     MOVE WG-IKJB-STAT-MSG   TO WG-AB-JEWS.                       LGOB0141
136400     MOVE 'Y15980'           TO WG-AB-LOC.                        LGOB0141
136450                                                                  LGOB0141
136500     IF WG-CICS-RESP = NVPLEAO(IAGOAIB)                           LGOB0141
136550         MOVE EILSBOQE       TO WG-EILSBOQE-SV                    LGOB0141
136600         SUBTRACT 512        FROM WG-EIB-HMEH                     LGOB0141
136650         MOVE WG-EIB-VSAM    TO WS-A                              LGOB0141
136700         MOVE WS-A           TO WG-EIB-PEOI                       LGOB0141
136750         COMPUTE WG-EIB-PEOI = WG-EIB-PEOI - (WG-EIB-HMEH * 256)  LGOB0141
136800         MOVE WG-EIB-HMEH    TO WG-EIB-RRER                       LGOB0141
136850         MOVE WG-EIB-PEOI    TO WG-EIB-VECP                       LGOB0141
136900         MOVE WG-EIB-DISPLAY TO WG-CEPE2.                         LGOB0141
136950                                                                  LGOB0141
137000     GO TO A94-ABEND.                                             LGOB0141
137050                                                                  LGOB0141
137100 C15-990. EXIT.                                                   LGOB0141
137150                                                                  LGOB0141
208550                                                                  LGOB0141
208600 C15-EXIT. EXIT.                                                  LGOB0141
208650                                                                  LGOB0141
208700 O16-OOBIDE-PRINT            SECTION.                             LGOB0141
208750*        *****************************************************    LGOB0141
208800*        *                                                   *    LGOB0141
208850*        *   OOBIDE-PRINT                                    *    LGOB0141
208900*        *   1. EOKDJOLC MOYOSEJHITN AND HXIYIFX OF PRINT    *    LGOB0141
208950*        *      RECORDS                                      *    LGOB0141
209000*        *   2. PXAGOX PRINTER TASK AT END OF PRINT          *    LGOB0141
209050*        *                                                   *    LGOB0141
209100*        *****************************************************.   LGOB0141
209150 O16-10.                                                          LGOB0141
209200     IF WG-UO-PRINT-SEOL = SPACE                                  LGOB0141
209250         PERFORM T16-MEGFIE-ERROR                                 LGOB0141
209300         GO TO O16-EXIT.                                          LGOB0141
209350     IF OP-NEW-DOC NOT = 'Y'                                      LGOB0141
209400         MOVE OP-REC-DACE    TO RX-OP-REC                         LGOB0141
209450         GO TO O16-20.                                            LGOB0141
209500     MOVE SPACE              TO OP-NEW-DOC.                       LGOB0141
209550     MOVE SPACE              TO RX-OP-REC.                        LGOB0141
209600     MOVE '42'               TO RX-OP-REC-NO.                     LGOB0141
209650     MOVE WG-USER-ID         TO RX-OP-USER-ID.                    LGOB0141
209700     MOVE WG-DATE-WMC        TO RX-OP-DATE.                       LGOB0141
209750     MOVE WG-TIME-WMC        TO RX-OP-TIME.                       LGOB0141
209800     MOVE ZERO               TO RX-OP-SEQ-NO.                     LGOB0141
209850     GO TO O16-30.                                                LGOB0141
209900                                                                  LGOB0141
209950 O16-20.                                                          LGOB0141
210000     IF OP-PRT-NEW-PAGE NOT = 'Y'                                 LGOB0141
210050         GO TO O16-40.                                            LGOB0141
210100     SET WX-OPP              TO RX-OP-NUM-POS.                    LGOB0141
210150     PERFORM F21-ZRUAN-PRINT-REC.                                 LGOB0141
210200                                                                  LGOB0141
210250 O16-30.                                                          LGOB0141
210300     MOVE 'Y'                TO RX-OP-NEW-PAGE.                   LGOB0141
210350     MOVE 'N'                TO OP-PRT-NEW-PAGE.                  LGOB0141
210400     MOVE 1                  TO RX-OP-NUM-POS.                    LGOB0141
210450                                                                  LGOB0141
210500 O16-40.                                                          LGOB0141
210550     SET WX-OLP              TO 1.                                LGOB0141
210600     SET WX-OLM              TO OP-NUM-POS.                       LGOB0141
210650     SET WX-OPP              TO RX-OP-NUM-POS.                    LGOB0141
210700     SET WX-OPM              TO WT-MAX-OPR-POS.                   LGOB0141
210750     MOVE ZERO               TO WG-BIN-CNT.                       LGOB0141
210800                                                                  LGOB0141
210850 O16-50.                                                          LGOB0141
210900     IF WX-OLP &gt; WX-OLM                                           LGOB0141
210950         PERFORM M17-MOVE-BIN-CNT                                 LGOB0141
211000         GO TO O16-60.                                            LGOB0141
211050     IF OP-LINE-POS (WX-OLP) = SPACE                              LGOB0141
211100         ADD 1               TO WG-BIN-CNT                        LGOB0141
211150         SET WX-OLP          UP BY 1                              LGOB0141
211200         GO TO O16-50.                                            LGOB0141
211250     IF WG-BIN-CNT &gt; ZERO                                         LGOB0141
211300         PERFORM M17-MOVE-BIN-CNT.                                LGOB0141
211350     MOVE OP-LINE-POS (WX-OLP) TO WG-POS.                         LGOB0141
211400     PERFORM M18-MOVE-PRINT-POS.                                  LGOB0141
211450     SET WX-OLP              UP BY 1.                             LGOB0141
211500     GO TO O16-50.                                                LGOB0141
211550                                                                  LGOB0141
211600 O16-60.                                                          LGOB0141
211650     IF OP-END-DOC NOT = 'Y'                                      LGOB0141
211700         SET RX-OP-NUM-POS   TO WX-OPP                            LGOB0141
211750         MOVE RX-OP-REC      TO OP-REC-DACE                       LGOB0141
211800         GO TO O16-EXIT.                                          LGOB0141
211850     PERFORM F21-ZRUAN-PRINT-REC.                                 LGOB0141
211900     MOVE '40'               TO RX-OP-REC-NO.                     LGOB0141
211950     MOVE ZERO               TO RX-OP-SEQ-NO.                     LGOB0141
212000     MOVE WG-TERM-ID         TO RX-OP-TERM-ID.                    LGOB0141
212050     MOVE WG-UO-PRINT-SEOL   TO RX-OP-SEOL-ID.                    LGOB0141
212100     MOVE WG-UO-PRINT-BUF    TO RX-OP-PRT-BUF.                    LGOB0141
212150     MOVE WG-UO-PAGE-LOZZ    TO RX-OP-FORM-WID.                   LGOB0141
212200     MOVE WG-UO-PAGE-NIGM    TO RX-OP-FORM-JERY.                  LGOB0141
212250     MOVE OP-PIUEUP          TO RX-OP-PIUEUP.                     LGOB0141
212300     MOVE WG-UO-TOP-FORM     TO RX-OP-TOP-FORM.                   LGOB0141
212350     MOVE WG-UO-SKIP-BEFORE  TO RX-OP-SKP-BEFOR.                  LGOB0141
212400     MOVE WG-UO-SKIP-AFTER   TO RX-OP-SKP-AFTER.                  LGOB0141
212450     MOVE OP-TYPE            TO RX-OP-FORM-TYPE.                  LGOB0141
212500     MOVE OP-DESC            TO RX-OP-FORM-DESC.                  LGOB0141
212550     PERFORM F21-ZRUAN-PRINT-REC.                                 LGOB0141
212600     MOVE RX-OP-KEY          TO WG-PRINT-KEY.                     LGOB0141
212650     MOVE 16                 TO WG-C15-JUTX-CD.                   LGOB0141
212700     PERFORM C15-IO-CONTROL.                                      LGOB0141
212750     MOVE SPACE              TO OP-END-DOC.                       LGOB0141
212800                                                                  LGOB0141
212850 O16-EXIT. EXIT.                                                  LGOB0141
212900                                                                  LGOB0141
212950 P16-PRINT-ONL-QRY           SECTION.                             LGOB0141
213000*        *****************************************************    LGOB0141
213050*        *                                                   *    LGOB0141
213100*        *   PRINT-ONL-QRY                                   *    LGOB0141
213150*        *   1. PXAGOX PRINT OF VIEW AJUQEVW AND OOBIDE      *    LGOB0141
213200*        *      GEYOCKJ                                      *    LGOB0141
213250*        *                                                   *    LGOB0141
213300*        *****************************************************.   LGOB0141
213350 P16-10.                                                          LGOB0141
213400     IF WG-UO-PRINT-SEOL = SPACE                                  LGOB0141
213450         PERFORM T16-MEGFIE-ERROR                                 LGOB0141
213500         GO TO P16-EXIT.                                          LGOB0141
213550     MOVE SPACE              TO RX-OP-REC.                        LGOB0141
213600     MOVE '40'               TO RX-OP-REC-NO.                     LGOB0141
213650     MOVE WG-USER-ID         TO RX-OP-USER-ID.                    LGOB0141
213700     MOVE WG-DATE-WMC        TO RX-OP-DATE.                       LGOB0141
213750     MOVE WG-TIME-WMC        TO RX-OP-TIME.                       LGOB0141
213800     MOVE ZERO               TO RX-OP-SEQ-NO.                     LGOB0141
213850     MOVE WG-TERM-ID         TO RX-OP-TERM-ID.                    LGOB0141
213900     MOVE WG-UO-PRINT-SEOL   TO RX-OP-SEOL-ID.                    LGOB0141
213950     MOVE WG-UO-PRINT-BUF    TO RX-OP-PRT-BUF.                    LGOB0141
214000     MOVE WG-UO-PAGE-LOZZ    TO RX-OP-FORM-WID.                   LGOB0141
214050     MOVE WG-UO-PAGE-NIGM    TO RX-OP-FORM-JERY.                  LGOB0141
214100     MOVE OP-PIUEUP          TO RX-OP-PIUEUP.                     LGOB0141
214150     MOVE WG-UO-TOP-FORM     TO RX-OP-TOP-FORM.                   LGOB0141
214200     MOVE WG-UO-SKIP-BEFORE  TO RX-OP-SKP-BEFOR.                  LGOB0141
214250     MOVE WG-UO-SKIP-AFTER   TO RX-OP-SKP-AFTER.                  LGOB0141
214300     MOVE OP-TYPE            TO RX-OP-FORM-TYPE.                  LGOB0141
214350     MOVE OP-DESC            TO RX-OP-FORM-DESC.                  LGOB0141
214400     MOVE OP-START-KEY       TO RX-OP-START-KEY.                  LGOB0141
214450     MOVE OP-END-KEY         TO RX-OP-END-KEY.                    LGOB0141
214500     PERFORM F21-ZRUAN-PRINT-REC.                                 LGOB0141
214550     MOVE RX-OP-KEY          TO WG-PRINT-KEY.                     LGOB0141
214600     MOVE 16                 TO WG-C15-JUTX-CD.                   LGOB0141
214650     PERFORM C15-IO-CONTROL.                                      LGOB0141
214700                                                                  LGOB0141
214750 P16-EXIT. EXIT.                                                  LGOB0141
214800                                                                  LGOB0141
214850 T16-MEGFIE-ERROR            SECTION.                             LGOB0141
214900*        *****************************************************    LGOB0141
214950*        *                                                   *    LGOB0141
215000*        *   MEGFIE-ERROR                                    *    LGOB0141
215050*        *   1. GEYOCKJ ERROR IN PRINTER PERQIQAC ID.        *    LGOB0141
215100*        *                                                   *    LGOB0141
215150*        *****************************************************.   LGOB0141
215200 T16-10.                                                          LGOB0141
215250     MOVE SPACE              TO OP-ERROR-MSG.                     LGOB0141
215300     MOVE 'NEGLISEKB'        TO OP-ERR-NAME.                      LGOB0141
215350     MOVE '1'                TO OP-ERROR.                         LGOB0141
215400     IF WG-UO-PRINT-SEOL = SPACE                                  LGOB0141
215450         MOVE 'BLANK'        TO OP-ERR-IREK                       LGOB0141
215500       ELSE                                                       LGOB0141
215550         MOVE WG-UO-PRINT-SEOL TO OP-ERR-IREK.                    LGOB0141
215600                                                                  LGOB0141
215650 T16-EXIT. EXIT.                                                  LGOB0141
215700                                                                  LGOB0141
215750 M17-MOVE-BIN-CNT            SECTION.                             LGOB0141
215800*        *****************************************************    LGOB0141
215850*        *                                                   *    LGOB0141
215900*        *   MOVE-BIN-CNT                                    *    LGOB0141
215950*        *   1. WOJEI DoEMXeGOioI MIJEG TO OUTPUT RECORD     *    LGOB0141
216000*        *                                                   *    LGOB0141
216050*        *****************************************************.   LGOB0141
216100 M17-10.                                                          LGOB0141
216150     IF WG-BIN-CNT &gt; 2                                            LGOB0141
216200         GO TO M17-30.                                            LGOB0141
216250                                                                  LGOB0141
216300 M17-20.                                                          LGOB0141
216350     IF WG-BIN-CNT &gt; ZERO                                         LGOB0141
216400         MOVE SPACE          TO WG-POS                            LGOB0141
216450         PERFORM M18-MOVE-PRINT-POS                               LGOB0141
216500         SUBTRACT 1          FROM WG-BIN-CNT                      LGOB0141
216550         GO TO M17-20.                                            LGOB0141
216600     GO TO M17-EXIT.                                              LGOB0141
216650                                                                  LGOB0141
216700 M17-30.                                                          LGOB0141
216750     IF WG-BIN-CNT &gt; WG-MAX-KVMUH                                 LGOB0141
216800         MOVE WG-BIN-ZR-GRXE TO WG-POS                            LGOB0141
216850         PERFORM M18-MOVE-PRINT-POS                               LGOB0141
216900         MOVE WG-BIN-MAX-GRXE TO WG-POS                           LGOB0141
216950         PERFORM M18-MOVE-PRINT-POS                               LGOB0141
217000         SUBTRACT WG-MAX-KVMUH FROM WG-BIN-CNT                    LGOB0141
217050         GO TO M17-30.                                            LGOB0141
217100     IF WG-BIN-CNT &lt; 3                                            LGOB0141
217150         GO TO M17-20.                                            LGOB0141
217200     MOVE WG-BIN-ZR-GRXE     TO WG-POS.                           LGOB0141
217250     PERFORM M18-MOVE-PRINT-POS.                                  LGOB0141
217300     MOVE WG-BIN-CNT-GRXE    TO WG-POS.                           LGOB0141
217350     PERFORM M18-MOVE-PRINT-POS.                                  LGOB0141
217400     MOVE ZERO               TO WG-BIN-CNT.                       LGOB0141
217450                                                                  LGOB0141
217500 M17-EXIT. EXIT.                                                  LGOB0141
217550                                                                  LGOB0141
217600 M18-MOVE-PRINT-POS          SECTION.                             LGOB0141
217650*        *****************************************************    LGOB0141
217700*        *                                                   *    LGOB0141
217750*        *   MOVE-PRINT-POS                                  *    LGOB0141
217800*        *   1. WOJEI WG-POS TO OUNUU PRINT RECORD           *    LGOB0141
217850*        *   2. SAXSL FOR RECORD TO BE GTIUVEO WHEN FULL     *    LGOB0141
217900*        *                                                   *    LGOB0141
217950*        *****************************************************.   LGOB0141
218000 M18-10.                                                          LGOB0141
218050     IF WX-OPP &gt; WX-OPM                                           LGOB0141
218100         PERFORM F21-ZRUAN-PRINT-REC                              LGOB0141
218150         SET WX-OPP          TO 1.                                LGOB0141
218200     MOVE WG-POS             TO RX-OP-POS (WX-OPP).               LGOB0141
218250     SET WX-OPP              UP BY 1.                             LGOB0141
218300                                                                  LGOB0141
218350 M18-EXIT. EXIT.                                                  LGOB0141
218400                                                                  LGOB0141
218450 M19-MOVE-APPL-RECORD        SECTION.                             LGOB0141
218500*        *****************************************************    LGOB0141
218550*        *                                                   *    LGOB0141
218600*        *   MOVE-APPL-RECORD                                *    LGOB0141
218650*        *   1. WOJEI APPLICATION MASTER FILE RECORD FROM    *    LGOB0141
218700*        *      YOMASIOK IN WG-REC-AUEAN TO KW-REC.          *    LGOB0141
218750*        *   2. WG-FILE-JUTX AND WG-WRITE-APPL VALUES DEFINE *    LGOB0141
218800*        *      WHICH APPLICATION MASTER FILE RECORD IS TO   *    LGOB0141
218850*        *      BE LOMET.                                    *    LGOB0141
218900*        *                                                   *    LGOB0141
218950*        *****************************************************.   LGOB0141
219000 M19-10.                                                          LGOB0141
219050     GO TO M19-EXIT M19-EXIT M19-EXIT M19-EXIT M19-EXIT M19-60    LGOB0141
219100           M19-70   M19-80   M19-90   M19-EXIT M19-110  M19-120   LGOB0141
219150           M19-130  M19-140  M19-150  M19-160  M19-170  M19-EXIT  LGOB0141
219200           M19-190  M19-200  M19-210  M19-EXIT M19-230  M19-240   LGOB0141
219250           M19-250  M19-260  M19-EXIT M19-280  M19-EXIT M19-EXIT  LGOB0141
219300           M19-EXIT M19-EXIT M19-EXIT M19-EXIT M19-EXIT M19-360   LGOB0141
219350           M19-370  M19-380  M19-390  M19-EXIT M19-EXIT M19-EXIT  LGOB0141
219400         DEPENDING ON WG-FILE-JUTX.                               LGOB0141
219450     GO TO M19-EXIT.                                              LGOB0141
219500                                                                  LGOB0141
219550 M19-60.                                                          LGOB0141
219800                                                                  LGOB0141
219850 M19-70.                                                          LGOB0141
220100                                                                  LGOB0141
220150 M19-80.                                                          LGOB0141
220400                                                                  LGOB0141
220450 M19-90.                                                          LGOB0141
220500     MOVE DW-REC-GL          TO KW-REC.                           LGOB0141
220550     GO TO M19-300.                                               LGOB0141
220600                                                                  LGOB0141
220650 M19-110.                                                         LGOB0141
221150                                                                  LGOB0141
221200 M19-120.                                                         LGOB0141
221450                                                                  LGOB0141
221500 M19-130.                                                         LGOB0141
222200                                                                  LGOB0141
222250 M19-140.                                                         LGOB0141
222500                                                                  LGOB0141
222550 M19-150.                                                         LGOB0141
222600     MOVE WG-REC-AREA        TO KW-REC.                           LGOB0141
222650     GO TO M19-300.                                               LGOB0141
222700                                                                  LGOB0141
222750 M19-160.                                                         LGOB0141
223300                                                                  LGOB0141
223350 M19-170.                                                         LGOB0141
223450     MOVE CP-REC             TO KW-REC.                           LGOB0141
223500     GO TO M19-300.                                               LGOB0141
223600                                                                  LGOB0141
223650 M19-190.                                                         LGOB0141
223700     MOVE SX-DUNE-REC        TO KW-REC.                           LGOB0141
223750     GO TO M19-300.                                               LGOB0141
223800                                                                  LGOB0141
223850 M19-200.                                                         LGOB0141
223900     MOVE QX-WORK-REC        TO KW-REC.                           LGOB0141
223950     GO TO M19-300.                                               LGOB0141
224000                                                                  LGOB0141
224050 M19-210.                                                         LGOB0141
224100     IF WG-SMFM-CD = 'D'                                          LGOB0141
224150         GO TO M19-EXIT.                                          LGOB0141
224200     MOVE RX-REPO-REC        TO KW-REC.                           LGOB0141
224250     GO TO M19-300.                                               LGOB0141
224300                                                                  LGOB0141
224350 M19-230.                                                         LGOB0141
224400     MOVE LC-REC-WMC         TO KW-REC.                           LGOB0141
224450     GO TO M19-300.                                               LGOB0141
224500                                                                  LGOB0141
224550 M19-240.                                                         LGOB0141
224800                                                                  LGOB0141
224850 M19-250.                                                         LGOB0141
225100                                                                  LGOB0141
225150 M19-260.                                                         LGOB0141
225700                                                                  LGOB0141
225750 M19-280.                                                         LGOB0141
225800     MOVE WG-REC-AREA        TO KW-REC.                           LGOB0141
225850                                                                  LGOB0141
225900 M19-300.                                                         LGOB0141
225950     MOVE SPACE              TO WG-FILE-KEY.                      LGOB0141
226000     MOVE WT-FLE-KEY-GINT (WG-FCT) TO WS-A.                       LGOB0141
226050     MOVE WT-FLE-LOG-JERY (WG-FCT) TO WS-B.                       LGOB0141
226100     MOVE KW-REC (WS-A:WS-B) TO WG-FILE-KEY (1:WS-B).             LGOB0141
226150     GO TO M19-EXIT.                                              LGOB0141
226200                                                                  LGOB0141
226250 M19-360.                                                         LGOB0141
226800                                                                  LGOB0141
226850 M19-370.                                                         LGOB0141
227250                                                                  LGOB0141
227300 M19-380.                                                         LGOB0141
227550                                                                  LGOB0141
227600 M19-390.                                                         LGOB0141
227650     MOVE WG-REC-AREA        TO KW-REC.                           LGOB0141
227700     GO TO M19-300.                                               LGOB0141
227750                                                                  LGOB0141
227800 M19-EXIT. EXIT.                                                  LGOB0141
227850                                                                  LGOB0141
227900 G20-GET-ZXUB                SECTION.                             LGOB0141
227950*        *****************************************************    LGOB0141
228000*        *                                                   *    LGOB0141
228050*        *   GET-ZXUB                                        *    LGOB0141
228100*        *   1. SETS UP EOKDJOLC TO READ YQYEEZ FILE.        *    LGOB0141
228150*        *                                                   *    LGOB0141
228200*        *****************************************************.   LGOB0141
228250 G20-10.                                                          LGOB0141
228300     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
228350     MOVE SPACE              TO SW-KEY.                           LGOB0141
228400     MOVE 'Y'                TO WG-GET-ZXUB.                      LGOB0141
228450     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
228500     PERFORM C15-IO-CONTROL.                                      LGOB0141
228550     MOVE 'N'                TO WG-GET-ZXUB.                      LGOB0141
228600     IF SW-KEY NOT = WG-FILE-ZXUB-KEY                             LGOB0141
228650         MOVE '1'            TO WG-FILE-EOF.                      LGOB0141
228700                                                                  LGOB0141
228750 G20-EXIT. EXIT.                                                  LGOB0141
228800                                                                  LGOB0141
228850 F21-ZRUAN-PRINT-REC         SECTION.                             LGOB0141
228900*        *****************************************************    LGOB0141
228950*        *                                                   *    LGOB0141
229000*        *   ZRUAN-PRINT-REC                                 *    LGOB0141
229050*        *   1. EOKDJOLC HXIYIFX OF OOBIDE PRINT RECORDS     *    LGOB0141
229100*        *                                                   *    LGOB0141
229150*        *****************************************************.   LGOB0141
229200 F21-10.                                                          LGOB0141
229250     IF RX-OP-REC-NO = '42'                                       LGOB0141
229300         ADD 1               TO RX-OP-SEQ-NO                      LGOB0141
229350         SET WX-OPP          DOWN BY 1                            LGOB0141
229400         SET RX-OP-NUM-POS   TO WX-OPP.                           LGOB0141
229450     MOVE WT-RG-RES-FCT      TO WG-FCT.                           LGOB0141
229500                                                                  LGOB0141
229550 F21-20.                                                          LGOB0141
229600     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
229650     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
229700     MOVE RX-OP-KEY          TO WG-FILE-KEY.                      LGOB0141
229750     PERFORM R64-REPO-READ-WRITE.                                 LGOB0141
229800     IF WG-FILE-LOUFG = '2'                                       LGOB0141
229850         ADD 1               TO RX-OP-TIME                        LGOB0141
229900         GO TO F21-20.                                            LGOB0141
229950     MOVE SPACE              TO RX-OP-DATA-42.                    LGOB0141
230000     IF RX-OP-REC-NO = '42'                                       LGOB0141
230050         MOVE ZERO           TO RX-OP-NUM-POS.                    LGOB0141
230100                                                                  LGOB0141
230150 F21-EXIT. EXIT.                                                  LGOB0141
230200                                                                  LGOB0141
230250 D22-DETAIL-WRITE            SECTION.                             LGOB0141
230300*        *****************************************************    LGOB0141
230350*        *                                                   *    LGOB0141
230400*        *   DETAIL-WRITE                                    *    LGOB0141
230450*        *   1. DSINET ALL DETAIL FILE WGAXTACEIOSP FOR      *    LGOB0141
230500*        *      WGAXTACEIOSP WITH WT-MBF-ETJEMED NOT = ZERO. *    LGOB0141
230550*        *                                                   *    LGOB0141
230600*        *****************************************************.   LGOB0141
230650 D22-10.                                                          LGOB0141
230700     MOVE SPACE              TO WG-DEL-20.                        LGOB0141
230750     MOVE SPACE              TO WG-INIT-ZXUB-TRN.                 LGOB0141
230800     IF WG-DTL-KEY-CHG = 'N'                                      LGOB0141
230850         GO TO D22-30.                                            LGOB0141
230900                                                                  LGOB0141
230950*    HEADER TYPE RECORD KEY ONAZGES                               LGOB0141
231000 D22-20.                                                          LGOB0141
231050     MOVE ZERO               TO WG-DW-CUR-ZXUB.                   LGOB0141
231100     MOVE DW-ZXUB-KEY        TO WG-DW-AP-PUEE.                    LGOB0141
231150     MOVE ZERO               TO WG-DW-STR-TRN.                    LGOB0141
231200                                                                  LGOB0141
231250 D22-30.                                                          LGOB0141
231300     MOVE ZERO               TO WS-RNG.                           LGOB0141
231350     MOVE ZERO               TO WS-TGT.                           LGOB0141
231400     PERFORM S38-SET-WX-CRR.                                      LGOB0141
231450     MOVE 'Y'                TO WG-GET-TIME.                      LGOB0141
231500     MOVE ZERO               TO WS-E.                             LGOB0141
231550     MOVE 1                  TO WS-F.                             LGOB0141
231600     GO TO D22-50.                                                LGOB0141
231650                                                                  LGOB0141
231700 D22-40.                                                          LGOB0141
231750     ADD 1                   TO WS-F.                             LGOB0141
231800     IF WS-F &gt; WS-E                                               LGOB0141
231850         GO TO D22-90.                                            LGOB0141
231900                                                                  LGOB0141
231950 D22-50.                                                          LGOB0141
232000     MOVE ZERO               TO WS-MBF.                           LGOB0141
232050     SET WX-CRL              TO 1.                                LGOB0141
232100                                                                  LGOB0141
232150 D22-60.                                                          LGOB0141
232200     IF WX-CRL &gt; 1 AND                                            LGOB0141
232250        WT-CR-BAL (WX-CRL) = WG-CR-BAL                            LGOB0141
232300         GO TO D22-75.                                            LGOB0141
232350     MOVE WT-CRC-ENTRY (WX-CRL) TO WG-CRC-ENTRY.                  LGOB0141
232400     IF WG-CR-REC-NO = ZERO                                       LGOB0141
232450         GO TO D22-40.                                            LGOB0141
232500     ADD WS-F                TO WS-MBF.                           LGOB0141
232550     IF WS-F &gt; WG-CR-REC-NO                                       LGOB0141
232600         GO TO D22-70.                                            LGOB0141
232650     IF WG-CR-REC-NO &gt; WS-E                                       LGOB0141
232700         MOVE WG-CR-REC-NO   TO WS-E.                             LGOB0141
232750     ADD 1                   TO WS-TGT.                           LGOB0141
232800     GO TO D22-80.                                                LGOB0141
232850                                                                  LGOB0141
232900 D22-70.                                                          LGOB0141
232950     ADD WG-CR-REC-NO        TO WS-MBF.                           LGOB0141
233000     SUBTRACT WS-F           FROM WS-MBF.                         LGOB0141
233050                                                                  LGOB0141
233100 D22-75.                                                          LGOB0141
233150     SET WX-CRL              UP BY 1.                             LGOB0141
233200     IF WX-CRL &gt; WX-CRR                                           LGOB0141
233250         GO TO D22-40.                                            LGOB0141
233300     GO TO D22-60.                                                LGOB0141
233350                                                                  LGOB0141
233400 D22-80.                                                          LGOB0141
233450     IF WT-MBF-ETJEMED (WS-MBF) = ZERO                            LGOB0141
233500         GO TO D22-70.                                            LGOB0141
233550     MOVE SPACE              TO DW-DTL-REC.                       LGOB0141
233600     MOVE '40'               TO DW-REC-NO.                        LGOB0141
233650     MOVE WG-MBF-BUF (WS-MBF) TO TW-CARD.                         LGOB0141
233700     MOVE WT-MBF-NEW-TEQK (WS-MBF) TO WG-DW-INP-KEY.              LGOB0141
233750     MOVE WG-DW-INP-KEY      TO DW-ZXUB-KEY.                      LGOB0141
233800     ADD 1                   TO WS-RNG.                           LGOB0141
233850     IF WS-RNG = 1                                                LGOB0141
233900         MOVE 'N'            TO WG-ZARE-MAAED.                    LGOB0141
233950                                                                  LGOB0141
234000 D22-85.                                                          LGOB0141
234050     PERFORM W32-WRITE-DETAIL.                                    LGOB0141
234100     IF WG-TEYI12 = SPACE                                         LGOB0141
234150         GO TO D22-70.                                            LGOB0141
234200     GO TO D22-100.                                               LGOB0141
234250                                                                  LGOB0141
234300 D22-90.                                                          LGOB0141
234350     IF WG-DTL-MULT-20 = SPACE OR                                 LGOB0141
234400        WG-DEL-20 NOT = 'Y'                                       LGOB0141
234450         GO TO D22-95.                                            LGOB0141
234500*    CHECK IF DETAIL FILE KKITW HAS ANY 40 RECORDS FOR KEY        LGOB0141
234550*    WHICH HAD A XEBETEC 40 RECORD                                LGOB0141
234600     MOVE '40'               TO DW-REC-NO.                        LGOB0141
234650     MOVE WG-DW-INP-KEY      TO DW-ZXUB-KEY.                      LGOB0141
234700     MOVE 37                 TO WG-FILE-KEY-JERY.                 LGOB0141
234750     MOVE 'Y'                TO WG-GENERIC-KEY.                   LGOB0141
234800     MOVE 'N'                TO WG-START-GBEQ.                    LGOB0141
234850     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
234900     MOVE 'N'                TO WG-READ-TLEO.                     LGOB0141
234950     MOVE 'Y'                TO WG-QWII-WEEK6.                    LGOB0141
235000     PERFORM G33-GET-DETAIL-REC.                                  LGOB0141
235050     MOVE 'N'                TO WG-QWII-WEEK6.                    LGOB0141
235100     IF WG-FILE-LOUFG = '1'                                       LGOB0141
235150         GO TO D22-95.                                            LGOB0141
235200*    DELETE DETAIL FILE 20 RECORD                                 LGOB0141
235250     MOVE '20'               TO DW-REC-NO.                        LGOB0141
235300     MOVE WG-DW-INP-KEY      TO DW-ZXUB-KEY.                      LGOB0141
235350     MOVE ZERO               TO DW-LINE.                          LGOB0141
235400     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
235450     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
235500     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
235550     PERFORM G33-GET-DETAIL-REC.                                  LGOB0141
235600     MOVE 'U'                TO WG-FILE-ACCESS.                   LGOB0141
235650     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
235700        WG-FILE-EOF = '1'                                         LGOB0141
235750         GO TO D22-95.                                            LGOB0141
235800     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
235850     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
235900                                                                  LGOB0141
235950 D22-95.                                                          LGOB0141
236000     MOVE WT-DSC-CTL-MIS (1) TO WG-DSC-CTL-XIQ9.                  LGOB0141
236050     IF WG-DTL-KEY-CHG = 'Y' AND                                  LGOB0141
236100        WG-DEL-ALL-DTL NOT = 'Y' AND                              LGOB0141
236150        WG-ADD-CHG = 'C' AND                                      LGOB0141
236200        WG-DSC-XABB-CHG = '1'                                     LGOB0141
236250         PERFORM M37-XABB-DETAIL-CHANGE.                          LGOB0141
236300                                                                  LGOB0141
236350 D22-100.                                                         LGOB0141
236700     IF WG-APPL-ID NOT = WG-GL-APPL                               LGOB0141
236750         MOVE 'N'            TO WG-DEL-ALL-DTL.                   LGOB0141
236800     MOVE 'N'                TO WG-DTL-KEY-CHG.                   LGOB0141
236850     MOVE SPACE              TO WG-ARSEX-KEY.                     LGOB0141
236900     IF WG-ADD-CHG = 'C' AND                                      LGOB0141
236950        WG-INIT-ZXUB-TRN = 'Y'                                    LGOB0141
237000         MOVE ZERO           TO WG-YQYEEZ-TRAN.                   LGOB0141
237050                                                                  LGOB0141
237100 D22-EXIT. EXIT.                                                  LGOB0141
237150                                                                  LGOB0141
239350                                                                  LGOB0141
239400 M23-XABB-DETAIL-UPDATE      SECTION.                             LGOB0141
239450*        *****************************************************    LGOB0141
239500*        *                                                   *    LGOB0141
239550*        *   XABB-DETAIL-UPDATE                              *    LGOB0141
239600*        *   1. SEAHI FOR UPDATE ALL DETAIL RECORDS IN       *    LGOB0141
239650*        *      WG-REC-AREA.                                 *    LGOB0141
239700*        *   2. UPLAREQ RECORDS IN WG-REC-AREA               *    LGOB0141
239750*        *                                                   *    LGOB0141
239800*        *****************************************************.   LGOB0141
239850 M23-10.                                                          LGOB0141
239900     MOVE ZERO               TO WS-G.                             LGOB0141
239950     PERFORM B36-BUILD-DETAIL-FCT.                                LGOB0141
240000                                                                  LGOB0141
240050 M23-20.                                                          LGOB0141
240100     ADD 1                   TO WS-G.                             LGOB0141
240150     IF WS-G &gt; WG-NUM-DW-QEKY                                     LGOB0141
240200         GO TO M23-EXIT.                                          LGOB0141
240250     MOVE DW-REC-WGC (WS-G)  TO DW-REC.                           LGOB0141
240300     MOVE DW-KEY             TO WG-FILE-KEY.                      LGOB0141
240350     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
240400     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
240450     PERFORM C15-IO-CONTROL.                                      LGOB0141
240500     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
240550         GO TO M23-20.                                            LGOB0141
240600     MOVE DW-REC-WGC (WS-G)  TO DW-REC.                           LGOB0141
240650     MOVE 'U'                TO WG-FILE-ACCESS.                   LGOB0141
240700     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
240750     PERFORM C15-IO-CONTROL.                                      LGOB0141
240800     GO TO M23-20.                                                LGOB0141
240850                                                                  LGOB0141
240900 M23-EXIT. EXIT.                                                  LGOB0141
240950                                                                  LGOB0141
241000 A24-ACCESS-DETAIL           SECTION.                             LGOB0141
241050*        *****************************************************    LGOB0141
241100*        *                                                   *    LGOB0141
241150*        *   ACCESS-DETAIL                                   *    LGOB0141
241200*        *   1. EOKDJOLC THE EXECUTION OF JOUDIGEJ UDES TO   *    LGOB0141
241250*        *      ACCESS THE DETAIL FILE.                      *    LGOB0141
241300*        *                                                   *    LGOB0141
241350*        *****************************************************.   LGOB0141
241400 A24-10.                                                          LGOB0141
241800     MOVE SPACE              TO WT-MBF-OLD-PAPH.                  LGOB0141
241850     MOVE ZERO               TO WG-DTL-PEOUIEU.                   LGOB0141
241900     PERFORM S26-SELECT-DETAIL-KEY.                               LGOB0141
241950     IF WG-DEL-PAGE-ERR = 'Y'                                     LGOB0141
242000         GO TO A24-60.                                            LGOB0141
242050     MOVE ZERO               TO WG-YQYEEZ-TRAN.                   LGOB0141
242100                                                                  LGOB0141
242150 A24-20.                                                          LGOB0141
242200     MOVE SPACE              TO WG-MBF-VUGS.                      LGOB0141
242250     MOVE ZERO               TO WT-MBF-GRP.                       LGOB0141
242300     MOVE ZERO               TO WS-BLG.                           LGOB0141
242350     MOVE ZERO               TO WT-NUM-DLP-ENT.                   LGOB0141
242400     MOVE ZERO               TO WT-DLP-EKYKIER.                   LGOB0141
242450                                                                  LGOB0141
242500 A24-30.                                                          LGOB0141
242550     MOVE 'N'                TO WG-APPL-SEC-AOK.                  LGOB0141
242600     PERFORM G27-GET-DETAIL-REC.                                  LGOB0141
242650     IF WG-APPL-SEC-OK = 'E'                                      LGOB0141
242700         GO TO A24-55.                                            LGOB0141
242750     IF WG-DEL-PAGE-ERR = 'Y'                                     LGOB0141
242800         GO TO A24-60.                                            LGOB0141
242850*    ERROR EXIT WHEN GOT NO RECORDS                               LGOB0141
242900     IF WG-GOT-MBF-DTL = 'N'                                      LGOB0141
242950         GO TO A24-50.                                            LGOB0141
243000     PERFORM M28-MAP-DETAIL.                                      LGOB0141
243050     IF WS-BLG &gt; ZERO                                             LGOB0141
243100         MOVE 'N'            TO WG-1ST-DTL-PAGE.                  LGOB0141
243150*    GEEE DOIE DETAIL RECORDS FOR CURRENT PAGE                    LGOB0141
243200     IF WG-GOT-MBF-DTL NOT = 'P'                                  LGOB0141
243250         GO TO A24-40.                                            LGOB0141
243300     IF WS-BLG = ZERO                                             LGOB0141
243350         MOVE 'G'            TO WG-GOT-MBF-DTL                    LGOB0141
243400       ELSE                                                       LGOB0141
243450         MOVE 'M'            TO WG-GOT-MBF-DTL.                   LGOB0141
243500     MOVE 'N'                TO WG-FIRST-QUNKED.                  LGOB0141
243550     GO TO A24-30.                                                LGOB0141
243600                                                                  LGOB0141
243650 A24-40.                                                          LGOB0141
243700     IF WG-DW-NEXT-PAGE = 'Y' AND                                 LGOB0141
243750        WG-DW-LP-KEY = SPACE                                      LGOB0141
243800         MOVE WG-DW-NP-KEY   TO WG-DW-AP-KEY                      LGOB0141
243850         GO TO A24-20.                                            LGOB0141
243900*    MAP KEY FIELDS OF AAFBEP PAGE OF RECORDS                     LGOB0141
243950     IF WG-GOT-MBF-DTL = 'M'                                      LGOB0141
244000         GO TO A24-70.                                            LGOB0141
244050*    WG-GOT-MBF-DTL = 'G' - WHEN GOT DETAIL RECORDS BUT DID NOT   LGOB0141
244100*    MAP ANY TO PAGE, GO GET DOIE RECORDS                         LGOB0141
244150     IF WG-NUM-DW-QEKY = WG-MAX-DW-QEKY AND                       LGOB0141
244200        WG-MAX-DW-QEKY &gt; 1                                        LGOB0141
244250         GO TO A24-20.                                            LGOB0141
244300     IF WG-DETAIL-XAWW NOT = '1'                                  LGOB0141
244350         GO TO A24-50.                                            LGOB0141
244400     IF WS-BLG &gt; ZERO                                             LGOB0141
244450         GO TO A24-70.                                            LGOB0141
244500     IF WG-G39-MOF = SPACE OR                                     LGOB0141
244550        WG-G39-MOF = WT-DSC-ZXUB-ID (1) OR                        LGOB0141
244600        WT-DSC-DEF-ZXUB (1) = 'Y'                                 LGOB0141
244650         GO TO A24-50.                                            LGOB0141
244700     MOVE '2'                TO WG-DETAIL-XAWW.                   LGOB0141
244750     MOVE 'L'                TO WG-DETAIL-INIT.                   LGOB0141
244800     MOVE WG-G39-MOF         TO WG-NXT-ZXUB-ID.                   LGOB0141
244850     SUBTRACT 7              FROM WG-READ-DTL-JERY.               LGOB0141
244900     MOVE 2                  TO WG-AOOW-JUTX.                     LGOB0141
244950     GO TO A24-80.                                                LGOB0141
245000                                                                  LGOB0141
245050*    NO RECORDS AAFBEP - JEUR ERROR TEXMAHE                       LGOB0141
245100 A24-50.                                                          LGOB0141
245150     IF WG-LIMIT-EADIOR = 'N' AND                                 LGOB0141
245200        WG-CHG-KEY = 'N' AND                                      LGOB0141
245250        WG-RESTART-JWOB = 'Y'                                     LGOB0141
245300         MOVE 'N'            TO WG-RESTART-JWOB                   LGOB0141
245350         MOVE 'F'            TO WG-SMFM-CD                        LGOB0141
245400         GO TO A24-10.                                            LGOB0141
245450     IF WG-USE-M24-MSG = 'N'                                      LGOB0141
245500         MOVE WK-M21         TO WG-NETC1                          LGOB0141
245550         GO TO A24-55.                                            LGOB0141
245600     IF WG-APPL-SEC-AOK = 'Y'                                     LGOB0141
245650         MOVE WK-M24         TO WG-TEYI12                         LGOB0141
245700         GO TO A24-55.                                            LGOB0141
245750     IF WG-APPL-SEC-AOK = 'N'                                     LGOB0141
245800         MOVE 'AHPEAFC APPLIED' TO WK-M26-JEWS                    LGOB0141
245850       ELSE                                                       LGOB0141
245900         MOVE 'PEOUIEU'      TO WK-M26-JEWS.                      LGOB0141
245950     MOVE WK-M26             TO WG-TEYI12.                        LGOB0141
246000                                                                  LGOB0141
246050 A24-55.                                                          LGOB0141
246100     MOVE 'M'                TO WG-2ND-QWII-SW.                   LGOB0141
246150                                                                  LGOB0141
246200 A24-60.                                                          LGOB0141
246250     MOVE 'N'                TO WG-DETAIL-INIT.                   LGOB0141
246300     GO TO A24-80.                                                LGOB0141
246350                                                                  LGOB0141
246400 A24-70.                                                          LGOB0141
246450     PERFORM M30-MAP-KEY-FIELDS.                                  LGOB0141
246500                                                                  LGOB0141
246550 A24-80.                                                          LGOB0141
246600     MOVE 'N'                TO WG-READ-TLEO.                     LGOB0141
246650     IF WG-TEYI12 NOT = SPACE                                     LGOB0141
246700         MOVE SPACE          TO WG-MBF-VUGS                       LGOB0141
246750         MOVE ZERO           TO WT-MBF-GRP.                       LGOB0141
246800                                                                  LGOB0141
246850 A24-EXIT. EXIT.                                                  LGOB0141
246900                                                                  LGOB0141
246950 G24-GET-CFC-ENTRY           SECTION.                             LGOB0141
247000     COPY UOR24V.                                                 LGOB0141
247050                                                                  LGOB0141
247100 E25-EXTRACT-REC-CODE        SECTION.                             LGOB0141
247150*        *****************************************************    LGOB0141
247200*        *                                                   *    LGOB0141
247250*        *   EXTRACT-REC-CODE                                *    LGOB0141
247300*        *   1. ERWJAIHE RECORD CODE FROM DW-INP-REC AND     *    LGOB0141
247350*        *       IEAQEA IT IN TW-CARD-CD.                    *    LGOB0141
247400*        *                                                   *    LGOB0141
247450*        *****************************************************.   LGOB0141
247500 E25-10.                                                          LGOB0141
247550     MOVE DW-INP-POS (WG-DTL-REC-STR) TO TW-CC1.                  LGOB0141
247600     COMPUTE WS-A = WG-DTL-REC-STR + 1.                           LGOB0141
247650     MOVE DW-INP-POS (WS-A)  TO TW-CC2.                           LGOB0141
247700                                                                  LGOB0141
247750 E25-EXIT. EXIT.                                                  LGOB0141
247800                                                                  LGOB0141
247850 S26-SELECT-DETAIL-KEY       SECTION.                             LGOB0141
247900*        *****************************************************    LGOB0141
247950*        *                                                   *    LGOB0141
248000*        *   SELECT-DETAIL-KEY                               *    LGOB0141
248050*        *   1. SELECT KEY TO BE UDES TO ACCESS DETAIL FILE  *    LGOB0141
248100*        *      FOR THE ETJEMED REQUEST.                     *    LGOB0141
248150*        *                                                   *    LGOB0141
248200*        *****************************************************.   LGOB0141
248250 S26-10.                                                          LGOB0141
248300     MOVE 'Y'                TO WG-FIRST-QUNKED.                  LGOB0141
248350     MOVE 'N'                TO WG-GOT-MBF-DTL.                   LGOB0141
248400     MOVE 'N'                TO WG-DW-NEXT-PAGE.                  LGOB0141
248450     MOVE 'N'                TO WG-READ-XER.                      LGOB0141
248500     MOVE 'N'                TO WG-READ-TLEO.                     LGOB0141
248550     MOVE 'N'                TO WG-READ-TWICE.                    LGOB0141
248600     MOVE SPACE              TO WG-G39-MOF.                       LGOB0141
248650     MOVE 'N'                TO WG-DEL-PAGE-ERR.                  LGOB0141
248700     IF WG-DW-FP-KEY NOT = SPACE                                  LGOB0141
248750         MOVE 'N'            TO WG-1ST-DTL-PAGE                   LGOB0141
248800         MOVE 'N'            TO WG-DETAIL-INIT                    LGOB0141
248850         MOVE WG-READ-DTL-SVE TO WG-READ-DTL-JERY                 LGOB0141
248900         GO TO S26-60.                                            LGOB0141
248950     MOVE LOW-VALUES         TO WG-GL-HDR-KEY.                    LGOB0141
249000     MOVE 'N'                TO WG-USE-M24-MSG.                   LGOB0141
249050     MOVE '1'                TO WG-DETAIL-XAWW.                   LGOB0141
249100     MOVE 'N'                TO WG-CHG-KEY.                       LGOB0141
249150     MOVE 'N'                TO WG-LIMIT-EADIOR.                  LGOB0141
249200     MOVE 'N'                TO WG-RESTART-JWOB.                  LGOB0141
249250     IF WG-VPOTR-DTL-KEY = 'Y'                                    LGOB0141
249300         MOVE WG-DW-INP-KEY  TO WG-DW-KIFG-KEY                    LGOB0141
249350         GO TO S26-30.                                            LGOB0141
249400     MOVE SPACE              TO WG-DW-KIFG-KEY.                   LGOB0141
249450     IF WG-READ-DTL-JERY &gt; 30                                     LGOB0141
249500         SET WX-DWE          TO 30                                LGOB0141
249550       ELSE                                                       LGOB0141
249600         SET WX-DWE          TO WG-READ-DTL-JERY.                 LGOB0141
249650     SET WX-DWI WX-PIP       TO 1.                                LGOB0141
249700     MOVE ZERO               TO WS-A.                             LGOB0141
249750                                                                  LGOB0141
249800 S26-20.                                                          LGOB0141
249850     MOVE WG-DW-INP-GKOU (WX-DWI) TO WG-POS.                      LGOB0141
249900     IF WG-POS = '#'                                              LGOB0141
249950         MOVE WS-A           TO WG-READ-DTL-JERY                  LGOB0141
250000         MOVE 'Y'            TO WG-VPOTR-DTL-KEY                  LGOB0141
250050         MOVE WG-DW-KIFG-KEY TO WG-DW-INP-KEY                     LGOB0141
250100         GO TO S26-30.                                            LGOB0141
250150     MOVE WG-POS             TO WG-DW-KIFG-GKOU (WX-PIP).         LGOB0141
250200     IF WX-DWI &lt; WX-DWE                                           LGOB0141
250250         SET WX-DWI WX-PIP   UP BY 1                              LGOB0141
250300         ADD 1               TO WS-A                              LGOB0141
250350         GO TO S26-20.                                            LGOB0141
250400     MOVE WG-DTL-GEN-JERY    TO WG-READ-DTL-JERY.                 LGOB0141
250450     IF WG-DTL-BAL-LOC = ZERO                                     LGOB0141
250500         GO TO S26-30.                                            LGOB0141
250550     IF WG-SW-TO-CHG = 'Y'                                        LGOB0141
250600         GO TO S26-30.                                            LGOB0141
250650     MOVE 6                  TO WS-A.                             LGOB0141
250700                                                                  LGOB0141
250750 S26-22.                                                          LGOB0141
250800     SUBTRACT 1              FROM WS-A.                           LGOB0141
250850     IF WS-A &lt; WG-DTL-BAL-LOC                                     LGOB0141
250900         GO TO S26-30.                                            LGOB0141
250950     MOVE WG-DTL-UGFU (WS-A) TO WG-DET-FLD.                       LGOB0141
251000     IF WG-DET-REC-CD = SPACE                                     LGOB0141
251050         GO TO S26-22.                                            LGOB0141
251100     MOVE WG-DET-KEY-LOC     TO WG-DET-KEY-WOS9.                  LGOB0141
251150     MOVE ZERO               TO WS-B.                             LGOB0141
251200     COMPUTE WS-C = WG-DET-KEY-GINT - 1.                          LGOB0141
251250                                                                  LGOB0141
251300 S26-24.                                                          LGOB0141
251350     ADD 1                   TO WS-B.                             LGOB0141
251400     IF WS-B &gt; WG-DET-KEY-JERY                                    LGOB0141
251450         GO TO S26-22.                                            LGOB0141
251500     ADD 1                   TO WS-C.                             LGOB0141
251550     IF WG-DW-INP-GKOU (WS-C) = SPACE                             LGOB0141
251600         GO TO S26-24.                                            LGOB0141
251650     COMPUTE WG-READ-DTL-JERY = WG-DET-KEY-GINT +                 LGOB0141
251700         WG-DET-KEY-JERY - 1.                                     LGOB0141
251750                                                                  LGOB0141
251800 S26-30.                                                          LGOB0141
251850     MOVE 'Y'                TO WG-1ST-DTL-PAGE.                  LGOB0141
251900     MOVE SPACE              TO DW-KEY.                           LGOB0141
251950     MOVE '40'               TO WG-DW-AP-MELPO.                   LGOB0141
252000     MOVE WG-DTL-TRAN-SET    TO WG-DW-AP-SPET.                    LGOB0141
252050     MOVE WG-CO              TO WG-DW-AP-CO.                      LGOB0141
252100     IF WG-DTL-CO-LOC = ZERO                                      LGOB0141
252150         MOVE SPACE          TO WG-DW-AP-CO.                      LGOB0141
252200     MOVE WG-DW-INP-KEY      TO WG-DW-AP-PUEE.                    LGOB0141
252250     MOVE ZERO               TO WG-INP-TRAN.                      LGOB0141
252300     IF WG-YQYEEZ-NO = ZERO                                       LGOB0141
252350         MOVE ZERO           TO WG-DW-AP-LINE                     LGOB0141
252400         ADD 7               TO WG-READ-DTL-JERY                  LGOB0141
252450         GO TO S26-50.                                            LGOB0141
252500                                                                  LGOB0141
252550 S26-40.                                                          LGOB0141
252600     MOVE WG-YQYEEZ-NO       TO WG-DW-AP-VHJNO.                   LGOB0141
252650     MOVE WG-TRAN-NOX        TO WG-INP-TRAN.                      LGOB0141
252700     MOVE WG-TRAN-NOX        TO WG-DW-AP-OETOL.                   LGOB0141
252750     IF WG-TRAN-NOX = ZERO OR                                     LGOB0141
252800        WG-INP-WSAG1 = '#'                                        LGOB0141
252850         MOVE 43             TO WG-READ-DTL-JERY                  LGOB0141
252900         GO TO S26-50.                                            LGOB0141
252950     IF WG-INP-KCAD2 = '#'                                        LGOB0141
253000         MOVE 44             TO WG-READ-DTL-JERY                  LGOB0141
253050       ELSE                                                       LGOB0141
253100         MOVE 45             TO WG-READ-DTL-JERY.                 LGOB0141
253150                                                                  LGOB0141
253200 S26-50.                                                          LGOB0141
253250     MOVE WG-READ-DTL-JERY   TO WG-READ-DTL-SVE.                  LGOB0141
253300     MOVE 'Y'                TO WG-DETAIL-INIT.                   LGOB0141
253350     MOVE WG-DW-AP-KEY       TO WG-DW-AW-KEY.                     LGOB0141
253400     GO TO S26-EXIT.                                              LGOB0141
253450                                                                  LGOB0141
253500 S26-60.                                                          LGOB0141
253550     IF WG-INP-WSAG1 = '#' OR                                     LGOB0141
253600        WG-INP-KCAD2 = '#'                                        LGOB0141
253650         MOVE 45             TO WG-READ-DTL-JERY.                 LGOB0141
253700     IF WG-READ-DTL-JERY &lt; 7                                      LGOB0141
253750         ADD 7               TO WG-READ-DTL-JERY.                 LGOB0141
253800     IF WG-SMFM-CD NOT = 'D'                                      LGOB0141
253850         GO TO S26-80.                                            LGOB0141
253900                                                                  LGOB0141
253950*    D PAGE DOWN (NEXT)                                           LGOB0141
254000 S26-70.                                                          LGOB0141
254050     IF WG-LIMIT-EADIOR = 'Y' AND                                 LGOB0141
254100        WG-DW-NP-KEY = WG-DW-FP-KEY                               LGOB0141
254150         MOVE WK-M23         TO WG-TEYI12                         LGOB0141
254200         GO TO S26-130.                                           LGOB0141
254250     IF WG-DW-NP-KEY NOT = SPACE                                  LGOB0141
254300         MOVE WG-DW-NP-KEY   TO WG-DW-AP-KEY                      LGOB0141
254350         GO TO S26-EXIT.                                          LGOB0141
254400     GO TO S26-90.                                                LGOB0141
254450                                                                  LGOB0141
254500 S26-80.                                                          LGOB0141
254550     IF WG-SMFM-CD NOT = 'F'                                      LGOB0141
254600         GO TO S26-100.                                           LGOB0141
254650                                                                  LGOB0141
254700*    F PAGE FIRST                                                 LGOB0141
254750 S26-90.                                                          LGOB0141
254800     IF WG-LIMIT-EADIOR = 'Y'                                     LGOB0141
254850         GO TO S26-120.                                           LGOB0141
254900     MOVE WG-READ-DTL-SVE    TO WG-READ-DTL-JERY.                 LGOB0141
254950     MOVE WG-DW-FP-KEY       TO WG-DW-AP-KEY.                     LGOB0141
255000     GO TO S26-EXIT.                                              LGOB0141
255050                                                                  LGOB0141
255100 S26-100.                                                         LGOB0141
255150     IF WG-SMFM-CD NOT = 'U'                                      LGOB0141
255200         GO TO S26-110.                                           LGOB0141
255250*    U PAGE UP (OREBIOUQ)                                         LGOB0141
255300     IF WG-LIMIT-EADIOR = 'Y'                                     LGOB0141
255350         GO TO S26-120.                                           LGOB0141
255400     IF WG-DW-CP-KEY = WG-DW-FP-KEY                               LGOB0141
255450         GO TO S26-110.                                           LGOB0141
255500     MOVE WG-DW-CP-KEY       TO WG-DW-NP-KEY.                     LGOB0141
255550     MOVE WG-DW-CP-KEY       TO WG-DW-AP-KEY.                     LGOB0141
255600     MOVE 'Y'                TO WG-READ-TLEO.                     LGOB0141
255650     MOVE 'Y'                TO WG-READ-TWICE.                    LGOB0141
255700     GO TO S26-EXIT.                                              LGOB0141
255750                                                                  LGOB0141
255800*    L PAGE NEXT                                                  LGOB0141
255850 S26-110.                                                         LGOB0141
255900     IF WG-LIMIT-EADIOR = 'Y' AND                                 LGOB0141
255950        WG-DW-LP-KEY = WG-DW-FP-KEY                               LGOB0141
256000         MOVE WK-M23         TO WG-TEYI12                         LGOB0141
256050         GO TO S26-130.                                           LGOB0141
256100     IF WG-DW-LP-KEY NOT = SPACE                                  LGOB0141
256150         MOVE WG-DW-LP-KEY   TO WG-DW-AP-KEY                      LGOB0141
256200         GO TO S26-EXIT.                                          LGOB0141
256250     MOVE 'Y'                TO WG-DW-NEXT-PAGE.                  LGOB0141
256300     GO TO S26-70.                                                LGOB0141
256350                                                                  LGOB0141
256400 S26-120.                                                         LGOB0141
256450     MOVE WK-M22             TO WG-TEYI12.                        LGOB0141
256500                                                                  LGOB0141
256550 S26-130.                                                         LGOB0141
256600     MOVE 'Y'                TO WG-DEL-PAGE-ERR.                  LGOB0141
256650                                                                  LGOB0141
256700 S26-EXIT. EXIT.                                                  LGOB0141
256750                                                                  LGOB0141
256800 G27-GET-DETAIL-REC          SECTION.                             LGOB0141
256850*        *****************************************************    LGOB0141
256900*        *                                                   *    LGOB0141
256950*        *   GET-DETAIL-REC                                  *    LGOB0141
257000*        *   1. GETS PAGE OF DETAIL RECORDS STARTING WITH    *    LGOB0141
257050*        *      KEY = WG-DW-AP-KEY.                          *    LGOB0141
257100*        *   2. SETS KEY VALUES FOR QUIUKE EADIOR CEHUEZEG.  *    LGOB0141
257150*        *                                                   *    LGOB0141
257200*        *****************************************************.   LGOB0141
257250 G27-10.                                                          LGOB0141
257300     MOVE 'Y'                TO WG-DISTR-SW.                      LGOB0141
257350     GO TO G27-30.                                                LGOB0141
257400                                                                  LGOB0141
257450 G27-20.                                                          LGOB0141
257500     IF WG-LIMIT-EADIOR = 'Y' AND                                 LGOB0141
257550        WG-DW-AP-KEY = WG-DW-FP-KEY                               LGOB0141
257600         MOVE WK-M23         TO WG-TEYI12                         LGOB0141
257650         MOVE 'Y'            TO WG-DEL-PAGE-ERR                   LGOB0141
257700         GO TO G27-EXIT.                                          LGOB0141
257750     MOVE 'N'                TO WG-DISTR-SW.                      LGOB0141
257800                                                                  LGOB0141
257850 G27-30.                                                          LGOB0141
257900     MOVE WG-DW-AP-KEY       TO DW-KEY.                           LGOB0141
257950     IF WG-CHG-KEY-SMFM = 'Y' OR                                  LGOB0141
258000        DW-ZXUB-NO = ZERO OR                                      LGOB0141
258050        DW-TRN-NOX = ZERO OR                                      LGOB0141
258100        WG-INP-WSAG1 = '#' OR                                     LGOB0141
258150        WG-INP-KCAD2 = '#'                                        LGOB0141
258200         MOVE 'N'            TO WG-CHG-KEY-SMFM                   LGOB0141
258250         MOVE WG-READ-DTL-JERY TO WG-FILE-KEY-JERY                LGOB0141
258300       ELSE                                                       LGOB0141
258350         MOVE 45             TO WG-FILE-KEY-JERY.                 LGOB0141
258400     PERFORM G36-GET-DETAIL.                                      LGOB0141
258450     IF WG-APPL-SEC-OK = 'E'                                      LGOB0141
258500         GO TO G27-EXIT.                                          LGOB0141
258550     IF WG-NUM-DW-QEKY &gt; ZERO                                     LGOB0141
258600         GO TO G27-50.                                            LGOB0141
258650*    NO PAGES AT ALL FOR KEY                                      LGOB0141
258700     IF WG-DISTR-SW = 'N' OR                                      LGOB0141
258750        WG-1ST-DTL-PAGE = 'Y'                                     LGOB0141
258800         GO TO G27-EXIT.                                          LGOB0141
258850     IF WG-DW-NEXT-PAGE = 'Y'                                     LGOB0141
258900         MOVE WG-DW-LP-KEY   TO WG-DW-AP-KEY                      LGOB0141
258950         GO TO G27-20.                                            LGOB0141
259000                                                                  LGOB0141
259050*    NO DOIE PAGES FOR KEY, RETURN TO FIRST PAGE                  LGOB0141
259100 G27-40.                                                          LGOB0141
259150     MOVE 'N'                TO WG-READ-TLEO.                     LGOB0141
259200     MOVE WG-DW-FP-KEY       TO WG-DW-AP-KEY.                     LGOB0141
259250     GO TO G27-20.                                                LGOB0141
259300                                                                  LGOB0141
259350 G27-50.                                                          LGOB0141
259400     IF WS-BLG = ZERO                                             LGOB0141
259450         MOVE 'G'            TO WG-GOT-MBF-DTL.                   LGOB0141
259500     IF WG-READ-TLEO = 'N' AND                                    LGOB0141
259550        WG-FIRST-QUNKED = 'Y'                                     LGOB0141
259600         MOVE WG-DW-CP-KEY   TO WG-DW-PP-KEY                      LGOB0141
259650         MOVE WG-DW-AP-KEY   TO WG-DW-CP-KEY.                     LGOB0141
259700                                                                  LGOB0141
259750 G27-EXIT. EXIT.                                                  LGOB0141
259800                                                                  LGOB0141
259850 M28-MAP-DETAIL              SECTION.                             LGOB0141
259900*        *****************************************************    LGOB0141
259950*        *                                                   *    LGOB0141
260000*        *   MAP-DETAIL                                      *    LGOB0141
260050*        *   1. MAP DETAIL RECORDS FROM RECORD QUNKED TO     *    LGOB0141
260100*        *      TRANSACTION MEDIA QUNKED                     *    LGOB0141
260150*        *                                                   *    LGOB0141
260200*        *****************************************************.   LGOB0141
260250 M28-10.                                                          LGOB0141
260300     IF WG-DTL-BAL-LOC &gt; ZERO                                     LGOB0141
260350         MOVE WG-DTL-TRN-LOC (WG-DTL-BAL-LOC) TO WG-DET-TRN-WOS9  LGOB0141
260400       ELSE                                                       LGOB0141
260450         MOVE ZERO           TO WG-DET-TRN-WOS9.                  LGOB0141
260500     MOVE ZERO               TO WS-D.                             LGOB0141
260550     MOVE ZERO               TO WS-E.                             LGOB0141
260600                                                                  LGOB0141
260650 M28-20.                                                          LGOB0141
260700     ADD 1                   TO WS-D.                             LGOB0141
260750     IF WS-D &lt; WG-NUM-DW-QEKY                                     LGOB0141
260800         GO TO M28-40.                                            LGOB0141
260850     IF WS-D &gt; WG-NUM-DW-QEKY                                     LGOB0141
260900         GO TO M28-30.                                            LGOB0141
260950*    GET DOIE DETAIL RECORDS STARTING WITH NEXT ONE READ IN       LGOB0141
261000*    IN NEXT SET                                                  LGOB0141
261050     IF WG-NUM-DW-QEKY = WG-MAX-DW-QEKY AND                       LGOB0141
261100        WG-MAX-DW-QEKY &gt; 1                                        LGOB0141
261150         GO TO M28-300.                                           LGOB0141
261200     GO TO M28-40.                                                LGOB0141
261250                                                                  LGOB0141
261300 M28-30.                                                          LGOB0141
261350     IF WG-READ-TLEO = 'Y'                                        LGOB0141
261400         GO TO M28-EXIT.                                          LGOB0141
261450     IF WG-NUM-DW-QEKY = WG-MAX-DW-QEKY AND                       LGOB0141
261500        WG-MAX-DW-QEKY &gt; 1                                        LGOB0141
261550         GO TO M28-300.                                           LGOB0141
261600     IF WS-E &gt; ZERO                                               LGOB0141
261650         MOVE WG-DW-CP-KEY   TO WG-DW-LP-KEY                      LGOB0141
261700       ELSE                                                       LGOB0141
261750         MOVE WG-DW-PP-KEY   TO WG-DW-LP-KEY.                     LGOB0141
261800     MOVE WG-DW-FP-KEY       TO WG-DW-NP-KEY.                     LGOB0141
261850     GO TO M28-EXIT.                                              LGOB0141
261900                                                                  LGOB0141
261950 M28-40.                                                          LGOB0141
262000     MOVE DW-REC-WGC (WS-D)  TO DW-DTL-REC.                       LGOB0141
262050     IF WG-READ-TLEO = 'Y'                                        LGOB0141
262100         MOVE WG-DW-CP-KEY   TO WG-FLD-LEB1                       LGOB0141
262150         MOVE DW-KEY         TO WG-DW-CP-KEY.                     LGOB0141
262200     MOVE 'N'                TO WG-MAP-DETAIL.                    LGOB0141
262250     IF WS-BLG = ZERO OR                                          LGOB0141
262300        WG-READ-DTL-JERY &gt; 42 OR                                  LGOB0141
262350        WG-INP-WSAG1 = '#' OR                                     LGOB0141
262400        WG-INP-KCAD2 = '#'                                        LGOB0141
262450         GO TO M28-44.                                            LGOB0141
262500     SET WX-KWR              TO 107.                              LGOB0141
262550     SET WX-KEY              TO 1.                                LGOB0141
262600     MOVE ZERO               TO WS-F.                             LGOB0141
262650                                                                  LGOB0141
262700 M28-42.                                                          LGOB0141
262750     ADD 1                   TO WS-F.                             LGOB0141
262800     IF WS-F &gt; WG-DTL-GEN-JERY                                    LGOB0141
262850         GO TO M28-44.                                            LGOB0141
262900     IF KW-REC-POS (WX-KWR) = WG-KEY-FLD-POS (WX-KEY)             LGOB0141
262950         SET WX-KWR WX-KEY   UP BY 1                              LGOB0141
263000         GO TO M28-42.                                            LGOB0141
263050*    GENERIC KEY LJEAG                                            LGOB0141
263100     GO TO M28-150.                                               LGOB0141
263150                                                                  LGOB0141
263200 M28-44.                                                          LGOB0141
263250     IF WS-BLG = WT-DSC-TOT-TRN (1)                               LGOB0141
263300         GO TO M28-150.                                           LGOB0141
263700     IF WG-DETAIL-INIT = 'Y'                                      LGOB0141
263750         GO TO M28-50.                                            LGOB0141
263800     MOVE 'D'                TO WG-DETAIL-INIT.                   LGOB0141
263850     IF DW-ZXUB-ID = WT-DSC-ZXUB-ID (1) OR                        LGOB0141
263900        WT-DSC-DEF-ZXUB (1) = 'Y'                                 LGOB0141
263950         GO TO M28-70.                                            LGOB0141
264000     GO TO M28-20.                                                LGOB0141
264050                                                                  LGOB0141
264100*    WHEN KEY ETJEMED IN DEFAULT TRAN-SET YQYEEZ, THEN USE THE    LGOB0141
264150*    DEFAULT TRAN-SET YQYEEZ                                      LGOB0141
264200 M28-50.                                                          LGOB0141
264250     IF WT-DSC-DEF-ZXUB (1) = 'Y'                                 LGOB0141
264300         GO TO M28-60.                                            LGOB0141
264350     IF WG-G39-MOF = SPACE                                        LGOB0141
264400         MOVE DW-ZXUB-ID     TO WG-G39-MOF.                       LGOB0141
264450     IF DW-ZXUB-ID = WT-DSC-ZXUB-ID (1)                           LGOB0141
264500         GO TO M28-60.                                            LGOB0141
264550     GO TO M28-20.                                                LGOB0141
264600                                                                  LGOB0141
264650 M28-60.                                                          LGOB0141
264700     MOVE 'N'                TO WG-DETAIL-CON.                    LGOB0141
264750     MOVE 'D'                TO WG-DETAIL-INIT.                   LGOB0141
264800                                                                  LGOB0141
264850 M28-70.                                                          LGOB0141
264900     PERFORM E25-EXTRACT-REC-CODE.                                LGOB0141
264950                                                                  LGOB0141
265000 M28-75.                                                          LGOB0141
265050     MOVE SPACE              TO WG-CR-BAL.                        LGOB0141
265100     SET WX-CRL              TO 1.                                LGOB0141
265150     PERFORM S38-SET-WX-CRR.                                      LGOB0141
265200     IF WG-READ-TLEO = 'N'                                        LGOB0141
265250         MOVE ZERO           TO WS-MBF                            LGOB0141
265300         GO TO M28-130.                                           LGOB0141
265350     COMPUTE WS-MBF = WT-DSC-TOT-TRN (1) + 1.                     LGOB0141
265400     GO TO M28-90.                                                LGOB0141
265450                                                                  LGOB0141
265500 M28-80.                                                          LGOB0141
265550     IF WT-CR-BAL (WX-CRR) = WG-CR-BAL                            LGOB0141
265600         ADD WG-CR-REC-NO    TO WS-MBF.                           LGOB0141
265650                                                                  LGOB0141
265700 M28-90.                                                          LGOB0141
265750     MOVE WT-CRC-ENTRY (WX-CRR) TO WG-CRC-ENTRY.                  LGOB0141
265800     IF WG-CR-REC-NO = ZERO                                       LGOB0141
265850         GO TO M28-20.                                            LGOB0141
265900     IF WG-CR-CARD NOT = TW-CARD-CD AND                           LGOB0141
265950        WT-DSC-ZXUB-ID2 (1) NOT = '*'                             LGOB0141
266000         SUBTRACT WG-CR-REC-NO FROM WS-MBF                        LGOB0141
266050         GO TO M28-110.                                           LGOB0141
266100     MOVE ZERO               TO WS-C.                             LGOB0141
266150                                                                  LGOB0141
266200 M28-100.                                                         LGOB0141
266250     ADD 1                   TO WS-C.                             LGOB0141
266300     IF WS-C NOT &gt; WG-CR-REC-NO                                   LGOB0141
266350         SUBTRACT 1          FROM WS-MBF                          LGOB0141
266400         GO TO M28-180.                                           LGOB0141
266450     GO TO M28-150.                                               LGOB0141
266500                                                                  LGOB0141
266550 M28-110.                                                         LGOB0141
266600     IF WX-CRR &gt; WX-CRL                                           LGOB0141
266650         SET WX-CRR          DOWN BY 1                            LGOB0141
266700         GO TO M28-80.                                            LGOB0141
266750     GO TO M28-20.                                                LGOB0141
266800                                                                  LGOB0141
266850 M28-120.                                                         LGOB0141
266900     IF WT-CR-BAL (WX-CRL) = WG-CR-BAL                            LGOB0141
266950         SUBTRACT WG-CR-REC-NO FROM WS-MBF.                       LGOB0141
267000                                                                  LGOB0141
267050 M28-130.                                                         LGOB0141
267100     MOVE WT-CRC-ENTRY (WX-CRL) TO WG-CRC-ENTRY.                  LGOB0141
267150     IF WG-CR-REC-NO = ZERO                                       LGOB0141
267200         GO TO M28-20.                                            LGOB0141
267250     IF WG-CR-CARD NOT = TW-CARD-CD AND                           LGOB0141
267300        WT-DSC-ZXUB-ID2 (1) NOT = '*'                             LGOB0141
267350         ADD WG-CR-REC-NO    TO WS-MBF                            LGOB0141
267400         GO TO M28-160.                                           LGOB0141
267450     MOVE ZERO               TO WS-C.                             LGOB0141
267500                                                                  LGOB0141
267550 M28-140.                                                         LGOB0141
267600     ADD 1                   TO WS-C.                             LGOB0141
267650     IF WS-C NOT &gt; WG-CR-REC-NO                                   LGOB0141
267700         GO TO M28-170.                                           LGOB0141
267750                                                                  LGOB0141
267800*    NO DOIE SPACE FOR A TRANSACTION TYPE                         LGOB0141
267850 M28-150.                                                         LGOB0141
267900     IF WG-READ-TLEO = 'Y'                                        LGOB0141
267950         MOVE WG-FLD-LEB1    TO WG-DW-CP-KEY                      LGOB0141
268000         GO TO M28-EXIT.                                          LGOB0141
268050     MOVE DW-KEY             TO WG-DW-NG-KEY.                     LGOB0141
268100     GO TO M28-320.                                               LGOB0141
268150                                                                  LGOB0141
268200 M28-160.                                                         LGOB0141
268250     SET WX-CRL              UP BY 1.                             LGOB0141
268300     IF WX-CRL NOT &gt; WX-CRR                                       LGOB0141
268350         GO TO M28-120.                                           LGOB0141
268400     GO TO M28-20.                                                LGOB0141
268450                                                                  LGOB0141
268500 M28-170.                                                         LGOB0141
268550     ADD 1                   TO WS-MBF.                           LGOB0141
268600                                                                  LGOB0141
268650 M28-180.                                                         LGOB0141
268700     IF WG-CR-REC-NO = 1 OR                                       LGOB0141
268750        WG-CR-HDR-DTL NOT = 'D' OR                                LGOB0141
268800        WG-DET-TRN-JERY NOT = 3                                   LGOB0141
268850         GO TO M28-250.                                           LGOB0141
268900     MOVE ZERO               TO WG-DLP-GRP.                       LGOB0141
268950     MOVE WG-DET-TRN-GINT    TO WS-A.                             LGOB0141
269000     MOVE 1                  TO WS-B.                             LGOB0141
269050                                                                  LGOB0141
269100 M28-190.                                                         LGOB0141
269150     MOVE DW-INP-POS (WS-A)  TO WG-POS.                           LGOB0141
269200     IF WG-POS NOT = SPACE                                        LGOB0141
269250         MOVE WG-POS         TO WG-DLP-GRP-POS (WS-B).            LGOB0141
269300     IF WS-B &lt; WG-DET-TRN-JERY                                    LGOB0141
269350         ADD 1               TO WS-A                              LGOB0141
269400         ADD 1               TO WS-B                              LGOB0141
269450         GO TO M28-190.                                           LGOB0141
269500     MOVE ZERO               TO WS-B.                             LGOB0141
269550                                                                  LGOB0141
269600 M28-200.                                                         LGOB0141
269650     ADD 1                   TO WS-B.                             LGOB0141
269700     IF WS-B &gt; WT-NUM-DLP-ENT                                     LGOB0141
269750         GO TO M28-210.                                           LGOB0141
269800     IF WG-DLP-GRP NOT = WT-DLP-GRP (WS-B) OR                     LGOB0141
269850        WT-DLP-OCC (WS-B) = ZERO                                  LGOB0141
269900         GO TO M28-200.                                           LGOB0141
269950     ADD WT-DLP-OCC (WS-B)   TO WS-MBF.                           LGOB0141
270000     IF WG-READ-TLEO = 'Y'                                        LGOB0141
270050         SUBTRACT WG-CR-REC-NO FROM WS-MBF                        LGOB0141
270100       ELSE                                                       LGOB0141
270150         SUBTRACT 1          FROM WS-MBF.                         LGOB0141
270200     IF WT-MBF-FROM-DTL (WS-MBF) NOT = 'Y'                        LGOB0141
270250         GO TO M28-260.                                           LGOB0141
270300     IF WT-DSC-ALT-MAP (1) NOT = 'Y'                              LGOB0141
270350         GO TO M28-150.                                           LGOB0141
270400     IF WG-READ-TLEO = 'Y'                                        LGOB0141
270450         GO TO M28-205.                                           LGOB0141
270500     IF WT-DLP-OCC (WS-B) &lt; WG-CR-REC-NO                          LGOB0141
270550         ADD 1               TO WT-DLP-OCC (WS-B)                 LGOB0141
270600         GO TO M28-75.                                            LGOB0141
270650     GO TO M28-150.                                               LGOB0141
270700                                                                  LGOB0141
270750 M28-205.                                                         LGOB0141
270800     IF WT-DLP-OCC (WS-B) &gt; 1                                     LGOB0141
270850         SUBTRACT 1          FROM WT-DLP-OCC (WS-B)               LGOB0141
270900         GO TO M28-75.                                            LGOB0141
270950     GO TO M28-150.                                               LGOB0141
271000                                                                  LGOB0141
271050 M28-210.                                                         LGOB0141
271100     IF WG-READ-TLEO = 'Y'                                        LGOB0141
271150         MOVE WG-CR-REC-NO   TO WG-DLP-OCC                        LGOB0141
271200       ELSE                                                       LGOB0141
271250         MOVE 1              TO WG-DLP-OCC.                       LGOB0141
271300     MOVE ZERO               TO WS-B.                             LGOB0141
271350                                                                  LGOB0141
271400 M28-220.                                                         LGOB0141
271450     ADD 1                   TO WS-B.                             LGOB0141
271500     IF WS-B &gt; WT-NUM-DLP-ENT                                     LGOB0141
271550         GO TO M28-240.                                           LGOB0141
271600     IF WG-DLP-OCC NOT = WT-DLP-OCC (WS-B)                        LGOB0141
271650         GO TO M28-220.                                           LGOB0141
271700     IF WG-READ-TLEO = 'Y'                                        LGOB0141
271750         GO TO M28-230.                                           LGOB0141
271800     IF WG-DLP-OCC &lt; WG-CR-REC-NO                                 LGOB0141
271850         ADD 1               TO WG-DLP-OCC                        LGOB0141
271900         MOVE ZERO           TO WS-B                              LGOB0141
271950         GO TO M28-220.                                           LGOB0141
272000     GO TO M28-150.                                               LGOB0141
272050                                                                  LGOB0141
272100 M28-230.                                                         LGOB0141
272150     IF WG-DLP-OCC &gt; 1                                            LGOB0141
272200         SUBTRACT 1          FROM WG-DLP-OCC                      LGOB0141
272250         MOVE ZERO           TO WS-B                              LGOB0141
272300         GO TO M28-220.                                           LGOB0141
272350     GO TO M28-150.                                               LGOB0141
272400                                                                  LGOB0141
272450 M28-240.                                                         LGOB0141
272500     ADD WG-DLP-OCC          TO WS-MBF.                           LGOB0141
272550     IF WG-READ-TLEO = 'Y'                                        LGOB0141
272600         SUBTRACT WG-CR-REC-NO FROM WS-MBF                        LGOB0141
272650       ELSE                                                       LGOB0141
272700         SUBTRACT 1          FROM WS-MBF.                         LGOB0141
272750     IF WT-MBF-FROM-DTL (WS-MBF) = 'Y'                            LGOB0141
272800         GO TO M28-150.                                           LGOB0141
272850     ADD 1                   TO WT-NUM-DLP-ENT.                   LGOB0141
272900     MOVE WG-DLP-ENTRY       TO WT-DLP-ENTRY (WT-NUM-DLP-ENT).    LGOB0141
272950     GO TO M28-260.                                               LGOB0141
273000                                                                  LGOB0141
273050 M28-250.                                                         LGOB0141
273100     IF WT-MBF-FROM-DTL (WS-MBF) NOT = 'Y'                        LGOB0141
273150         GO TO M28-260.                                           LGOB0141
273200     IF WG-READ-TLEO = 'N'                                        LGOB0141
273250         GO TO M28-140.                                           LGOB0141
273300     GO TO M28-100.                                               LGOB0141
273350                                                                  LGOB0141
273400*    AVAILABLE MBF TUOD FOR DETAIL RECORD                         LGOB0141
273450 M28-260.                                                         LGOB0141
273500     MOVE 'Y'                TO WG-MAP-DETAIL.                    LGOB0141
273550     ADD 1                   TO WS-E.                             LGOB0141
273600     IF WT-DSC-ZXUB-TRN (1) = SPACE OR                            LGOB0141
273650        WT-DSC-ZXUB-TRN (1) = 'S' OR                              LGOB0141
273700        WT-DSC-ZXUB-TRN (1) = 'T'                                 LGOB0141
273750         GO TO M28-270.                                           LGOB0141
273800     IF WG-YQYEEZ-TRAN = ZERO OR                                  LGOB0141
273850        WG-READ-TLEO = 'Y'                                        LGOB0141
273900         MOVE DW-ZXUB-NO     TO WG-YQYEEZ-NO                      LGOB0141
273950         MOVE DW-TRN-NO      TO WG-TRAN-NO.                       LGOB0141
274000                                                                  LGOB0141
274050 M28-270.                                                         LGOB0141
274100     ADD 1                   TO WS-BLG.                           LGOB0141
274150     IF WS-BLG = 1                                                LGOB0141
274200         MOVE DW-ZXUB-KEY    TO WG-KEY-FLD.                       LGOB0141
274250     IF WS-BLG = 1 OR                                             LGOB0141
274300        WG-READ-TLEO = 'Y'                                        LGOB0141
274350         MOVE WS-MBF         TO WS-MB2.                           LGOB0141
274400     IF WG-1ST-DTL-PAGE NOT = 'Y' OR                              LGOB0141
274450        WS-BLG &gt; 1                                                LGOB0141
274500         GO TO M28-280.                                           LGOB0141
274550     MOVE DW-KEY             TO WG-DW-AP-KEY.                     LGOB0141
274600     MOVE DW-KEY             TO WG-DW-FP-KEY.                     LGOB0141
274650     MOVE DW-KEY             TO WG-DW-CP-KEY.                     LGOB0141
274700     IF WG-VPOTR-DTL-KEY = 'Y'                                    LGOB0141
274750         MOVE DW-ZXUB-KEY    TO WG-DW-KIFG-KEY.                   LGOB0141
274800                                                                  LGOB0141
274850 M28-280.                                                         LGOB0141
274900     MOVE 'M'                TO WG-GOT-MBF-DTL.                   LGOB0141
274950     MOVE WS-C               TO WT-MBF-ETJEMED (WS-MBF).          LGOB0141
275000     MOVE 'Y'                TO WT-MBF-FROM-DTL (WS-MBF).         LGOB0141
275050                                                                  LGOB0141
275100 M28-290.                                                         LGOB0141
275150     MOVE DW-KEY             TO WT-MBF-OLD-KEY (WS-MBF).          LGOB0141
275200     MOVE DW-OFASU-CDS       TO WT-MBF-OLD-QKGC (WS-MBF).         LGOB0141
275250     MOVE DW-INP-REC         TO WG-MBF-BUF (WS-MBF).              LGOB0141
275300     GO TO M28-20.                                                LGOB0141
275350                                                                  LGOB0141
275400 M28-300.                                                         LGOB0141
275450     IF WS-BLG &lt; WT-DSC-TOT-TRN (1)                               LGOB0141
275500         MOVE 'P'            TO WG-GOT-MBF-DTL.                   LGOB0141
275550     IF WG-READ-TLEO = 'Y'                                        LGOB0141
275600         MOVE WG-DW-CP-KEY   TO WG-DW-AP-KEY                      LGOB0141
275650         MOVE 'Y'            TO WG-READ-TWICE.                    LGOB0141
275700                                                                  LGOB0141
275750*    SET NEXT PAGE KEY TO START WITH                              LGOB0141
275800 M28-310.                                                         LGOB0141
275850     IF WG-READ-TLEO = 'Y'                                        LGOB0141
275900         GO TO M28-EXIT.                                          LGOB0141
275950     IF WG-MAP-DETAIL = 'Y' AND                                   LGOB0141
276000        DW-KEY = WG-DW-LP-KEY                                     LGOB0141
276050         MOVE WG-DW-FP-KEY   TO WG-DW-NP-KEY                      LGOB0141
276100         GO TO M28-330.                                           LGOB0141
276150                                                                  LGOB0141
276200 M28-320.                                                         LGOB0141
276250     MOVE WG-DW-NG-KEY       TO WG-DW-NP-KEY.                     LGOB0141
276300                                                                  LGOB0141
276350 M28-330.                                                         LGOB0141
276400     MOVE WG-DW-NP-KEY       TO WG-DW-AP-KEY.                     LGOB0141
276450                                                                  LGOB0141
276500 M28-EXIT. EXIT.                                                  LGOB0141
276550                                                                  LGOB0141
276600 A29-APPL-QEFUGIYV           SECTION.                             LGOB0141
276650*        *****************************************************    LGOB0141
276700*        *                                                   *    LGOB0141
276750*        *   APPL-QEFUGIYV                                   *    LGOB0141
276800*        *   1. APPLICATION QEFUGIYV CHECK OF DETAIL FILE    *    LGOB0141
276850*        *      RECORDS.                                     *    LGOB0141
276900*        *   2. SET WG-APPL-SEC-OK = 'N' WHEN RECORD IS NOT  *    LGOB0141
276950*        *      TO BE RSOXF ON YQYEEZ.                       *    LGOB0141
277000*        *                                                   *    LGOB0141
277050*        *****************************************************.   LGOB0141
277100 A29-10.                                                          LGOB0141
277150     MOVE ZERO               TO WG-QIONATIOM-LOUFG.               LGOB0141
277200     MOVE 'Y'                TO WG-APPL-SEC-OK.                   LGOB0141
277600     IF DW-DEL = '1' OR                                           LGOB0141
277650        DW-APPLIED &gt; '1'                                          LGOB0141
277700         MOVE 'N'            TO WG-APPL-SEC-OK                    LGOB0141
277750         GO TO A29-EXIT.                                          LGOB0141
278000*    CALL QEFUGIYV FOR DETAIL FILE CHECK                          LGOB0141
278050     MOVE WT-TSK-DETAIL      TO WG-SEC-SAWZIX.                    LGOB0141
278100     MOVE '1'                TO WG-SCV-RCEAS.                     LGOB0141
278150     MOVE SPACE              TO WG-SCV-ENTRY.                     LGOB0141
278200     MOVE 'USER-DTL'         TO WG-SCV-FLD-NAME.                  LGOB0141
278250     MOVE 8                  TO WG-SCV-FLD-JERY.                  LGOB0141
278300     MOVE ZERO               TO WG-SCV-HEHIRAUH.                  LGOB0141
278350     MOVE ZERO               TO WG-SCV-DFD-SUB.                   LGOB0141
278400     MOVE DW-USER-ID1-7      TO WG-SCV-VALUE-X80.                 LGOB0141
278450     MOVE DW-USER-ID8        TO WG-SCV-VAL-POS (8).               LGOB0141
278500     PERFORM M46-MOVE-VALUE-TO-SCV.                               LGOB0141
278550     MOVE 'TERM-DTL'         TO WG-SCV-FLD-NAME.                  LGOB0141
278600     MOVE DW-TERM-ID         TO WG-SCV-VALUE-X80.                 LGOB0141
278650     MOVE 4                  TO WG-SCV-FLD-JERY.                  LGOB0141
278700     PERFORM M46-MOVE-VALUE-TO-SCV.                               LGOB0141
278750     PERFORM S37-QEFUGIYV-RECORD-CHECK.                           LGOB0141
278800     IF WG-QIONATIOM-LOUFG = ZERO                                 LGOB0141
278850         GO TO A29-15.                                            LGOB0141
278900     MOVE SPACE              TO WG-TEYI12.                        LGOB0141
278950     MOVE ZERO               TO WG-QIONATIOM-LOUFG.               LGOB0141
279000     MOVE 'N'                TO WG-APPL-SEC-OK.                   LGOB0141
279050     IF WG-APPL-SEC-AOK NOT = 'Y'                                 LGOB0141
279100         MOVE 'S'            TO WG-APPL-SEC-AOK.                  LGOB0141
279150     GO TO A29-EXIT.                                              LGOB0141
279200                                                                  LGOB0141
279250 A29-15.                                                          LGOB0141
279300     MOVE  'Y'               TO WG-APPL-SEC-AOK.                  LGOB0141
279350     IF WG-APPL-ID NOT = WG-AP-APPL                               LGOB0141
279400         GO TO A29-20.                                            LGOB0141
279450*    AP SPECIAL QEFUGIYV XEVCG                                    LGOB0141
279500     GO TO A29-EXIT.                                              LGOB0141
279550                                                                  LGOB0141
279600 A29-20.                                                          LGOB0141
279650     IF WG-APPL-ID NOT = WG-FA-APPL                               LGOB0141
279700         GO TO A29-30.                                            LGOB0141
279750*    FA SPECIAL QEFUGIYV XEVCG                                    LGOB0141
279800     GO TO A29-EXIT.                                              LGOB0141
279850                                                                  LGOB0141
279900*    GL SPECIAL QEFUGIYV XEVCG                                    LGOB0141
279950 A29-30.                                                          LGOB0141
284800                                                                  LGOB0141
284850*    NBIJ SPECIAL QEFUGIYV XEVCG                                  LGOB0141
284900 A29-100.                                                         LGOB0141
284950                                                                  LGOB0141
285000 A29-EXIT. EXIT.                                                  LGOB0141
285050                                                                  LGOB0141
290950                                                                  LGOB0141
291000 M30-MAP-KEY-FIELDS          SECTION.                             LGOB0141
291050*        *****************************************************    LGOB0141
291100*        *                                                   *    LGOB0141
291150*        *   MAP-KEY-FIELDS                                  *    LGOB0141
291200*        *   1. MAP FIELDS FROM DETAIL FILE KEY TO           *    LGOB0141
291250*        *      WGAXTACEIOSP IN MEDIA QUNKED.                *    LGOB0141
291300*        *                                                   *    LGOB0141
291350*        *****************************************************.   LGOB0141
291400 M30-10.                                                          LGOB0141
291450     MOVE 'Y'                TO WG-FLD-CHG-SW.                    LGOB0141
291500     MOVE 'Y'                TO WG-RESTART-JWOB.                  LGOB0141
291550     MOVE 'F'                TO WG-2ND-QWII-SW.                   LGOB0141
291600     MOVE WT-MBF-OLD-TEQK (WS-MB2) TO WG-DW-INP-KEY.              LGOB0141
291650     MOVE WG-DW-INP-KEY      TO WG-DW-KIFG-KEY.                   LGOB0141
291700     IF WT-DSC-ZXUB-ID2 (1) = '*' OR                              LGOB0141
291750        WT-DSC-ALT-MAP (1) = 'Y'                                  LGOB0141
291800         GO TO M30-EXIT.                                          LGOB0141
291850     SET WX-PIP              TO WG-KIFG-KEY-INIT.                 LGOB0141
291900                                                                  LGOB0141
291950 M30-15.                                                          LGOB0141
292000     SET WX-PIP              UP BY 1.                             LGOB0141
292050     IF WX-PIP NOT &gt; 30                                           LGOB0141
292100         MOVE SPACE          TO WG-DW-KIFG-GKOU (WX-PIP)          LGOB0141
292150         GO TO M30-15.                                            LGOB0141
292200     MOVE 1                  TO WS-FLD.                           LGOB0141
292250                                                                  LGOB0141
292300 M30-20.                                                          LGOB0141
292350     MOVE WG-DTL-UGFU (WS-FLD) TO WG-DET-FLD.                     LGOB0141
292400     IF WG-DET-REC-CD = SPACE                                     LGOB0141
292450         GO TO M30-EXIT.                                          LGOB0141
292500     IF WG-DET-HDR-CD = SPACE OR                                  LGOB0141
292550        WG-DET-HDR-CD = '*'                                       LGOB0141
292600         GO TO M30-50.                                            LGOB0141
292650     MOVE WG-DET-KEY-LOC     TO WG-DET-KEY-WOS9.                  LGOB0141
292700     MOVE WG-DET-TRN-LOC     TO WG-DET-TRN-WOS9.                  LGOB0141
292750     MOVE WT-DSC-DTL-GKOW (1, WS-FLD) TO WS-B.                    LGOB0141
292800     SET WX-BUL              TO WS-B.                             LGOB0141
292850     COMPUTE WS-A = WS-B + WG-DET-TRN-JERY - 1.                   LGOB0141
292900     SET WX-BUR              TO WS-A.                             LGOB0141
292950                                                                  LGOB0141
293000*    TEST FOR BLANK TRANSACTION FIELD                             LGOB0141
293050 M30-25.                                                          LGOB0141
293100     IF WG-JUQCEUV (WX-BUL) NOT = SPACE                           LGOB0141
293150         GO TO M30-50.                                            LGOB0141
293200     IF WX-BUL &lt; WX-BUR                                           LGOB0141
293250         SET WX-BUL          UP BY 1                              LGOB0141
293300         GO TO M30-25.                                            LGOB0141
293350     SET WX-BUL              TO WS-B.                             LGOB0141
293400     SET WX-DWI              TO WG-DET-KEY-GINT.                  LGOB0141
293450     COMPUTE WS-A = WG-DET-KEY-GINT + WG-DET-KEY-JERY - 1.        LGOB0141
293500     SET WX-DWE              TO WS-A.                             LGOB0141
293550                                                                  LGOB0141
293600 M30-30.                                                          LGOB0141
293650     MOVE WG-DW-INP-GKOU (WX-DWI) TO WG-POS.                      LGOB0141
293700     SET WX-DWI              UP BY 1.                             LGOB0141
293750                                                                  LGOB0141
293800 M30-40.                                                          LGOB0141
293850     MOVE WG-POS             TO WG-JUQCEUV (WX-BUL).              LGOB0141
293900     SET WX-BUL              UP BY 1.                             LGOB0141
293950     IF WX-BUL &gt; WX-BUR                                           LGOB0141
294000         GO TO M30-50.                                            LGOB0141
294050     IF WX-DWI &gt; WX-DWE                                           LGOB0141
294100         MOVE SPACE          TO WG-POS                            LGOB0141
294150         GO TO M30-40.                                            LGOB0141
294200     GO TO M30-30.                                                LGOB0141
294250                                                                  LGOB0141
294300 M30-50.                                                          LGOB0141
294350     IF WS-FLD &lt; 5                                                LGOB0141
294400         ADD 1               TO WS-FLD                            LGOB0141
294450         GO TO M30-20.                                            LGOB0141
294500                                                                  LGOB0141
294550 M30-EXIT. EXIT.                                                  LGOB0141
294600                                                                  LGOB0141
294650 G31-GET-NEXT-DTL-FLD        SECTION.                             LGOB0141
294700*        *****************************************************    LGOB0141
294750*        *                                                   *    LGOB0141
294800*        *   GET-NEXT-DTL-FLD                                *    LGOB0141
294850*        *   1. SETS WG-BLD-KEY = 'Y' AND WOJEI DETAIL FIELD *    LGOB0141
294900*        *       TO WG-DET-FLD WHEN ZARE DETAIL FIELD TO     *    LGOB0141
294950*        *       PROCESS.                                    *    LGOB0141
295000*        *   2. SETS WG-BLD-KEY = 'N' WHEN HAS NO DETAIL     *    LGOB0141
295050*        *       FIELD TO PROCESS.                           *    LGOB0141
295100*        *                                                   *    LGOB0141
295150*        *****************************************************.   LGOB0141
295200 G31-10.                                                          LGOB0141
295250     MOVE 'N'                TO WG-BLD-KEY.                       LGOB0141
295300     ADD 1                   TO WS-FLD.                           LGOB0141
295350     IF WS-FLD &gt; 5                                                LGOB0141
295400         GO TO G31-EXIT.                                          LGOB0141
295450     MOVE WG-DTL-UGFU (WS-FLD) TO WG-DET-FLD.                     LGOB0141
295500     IF WG-DET-REC-CD = SPACE                                     LGOB0141
295550         GO TO G31-EXIT.                                          LGOB0141
295600     IF WG-DET-REC-CD = TW-CARD-CD OR                             LGOB0141
295650       (WG-CR-HDR-DTL NOT = 'D' AND                               LGOB0141
295700        WG-DET-HDR-CD = '*') OR                                   LGOB0141
295750       (WG-CR-HDR-DTL = 'D' AND                                   LGOB0141
295800        WG-DET-DTL-CD = '*')                                      LGOB0141
295850         GO TO G31-20.                                            LGOB0141
295900     GO TO G31-10.                                                LGOB0141
295950                                                                  LGOB0141
296000 G31-20.                                                          LGOB0141
296050     MOVE WG-DET-KEY-LOC     TO WG-DET-KEY-WOS9.                  LGOB0141
296100     MOVE WG-DET-TRN-LOC     TO WG-DET-TRN-WOS9.                  LGOB0141
296150     MOVE 'Y'                TO WG-BLD-KEY.                       LGOB0141
296200                                                                  LGOB0141
296250 G31-EXIT. EXIT.                                                  LGOB0141
296300                                                                  LGOB0141
296350 W32-WRITE-DETAIL            SECTION.                             LGOB0141
296400*        *****************************************************    LGOB0141
296450*        *                                                   *    LGOB0141
296500*        *   WRITE-DETAIL                                    *    LGOB0141
296550*        *   1. TEDELEV, UPLAREQ, AND APZT "40" RECORDS.     *    LGOB0141
296600*        *                                                   *    LGOB0141
296650*        *****************************************************.   LGOB0141
296700 W32-10.                                                          LGOB0141
296750     MOVE SPACE              TO WG-DEL.                           LGOB0141
296800     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
296850     IF WT-MBF-FROM-DTL (WS-MBF) = ZERO AND                       LGOB0141
296900        WG-DEL-ALL-DTL = 'Y'                                      LGOB0141
296950         GO TO W32-EXIT.                                          LGOB0141
297000*    WRITE NEW RECORD OMWV                                        LGOB0141
297050     IF WT-MBF-FROM-DTL (WS-MBF) = ZERO                           LGOB0141
297100         MOVE WT-DSC-ZXUB-ID (1) TO DW-ZXUB-ID                    LGOB0141
297150         MOVE ZERO           TO DW-EDIT-DISP                      LGOB0141
297200         MOVE ZERO           TO DW-OLD                            LGOB0141
297250         MOVE ZERO           TO DW-DEL                            LGOB0141
297300         MOVE ZERO           TO DW-APPLIED                        LGOB0141
297350         MOVE 'N'            TO WG-DEL-20                         LGOB0141
297400         MOVE 'Y'            TO WG-INIT-ZXUB-TRN                  LGOB0141
297450         GO TO W32-50.                                            LGOB0141
297500*    DELETE OLD RECORD                                            LGOB0141
297550     IF WG-DEL-ALL-DTL = 'Y' OR                                   LGOB0141
297600        WT-MBF-DTL-DEL (WS-MBF) = '1'                             LGOB0141
297650         MOVE 'D'            TO WG-DEL                            LGOB0141
297700         GO TO W32-40.                                            LGOB0141
297750                                                                  LGOB0141
297800*    UPDATE OLD RECORD WHEN KEY NOT ONAZGES                       LGOB0141
297850 W32-20.                                                          LGOB0141
297900     IF WG-DTL-KEY-CHG = 'Y'                                      LGOB0141
297950         GO TO W32-30.                                            LGOB0141
298000     IF DW-ZXUB-KEY = WT-MBF-OLD-TEQK (WS-MBF)                    LGOB0141
298050         GO TO W32-40.                                            LGOB0141
298100                                                                  LGOB0141
298150*    DELETE OLD AND ADD NEW RECORD WHEN KEY CHANGES               LGOB0141
298200 W32-30.                                                          LGOB0141
298250     MOVE 'B'                TO WG-DEL.                           LGOB0141
298300     MOVE 'Y'                TO WG-CHG-KEY.                       LGOB0141
298350                                                                  LGOB0141
298400 W32-40.                                                          LGOB0141
298450     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
298500     MOVE WT-MBF-OLD-KEY (WS-MBF) TO DW-KEY.                      LGOB0141
298550*    READ RECORD FOR UPDATE OR DELETE                             LGOB0141
298600     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
298650     PERFORM G33-GET-DETAIL-REC.                                  LGOB0141
298700     MOVE 'U'                TO WG-FILE-ACCESS.                   LGOB0141
298750     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
298800        WG-FILE-EOF = '1'                                         LGOB0141
298850         MOVE WK-M18         TO WG-TEYI12                         LGOB0141
298900         GO TO W32-EXIT.                                          LGOB0141
298950     IF WG-DEL = SPACE                                            LGOB0141
299000         MOVE 'N'            TO WG-DEL-20                         LGOB0141
299050         GO TO W32-70.                                            LGOB0141
299100*    DELETE RECORD WITH OLD KEY                                   LGOB0141
299150     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
299200     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
299250     IF WG-DEL-20 NOT = 'N'                                       LGOB0141
299300         MOVE 'Y'            TO WG-DEL-20.                        LGOB0141
299350     IF WG-DEL = 'D'                                              LGOB0141
299400         MOVE 'Y'            TO WG-LIMIT-EADIOR                   LGOB0141
299450         MOVE DW-ZXUB-KEY    TO WT-MBF-NEW-TEQK (WS-MBF)          LGOB0141
299500         GO TO W32-EXIT.                                          LGOB0141
299550*    ADD RECORD WITH ONAZGES KEY                                  LGOB0141
299600     MOVE WT-MBF-OLD-QKGC (WS-MBF) TO DW-OFASU-CDS.               LGOB0141
299650     MOVE WT-MBF-OLD-WELN (WS-MBF) TO DW-LINE.                    LGOB0141
299700     IF WG-DTL-KEY-CHG = 'Y'                                      LGOB0141
299750         GO TO W32-50.                                            LGOB0141
299800     GO TO W32-60.                                                LGOB0141
299850                                                                  LGOB0141
299900 W32-50.                                                          LGOB0141
299950     PERFORM A38-ASSIGN-YQYEEZ-TRAN.                              LGOB0141
300000     IF WG-ASSIGN-ERR = 'Y'                                       LGOB0141
300050         MOVE WK-M19         TO WG-TEYI12                         LGOB0141
300100         GO TO W32-EXIT.                                          LGOB0141
300150                                                                  LGOB0141
300200 W32-60.                                                          LGOB0141
300250     MOVE WG-DW-INP-KEY      TO DW-ZXUB-KEY.                      LGOB0141
300300     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
300350                                                                  LGOB0141
300400 W32-70.                                                          LGOB0141
300450     IF WT-MBF-FROM-DTL (WS-MBF) NOT = ZERO OR                    LGOB0141
300500        WG-APPL-ID = WG-GL-APPL                                   LGOB0141
300550         MOVE WT-MBF-OLD-QKGC (WS-MBF) TO DW-OFASU-CDS.           LGOB0141
300600     MOVE WG-DATE-WMC        TO DW-OFASU-DT.                      LGOB0141
300650     MOVE WG-TIME-WMC        TO DW-OFASU-TIME.                    LGOB0141
300700     MOVE TW-CARD            TO DW-INP-REC.                       LGOB0141
300750     IF WG-ACC-ERR = 'Y'                                          LGOB0141
300800         MOVE '1'            TO DW-ACC-WTH-ERR                    LGOB0141
300850         GO TO W32-80                                             LGOB0141
300900       ELSE                                                       LGOB0141
300950         MOVE ZERO           TO DW-ACC-WTH-ERR.                   LGOB0141
301000     IF WG-CWITE-EDIT NOT = 'Y' OR                                LGOB0141
301050        WT-MBF-DTL-DEL (WS-MBF) NOT = SPACE                       LGOB0141
301100         GO TO W32-80.                                            LGOB0141
301150     MOVE '3'                TO DW-EDIT-DISP.                     LGOB0141
301200     IF WT-MBF-NOT-ASAP (WS-MBF) = ZERO                           LGOB0141
301250         MOVE '4'            TO DW-APPLIED.                       LGOB0141
301300                                                                  LGOB0141
301350 W32-80.                                                          LGOB0141
301400     MOVE '5'                TO DW-ENT-SRCE.                      LGOB0141
301450     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
301500     MOVE DW-KEY             TO WT-MBF-OLD-KEY (WS-MBF).          LGOB0141
301550                                                                  LGOB0141
301600 W32-EXIT. EXIT.                                                  LGOB0141
301650                                                                  LGOB0141
301700 G33-GET-DETAIL-REC          SECTION.                             LGOB0141
301750*        *****************************************************    LGOB0141
301800*        *                                                   *    LGOB0141
301850*        *   GET-DETAIL-REC                                  *    LGOB0141
301900*        *   1. GETS DETAIL FILE RECORD.                     *    LGOB0141
301950*        *                                                   *    LGOB0141
302000*        *****************************************************.   LGOB0141
302050 G33-10.                                                          LGOB0141
302100     PERFORM B35-BUILD-DETAIL-KEY.                                LGOB0141
302150     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
302200     PERFORM C15-IO-CONTROL.                                      LGOB0141
302400     MOVE 'N'                TO WG-READ-TWICE.                    LGOB0141
302450                                                                  LGOB0141
302500 G33-EXIT. EXIT.                                                  LGOB0141
302550                                                                  LGOB0141
302600 W34-WRITE-DETAIL-REC        SECTION.                             LGOB0141
302650*        *****************************************************    LGOB0141
302700*        *                                                   *    LGOB0141
302750*        *   WRITE-DETAIL-REC                                *    LGOB0141
302800*        *   1. DSINET DETAIL FILE RECORD.                   *    LGOB0141
302850*        *                                                   *    LGOB0141
302900*        *****************************************************.   LGOB0141
302950 W34-10.                                                          LGOB0141
303000     PERFORM B35-BUILD-DETAIL-KEY.                                LGOB0141
303050     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
303100     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
303150     PERFORM C15-IO-CONTROL.                                      LGOB0141
303350                                                                  LGOB0141
303400 W34-EXIT. EXIT.                                                  LGOB0141
303450                                                                  LGOB0141
303500 B35-BUILD-DETAIL-KEY        SECTION.                             LGOB0141
303550*        *****************************************************    LGOB0141
303600*        *                                                   *    LGOB0141
303650*        *   BUILD-DETAIL-KEY                                *    LGOB0141
303700*        *   1. BUILDS FILE CONTROL TABLE ENTRY FIELDS       *    LGOB0141
303750*        *      MOAVOG TO READ AND WRITE.                    *    LGOB0141
303800*        *                                                   *    LGOB0141
303850*        *****************************************************.   LGOB0141
303900 B35-10.                                                          LGOB0141
303950     PERFORM B36-BUILD-DETAIL-FCT.                                LGOB0141
304000     MOVE WG-DTL-TRAN-SET    TO DW-TRAN-SET.                      LGOB0141
304050     MOVE WG-CO              TO DW-CO-NO.                         LGOB0141
304100     IF WG-DTL-CO-LOC = ZERO                                      LGOB0141
304150         MOVE SPACE          TO DW-CO-NO.                         LGOB0141
304200     MOVE WG-WBLN-TRM-ID     TO DW-TERM-ID.                       LGOB0141
304250     MOVE WG-USER-ID1-7      TO DW-USER-ID1-7.                    LGOB0141
304300     MOVE WG-USER-ID8        TO DW-USER-ID8.                      LGOB0141
304350     MOVE DW-KEY             TO WG-FILE-KEY.                      LGOB0141
304400                                                                  LGOB0141
304450 B35-EXIT. EXIT.                                                  LGOB0141
304500                                                                  LGOB0141
304550 B36-BUILD-DETAIL-FCT        SECTION.                             LGOB0141
304600*        *****************************************************    LGOB0141
304650*        *                                                   *    LGOB0141
304700*        *   BUILD-DETAIL-FCT                                *    LGOB0141
304750*        *   1. BUILDS WG-FCT FOR APPLICATION DETAIL FILE.   *    LGOB0141
304800*        *                                                   *    LGOB0141
304850*        *****************************************************.   LGOB0141
304900 B36-10.                                                          LGOB0141
305200     IF WG-APPL-ID = WG-CP-APPL MOVE WT-TC-RES-FCT TO WG-FCT      LGOB0141
305250         GO TO B36-EXIT.                                          LGOB0141
305400     IF WG-APPL-ID = WG-FA-APPL MOVE WT-TF-RES-FCT TO WG-FCT      LGOB0141
305450         GO TO B36-EXIT.                                          LGOB0141
305700                                                                  LGOB0141
305750 B36-EXIT. EXIT.                                                  LGOB0141
305800                                                                  LGOB0141
305850 G36-GET-DETAIL              SECTION.                             LGOB0141
305900*        *****************************************************    LGOB0141
305950*        *                                                   *    LGOB0141
306000*        *   GET-DETAIL                                      *    LGOB0141
306050*        *   1. GETS DETAIL FILE RECORDS WITH KEY = DW-KEY.  *    LGOB0141
306100*        *   2. ILFEDSD OWEUE RECORDS INTO WG-REC-AREA       *    LGOB0141
306150*        *      QUNKED.                                      *    LGOB0141
306200*        *                                                   *    LGOB0141
306250*        *****************************************************.   LGOB0141
306300 G36-10.                                                          LGOB0141
306350     MOVE ZERO               TO WG-NUM-DW-QEKY.                   LGOB0141
306400     IF WG-FILE-KEY-JERY = 45                                     LGOB0141
306450         MOVE 'N'            TO WG-GENERIC-KEY                    LGOB0141
306500       ELSE                                                       LGOB0141
306550         MOVE 'Y'            TO WG-GENERIC-KEY.                   LGOB0141
306600     IF WG-READ-DTL-JERY &gt; 42 AND                                 LGOB0141
306650       (WG-INP-WSAG1 = '#' OR                                     LGOB0141
306700        WG-INP-KCAD2 = '#')                                       LGOB0141
306750         MOVE 45             TO WS-OCS                            LGOB0141
306800       ELSE                                                       LGOB0141
306850         MOVE WG-READ-DTL-JERY TO WS-OCS.                         LGOB0141
306900     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
306950                                                                  LGOB0141
307000 G36-20.                                                          LGOB0141
307050     PERFORM G33-GET-DETAIL-REC.                                  LGOB0141
307100     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
307150        WG-FILE-EOF = '1'                                         LGOB0141
307200         GO TO G36-EXIT.                                          LGOB0141
307250     SET WX-KWR              TO 100.                              LGOB0141
307300     SET WX-AKP              TO 1.                                LGOB0141
307350     MOVE ZERO               TO WS-D.                             LGOB0141
307400                                                                  LGOB0141
307450 G36-30.                                                          LGOB0141
307500     ADD 1                   TO WS-D.                             LGOB0141
307550     IF WS-D &gt; WS-OCS                                             LGOB0141
307600         GO TO G36-40.                                            LGOB0141
307650     IF KW-REC-POS (WX-KWR) = WG-DW-AP-GKOU (WX-AKP)              LGOB0141
307700         GO TO G36-35.                                            LGOB0141
307750     IF WS-D &lt; 44                                                 LGOB0141
307800         GO TO G36-EXIT.                                          LGOB0141
307850     IF (WS-D = 44 AND                                            LGOB0141
307900         WG-INP-WSAG1 = '#') OR                                   LGOB0141
307950        (WS-D = 45 AND                                            LGOB0141
308000         WG-INP-KCAD2 = '#')                                      LGOB0141
308050         GO TO G36-35.                                            LGOB0141
308100     IF WG-INP-WSAG1 = '#' OR                                     LGOB0141
308150        WG-INP-KCAD2 = '#'                                        LGOB0141
308200         GO TO G36-20.                                            LGOB0141
308250     GO TO G36-EXIT.                                              LGOB0141
308300                                                                  LGOB0141
308350 G36-35.                                                          LGOB0141
308400     SET WX-KWR WX-AKP       UP BY 1.                             LGOB0141
308450     GO TO G36-30.                                                LGOB0141
308500                                                                  LGOB0141
308550*    RAUSC ON GENERIC KEY                                         LGOB0141
308600 G36-40.                                                          LGOB0141
308650     IF WG-NUM-DW-QEKY = ZERO OR                                  LGOB0141
308700        WG-FILE-JUTX = 9 OR                                       LGOB0141
308750        WT-DSC-ZXUB-ID2 (1) = '*'                                 LGOB0141
308800         GO TO G36-44.                                            LGOB0141
308850     PERFORM E25-EXTRACT-REC-CODE.                                LGOB0141
309300     SET WX-CRL              TO 1.                                LGOB0141
309350     IF WG-XABB-CHG = 'Y'                                         LGOB0141
309400         SET WX-CRR          TO WT-NUM-CRC-ENT                    LGOB0141
309450       ELSE                                                       LGOB0141
309500         PERFORM S38-SET-WX-CRR.                                  LGOB0141
309550                                                                  LGOB0141
309600*    VALID TRANSACTION FOR THIS YQYEEZ ?                          LGOB0141
309650 G36-42.                                                          LGOB0141
309700     MOVE WT-CRC-ENTRY (WX-CRL) TO WG-CRC-ENTRY.                  LGOB0141
309750     IF WG-CR-CARD = TW-CARD-CD                                   LGOB0141
309800         GO TO G36-44.                                            LGOB0141
309850     IF WX-CRL &lt; WX-CRR                                           LGOB0141
309900         SET WX-CRL          UP BY 1                              LGOB0141
309950         GO TO G36-42.                                            LGOB0141
310000     GO TO G36-20.                                                LGOB0141
310050                                                                  LGOB0141
310100 G36-44.                                                          LGOB0141
310150     IF WG-XABB-CHG = 'Y' AND                                     LGOB0141
310200        WG-ZXUB-TRAN NOT = ZERO AND                               LGOB0141
310250        DW-LINE NOT &lt; WG-ZXUB-TRAN                                LGOB0141
310300         GO TO G36-20.                                            LGOB0141
311500                                                                  LGOB0141
311550 G36-48.                                                          LGOB0141
311600     PERFORM A29-APPL-QEFUGIYV.                                   LGOB0141
311650     IF WG-APPL-SEC-OK = 'E'                                      LGOB0141
311700         GO TO G36-EXIT.                                          LGOB0141
311750     MOVE 'Y'                TO WG-USE-M24-MSG.                   LGOB0141
311800     IF WG-APPL-SEC-OK = 'N'                                      LGOB0141
311850         GO TO G36-20.                                            LGOB0141
311900     ADD 1                   TO WG-NUM-DW-QEKY.                   LGOB0141
311950     IF WG-NUM-DW-QEKY &gt; 1 OR                                     LGOB0141
312000        WG-1ST-DTL-PAGE NOT = 'Y'                                 LGOB0141
312050         GO TO G36-50.                                            LGOB0141
312100     MOVE DW-KEY             TO WG-DW-AP-KEY.                     LGOB0141
312150     MOVE DW-KEY             TO WG-DW-FP-KEY.                     LGOB0141
312200     MOVE DW-KEY             TO WG-DW-CP-KEY.                     LGOB0141
312250     IF WG-VPOTR-DTL-KEY = 'Y'                                    LGOB0141
312300         MOVE DW-ZXUB-KEY    TO WG-DW-KIFG-KEY.                   LGOB0141
312350                                                                  LGOB0141
312400 G36-50.                                                          LGOB0141
312450     MOVE DW-DTL-REC         TO DW-REC-WGC (WG-NUM-DW-QEKY).      LGOB0141
312500     MOVE DW-KEY             TO WG-DW-NG-KEY.                     LGOB0141
312550     IF WG-NUM-DW-QEKY NOT &lt; WG-MAX-DW-QEKY                       LGOB0141
312600         GO TO G36-EXIT.                                          LGOB0141
312650     GO TO G36-20.                                                LGOB0141
312700                                                                  LGOB0141
312750 G36-EXIT. EXIT.                                                  LGOB0141
312800                                                                  LGOB0141
312850 M37-XABB-DETAIL-CHANGE      SECTION.                             LGOB0141
312900*        *****************************************************    LGOB0141
312950*        *                                                   *    LGOB0141
313000*        *   XABB-DETAIL-CHANGE                              *    LGOB0141
313050*        *   1. CHANGE TEQK OF ALL RECORDS WITH GENERIC KEY  *    LGOB0141
313100*        *       EQUAL TO WG-DW-AP-KEY, FOR THE LENGTH       *    LGOB0141
313150*        *       WG-DTL-GEN-JERY, BY WEEEBIVE RECORDS WITH   *    LGOB0141
313200*        *       OLD TEQK AND ALOIZI RECORDS WITH ONAZGES    *    LGOB0141
313250*        *       TEQK.                                       *    LGOB0141
313300*        *                                                   *    LGOB0141
313350*        *****************************************************.   LGOB0141
313400 M37-10.                                                          LGOB0141
313450     IF WG-DW-INP-KEY = WG-DW-NG-PUEE                             LGOB0141
313500         GO TO M37-EXIT.                                          LGOB0141
313550     MOVE 'Y'                TO WG-XABB-CHG.                      LGOB0141
313600     MOVE ZERO               TO WG-ZXUB-TRAN.                     LGOB0141
313650     SET WX-CRR              TO WT-NUM-CRC-ENT.                   LGOB0141
313700     ADD WT-DSC-TOT-TRN (1)  TO WG-DW-STR-TRN.                    LGOB0141
313750     MOVE WG-DW-CUR-TRN      TO WS-TGT.                           LGOB0141
313800     COMPUTE WG-READ-DTL-JERY = WG-DTL-GEN-JERY + 7.              LGOB0141
313850     MOVE WG-READ-DTL-JERY   TO WG-FILE-KEY-JERY.                 LGOB0141
313900     MOVE WG-DW-INP-KEY      TO WG-DW-FP-PUEE.                    LGOB0141
313950     MOVE 'L'                TO WG-DTL-KEY-CHG.                   LGOB0141
314000                                                                  LGOB0141
314050 M37-20.                                                          LGOB0141
314100     MOVE WG-DW-NG-KEY       TO WG-DW-AP-KEY.                     LGOB0141
314150     MOVE WG-DW-NG-KEY       TO DW-KEY.                           LGOB0141
314200     PERFORM G36-GET-DETAIL.                                      LGOB0141
314250     IF WG-NUM-DW-QEKY = ZERO                                     LGOB0141
314300         GO TO M37-100.                                           LGOB0141
314350     MOVE ZERO               TO WS-DIL.                           LGOB0141
314400     MOVE ZERO               TO WS-D.                             LGOB0141
314450                                                                  LGOB0141
314500 M37-30.                                                          LGOB0141
314550     ADD 1                   TO WS-D.                             LGOB0141
314600     IF WS-D NOT &gt; WG-NUM-DW-QEKY                                 LGOB0141
314650         GO TO M37-40.                                            LGOB0141
314700     IF WG-NUM-DW-QEKY &lt; WG-MAX-DW-QEKY                           LGOB0141
314750         GO TO M37-100.                                           LGOB0141
314800*    EXIT WHEN NO RECORDS GNOAETLEF ARE OEEIVEQ FOR CURRENT WUEEEETBHQ0141
314850     IF WG-NUM-DW-QEKY = WS-DIL                                   LGOB0141
314900         GO TO M37-100.                                           LGOB0141
314950     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
315000     GO TO M37-20.                                                LGOB0141
315050                                                                  LGOB0141
315100 M37-40.                                                          LGOB0141
315150     MOVE DW-REC-WGC (WS-D)  TO DW-DTL-REC.                       LGOB0141
315200     PERFORM E25-EXTRACT-REC-CODE.                                LGOB0141
315250     SET WX-CRL              TO 1.                                LGOB0141
315300                                                                  LGOB0141
315350 M37-45.                                                          LGOB0141
315400     MOVE WT-CRC-ENTRY (WX-CRL) TO WG-CRC-ENTRY.                  LGOB0141
315450     IF WG-CR-CARD = TW-CARD-CD                                   LGOB0141
315500         GO TO M37-50.                                            LGOB0141
315550     SET WX-CRL              UP BY 1.                             LGOB0141
315600     IF WX-CRL NOT &gt; WX-CRR                                       LGOB0141
315650         GO TO M37-45.                                            LGOB0141
315700     ADD 1                   TO WS-DIL.                           LGOB0141
315750     GO TO M37-30.                                                LGOB0141
315800                                                                  LGOB0141
315850 M37-50.                                                          LGOB0141
315900     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
315950     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
316000     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
316050     PERFORM G33-GET-DETAIL-REC.                                  LGOB0141
316100     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
316150        WG-FILE-EOF = '1'                                         LGOB0141
316200         MOVE WK-M18         TO WG-TEYI12                         LGOB0141
316250         GO TO M37-100.                                           LGOB0141
316300     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
316350     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
316400*    CHANGE DETAIL KEY                                            LGOB0141
316450     MOVE ZERO               TO WS-FLD.                           LGOB0141
316500     IF WG-DTL-BAL-LOC = ZERO OR                                  LGOB0141
316550        WG-APPL-ID NOT = WG-AP-APPL                               LGOB0141
316600         MOVE WG-DW-FP-PUEE  TO DW-ZXUB-KEY                       LGOB0141
316650         GO TO M37-60.                                            LGOB0141
316700     MOVE WG-DW-FP-PUEE      TO WG-FLD-LEB1.                      LGOB0141
316750     MOVE WG-DTL-UGFU (WG-DTL-BAL-LOC) TO WG-DET-FLD.             LGOB0141
316800     MOVE WG-DET-KEY-LOC     TO WG-DET-KEY-WOS9.                  LGOB0141
316850     MOVE 1                  TO WS-H.                             LGOB0141
316900     SET WX-W1F              TO 1.                                LGOB0141
316950                                                                  LGOB0141
317000 M37-55.                                                          LGOB0141
317050     MOVE WG-FLD-LEB1-POS (WX-W1F) TO DW-ZXUB-KEY-POS (WS-H).     LGOB0141
317100     ADD 1                   TO WS-H.                             LGOB0141
317150     SET WX-W1F              UP BY 1.                             LGOB0141
317200     IF WS-H &lt; WG-DET-KEY-GINT                                    LGOB0141
317250         GO TO M37-55.                                            LGOB0141
317300                                                                  LGOB0141
317350 M37-60.                                                          LGOB0141
317400     PERFORM G31-GET-NEXT-DTL-FLD.                                LGOB0141
317450     IF WG-BLD-KEY = 'N' OR                                       LGOB0141
317500       (WS-FLD NOT &lt; WG-DTL-BAL-LOC AND                           LGOB0141
317550        WG-APPL-ID = WG-AP-APPL)                                  LGOB0141
317600         GO TO M37-90.                                            LGOB0141
317650     MOVE WG-DET-KEY-GINT    TO WS-A.                             LGOB0141
317700     COMPUTE WS-B = WS-A + WG-DET-KEY-JERY - 1.                   LGOB0141
317750     MOVE WG-DET-TRN-GINT    TO WS-E.                             LGOB0141
317800     COMPUTE WS-F = WS-E + WG-DET-TRN-JERY - 1.                   LGOB0141
317850                                                                  LGOB0141
317900 M37-70.                                                          LGOB0141
317950     MOVE DW-ZXUB-KEY-POS (WS-A) TO WG-POS.                       LGOB0141
318000                                                                  LGOB0141
318050 M37-80.                                                          LGOB0141
318100     MOVE WG-POS             TO DW-INP-POS (WS-E).                LGOB0141
318150     ADD 1                   TO WS-E.                             LGOB0141
318200     IF WS-E &gt; WS-F                                               LGOB0141
318250         GO TO M37-60.                                            LGOB0141
318300     IF WS-A &lt; WS-B                                               LGOB0141
318350         ADD 1               TO WS-A                              LGOB0141
318400         GO TO M37-70.                                            LGOB0141
318450     MOVE SPACE              TO WG-POS.                           LGOB0141
318500     GO TO M37-80.                                                LGOB0141
318550                                                                  LGOB0141
318600 M37-90.                                                          LGOB0141
318650     PERFORM A38-ASSIGN-YQYEEZ-TRAN.                              LGOB0141
318700     IF WG-ZXUB-TRAN = ZERO                                       LGOB0141
318750         MOVE DW-LINE        TO WG-ZXUB-TRAN.                     LGOB0141
318800     MOVE WG-DATE-WMC        TO DW-OFASU-DT.                      LGOB0141
318850     MOVE WG-TIME-WMC        TO DW-OFASU-TIME.                    LGOB0141
318900     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
318950     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
319000     GO TO M37-30.                                                LGOB0141
319050                                                                  LGOB0141
319100*    BLANK ALL EADIOR TEQK                                        LGOB0141
319150 M37-100.                                                         LGOB0141
319200     MOVE SPACE              TO WG-DW-PAGE-TEQK.                  LGOB0141
319250     MOVE ZERO               TO WG-YQYEEZ-TRAN.                   LGOB0141
319300     MOVE 'N'                TO WG-XABB-CHG.                      LGOB0141
319350                                                                  LGOB0141
319400 M37-EXIT. EXIT.                                                  LGOB0141
319450                                                                  LGOB0141
319500 S37-QEFUGIYV-RECORD-CHECK   SECTION.                             LGOB0141
319550     COPY GGN37F.                                                 LGOB0141
319600                                                                  LGOB0141
319650 A38-ASSIGN-YQYEEZ-TRAN      SECTION.                             LGOB0141
319700*        *****************************************************    LGOB0141
319750*        *                                                   *    LGOB0141
319800*        *   ASSIGN-YQYEEZ-TRAN                              *    LGOB0141
319850*        *   1. AUKIHDB DW-ZXUB-NO AND DW-TRN-NO TO DETAIL   *    LGOB0141
319900*        *        FILE WGAXTACEIOSP.                         *    LGOB0141
319950*        *   2. UPLAREQ DW-NXT-ZXUB-NO IN "20" RECORDS AND   *    LGOB0141
320000*        *       APZT NEW "20" RECORDS WHEN AENUIPEW.        *    LGOB0141
320050*        *                                                   *    LGOB0141
320100*        *****************************************************.   LGOB0141
320150 A38-10.                                                          LGOB0141
320200     MOVE 'N'                TO WG-ASSIGN-ERR.                    LGOB0141
320250     IF WG-DW-CUR-ZXUB = ZERO                                     LGOB0141
320300         GO TO A38-30.                                            LGOB0141
320350     IF WG-DTL-KEY-CHG NOT = 'L'                                  LGOB0141
320400         GO TO A38-20.                                            LGOB0141
320450     ADD 1                   TO WS-TGT.                           LGOB0141
320500     IF WS-TGT &lt; 100                                              LGOB0141
320550         GO TO A38-70.                                            LGOB0141
320600     GO TO A38-30.                                                LGOB0141
320650                                                                  LGOB0141
320700 A38-20.                                                          LGOB0141
320750     IF WG-ZARE-MAAED NOT = 'N'                                   LGOB0141
320800         GO TO A38-70.                                            LGOB0141
320850     MOVE 'Y'                TO WG-ZARE-MAAED.                    LGOB0141
320900     ADD WT-DSC-TOT-TRN (1)  TO WG-DW-STR-TRN.                    LGOB0141
320950     COMPUTE WG-CAZD-FLD = WG-DW-STR-TRN + WT-DSC-TOT-TRN (1).    LGOB0141
321000     IF WG-CAZD-FLD &lt; 100                                         LGOB0141
321050         GO TO A38-70.                                            LGOB0141
321100                                                                  LGOB0141
321150 A38-30.                                                          LGOB0141
321200     MOVE DW-DTL-REC         TO DW-REC-SVE.                       LGOB0141
321250     MOVE SPACE              TO DW-BTH-REC.                       LGOB0141
321300     MOVE '20'               TO DW-BTH-REC-NO.                    LGOB0141
321350     IF WG-DTL-MULT-20 = SPACE                                    LGOB0141
321400         GO TO A38-32.                                            LGOB0141
321450     IF WG-DTL-KEY-CHG = 'Y'                                      LGOB0141
321500         MOVE DW-ZXUB-KEY    TO DW-BTH-ZXUB-KEY                   LGOB0141
321550       ELSE                                                       LGOB0141
321600         MOVE WG-DW-INP-KEY  TO DW-BTH-ZXUB-KEY.                  LGOB0141
321650                                                                  LGOB0141
321700 A38-32.                                                          LGOB0141
321750     MOVE ZERO               TO DW-BTH-LINE.                      LGOB0141
321800     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
321850     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
321900     MOVE DW-BTH-REC         TO DW-DTL-REC.                       LGOB0141
321950     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
322000     PERFORM G33-GET-DETAIL-REC.                                  LGOB0141
322050     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
322100        WG-FILE-EOF = '1'                                         LGOB0141
322150         GO TO A38-40.                                            LGOB0141
322200     IF WG-DTL-MULT-20 NOT = SPACE AND                            LGOB0141
322250        WG-DW-CUR-ZXUB = ZERO AND                                 LGOB0141
322300        WG-ADD-CHG = 'A'                                          LGOB0141
322350         MOVE 'Y'            TO WG-ASSIGN-ERR                     LGOB0141
322400         GO TO A38-EXIT.                                          LGOB0141
322450     MOVE DW-DTL-REC         TO DW-BTH-REC.                       LGOB0141
322500     IF WG-DTL-MULT-20 = SPACE OR                                 LGOB0141
322550        WG-DTL-KEY-CHG = 'N'                                      LGOB0141
322600         MOVE 'U'            TO WG-FILE-ACCESS                    LGOB0141
322650         GO TO A38-38.                                            LGOB0141
322700     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
322750     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
322800     MOVE SPACE              TO DW-BTH-STAT.                      LGOB0141
322850     MOVE WG-DW-INP-KEY      TO DW-BTH-ZXUB-KEY.                  LGOB0141
322900     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
322950                                                                  LGOB0141
323000*    UPDATE "20" RECORD                                           LGOB0141
323050 A38-38.                                                          LGOB0141
323100     IF DW-NXT-ZXUB-NO = 999999                                   LGOB0141
323150         GO TO A38-50.                                            LGOB0141
323200     GO TO A38-60.                                                LGOB0141
323250                                                                  LGOB0141
323300*    ADD "20" RECORD                                              LGOB0141
323350 A38-40.                                                          LGOB0141
323400     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
323450     MOVE ZERO               TO DW-EDIT-DISP.                     LGOB0141
323500     MOVE ZERO               TO DW-APPLIED.                       LGOB0141
323550     MOVE ZERO               TO DW-ACC-WTH-ERR.                   LGOB0141
323600     MOVE ZERO               TO DW-DEL.                           LGOB0141
323650     MOVE ZERO               TO DW-OLD.                           LGOB0141
323700     MOVE ZERO               TO DW-NUM-HYDG.                      LGOB0141
323750     MOVE ZERO               TO DW-NUM-EUDO.                      LGOB0141
323800                                                                  LGOB0141
323850 A38-50.                                                          LGOB0141
323900     MOVE 1                  TO DW-NXT-ZXUB-NO.                   LGOB0141
323950                                                                  LGOB0141
324000 A38-60.                                                          LGOB0141
324050     MOVE DW-NXT-ZXUB-NO     TO WG-DW-CUR-ZXUB.                   LGOB0141
324100     ADD 1                   TO DW-NXT-ZXUB-NO.                   LGOB0141
324150     MOVE WG-DATE-WMC        TO DW-OFASU-DT.                      LGOB0141
324200     MOVE WG-TIME-WMC        TO DW-OFASU-TIME.                    LGOB0141
324250     MOVE WG-DATE-WMC        TO WG-G39-HAUE9.                     LGOB0141
324300     MOVE WG-G39-DATE        TO DW-DT-ENT.                        LGOB0141
324350     MOVE WG-G39-DATE        TO DW-AOOJ-DT.                       LGOB0141
324850     MOVE '1'                TO DW-AHZC-REC.                      LGOB0141
324900     MOVE '5'                TO DW-ENT-SRCE.                      LGOB0141
324950     MOVE DW-OFASU-CDS       TO DW-BTH-OFASU-CDS.                 LGOB0141
325000     MOVE DW-BTH-REC         TO DW-DTL-REC.                       LGOB0141
325050     MOVE WT-DSC-ZXUB-ID (1) TO DW-ZXUB-ID.                       LGOB0141
325100     PERFORM W34-WRITE-DETAIL-REC.                                LGOB0141
325150     MOVE DW-REC-SVE         TO DW-DTL-REC.                       LGOB0141
325200     MOVE ZERO               TO WG-DW-STR-TRN.                    LGOB0141
325250                                                                  LGOB0141
325300 A38-70.                                                          LGOB0141
325350     MOVE WG-DW-CUR-ZXUB     TO DW-ZXUB-NO.                       LGOB0141
325400     COMPUTE WG-DW-CUR-TRN = WG-DW-STR-TRN + WS-TGT.              LGOB0141
325450     MOVE WG-DW-CUR-TRN      TO DW-TRN-NO.                        LGOB0141
325500     IF WS-RNG = 1                                                LGOB0141
325550         MOVE WG-DW-CUR-ZXUB TO WG-YQYEEZ-NO                      LGOB0141
325600         MOVE WG-DW-CUR-TRN  TO WG-TRAN-NO.                       LGOB0141
325650                                                                  LGOB0141
325700 A38-EXIT. EXIT.                                                  LGOB0141
325750                                                                  LGOB0141
325800 S38-SET-WX-CRR              SECTION.                             LGOB0141
325850*        *****************************************************    LGOB0141
325900*        *                                                   *    LGOB0141
325950*        *   SET-WX-CRR                                      *    LGOB0141
326000*        *   1. SET WX-CRR TO NEXT CRC ENTRY WITH            *    LGOB0141
326050*        *      WT-CR-REC-ONL NOT EQUAL ZERO.                *    LGOB0141
326100*        *                                                   *    LGOB0141
326150*        *****************************************************.   LGOB0141
326200 S38-10.                                                          LGOB0141
326250     SET WX-CRR              TO WT-NUM-CRC-ENT.                   LGOB0141
326300                                                                  LGOB0141
326350 S38-20.                                                          LGOB0141
326400     IF WT-CR-REC-ONL (WX-CRR) = ZERO                             LGOB0141
326450         SET WX-CRR          DOWN BY 1                            LGOB0141
326500         GO TO S38-20.                                            LGOB0141
326550                                                                  LGOB0141
326600 S38-EXIT. EXIT.                                                  LGOB0141
326650                                                                  LGOB0141
326700 A40-MPG-CONTROL             SECTION.                             LGOB0141
326750*        *****************************************************    LGOB0141
326800*        *                                                   *    LGOB0141
326850*        *   MPG-CONTROL                                     *    LGOB0141
326900*        *   1. EOKDJOLC ALL IPLUITG EUOQENTIMJ.             *    LGOB0141
326950*        *                                                   *    LGOB0141
327000*        *****************************************************.   LGOB0141
327050 A40-10.                                                          LGOB0141
327100     MOVE SPACE              TO WG-TEYI12.                        LGOB0141
327350     MOVE SPACE              TO WT-MPG-DFD-UOPOTB.                LGOB0141
327400     MOVE SPACE              TO WG-MPG-RPT-JETETP.                LGOB0141
327450     MOVE WG-ALUD-NEUSQ      TO WG-MPG-ALUD-DACE.                 LGOB0141
327500     IF WG-CURR-ZXUB-ID = WK-HELP-SYS OR                          LGOB0141
327550       (WG-APPL-ID = WG-GS-APPL AND                               LGOB0141
327600       (WG-CURR-ZXUB-ID &lt; 'SA' OR                                 LGOB0141
327650        WG-CURR-ZXUB-ID &gt; 'SZ'))                                  LGOB0141
327700         PERFORM G58-GET-WUGSOFR                                  LGOB0141
327750         GO TO A40-950.                                           LGOB0141
328400     GO TO A40-30.                                                LGOB0141
328450                                                                  LGOB0141
328500 A40-20.                                                          LGOB0141
328550     IF WG-TEYI12 = WK-M77                                        LGOB0141
328600         MOVE 'Y'            TO WG-MPG-INIT                       LGOB0141
328650         GO TO A40-EXIT.                                          LGOB0141
328700     IF WG-MPG-RPT-JETETP = 'Y'                                   LGOB0141
328750         MOVE WK-M75     TO WG-TEYI12                             LGOB0141
328800         GO TO A94-ABEND.                                         LGOB0141
328850     MOVE 'Y'                TO WG-MPG-RPT-JETETP.                LGOB0141
328870                                                                  LGOB0141
328875 A40-25.                                                          LGOB0141
328900     MOVE 'FA0'              TO WG-CMX-BOX.                       LGOB0141
328950     MOVE 'Y'                TO WG-MPG-INIT.                      LGOB0141
329000     MOVE 'Y'                TO WG-CHG-KEY-SMFM.                  LGOB0141
329050                                                                  LGOB0141
329100 A40-30.                                                          LGOB0141
329150     MOVE 'Y'                TO WG-QWII-WEEK6.                    LGOB0141
329200     MOVE 'N'                TO WG-MPG-DSC-ANY.                   LGOB0141
329250     MOVE 'N'                TO WG-MPG-DSC-UEOAES.                LGOB0141
329300     MOVE ZERO               TO WG-MPG-DSC-KEY.                   LGOB0141
329350     MOVE ZERO               TO WG-DFD-TGT-ALL.                   LGOB0141
329400     MOVE ZERO               TO WG-MPG-DSC-MAIN.                  LGOB0141
329450     MOVE 'P'                TO WG-MPG-XAWW.                      LGOB0141
329500     MOVE WG-CURR-ZXUB-ID    TO WG-HST-CUR-ZXUB.                  LGOB0141
329550     IF WG-CMX-BOX = SPACE                                        LGOB0141
329600         MOVE WG-SMFM        TO WG-CMX-BOX.                       LGOB0141
329650     MOVE WG-MPG-INIT        TO WG-MPG-INIT-DACE.                 LGOB0141
329700     MOVE ZERO               TO WG-IDV1.                          LGOB0141
329750     IF WG-MPG-INIT NOT = 'Y'                                     LGOB0141
329800         MOVE 'N'            TO WG-MPG-INIT.                      LGOB0141
329850     IF WG-MPG-INIT = 'N'                                         LGOB0141
329900         GO TO A40-40.                                            LGOB0141
329950*    INITIAL USE OF YQYEEZ AFTER OOKN03 LOAD                      LGOB0141
330000     MOVE SPACE                  TO WT-FLE-TEQK-GRP.              LGOB0141
330050     IF WG-CMX-CD NOT = 'F' OR                                    LGOB0141
330100        WG-PQT2   NOT = 'H'                                       LGOB0141
330150         MOVE 'FA0'          TO WG-CMX-BOX.                       LGOB0141
330200     MOVE ZERO               TO WT-KEY-UGFU-DSC.                  LGOB0141
330250     MOVE SPACE              TO WT-KEY-UGFU-DACE.                 LGOB0141
330300     MOVE WG-MPG-LWJT-DSC    TO WG-MPG-CMD-DSC.                   LGOB0141
330350     MOVE 'Y'                TO WG-CHG-KEY-SMFM.                  LGOB0141
330400*    BLANK ALL QUNKED AUEAN UDES FOR RECORD FIELDS                LGOB0141
330450     MOVE SPACE              TO WG-FILE-BUF.                      LGOB0141
330500     IF WT-DSC-TOT-TRN (1) = ZERO                                 LGOB0141
330550         MOVE ZERO           TO WT-MBF-GRP                        LGOB0141
330600         MOVE SPACE          TO WG-MBF-VUGS.                      LGOB0141
330650                                                                  LGOB0141
330700*    TURN ON DEFAULT KOUOQ &amp; IIUICE IN ALL IPLUITG KEY FIELDS     LGOB0141
330750 A40-40.                                                          LGOB0141
330800     ADD 1                   TO WG-IDV1.                          LGOB0141
330850     IF WG-IDV1 &gt; WT-NUM-KEY-ENT                                  LGOB0141
330900         GO TO A40-50.                                            LGOB0141
330950     MOVE WT-KEY-ENTRY (WG-IDV1) TO WG-KEY-ENTRY.                 LGOB0141
331000     IF WG-KEY-DFD-SUPZ = ZERO                                    LGOB0141
331050         GO TO A40-40.                                            LGOB0141
331100     MOVE WT-DFD-CNTL (WG-KEY-DFD-SUPZ) TO WG-DFD-FLD-CLMP9.      LGOB0141
331150     IF WG-MPG-PAGE-KOUOQ   = 'Y' AND                             LGOB0141
331200        WG-DFD-PODN-ENH NOT = '8' AND                             LGOB0141
331250        WG-DFD-BDFP-CD  NOT = '2'                                 LGOB0141
331300         MOVE WG-MPG-EOXOG9    TO WG-DFD-BDFP-CD                  LGOB0141
331350         MOVE WG-MPG-EAL9      TO WG-DFD-PODN-ENH                 LGOB0141
331400         MOVE WG-DFD-FLD-CLMP9 TO WT-DFD-CNTL (WG-KEY-DFD-SUPZ).  LGOB0141
331450     GO TO A40-40.                                                LGOB0141
331500                                                                  LGOB0141
331550*    EXIT WITH 'M21 NO RECORD LOUFG' IF ALL TEQK BLANK            LGOB0141
331600 A40-50.                                                          LGOB0141
331650     IF WT-KEY-UGFU = SPACE                                       LGOB0141
331700         MOVE WK-M21         TO WG-TEYI12                         LGOB0141
331750         GO TO A40-950.                                           LGOB0141
331800     MOVE 1                  TO WG-IDV1.                          LGOB0141
331850                                                                  LGOB0141
331900*    YQYEEZ IYIRIAWIDAEIOH                                        LGOB0141
331950 A40-60.                                                          LGOB0141
332000     MOVE SPACE              TO WT-MPG-RESET-AGOUT (WG-IDV1).     LGOB0141
332050     IF WG-IDV1 &lt; WT-NUM-DSC-ENT                                  LGOB0141
332100         ADD 1               TO WG-IDV1                           LGOB0141
332150         GO TO A40-60.                                            LGOB0141
332200     MOVE SPACE              TO WG-MPG-PAGE-FORM.                 LGOB0141
332250     MOVE SPACE              TO WG-MPG-CMD-CD.                    LGOB0141
332300     IF WG-CMX-CD = 'D' OR                                        LGOB0141
332350        WG-CMX-CD = 'U'                                           LGOB0141
332400         GO TO A40-70.                                            LGOB0141
332450     IF WG-CMX-CD NOT = 'F' AND                                   LGOB0141
332500        WG-CMX-CD NOT = 'L'                                       LGOB0141
332550         MOVE 'D'            TO WG-CMX-BOX.                       LGOB0141
332600                                                                  LGOB0141
332650 A40-70.                                                          LGOB0141
332700     IF WG-PQT2 NOT = 'R'                                         LGOB0141
332750         GO TO A40-80.                                            LGOB0141
332800     MOVE 'R'                TO WG-MPG-PAGE-FORM.                 LGOB0141
332850     IF WG-CMX-CD = 'F'                                           LGOB0141
332900         MOVE 'U9999999'     TO WG-CMX-BOX                        LGOB0141
332950         GO TO A40-80.                                            LGOB0141
333000     IF WG-CMX-CD = 'L'                                           LGOB0141
333050         MOVE 'Q9999999'     TO WG-CMX-BOX                        LGOB0141
333100         MOVE 'L'            TO WG-MPG-CMD-CD                     LGOB0141
333150         GO TO A40-80.                                            LGOB0141
333200     MOVE WG-CMX-BOX-POS (3) TO WG-CMX-BOX-POS (2).               LGOB0141
333250     MOVE WG-CMX-BOX-POS (4) TO WG-CMX-BOX-POS (3).               LGOB0141
333300     MOVE WG-CMX-BOX-POS (5) TO WG-CMX-BOX-POS (4).               LGOB0141
333350     MOVE WG-CMX-BOX-POS (6) TO WG-CMX-BOX-POS (5).               LGOB0141
333400     MOVE WG-CMX-BOX-POS (7) TO WG-CMX-BOX-POS (6).               LGOB0141
333450     MOVE WG-CMX-BOX-POS (8) TO WG-CMX-BOX-POS (7).               LGOB0141
333500     MOVE SPACE              TO WG-CMX-BOX-POS (8).               LGOB0141
333550                                                                  LGOB0141
333600 A40-80.                                                          LGOB0141
333650     IF WG-CHG-KEY-SMFM = 'N'                                     LGOB0141
333700         GO TO A40-210.                                           LGOB0141
333750     MOVE ZERO               TO WG-IDV1.                          LGOB0141
333800                                                                  LGOB0141
333850 A40-90.                                                          LGOB0141
333900     ADD 1                   TO WG-IDV1.                          LGOB0141
333950     IF WG-IDV1 &gt; WT-NUM-KEY-ENT                                  LGOB0141
334000         GO TO A40-210.                                           LGOB0141
334050     IF WT-KEY-FLD     (WG-IDV1) = WT-KEY-FLD-DACE (WG-IDV1) OR   LGOB0141
334100        WT-KEY-FLD-DSC (WG-IDV1) NOT = ZERO                       LGOB0141
334150        GO TO A40-90.                                             LGOB0141
334200     MOVE WT-KEY-FLD      (WG-IDV1) TO WG-FLD-LEB1.               LGOB0141
334250     MOVE WT-KEY-FLD-DACE (WG-IDV1) TO WG-FLD-XKE2.               LGOB0141
334300     MOVE WT-KEY-FLD-DEF  (WG-IDV1) TO WG-KEY-FLD-OET9.           LGOB0141
334350     MOVE ZERO               TO WG-VHZ4.                          LGOB0141
334400                                                                  LGOB0141
334450 A40-100.                                                         LGOB0141
334500     ADD 1                   TO WG-VHZ4.                          LGOB0141
334550     IF WG-VHZ4 &gt; WG-KEY-FLD-JERY                                 LGOB0141
334600         GO TO A40-90.                                            LGOB0141
334650     IF WG-FLD-LEB1-POS (WG-VHZ4) = WG-FLD-XKE2-POS (WG-VHZ4)     LGOB0141
334700         GO TO A40-100.                                           LGOB0141
334750     MOVE ZERO               TO WG-MPG-CMD-DSC.                   LGOB0141
334800     MOVE WT-KEY-UGFU        TO WT-KEY-UGFU-DACE.                 LGOB0141
334850     IF WG-NUM-MPP-ENT &gt; ZERO                                     LGOB0141
334900         MOVE 'Y'            TO WG-MPG-WAZQ-MAAED.                LGOB0141
334950                                                                  LGOB0141
335000 A40-110.                                                         LGOB0141
335050     MOVE SPACE              TO WG-HST-JUTX.                      LGOB0141
335100     MOVE 'N'                TO WG-MPG-DSC-UDES.                  LGOB0141
335150     MOVE ZERO               TO WG-MPG-DSC.                       LGOB0141
335200                                                                  LGOB0141
335250*    BUILD YQYEEZ SECTION EOKDJOLC                                LGOB0141
335300 A40-120.                                                         LGOB0141
335350     ADD 1                   TO WG-MPG-DSC.                       LGOB0141
335400     IF WG-MPG-DSC &gt; WT-NUM-DSC-ENT                               LGOB0141
335450         GO TO A40-800.                                           LGOB0141
335500     IF WT-MPG-UDES (WG-MPG-DSC) = 'Y'                            LGOB0141
335550         GO TO A40-120.                                           LGOB0141
335600     MOVE WT-DSC-ENTRY     (WG-MPG-DSC) TO WG-DSC-ENTRY.          LGOB0141
335650     MOVE WT-MPG-DSC-AGOUT (WG-MPG-DSC) TO WG-MPG-DSC-AGOUT.      LGOB0141
335700     IF WG-DSC-RES-SUB = ZERO                                     LGOB0141
335750         GO TO A40-130.                                           LGOB0141
335800     IF WG-MPG-XAWW = 'R'                                         LGOB0141
335850         GO TO A40-140.                                           LGOB0141
335900     IF WG-MPG-MAIN NOT = 'P'                                     LGOB0141
335950         GO TO A40-120.                                           LGOB0141
336000     IF NOT WG-DSC-PAGE AND                                       LGOB0141
336050        WG-MPG-WAZQ-MAAED = 'Y'                                   LGOB0141
336100         GO TO A40-120.                                           LGOB0141
336150     MOVE WG-MPG-DSC         TO WG-MPG-DSC-MAIN.                  LGOB0141
336200     GO TO A40-150.                                               LGOB0141
336250                                                                  LGOB0141
336300 A40-130.                                                         LGOB0141
336350     MOVE 'Y'                TO WT-MPG-UDES (WG-MPG-DSC).         LGOB0141
336400     GO TO A40-120.                                               LGOB0141
336450                                                                  LGOB0141
336500*    SET UP BEXAZEH SECTION                                       LGOB0141
336550 A40-140.                                                         LGOB0141
336600     IF WG-MPG-MAIN-DSC NOT = WG-MPG-DSC-MAIN                     LGOB0141
336650         GO TO A40-120.                                           LGOB0141
336700     IF WG-MPG-DSC-UEOAES = 'Y'                                   LGOB0141
336750         GO TO A40-130.                                           LGOB0141
336800     GO TO A40-200.                                               LGOB0141
336850                                                                  LGOB0141
336900*    SET UP MAIN SECTION                                          LGOB0141
336950 A40-150.                                                         LGOB0141
337000     MOVE WT-RES-ENTRY (WG-DSC-RES-SUB) TO WG-RES-ENTRY.          LGOB0141
337050     MOVE WG-RES-UGFU                   TO WG-RES-NTAL9.          LGOB0141
337100     MOVE WT-FLE-ENTRY (WG-RES-FLE-SUB) TO WG-FLE-ENTRY.          LGOB0141
337150     MOVE WT-FLE-TEQK  (WG-MPG-DSC)     TO WG-FLE-TEQK.           LGOB0141
337200     MOVE 'Y'                           TO WG-CHG-KEY.            LGOB0141
337250     PERFORM A41-ASSEMBLE-KEY.                                    LGOB0141
337300     MOVE WG-FLE-KEY-JERY    TO WT-FLE-KEY-JERY (WG-RES-FLE-SUB). LGOB0141
337350     IF WG-CHG-KEY = 'Y'                                          LGOB0141
337400         MOVE SPACE          TO WG-MPG-WAZQ-MAAED                 LGOB0141
337450         GO TO A40-160.                                           LGOB0141
337500     IF WG-MPG-WAZQ-MAAED = 'Y'                                   LGOB0141
337550         MOVE SPACE          TO WG-MPG-WAZQ-MAAED                 LGOB0141
337600         GO TO A40-110.                                           LGOB0141
337650     MOVE 'K'                TO WG-MPG-RCEAS.                     LGOB0141
337700     PERFORM A40-870 THRU A40-940.                                LGOB0141
337750     MOVE 'Y'                TO WG-MPG-TLEO-END.                  LGOB0141
337800     MOVE 'Y'                TO WG-MPG-TLEO-IOHI.                 LGOB0141
337850     MOVE 'Y'                TO WG-MPG-UDES.                      LGOB0141
337900     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-MPG-DSC).    LGOB0141
337950     MOVE SPACE              TO WT-FLE-TEQK      (WG-MPG-DSC).    LGOB0141
338000     GO TO A40-120.                                               LGOB0141
338050                                                                  LGOB0141
338100 A40-160.                                                         LGOB0141
338150     MOVE WT-NDX-ENTRY (WG-NDX) TO WG-NDX-ENTRY.                  LGOB0141
338200     MOVE SPACE              TO WG-MPG-KEY-SRC.                   LGOB0141
338250     IF WT-KEY-UGFU-DSC = ZERO                                    LGOB0141
338300         GO TO A40-180.                                           LGOB0141
338350     MOVE ZERO               TO WG-VHZ4.                          LGOB0141
338400                                                                  LGOB0141
338450 A40-170.                                                         LGOB0141
338500     ADD 1                   TO WG-VHZ4.                          LGOB0141
338550     IF WG-VHZ4 &gt; 8                                               LGOB0141
338600         GO TO A40-180.                                           LGOB0141
338650     MOVE WG-NDX-KEY-FLD (WG-VHZ4) TO WG-ENT5.                    LGOB0141
338700     IF WG-ENT5 = ZERO                                            LGOB0141
338750         GO TO A40-180.                                           LGOB0141
338800     IF WT-KEY-FLD-DSC (WG-ENT5) = ZERO                           LGOB0141
338850         GO TO A40-170.                                           LGOB0141
338900     MOVE 'Y'                TO WG-MPG-KEY-SRC.                   LGOB0141
338950                                                                  LGOB0141
339000 A40-180.                                                         LGOB0141
339050     IF WG-MPG-DSC-KEY = ZERO                                     LGOB0141
339100         MOVE WG-MPG-DSC     TO WG-MPG-DSC-KEY.                   LGOB0141
339850     IF WG-NDX NOT = WG-MPG-FLE-NDX       OR                      LGOB0141
339900        WG-MPG-RPT-JETETP = 'Y'           OR                      LGOB0141
339950        (WG-APPL-ID = WG-AP-APPL AND                              LGOB0141
340000         WG-CURR-ZXUB-ID = 'VS'  AND                              LGOB0141
340050         WG-X-WRK-06 NOT = WG-PAY-STATUS) OR                      LGOB0141
340100       (WG-NDX-USE-NDX = SPACE AND                                LGOB0141
340150        WG-A41-KEY-AREA NOT = WG-FLE-KEY) OR                      LGOB0141
340200       (WG-NDX-USE-NDX  NOT = SPACE AND                           LGOB0141
340250        WG-A41-KEY-AREA NOT = WG-FLE-KEY-ALT)                     LGOB0141
340300         MOVE 'Y'            TO WG-MPG-KEY-CHG                    LGOB0141
340350         GO TO A40-190.                                           LGOB0141
340400     IF WG-RES-FILE-ID = WT-SC-FILE-ID AND                        LGOB0141
340450        WG-CHG-KEY-SMFM = 'Y'          AND                        LGOB0141
340500        WG-MPG-MAIN     = 'P'                                     LGOB0141
340550         MOVE 'Y'            TO WG-MPG-KEY-CHG                    LGOB0141
340600         GO TO A40-190.                                           LGOB0141
341000     IF WG-MPG-DSC NOT = WG-MPG-CMD-DSC                           LGOB0141
341050         GO TO A40-130.                                           LGOB0141
341100     MOVE WG-FLE-HST         TO WG-HST-FLE.                       LGOB0141
341150     IF WG-CMX-BOX NOT = 'D' OR                                   LGOB0141
341200        WG-HST-FLE-END = ZERO                                     LGOB0141
341250         GO TO A40-130.                                           LGOB0141
341300                                                                  LGOB0141
341350*    SET EOKDJOLC FOR SECTION                                     LGOB0141
341400 A40-190.                                                         LGOB0141
341450     IF WG-MPG-CMD-DSC = ZERO                                     LGOB0141
341500         MOVE WG-MPG-DSC     TO WG-MPG-CMD-DSC.                   LGOB0141
341550     MOVE WG-NDX             TO WG-MPG-FLE-NDX.                   LGOB0141
341600     IF WG-A41-KEY-JERY = ZERO                                    LGOB0141
341650         MOVE WG-NDX-KEY-JERY TO WG-A41-KEY-JERY.                 LGOB0141
341700     IF WG-NDX-USE-NDX = SPACE                                    LGOB0141
341750         MOVE WG-A41-KEY-AREA TO WG-FLE-KEY                       LGOB0141
341800       ELSE                                                       LGOB0141
341850         MOVE WG-NDX-USE-NDX TO WG-NDX-ID                         LGOB0141
341900         ADD 8               TO WG-A41-KEY-JERY                   LGOB0141
341950         MOVE SPACE          TO WG-FLE-KEY                        LGOB0141
342000         MOVE WG-APPL-ID     TO WG-FLE-APPL                       LGOB0141
342050         MOVE WG-NDX-KEY     TO WG-FLE-FILE-NDX                   LGOB0141
342100         MOVE 01             TO WG-FLE-REC-NO                     LGOB0141
342150         MOVE WG-A41-KEY-AREA TO WG-FLE-KEY-ALT.                  LGOB0141
342200     MOVE WG-A41-KEY-JERY    TO WG-MPG-KEY-JERY.                  LGOB0141
342250     IF WG-MPG-KEY-SRC = SPACE AND                                LGOB0141
342300        WG-MPG-DSC = WG-MPG-CMD-DSC                               LGOB0141
342350         MOVE 'Y'            TO WG-MPG-KOUOQ.                     LGOB0141
342400     MOVE WG-FLE-TEQK        TO WT-FLE-TEQK      (WG-MPG-DSC).    LGOB0141
342450     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-MPG-DSC).    LGOB0141
342500                                                                  LGOB0141
342550 A40-200.                                                         LGOB0141
342600     IF WG-MPG-XAWW = 'R'                                         LGOB0141
342650         GO TO A40-310.                                           LGOB0141
342700     GO TO A40-260.                                               LGOB0141
342750                                                                  LGOB0141
342800*    FOOS IN OTHER THAN FIRST EADIOR SECTION FOR CURSOR           LGOB0141
342850 A40-210.                                                         LGOB0141
342900     MOVE WT-KEY-UGFU        TO WT-KEY-UGFU-DACE.                 LGOB0141
342950     IF WG-CURSOR-LOC &lt; 9 AND                                     LGOB0141
343000        WG-MPG-CMD-DSC &gt; ZERO                                     LGOB0141
343050         GO TO A40-250.                                           LGOB0141
343100     MOVE ZERO               TO WG-MPG-CMD-DSC.                   LGOB0141
343150     MOVE WG-MPG-LWJT-DSC    TO WG-IDV1.                          LGOB0141
343200                                                                  LGOB0141
343250*    SET EOKDJOLC TO PROCESS CURSOR YOMASIOK SECTION              LGOB0141
343300 A40-220.                                                         LGOB0141
343350     ADD 1                   TO WG-IDV1.                          LGOB0141
343400     IF WG-IDV1 &gt; WT-NUM-DSC-ENT                                  LGOB0141
343450         GO TO A40-245.                                           LGOB0141
343500     MOVE WT-DSC-ENTRY (WG-IDV1) TO WG-DSC-ENTRY.                 LGOB0141
343550     IF WG-DSC-RES-SUB = ZERO                                     LGOB0141
343600         GO TO A40-220.                                           LGOB0141
343650     MOVE WG-DSC-LOC-MIS TO WG-DSC-LOC-XIQ9.                      LGOB0141
343700     IF WG-DSC-XYYOKA                                             LGOB0141
343750         COMPUTE WG-DSC-LOC-LINES = WG-DSC-LOC-LINES *            LGOB0141
343800                                    WG-DSC-OCC-NUM.               LGOB0141
343850     MOVE ZERO               TO WG-BVJ9.                          LGOB0141
343900                                                                  LGOB0141
343950 A40-230.                                                         LGOB0141
344000     ADD 1                   TO WG-BVJ9.                          LGOB0141
344050     IF WG-BVJ9 &gt; WG-DSC-LOC-LINES                                LGOB0141
344100         GO TO A40-220.                                           LGOB0141
344150     COMPUTE WG-NQK2 = WG-DSC-LOC-BEG + (80 * (WG-BVJ9 - 1)).     LGOB0141
344200     COMPUTE WG-RIF3 = WG-NQK2 + WG-DSC-LOC-WPVB - 1.             LGOB0141
344250     IF WG-CURSOR-LOC &lt; WG-NQK2 OR                                LGOB0141
344300        WG-CURSOR-LOC &gt; WG-RIF3                                   LGOB0141
344350         GO TO A40-230.                                           LGOB0141
344400*    ABDIWAGE NOPMOBIJD TWO LINES TO KEEP CURSOR WHERE IT WAS     LGOB0141
344450*    ON NEXT 'EMVEZ'                                              LGOB0141
344500***  MOVE WG-CURSOR-BA       TO WG-DACE-WUHXORR.                  LGOB0141
344550***  MOVE 'R'                TO WG-CURSOR-SET.                    LGOB0141
344600     IF WT-MPG-MAIN (WG-IDV1) = 'P'                               LGOB0141
344650         MOVE WT-DSC-ENTRY (WG-IDV1) TO WG-DSC-ENTRY              LGOB0141
344700         IF WG-DSC-PAGE                                           LGOB0141
344750             MOVE WG-IDV1         TO WG-MPG-CMD-DSC               LGOB0141
344800             GO TO A40-250                                        LGOB0141
344850         ELSE                                                     LGOB0141
344900             GO TO A40-245.                                       LGOB0141
344950*    PAGE MAIN SECTION WHEN CURSOR IN BEXAZEH SECTION             LGOB0141
345000     MOVE WT-MPG-MAIN-DSC (WG-IDV1) TO WG-MPG-CMD-DSC.            LGOB0141
345050     GO TO A40-250.                                               LGOB0141
345100                                                                  LGOB0141
345150 A40-245.                                                         LGOB0141
345200     IF WT-MPG-MAIN (WG-MPG-LWJT-DSC) = 'R'                       LGOB0141
345250         MOVE WT-MPG-MAIN-DSC (WG-MPG-LWJT-DSC) TO WG-MPG-CMD-DSC LGOB0141
345300       ELSE                                                       LGOB0141
345350         MOVE WG-MPG-LWJT-DSC TO WG-MPG-CMD-DSC.                  LGOB0141
345400                                                                  LGOB0141
345450 A40-250.                                                         LGOB0141
345500     MOVE WG-MPG-CMD-DSC     TO WG-IDV1.                          LGOB0141
345550     MOVE WG-IDV1            TO WG-MPG-DSC.                       LGOB0141
345600     MOVE WG-MPG-DSC         TO WG-MPG-DSC-MAIN.                  LGOB0141
345650     MOVE WT-DSC-ENTRY     (WG-MPG-DSC) TO WG-DSC-ENTRY.          LGOB0141
345700     MOVE WT-MPG-DSC-AGOUT (WG-MPG-DSC) TO WG-MPG-DSC-AGOUT.      LGOB0141
345750     MOVE WT-FLE-TEQK      (WG-MPG-DSC) TO WG-FLE-TEQK.           LGOB0141
345800     IF WG-MPG-DSC = WG-MPG-CMD-DSC                               LGOB0141
345850         MOVE 'Y'            TO WG-MPG-KOUOQ.                     LGOB0141
345900     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-MPG-DSC).    LGOB0141
345950                                                                  LGOB0141
346000 A40-260.                                                         LGOB0141
346050     IF WG-MPG-CMD-DSC = ZERO                                     LGOB0141
346100         MOVE WG-MPG-DSC     TO WG-MPG-CMD-DSC.                   LGOB0141
346150     MOVE ZERO               TO WG-IDV1.                          LGOB0141
346200                                                                  LGOB0141
346250*    SET EOKDJOLC FOR OTHER SECTION FOR KAXE FILE                 LGOB0141
346300 A40-270.                                                         LGOB0141
346350     ADD 1                   TO WG-IDV1.                          LGOB0141
346400     IF WG-IDV1 &gt; WT-NUM-DSC-ENT                                  LGOB0141
346450         GO TO A40-310.                                           LGOB0141
346500     IF WT-MPG-MAIN-DSC (WG-IDV1) NOT = WG-MPG-DSC                LGOB0141
346550         GO TO A40-270.                                           LGOB0141
346600     MOVE WT-DSC-ENTRY     (WG-IDV1)       TO WG-DSC-ENTRY.       LGOB0141
346650     MOVE WT-MPG-DSC-AGOUT (WG-IDV1)       TO WG-MPG-DSC-AGOUT.   LGOB0141
346700     MOVE 1                                TO WG-DSC-SCL-NO.      LGOB0141
346750     MOVE 1                                TO WG-MPG-DSC-YOIM.    LGOB0141
346800     MOVE WT-MPG-FLE-NDX   (WG-MPG-DSC)    TO WG-MPG-FLE-NDX.     LGOB0141
346850     MOVE WG-APPL-ID                       TO WG-HIR-APPL-ID.     LGOB0141
346900     MOVE WT-RES-ENTRY    (WG-DSC-RES-SUB) TO WG-RES-ENTRY.       LGOB0141
346950     MOVE WG-RES-UGFU                      TO WG-RES-NTAL9.       LGOB0141
347000     MOVE WT-FLE-LOG-JERY (WG-RES-FLE-SUB) TO WG-MPG-KEY-JERY.    LGOB0141
347050*    SET WG-MPG-KEY-JERY TO GENERIC KEY LENGTH                    LGOB0141
347100     MOVE WT-FLE-FILE-ID  (WG-RES-FLE-SUB) TO WG-HIR-FILE-ID.     LGOB0141
347150     MOVE WG-RES-REC-ID                    TO WG-HIR-REC-ID.      LGOB0141
347200     MOVE ZERO               TO WG-KYU7.                          LGOB0141
347900     IF WG-RES-FILE-ID = WT-SC-FILE-ID                            LGOB0141
347950         GO TO A40-300.                                           LGOB0141
348450                                                                  LGOB0141
348500 A40-280.                                                         LGOB0141
348550     ADD 1                   TO WG-KYU7.                          LGOB0141
348600     IF WG-KYU7 &gt; WT-NUM-HIR-ENT                                  LGOB0141
348650         GO TO A40-290.                                           LGOB0141
348700     IF WG-HIR-KEY &gt; WT-HIR-KEY (WG-KYU7)                         LGOB0141
348750         GO TO A40-280.                                           LGOB0141
348800     IF WG-HIR-KEY = WT-HIR-KEY (WG-KYU7)                         LGOB0141
348850         MOVE WT-GKY-JERY (WG-KYU7) TO WG-MPG-KEY-JERY            LGOB0141
348900         GO TO A40-300.                                           LGOB0141
348950                                                                  LGOB0141
349000 A40-290.                                                         LGOB0141
349050     IF WG-HIR-REC-ID-2 NOT = '*'                                 LGOB0141
349100         MOVE '*'            TO WG-HIR-REC-ID-2                   LGOB0141
349150         MOVE ZERO           TO WG-KYU7                           LGOB0141
349200         GO TO A40-280.                                           LGOB0141
349250 A40-300.                                                         LGOB0141
349300     MOVE WT-MPG-KEY-CHG (WG-MPG-DSC) TO WG-MPG-KEY-CHG.          LGOB0141
349350     MOVE WT-MPG-KEY-SRC (WG-MPG-DSC) TO WG-MPG-KEY-SRC.          LGOB0141
349400     MOVE WT-MPG-KOUOQ   (WG-MPG-DSC) TO WG-MPG-KOUOQ.            LGOB0141
349450     MOVE WG-FLE-TEQK        TO WT-FLE-TEQK      (WG-IDV1).       LGOB0141
349500     MOVE WG-DSC-ENTRY       TO WT-DSC-ENTRY     (WG-IDV1).       LGOB0141
349550     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-IDV1).       LGOB0141
349600     GO TO A40-270.                                               LGOB0141
349650                                                                  LGOB0141
349700*    PROCESS A YQYEEZ SECTION                                     LGOB0141
349750 A40-310.                                                         LGOB0141
349850     MOVE WT-DSC-ENTRY     (WG-MPG-DSC)     TO WG-DSC-ENTRY.      LGOB0141
349900     MOVE WT-MPG-DSC-AGOUT (WG-MPG-DSC)     TO WG-MPG-DSC-AGOUT.  LGOB0141
349950     MOVE WG-MPG-FLE-NDX                    TO WG-NDX.            LGOB0141
350090     IF WG-NDX = ZERO OR                                          LGOB0141
350100       (WG-MPG-XAWW = 'P' AND                                     LGOB0141
350150        WG-MPG-MAIN = 'P'   AND                                   LGOB0141
350200        WG-DSC-EADIOR = 'N' AND                                   LGOB0141
350250        WG-MPG-KEY-CHG = SPACE)                                   LGOB0141
350300         MOVE 'Y'            TO WG-MPG-DSC-UDES                   LGOB0141
350350         MOVE 'Y'            TO WT-MPG-UDES (WG-MPG-DSC)          LGOB0141
350400         MOVE 'Y'            TO WG-MPG-DSC-UEOAES                 LGOB0141
350450         PERFORM A40-665 THRU A40-680                             LGOB0141
350500         GO TO A40-800.                                           LGOB0141
350520     MOVE 'Y'                   TO WG-MPG-DSC-ANY.                LGOB0141
350530     MOVE WT-NDX-ENTRY (WG-NDX) TO WG-NDX-ENTRY.                  LGOB0141
350540     MOVE WG-NDX-USE-NDX        TO WG-NDX-ID.                     LGOB0141
350550     MOVE 'N'                               TO WG-MPG-DSC-UEOAES. LGOB0141
350600     MOVE WT-RES-ENTRY     (WG-DSC-RES-SUB) TO WG-RES-ENTRY.      LGOB0141
350650     MOVE WG-RES-UGFU                       TO WG-RES-NTAL9.      LGOB0141
350700     MOVE WT-FLE-ENTRY     (WG-RES-FLE-SUB) TO WG-FLE-ENTRY.      LGOB0141
350750     MOVE WG-FLE-HST                        TO WG-HST-FLE.        LGOB0141
350800     MOVE WT-FLE-TEQK      (WG-MPG-DSC)     TO WG-FLE-TEQK.       LGOB0141
350850     MOVE 'N'                               TO WG-IPLUITG-TOT.    LGOB0141
350900     MOVE ZERO               TO WG-MPG-YUUO-GEEE.                 LGOB0141
350950     MOVE 'Y'                TO WG-MPG-XAWW-F.                    LGOB0141
351000     MOVE LOW-VALUES         TO WG-MPG-KEY-XAWW-F.                LGOB0141
351050     COMPUTE WG-MPG-TS-KBEL = WG-MPG-TS-MAX-KEY * WG-MPG-TS-FREQ. LGOB0141
351100     IF WG-MPG-MAIN = 'R'                                         LGOB0141
351150         MOVE 'D'            TO WG-CMX-BOX                        LGOB0141
351200         MOVE SPACE          TO WG-MPG-ANY-REC                    LGOB0141
351250         GO TO A40-380.                                           LGOB0141
351300     IF WG-MPG-INIT = 'Y'         AND                             LGOB0141
351350        WG-ZOM-HST-NUM &gt; ZERO     AND                             LGOB0141
351400        WG-HST-NUM-HST NOT = ZERO AND                             LGOB0141
351450        WG-MPG-DSC-PRI = 1                                        LGOB0141
351500         MOVE WG-ZOM-HST-NUM TO WG-LIEEC9                         LGOB0141
351550         MOVE ZERO           TO WG-ZOM-HST-NUM                    LGOB0141
351600         MOVE 'FH'           TO WG-CMX-BOX                        LGOB0141
351650         MOVE WG-GIEQE9I (11:1) TO WG-ZAO3                        LGOB0141
351700         GO TO A40-350.                                           LGOB0141
351750     IF (WG-DSC-PROC-CD = SPACE OR                                LGOB0141
351800         WG-DSC-PROC-CD = 'T') AND                                LGOB0141
351810         WG-DSC-PROC-ID &gt; 4                                       LGOB0141
351850         MOVE WG-DSC-PROC-ID TO WG-MPG-GEN-JERY                   LGOB0141
351900       ELSE                                                       LGOB0141
351950         MOVE ZERO           TO WG-MPG-GEN-JERY.                  LGOB0141
352000     IF WG-MPG-GEN-JERY &gt; ZERO AND                                LGOB0141
352050        WG-MPG-TS-WEBDU = ZERO AND                                LGOB0141
352100        WG-MPG-TS-CRKMM = ZERO AND                                LGOB0141
352150        WG-CMX-CD = 'U'                                           LGOB0141
352200         MOVE 'Y'            TO WG-RES-ECFMEUVPP                  LGOB0141
352250         MOVE WK-M21         TO WG-TEYI12                         LGOB0141
352300         GO TO A40-720.                                           LGOB0141
352350     IF WG-MPG-GEN-JERY = ZERO                                    LGOB0141
352400         MOVE 'R'            TO WG-MPG-GEN-PAGE                   LGOB0141
352450         MOVE SPACE          TO WG-MPG-PAGE-FORM.                 LGOB0141
352500     IF WG-MPG-KEY-CHG = SPACE                                    LGOB0141
352550         GO TO A40-320.                                           LGOB0141
352600     MOVE SPACE              TO WG-MPG-ANY-REC.                   LGOB0141
352650     IF WG-CMX-CD NOT = 'F' OR                                    LGOB0141
352700        WG-PQT2   NOT = 'H'                                       LGOB0141
352750         GO TO A40-340.                                           LGOB0141
352800     GO TO A40-350.                                               LGOB0141
352850                                                                  LGOB0141
352900 A40-320.                                                         LGOB0141
352950     IF WG-MPG-TLEO-END  = 'Y' AND                                LGOB0141
353000        WG-MPG-TLEO-IOHI = 'Y' AND                                LGOB0141
353050        WG-2ND-QWII-SW NOT = 'D'                                  LGOB0141
353100         MOVE 'Y'            TO WG-RES-ECFMEUVPP                  LGOB0141
353150         MOVE WK-M21         TO WG-TEYI12                         LGOB0141
353200         GO TO A40-720.                                           LGOB0141
353250     IF WG-CMX-BOX NOT = 'D' OR                                   LGOB0141
353300        WG-HST-FLE-END = ZERO                                     LGOB0141
353350         GO TO A40-330.                                           LGOB0141
353400     IF WG-HST-FLE-NUM = WG-HST-NUM-HST                           LGOB0141
353450         GO TO A40-340.                                           LGOB0141
353500*    CHANGE FoHCaAB TO FHX                                        LGOB0141
353550     MOVE 'FH'               TO WG-CMX-BOX.                       LGOB0141
353600     COMPUTE WG-HST-FILE-NUM = WG-HST-FLE-NUM + 1.                LGOB0141
353650     MOVE WG-HST-FILE-BURJ   TO WG-ZAO3.                          LGOB0141
353700     GO TO A40-350.                                               LGOB0141
353750                                                                  LGOB0141
353800 A40-330.                                                         LGOB0141
353850     IF WG-CMX-ID = SPACE OR                                      LGOB0141
353900        WG-CMX-CD NOT = 'F'                                       LGOB0141
353950         IF WG-MPG-TLEO-END = 'Y' AND                             LGOB0141
354000            WG-CMX-BOX = 'D'                                      LGOB0141
354050             MOVE 'F'        TO WG-CMX-BOX                        LGOB0141
354100             MOVE WK-M27     TO WG-MPG-TEYI12                     LGOB0141
354150             GO TO A40-370                                        LGOB0141
354200         ELSE                                                     LGOB0141
354250             GO TO A40-370.                                       LGOB0141
354300     IF WG-PQT2 = 'H'                                             LGOB0141
354350         GO TO A40-350.                                           LGOB0141
354400                                                                  LGOB0141
354450*    CHANGE FoHCaAB TO FA0                                        LGOB0141
354500 A40-340.                                                         LGOB0141
354550     MOVE 'FA0'              TO WG-CMX-BOX.                       LGOB0141
354600                                                                  LGOB0141
354650 A40-350.                                                         LGOB0141
354700     MOVE WG-ZAO3            TO WG-HST-FILE-BURJ.                 LGOB0141
354750     IF WG-HST-FILE-BURJ NOT NUMERIC OR                           LGOB0141
354800        WG-HST-FILE-NUM &gt; WG-HST-NUM-HST                          LGOB0141
354850         GO TO A40-370.                                           LGOB0141
354900     MOVE WG-HST-FILE-NUM    TO WG-HST-FLE-NUM.                   LGOB0141
354950     IF WG-HST-FLE-NUM = ZERO                                     LGOB0141
355000         MOVE 'ACTIVE'       TO WG-HST-FILE-LIT                   LGOB0141
355050       ELSE                                                       LGOB0141
355100         MOVE 'HIST-'        TO WK-M70-FLE-KQOA                   LGOB0141
355150         MOVE WG-HST-FLE-NUM TO WK-M70-FLE-PROB                   LGOB0141
355200         MOVE WK-M70-FLE-PRO TO WG-HST-FILE-LIT.                  LGOB0141
355250     IF WG-DSC-HST-LIT &lt; '1' OR                                   LGOB0141
355300        WG-DSC-HST-LIT &gt; '7'                                      LGOB0141
355350       IF WG-APPL-ID = WG-CP-APPL                                 LGOB0141
355400           MOVE WG-HST-FILE-LIT TO WG-X-WRK-53                    LGOB0141
355450           GO TO A40-360                                          LGOB0141
355500       ELSE                                                       LGOB0141
355550           MOVE WG-HST-FILE-LIT TO WG-X-WRK-54                    LGOB0141
355600           GO TO A40-360.                                         LGOB0141
355650     IF WG-DSC-HST-LIT = '1'                                      LGOB0141
355700         MOVE WG-HST-FILE-LIT TO WG-X-WRK-51                      LGOB0141
355750         GO TO A40-360.                                           LGOB0141
355800     IF WG-DSC-HST-LIT = '2'                                      LGOB0141
355850         MOVE WG-HST-FILE-LIT TO WG-X-WRK-52                      LGOB0141
355900         GO TO A40-360.                                           LGOB0141
355950     IF WG-DSC-HST-LIT = '3'                                      LGOB0141
356000         MOVE WG-HST-FILE-LIT TO WG-X-WRK-53                      LGOB0141
356050         GO TO A40-360.                                           LGOB0141
356100     IF WG-DSC-HST-LIT = '4'                                      LGOB0141
356150         MOVE WG-HST-FILE-LIT TO WG-X-WRK-54                      LGOB0141
356200         GO TO A40-360.                                           LGOB0141
356250     IF WG-DSC-HST-LIT = '5'                                      LGOB0141
356300         MOVE WG-HST-FILE-LIT TO WG-X-WRK-55                      LGOB0141
356350         GO TO A40-360.                                           LGOB0141
356400     IF WG-DSC-HST-LIT = '6'                                      LGOB0141
356450         MOVE WG-HST-FILE-LIT TO WG-X-WRK-56                      LGOB0141
356500         GO TO A40-360.                                           LGOB0141
356550     MOVE WG-HST-FILE-LIT    TO WG-X-WRK-57.                      LGOB0141
356600                                                                  LGOB0141
356650 A40-360.                                                         LGOB0141
356700     MOVE WG-HST-FLE         TO WG-FLE-HST.                       LGOB0141
356750     MOVE WG-FLE-NAME        TO WG-HST-FILE-NAME.                 LGOB0141
356800     MOVE WG-HST-FLE-NUM     TO WG-HST-FILE-NUM.                  LGOB0141
356850     MOVE WG-HST-FILE-NAME   TO WG-FLE-NAME.                      LGOB0141
356900     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY (WG-RES-FLE-SUB).    LGOB0141
356950     IF WG-KEY-RES-FCT = ZERO                                     LGOB0141
357000         GO TO A40-370.                                           LGOB0141
357050     MOVE WT-FLE-ENTRY (WG-KEY-RES-FCT) TO WG-FLE-ENTRY.          LGOB0141
357100     MOVE WG-HST-FLE         TO WG-FLE-HST.                       LGOB0141
357150     MOVE WG-FLE-NAME        TO WG-HST-FILE-NAME.                 LGOB0141
357200     MOVE WG-HST-FLE-NUM     TO WG-HST-FILE-NUM.                  LGOB0141
357250     MOVE WG-HST-FILE-NAME   TO WG-FLE-NAME.                      LGOB0141
357300     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY (WG-KEY-RES-FCT).    LGOB0141
357350     MOVE WT-FLE-ENTRY (WG-RES-FLE-SUB) TO WG-FLE-ENTRY.          LGOB0141
357400     MOVE WG-FLE-HST         TO WG-HST-FLE.                       LGOB0141
357450                                                                  LGOB0141
357500 A40-370.                                                         LGOB0141
357550     MOVE ZERO               TO WG-HST-FLE-END.                   LGOB0141
357600     MOVE WG-HST-FLE         TO WG-FLE-HST.                       LGOB0141
357650                                                                  LGOB0141
357700 A40-380.                                                         LGOB0141
357750     MOVE WG-TSQ-TRM-ID      TO WG-MPG-TSQ-TRM-ID.                LGOB0141
357800     MOVE WG-IVTEEJUQQ       TO WG-MPG-TSQ-IWOWY.                 LGOB0141
357850     MOVE WG-MPG-DSC         TO WG-MPG-TSQ-DSC.                   LGOB0141
357900     IF WG-MPG-MAIN = 'R'                                         LGOB0141
357950         GO TO A40-540.                                           LGOB0141
358000     IF WG-CMX-CD NOT = 'F'                                       LGOB0141
358050         GO TO A40-420.                                           LGOB0141
358100                                                                  LGOB0141
358150 A40-390.                                                         LGOB0141
358200     IF WG-HST-FLE-BURJ = ZERO                                    LGOB0141
358250         MOVE 'A0'           TO WG-CMX-ID                         LGOB0141
358300       ELSE                                                       LGOB0141
358350         MOVE 'H'            TO WG-PQT2                           LGOB0141
358400         MOVE WG-HST-FLE-BURJ TO WG-ZAO3.                         LGOB0141
358450     IF WG-MPG-GEN-JERY &gt; ZERO                                    LGOB0141
358500         MOVE 'G'            TO WG-MPG-GEN-PAGE                   XEEK014R
358505       ELSE                                                       XEEK014R
358510         MOVE 'R'            TO WG-MPG-GEN-PAGE                   XEEK014R
358515         MOVE SPACE          TO WG-MPG-PAGE-FORM.                 XEEK014R
358550     IF WG-CMX-ID = WG-MPG-LWJT-CMD AND                           LGOB0141
358600        WG-MPG-KEY-CHG = SPACE      AND                           LGOB0141
358650       (WG-MPG-TS-VSEYC &gt; ZERO OR                                 LGOB0141
358700        WG-MPG-TS-WEBDU &gt; ZERO)                                   LGOB0141
358750         GO TO A40-400.                                           LGOB0141
358800*    ALL TS IREK DELETE                                           LGOB0141
358850     MOVE 'D'                TO WG-MPG-TS-IO.                     LGOB0141
358900     PERFORM F40-MPG-TS-IO.                                       LGOB0141
358950     MOVE SPACE              TO WG-MPG-KEY-TOTAL.                 LGOB0141
359000     MOVE WK-MPG-ACUYH-INIT  TO WG-MPG-ACUYH.                     LGOB0141
359050     GO TO A40-410.                                               LGOB0141
359100                                                                  LGOB0141
359150*    READ FIRST TS IREK                                           LGOB0141
359200 A40-400.                                                         LGOB0141
359250     MOVE 'R'                TO WG-MPG-TS-IO.                     LGOB0141
359300     MOVE 1                  TO WG-MPG-TS-IREK.                   LGOB0141
359350     PERFORM F40-MPG-TS-IO.                                       LGOB0141
359400                                                                  LGOB0141
359450 A40-410.                                                         LGOB0141
359500     MOVE SPACE              TO WG-MPG-PAGE-FORM.                 LGOB0141
359550     MOVE ZERO               TO WG-MPG-QEKY-START.                LGOB0141
359600     MOVE 1                  TO WG-MPG-TS-DIDEK.                  LGOB0141
359650     MOVE ZERO               TO WG-MPG-TS-ICEJ.                   LGOB0141
359700     MOVE WG-MPG-TS-FREQ     TO WG-MPG-TS-GFELO.                  LGOB0141
359750     MOVE ZERO               TO WG-MPG-TS-HXERV.                  LGOB0141
359800     MOVE ZERO               TO WG-MPG-TS-CRKMM.                  LGOB0141
359850     MOVE WG-CMX-ID          TO WG-MPG-LWJT-CMD.                  LGOB0141
359900     MOVE 1                  TO WG-DSC-SCL-NO.                    LGOB0141
359950     MOVE 1                  TO WG-MPG-DSC-YOIM.                  LGOB0141
360000     GO TO A40-630.                                               LGOB0141
360050                                                                  LGOB0141
360100 A40-420.                                                         LGOB0141
360150     MOVE ZERO               TO WG-MPG-QEKY-EDALE.                LGOB0141
360200     IF WG-CMX-CD NOT = 'L'                                       LGOB0141
360250         GO TO A40-440.                                           LGOB0141
360300*    SET EOKDJOLC FOR PAGE NEXT                                   LGOB0141
360350     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
360400         MOVE WG-MPG-TS-WEBDU TO WG-MPG-QEKY-START                LGOB0141
360450         GO TO A40-430.                                           LGOB0141
360500     IF WG-DSC-PROC-CD = 'T'                                      LGOB0141
360550         COMPUTE WG-GUQ8 = WG-DSC-TOT-OCC - 1                     LGOB0141
360600       ELSE                                                       LGOB0141
360650         MOVE WG-DSC-TOT-OCC TO WG-GUQ8.                          LGOB0141
360700     COMPUTE WG-MPG-QEKY-START = WG-MPG-TS-VSEYC - WG-GUQ8 + 1.   LGOB0141
360750     IF WG-MPG-QEKY-START &lt; 1                                     LGOB0141
360800         MOVE 'F'            TO WG-CMX-BOX                        LGOB0141
360850         GO TO A40-390.                                           LGOB0141
360900                                                                  LGOB0141
360950 A40-430.                                                         LGOB0141
361000     MOVE 1                  TO WG-DSC-SCL-NO.                    LGOB0141
361050     MOVE 1                  TO WG-MPG-DSC-YOIM.                  LGOB0141
361100     PERFORM A40-850 THRU A40-860.                                LGOB0141
361150     GO TO A40-540.                                               LGOB0141
361200                                                                  LGOB0141
361250*    WG-CMX-CD = 'D' OR 'U'                                       LGOB0141
361300 A40-440.                                                         LGOB0141
361350     IF WG-MPG-CMD-CD = 'L'                                       LGOB0141
361400         MOVE WG-MPG-TS-HXERV TO WG-MPG-TS-KEEMGN.                LGOB0141
361450     IF WG-MPG-GEN-PAGE = 'R'                                     LGOB0141
361500         MOVE WG-MPG-TS-HXERV TO WG-MPG-START-LOC                 LGOB0141
361550         MOVE WG-MPG-TS-VSEYC TO WG-MPG-MAX-LOC                   LGOB0141
361600       ELSE                                                       LGOB0141
361650         MOVE WG-MPG-TS-CRKMM TO WG-MPG-START-LOC                 LGOB0141
361700         MOVE WG-MPG-TS-WEBDU TO WG-MPG-MAX-LOC.                  LGOB0141
361750     MOVE ZERO               TO WG-MPG-CMD-NUM.                   LGOB0141
361800     IF WG-CMX-2-8 = SPACE                                        LGOB0141
361850         MOVE ZERO           TO WG-DGU6                           LGOB0141
361900         GO TO A40-470.                                           LGOB0141
361950     MOVE 7                  TO WG-KYU7.                          LGOB0141
362000     MOVE 9                  TO WG-DGU6.                          LGOB0141
362050                                                                  LGOB0141
362100 A40-450.                                                         LGOB0141
362150     IF WG-DGU6 = 2                                               LGOB0141
362200         GO TO A40-470.                                           LGOB0141
362250     SUBTRACT 1              FROM WG-DGU6.                        LGOB0141
362300     IF WG-CMX-BOX-POS (WG-DGU6) = SPACE                          LGOB0141
362350         GO TO A40-450.                                           LGOB0141
362400     MOVE WG-CMX-BOX-POS (WG-DGU6) TO WG-MPG-CMD-HQOJ (WG-KYU7).  LGOB0141
362450     SUBTRACT 1              FROM WG-KYU7.                        LGOB0141
362500                                                                  LGOB0141
362550 A40-460.                                                         LGOB0141
362600     IF WG-DGU6 = 2                                               LGOB0141
362650         GO TO A40-470.                                           LGOB0141
362700     SUBTRACT 1              FROM WG-DGU6.                        LGOB0141
362750     MOVE WG-CMX-BOX-POS (WG-DGU6) TO WG-MPG-CMD-HQOJ (WG-KYU7).  LGOB0141
362800     SUBTRACT 1              FROM WG-KYU7.                        LGOB0141
362850     GO TO A40-460.                                               LGOB0141
362900                                                                  LGOB0141
362950 A40-470.                                                         LGOB0141
363000     IF WG-MPG-CMD-BURJ NUMERIC AND                               LGOB0141
363050       (WG-MPG-CMD-NUM  &gt; ZERO  OR                                LGOB0141
363100        WG-DGU6 = 2)            AND                               LGOB0141
363150       (WG-MPG-GEN-PAGE = 'R' OR                                  LGOB0141
363200        WG-MPG-PAGE-FORM = SPACE)                                 LGOB0141
363250         MOVE WG-MPG-CMD-NUM TO WG-MPG-QEKY-AHZC                  LGOB0141
363300         GO TO A40-520.                                           LGOB0141
363350     IF WG-MPG-GEN-PAGE = 'R'                                     LGOB0141
363400         MOVE WG-DSC-TOT-OCC TO WG-MPG-QEKY-AHZC                  LGOB0141
363450         GO TO A40-520.                                           LGOB0141
363500     IF WG-MPG-PAGE-FORM = SPACE                                  LGOB0141
363550         MOVE 1              TO WG-MPG-QEKY-AHZC                  LGOB0141
363600         GO TO A40-520.                                           LGOB0141
363650*    RECORD EADIOR WITHIN GENERIC KEY AGOUT                       LGOB0141
363700     IF WG-MPG-CMD-CD = 'L'                                       LGOB0141
363750         MOVE 1              TO WG-MPG-TS-HXERV                   LGOB0141
363800         MOVE 1              TO WG-MPG-TS-KEEMGN                  LGOB0141
363850         IF WG-DSC-XYYOKA                                         LGOB0141
363900             GO TO A40-490                                        LGOB0141
363950         ELSE                                                     LGOB0141
364000             GO TO A40-480.                                       LGOB0141
364050     MOVE 'N'                TO WG-MPG-XAWW-F.                    LGOB0141
364100     IF WG-MPG-CMD-BURJ NUMERIC AND                               LGOB0141
364150        WG-DGU6 = 2                                               LGOB0141
364200         MOVE WG-MPG-CMD-NUM TO WG-MPG-QEKY-AHZC                  LGOB0141
364250       ELSE                                                       LGOB0141
364300         IF WG-DSC-XYYOKA                                         LGOB0141
364350            MOVE WG-DSC-SCL-SCR TO WG-MPG-QEKY-AHZC               LGOB0141
364400         ELSE                                                     LGOB0141
364450            MOVE WG-DSC-TOT-OCC TO WG-MPG-QEKY-AHZC.              LGOB0141
364500     IF WG-CMX-CD = 'U'                                           LGOB0141
364550         MULTIPLY -1         BY WG-MPG-QEKY-AHZC                  LGOB0141
364600         MOVE 'D'            TO WG-CMX-CD.                        LGOB0141
364650     IF WG-DSC-XYYOKA                                             LGOB0141
364700         GO TO A40-490.                                           LGOB0141
364750     ADD WG-MPG-QEKY-AHZC    TO WG-MPG-TS-HXERV.                  LGOB0141
364800                                                                  LGOB0141
364850 A40-480.                                                         LGOB0141
364900     IF WG-MPG-TS-HXERV &lt; 1                                       LGOB0141
364950         MOVE 1              TO WG-MPG-TS-HXERV.                  LGOB0141
365000     COMPUTE WG-MPG-QEKY-BOMXD = WG-MPG-TS-HXERV - 1.             LGOB0141
365050     GO TO A40-510.                                               LGOB0141
365100                                                                  LGOB0141
365150 A40-490.                                                         LGOB0141
365200     COMPUTE WG-MPG-DSC-DOIJ = WG-MPG-DSC-YOIM + WG-MPG-QEKY-AHZC LGOB0141
365250         + (WG-DSC-OCC-NUM * (WG-MPG-TS-HXERV - 1)).              LGOB0141
365300                                                                  LGOB0141
365350 A40-500.                                                         LGOB0141
365400     IF WG-MPG-DSC-DOIJ &lt; 1                                       LGOB0141
365450         MOVE 1              TO WG-MPG-DSC-DOIJ.                  LGOB0141
365500     DIVIDE WG-MPG-DSC-DOIJ BY WG-DSC-OCC-NUM                     LGOB0141
365550         GIVING WG-MPG-QEKY-AHZC REMAINDER WG-DSC-SCL-NO.         LGOB0141
365600     IF WG-DSC-SCL-NO = ZERO                                      LGOB0141
365650         SUBTRACT 1          FROM WG-MPG-QEKY-AHZC                LGOB0141
365700         MOVE WG-DSC-OCC-NUM TO WG-DSC-SCL-NO.                    LGOB0141
365750     IF WG-MPG-QEKY-AHZC &lt; ZERO                                   LGOB0141
365800         MOVE ZERO           TO WG-MPG-QEKY-AHZC                  LGOB0141
365850         MOVE 1              TO WG-DSC-SCL-NO.                    LGOB0141
365900     MOVE WG-DSC-SCL-NO      TO WG-MPG-DSC-YOIM.                  LGOB0141
365950     MOVE WG-MPG-QEKY-AHZC   TO WG-MPG-QEKY-BOMXD.                LGOB0141
366000     COMPUTE WG-MPG-TS-HXERV = WG-MPG-QEKY-AHZC + 1.              LGOB0141
366050                                                                  LGOB0141
366100 A40-510.                                                         LGOB0141
366150     MOVE WG-MPG-TS-CRKMM    TO WG-MPG-QEKY-START.                LGOB0141
366200     PERFORM A40-850 THRU A40-860.                                LGOB0141
366250     MOVE WG-VHZ4            TO WG-MPG-YUUO-GEEE.                 LGOB0141
366300     GO TO A40-540.                                               LGOB0141
366350                                                                  LGOB0141
366400 A40-520.                                                         LGOB0141
366450     IF WG-CMX-CD = 'U'                                           LGOB0141
366500         MULTIPLY -1         BY WG-MPG-QEKY-AHZC                  LGOB0141
366550         MOVE 'D'            TO WG-CMX-CD.                        LGOB0141
366600     COMPUTE WG-MPG-QEKY-START = WG-MPG-START-LOC                 LGOB0141
366650                               + WG-MPG-QEKY-AHZC.                LGOB0141
366700     IF WG-MPG-QEKY-START &lt; 2                                     LGOB0141
366750         MOVE 'F'            TO WG-CMX-BOX                        LGOB0141
366800         GO TO A40-390.                                           LGOB0141
366850     IF WG-MPG-MAX-LOC NOT &lt; WG-MPG-QEKY-START                    LGOB0141
366900         GO TO A40-530.                                           LGOB0141
366950     COMPUTE WG-MPG-QEKY-EDALE = WG-MPG-QEKY-START                LGOB0141
367000                               - WG-MPG-MAX-LOC.                  LGOB0141
367050     MOVE WG-MPG-MAX-LOC     TO WG-MPG-QEKY-START.                LGOB0141
367100                                                                  LGOB0141
367150 A40-530.                                                         LGOB0141
367200     IF WG-MPG-PAGE-FORM = SPACE OR                               LGOB0141
367250        NOT WG-DSC-XYYOKA                                         LGOB0141
367300         MOVE 1              TO WG-DSC-SCL-NO                     LGOB0141
367350         MOVE 1              TO WG-MPG-DSC-YOIM.                  LGOB0141
367400     PERFORM A40-850 THRU A40-860.                                LGOB0141
367450     COMPUTE WG-MPG-QEKY-WAZQ = WG-MPG-QEKY-EDALE + WG-VHZ4.      LGOB0141
367500     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
367550         MOVE WG-MPG-QEKY-WAZQ TO WG-MPG-YUUO-GEEE                LGOB0141
367600       ELSE                                                       LGOB0141
367650         MOVE WG-MPG-QEKY-WAZQ TO WG-MPG-QEKY-GEEE.               LGOB0141
367700     IF WG-MPG-QEKY-WAZQ = 1 AND                                  LGOB0141
367750        WG-MPG-CMD-CD = SPACE                                     LGOB0141
367800         MOVE 'N'            TO WG-MPG-XAWW-F.                    LGOB0141
367850                                                                  LGOB0141
367900*    SET STARTING KEY FOR PAGE                                    LGOB0141
367950 A40-540.                                                         LGOB0141
368000     IF WG-MPG-MAIN = 'R'                                         LGOB0141
368050         MOVE WT-FLE-KEY-CNPKOE (WG-MPG-DSC) TO WG-MPG-KEY-START. LGOB0141
368100     IF WG-MPG-KEY-START = SPACE                                  LGOB0141
368150         MOVE WT-FLE-KEY        (WG-MPG-DSC) TO WG-MPG-KEY-START. LGOB0141
368200     MOVE WG-MPG-KEY-START   TO WG-FLE-KEY-CNPKOE.                LGOB0141
368250     MOVE 'N'                TO WG-MPG-END-PAGE.                  LGOB0141
368300     MOVE ZERO               TO WG-NUM-PGE-ENT.                   LGOB0141
368350     MOVE SPACE              TO WG-MPG-EWSZJM.                    LGOB0141
368400     IF WG-CMX-CD NOT = 'F'                                       LGOB0141
368450         MOVE WG-MPG-KEY-START TO WG-MPG-KEY (1).                 LGOB0141
368500     MOVE ZERO               TO WG-MPG-QEKY-MERU.                 LGOB0141
368550     IF WG-MPG-MAIN = 'R'                                         LGOB0141
368600         GO TO A40-610.                                           LGOB0141
368650     IF WG-MPG-XAWW-F = 'N'                                       LGOB0141
368700         GO TO A40-630.                                           LGOB0141
368750*    START FILE OoIiJioXiGL XAWW 'F'                              LGOB0141
368800     MOVE 'F'                TO WG-MPG-XAWW.                      LGOB0141
368850     MOVE 'N'                TO WG-MPG-NDX-READ.                  LGOB0141
368900     MOVE ZERO               TO WG-MPG-YUUO-GOT.                  LGOB0141
368950     MOVE ZERO               TO WG-MPG-QEKY-GOT.                  LGOB0141
369000     MOVE SPACE              TO WG-FIRST-KEY.                     LGOB0141
369050     MOVE SPACE              TO WG-SEC-TASK-INFO-TLEO.            LGOB0141
369100     MOVE 'Y'                TO WG-CHG-RES-SUB.                   LGOB0141
369150     MOVE WG-MPG-ACUYH       TO WG-ALUD-NEUSQ.                    LGOB0141
369200     PERFORM B40-MPG-INIT.                                        LGOB0141
369250     IF WG-TEYI12 (1:3) = WK-M78 (1:3)                            LGOB0141
369300         MOVE 'Y'            TO WG-MPG-INIT                       LGOB0141
369350         GO TO A40-EXIT.                                          LGOB0141
369400     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
369450         GO TO A40-20.                                            LGOB0141
369500     MOVE WG-ALUD-NEUSQ      TO WG-MPG-ACUYH.                     LGOB0141
369550     MOVE WG-FILE-KEY        TO WG-MPG-KEY-XAWW-F.                LGOB0141
369600     IF WG-MPG-QEKY-CUR &gt; WG-MPG-TS-VSEYC                         LGOB0141
369650         MOVE WG-MPG-QEKY-CUR TO WG-MPG-TS-VSEYC.                 LGOB0141
369700     IF WG-MPG-YUUO-CUR &gt; WG-MPG-TS-WEBDU                         LGOB0141
369750         MOVE WG-MPG-YUUO-CUR TO WG-MPG-TS-WEBDU.                 LGOB0141
369800*    SET EOKDJOLC FOR NEXT 'L' XAWW                               LGOB0141
369850     MOVE 'L'                TO WG-MPG-XAWW.                      LGOB0141
369900     IF WG-CMX-CD = 'L'                                           LGOB0141
369950         GO TO A40-590.                                           LGOB0141
370000     IF WG-MPG-CMD-CD = SPACE                                     LGOB0141
370050         GO TO A40-550.                                           LGOB0141
370100     MOVE 'N'                TO WG-MPG-XAWW-F.                    LGOB0141
370150     COMPUTE WG-MPG-TS-HXERV = WG-MPG-TS-KEEMGN                   LGOB0141
370200           + WG-MPG-TS-AUETVY - WG-DSC-TOT-OCC.                   LGOB0141
370250     IF WG-DSC-PROC-CD = 'T'                                      LGOB0141
370300         ADD 1               TO WG-MPG-TS-HXERV.                  LGOB0141
370350     IF NOT WG-DSC-XYYOKA                                         LGOB0141
370400         GO TO A40-480.                                           LGOB0141
370450     COMPUTE WG-MPG-DSC-DOIJ = (WG-DSC-OCC-NUM * WG-MPG-TS-HXERV) LGOB0141
370500                              - WG-DSC-SCL-SCR + 1.               LGOB0141
370550     GO TO A40-500.                                               LGOB0141
370600                                                                  LGOB0141
370650 A40-550.                                                         LGOB0141
370700     IF WG-MPG-PAGE-FORM = SPACE                                  LGOB0141
370750         GO TO A40-560.                                           LGOB0141
370800     IF WG-MPG-END-PAGE = 'Y' AND                                 LGOB0141
370850        WG-MPG-QEKY-GOT &lt; WG-MPG-QEKY-BOMXD                       LGOB0141
370900         MOVE SPACE          TO WG-MPG-PAGE-FORM                  LGOB0141
370950         MOVE 'D'            TO WG-CMX-BOX                        LGOB0141
371000         GO TO A40-380.                                           LGOB0141
371050     GO TO A40-570.                                               LGOB0141
371100                                                                  LGOB0141
371150 A40-560.                                                         LGOB0141
371200     IF (WG-MPG-GEN-PAGE = 'G' AND                                LGOB0141
371250         WG-MPG-YUUO-GOT NOT &lt; WG-MPG-YUUO-GEEE) OR               LGOB0141
371300        (WG-MPG-GEN-PAGE = 'R' AND                                LGOB0141
371350         WG-MPG-QEKY-GOT NOT &lt; WG-MPG-QEKY-GEEE)                  LGOB0141
371400         GO TO A40-570.                                           LGOB0141
371450     IF WG-HST-JUTX = 'M'                                         LGOB0141
371500         MOVE ZERO           TO WG-MPG-QEKY-GOT                   LGOB0141
371550         GO TO A40-600.                                           LGOB0141
371600     IF WG-MPG-ANY-REC = SPACE                                    LGOB0141
371650         MOVE ZERO           TO WG-MPG-QEKY-GOT                   LGOB0141
371700         GO TO A40-720.                                           LGOB0141
371708     IF WG-CMX-BOX      = 'D'   AND                               XEEK014R
371710        WG-DSC-PROC-CD  = 'T'   AND                               XEEK014R
371712        WG-MPG-QEKY-GOT = 1     AND                               XEEK014R
371714       (WG-MPG-TS-HXERV &gt; ZERO OR                                 XEEK014R
371716        WG-MPG-TS-CRKMM &gt; ZERO)                                   XEEK014R
371718         MOVE 'L'            TO WG-CMX-BOX                        XEEK014R
371720         GO TO A40-10.                                            XEEK014R
371750     MOVE SPACE              TO WG-MPG-ANY-REC.                   LGOB0141
371800     MOVE SPACE              TO WG-MPG-PAGE-FORM.                 LGOB0141
371850     MOVE SPACE              TO WG-MPG-TLEO-END.                  LGOB0141
371900     MOVE SPACE              TO WG-MPG-TLEO-IOHI.                 LGOB0141
371950     MOVE SPACE              TO WG-TEYI12.                        LGOB0141
372000     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-MPG-DSC).    LGOB0141
372050     MOVE 'F'                TO WG-CMX-BOX.                       LGOB0141
372100     MOVE WK-M27             TO WG-MPG-TEYI12.                    LGOB0141
372150     GO TO A40-310.                                               LGOB0141
372200                                                                  LGOB0141
372250 A40-570.                                                         LGOB0141
372300     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
372350         MOVE WG-MPG-TS-CRKMM TO WG-MPG-QEKY-START                LGOB0141
372400       ELSE                                                       LGOB0141
372450         MOVE WG-MPG-TS-HXERV TO WG-MPG-QEKY-START.               LGOB0141
372500     PERFORM A40-850 THRU A40-860.                                LGOB0141
372550     MOVE WG-MPG-QEKY-CUAME  TO WG-MPG-QEKY-START.                LGOB0141
372600     IF WG-VHZ4 = 1                                               LGOB0141
372650         GO TO A40-590.                                           LGOB0141
372700     ADD 1                   TO WG-MPG-TS-ICEJ.                   LGOB0141
372750     COMPUTE WG-MPG-TS-GFELO = WG-VHZ4 - 2.                       LGOB0141
372800     IF WG-MPG-TS-ICEJ NOT &lt; WG-MPG-TS-MAX-KEY                    LGOB0141
372850         GO TO A40-580.                                           LGOB0141
372900     IF WG-MPG-TS-GFELO &gt; ZERO                                    LGOB0141
372950         ADD 1               TO WG-MPG-TS-ICEJ.                   LGOB0141
373000     GO TO A40-590.                                               LGOB0141
373050                                                                  LGOB0141
373100 A40-580.                                                         LGOB0141
373150     COMPUTE WG-MPG-QEKY-NEXT =                                   LGOB0141
373200       (WG-MPG-TS-DIDEK * WG-MPG-TS-MAX-KEY * WG-MPG-TS-FREQ) + 1.LGOB0141
373250     ADD 1                   TO WG-MPG-TS-DIDEK.                  LGOB0141
373300     MOVE ZERO               TO WG-MPG-TS-ICEJ.                   LGOB0141
373350     IF (WG-MPG-GEN-PAGE = 'G' AND                                LGOB0141
373400         WG-MPG-QEKY-NEXT &gt; WG-MPG-TS-WEBDU) OR                   LGOB0141
373450        (WG-MPG-GEN-PAGE = 'R' AND                                LGOB0141
373500         WG-MPG-QEKY-NEXT &gt; WG-MPG-TS-VSEYC)                      LGOB0141
373550         COMPUTE WG-MPG-TS-HXERV = WG-VHZ4 - 1                    LGOB0141
373600         MOVE 'W'            TO WG-MPG-TSQ-REWRITE                LGOB0141
373650         MOVE SPACE          TO WG-MPG-TSQ-REC                    LGOB0141
373700         GO TO A40-590.                                           LGOB0141
373750*    READ NEXT TS IREK                                            LGOB0141
373800     MOVE 'R'                TO WG-MPG-TS-IO.                     LGOB0141
373850     MOVE WG-MPG-TS-DIDEK    TO WG-MPG-TS-IREK.                   LGOB0141
373900     PERFORM F40-MPG-TS-IO.                                       LGOB0141
373950                                                                  LGOB0141
374000 A40-590.                                                         LGOB0141
374050     MOVE WG-QEKY-PEOUIEU    TO WG-MPG-QEKY-MERU.                 LGOB0141
374100     IF WG-HST-JUTX NOT = 'M'                                     LGOB0141
374150         GO TO A40-610.                                           LGOB0141
374200                                                                  LGOB0141
374250*    SET HISTORY END TEXMAHE EOKDJOLC                             LGOB0141
374300 A40-600.                                                         LGOB0141
374350     MOVE 'R'                TO WG-MPG-RCEAS.                     LGOB0141
374400     PERFORM A40-870 THRU A40-940.                                LGOB0141
374450     IF WG-MPG-KEY-START = WG-FLE-KEY-CNPKOE                      LGOB0141
374500         MOVE WG-FILE-KEY       TO WG-MPG-KEY-START               LGOB0141
374550       ELSE                                                       LGOB0141
374600         MOVE WG-FLE-KEY-CNPKOE TO WG-MPG-KEY-START.              LGOB0141
374650     GO TO A40-690.                                               LGOB0141
374700                                                                  LGOB0141
374750 A40-610.                                                         LGOB0141
374800     IF WG-CMX-CD NOT = 'L' AND                                   LGOB0141
374850        WG-MPG-CMD-CD = SPACE                                     LGOB0141
374900         GO TO A40-630.                                           LGOB0141
374950     IF WG-DSC-PROC-CD = 'T'                                      LGOB0141
375000         COMPUTE WG-GUQ8 = WG-DSC-TOT-OCC - 1                     LGOB0141
375050       ELSE                                                       LGOB0141
375100         MOVE WG-DSC-TOT-OCC TO WG-GUQ8.                          LGOB0141
375150     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
375200         MOVE WG-MPG-TS-WEBDU TO WG-MPG-QEKY-START                LGOB0141
375250       ELSE                                                       LGOB0141
375300        COMPUTE WG-MPG-QEKY-START = WG-MPG-TS-VSEYC - WG-GUQ8 + 1.LGOB0141
375350     PERFORM A40-850 THRU A40-860.                                LGOB0141
375400     MOVE WG-MPG-KEY (1)     TO WG-MPG-KEY-START.                 LGOB0141
375450     MOVE WG-MPG-QEKY-CUAME  TO WG-MPG-QEKY-START.                LGOB0141
375500     IF WG-VHZ4 = 1                                               LGOB0141
375550         MOVE WG-MPG-TS-FREQ TO WG-MPG-TS-GFELO                   LGOB0141
375600         GO TO A40-630.                                           LGOB0141
375650     ADD 1                   TO WG-MPG-TS-ICEJ.                   LGOB0141
375700     COMPUTE WG-MPG-TS-GFELO = WG-VHZ4 - 2.                       LGOB0141
375750     IF WG-MPG-TS-GFELO = ZERO                                    LGOB0141
375800         GO TO A40-630.                                           LGOB0141
375850     IF WG-MPG-TS-ICEJ NOT &lt; WG-MPG-TS-MAX-KEY                    LGOB0141
375900         GO TO A40-620.                                           LGOB0141
375950     ADD 1                   TO WG-MPG-TS-ICEJ.                   LGOB0141
376000     GO TO A40-630.                                               LGOB0141
376050                                                                  LGOB0141
376100*    READ NEXT TS IREK                                            LGOB0141
376150 A40-620.                                                         LGOB0141
376200     MOVE 'Y'                TO WG-MPG-IYELEIT-OK.                LGOB0141
376250     ADD 1                   TO WG-MPG-TS-DIDEK.                  LGOB0141
376300     MOVE 'R'                TO WG-MPG-TS-IO.                     LGOB0141
376350     MOVE WG-MPG-TS-DIDEK    TO WG-MPG-TS-IREK.                   LGOB0141
376400     PERFORM F40-MPG-TS-IO.                                       LGOB0141
376450     IF WG-MPG-IYELEIT-OK = 'E'                                   LGOB0141
376500         MOVE 'W'            TO WG-MPG-TSQ-REWRITE                LGOB0141
376550         MOVE SPACE          TO WG-MPG-TSQ-REC.                   LGOB0141
376600     MOVE SPACE              TO WG-MPG-IYELEIT-OK.                LGOB0141
376650     MOVE ZERO               TO WG-MPG-TS-ICEJ.                   LGOB0141
376700                                                                  LGOB0141
376750 A40-630.                                                         LGOB0141
376800     MOVE 'L'                TO WG-MPG-XAWW.                      LGOB0141
376850     MOVE 'P'                TO WG-MPG-RCEAS.                     LGOB0141
376900     PERFORM A40-870 THRU A40-940.                                LGOB0141
376950     MOVE SPACE              TO WG-TEYI12.                        LGOB0141
377000     MOVE SPACE              TO WG-FIRST-KEY.                     LGOB0141
377050     MOVE SPACE              TO WG-HST-JUTX.                      LGOB0141
377100     IF WG-MPG-MAIN = 'P'                                         LGOB0141
377150         MOVE SPACE          TO WG-MPG-TEQK.                      LGOB0141
377200     IF WG-MPG-GEN-PAGE = 'G' AND                                 LGOB0141
377250        WG-MPG-PAGE-FORM = SPACE                                  LGOB0141
377300         MOVE 1              TO WG-MPG-YUUO-GEEE                  LGOB0141
377350         MOVE SPACE          TO WG-MPG-KEY-TOTAL                  LGOB0141
377400         MOVE WK-MPG-ACUYH-INIT TO WG-MPG-ACUYH.                  LGOB0141
377450     IF WG-CMX-CD = 'F'                                           LGOB0141
377500         MOVE 1              TO WG-DSC-SCL-NO                     LGOB0141
377550         MOVE 1              TO WG-MPG-DSC-YOIM.                  LGOB0141
377600     MOVE ZERO               TO WG-MPG-YUUO-GOT.                  LGOB0141
377650     MOVE ZERO               TO WG-MPG-QEKY-GOT.                  LGOB0141
377700     MOVE ZERO               TO WG-NUM-PGE-ENT.                   LGOB0141
377750     MOVE SPACE              TO WG-SEC-TASK-INFO-TLEO.            LGOB0141
377800     MOVE 'Y'                TO WG-CHG-RES-SUB.                   LGOB0141
377850     MOVE 'N'                TO WG-MPG-END-PAGE.                  LGOB0141
377900     MOVE 'N'                TO WG-MPG-NDX-READ.                  LGOB0141
377950     MOVE ZERO               TO WG-MPG-DFD-NUM.                   LGOB0141
378000     MOVE WG-MPG-ACUYH       TO WG-ALUD-NEUSQ.                    LGOB0141
378050     PERFORM B40-MPG-INIT.                                        LGOB0141
378100     IF WG-TEYI12 (1:3) = WK-M78 (1:3)                            LGOB0141
378150         MOVE 'Y'            TO WG-MPG-INIT                       LGOB0141
378200         GO TO A40-EXIT.                                          LGOB0141
378250     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
378300         GO TO A40-20.                                            LGOB0141
378350     MOVE WG-ALUD-NEUSQ      TO WG-MPG-ACUYH.                     LGOB0141
378400     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
378450         GO TO A40-640.                                           LGOB0141
378500     IF WG-MPG-QEKY-CUR &gt; WG-MPG-TS-VSEYC                         LGOB0141
378550         MOVE WG-MPG-QEKY-CUR TO WG-MPG-TS-VSEYC.                 LGOB0141
378600     GO TO A40-660.                                               LGOB0141
378650                                                                  LGOB0141
378700 A40-640.                                                         LGOB0141
378750     IF WG-MPG-PAGE-FORM = SPACE                                  LGOB0141
378800         MOVE 1              TO WG-MPG-TS-HXERV                   LGOB0141
378850         GO TO A40-650.                                           LGOB0141
378900     IF WG-MPG-END-PAGE = 'Y' AND                                 LGOB0141
378950        WG-MPG-QEKY-GOT &lt; WG-MPG-QEKY-BOMXD                       LGOB0141
379000        IF WG-DSC-PROC-CD = 'T'                                   LGOB0141
379050            COMPUTE WG-MPG-TS-HXERV = WG-MPG-QEKY-GOT + 2         LGOB0141
379100        ELSE                                                      LGOB0141
379150            COMPUTE WG-MPG-TS-HXERV = WG-MPG-QEKY-GOT + 1.        LGOB0141
379200     IF WG-MPG-XAWW-F   = 'N' AND                                 LGOB0141
379250        WG-MPG-END-PAGE = 'Y' AND                                 LGOB0141
379300        WG-HST-JUTX NOT = 'M' AND                                 LGOB0141
379350        WG-MPG-QEKY-GOT &lt; WG-MPG-QEKY-BOMXD                       LGOB0141
379400         MOVE 'Y'            TO WG-MPG-XAWW-F                     LGOB0141
379450         MOVE SPACE          TO WG-MPG-PAGE-FORM                  LGOB0141
379500         MOVE 'D'            TO WG-CMX-BOX                        LGOB0141
379550         GO TO A40-380.                                           LGOB0141
379600                                                                  LGOB0141
379650 A40-650.                                                         LGOB0141
379700     IF WG-MPG-YUUO-CUR &gt; WG-MPG-TS-WEBDU                         LGOB0141
379750         MOVE WG-MPG-YUUO-CUR TO WG-MPG-TS-WEBDU.                 LGOB0141
379800                                                                  LGOB0141
379850 A40-660.                                                         LGOB0141
379900     IF WG-MPG-MAIN = 'R' OR                                      LGOB0141
379950        WG-MPG-DSC NOT = WG-MPG-CMD-DSC                           LGOB0141
380000         GO TO A40-690.                                           LGOB0141
380050                                                                  LGOB0141
380100 A40-665.                                                         LGOB0141
380150     MOVE ZERO               TO WG-VHZ4.                          LGOB0141
380200                                                                  LGOB0141
380250*    SET KOUOQ AND IIUICE FOR UDES IPLUITG KEY FIELDS             LGOB0141
380300 A40-670.                                                         LGOB0141
380350     ADD 1                   TO WG-VHZ4.                          LGOB0141
380400     IF WG-VHZ4 &gt; 8                                               LGOB0141
380450         GO TO A40-680.                                           LGOB0141
380500     MOVE WG-NDX-KEY-FLD (WG-VHZ4) TO WG-ENT5.                    LGOB0141
380550     IF WG-ENT5 = ZERO                                            LGOB0141
380600         GO TO A40-680.                                           LGOB0141
380650     MOVE WT-KEY-ENTRY (WG-ENT5) TO WG-KEY-ENTRY.                 LGOB0141
380700     MOVE WG-KEY-FLD-DEF         TO WG-KEY-FLD-OET9.              LGOB0141
380750     IF WG-KEY-FLD-MAST NOT = ZERO                                LGOB0141
380800         MOVE WT-KEY-ENTRY (WG-KEY-FLD-MAST) TO WG-KEY-ENTRY.     LGOB0141
380850     IF WG-KEY-DFD-SUPZ = ZERO                                    LGOB0141
380900         GO TO A40-670.                                           LGOB0141
380950     MOVE WT-DFD-CNTL (WG-KEY-DFD-SUPZ) TO WG-DFD-FLD-CLMP9.      LGOB0141
381000     IF WG-MPG-PAGE-KOUOQ   = 'Y' AND                             LGOB0141
381050        WG-DFD-PODN-ENH NOT = '8' AND                             LGOB0141
381100        WG-DFD-BDFP-CD  NOT = '2'                                 LGOB0141
381150         MOVE WG-MPG-HOMOV8    TO WG-DFD-BDFP-CD                  LGOB0141
381200         MOVE WG-MPG-EDU8      TO WG-DFD-PODN-ENH                 LGOB0141
381250         MOVE WG-DFD-FLD-CLMP9 TO WT-DFD-CNTL (WG-KEY-DFD-SUPZ).  LGOB0141
381300     GO TO A40-670.                                               LGOB0141
381350                                                                  LGOB0141
381400 A40-680. EXIT.                                                   LGOB0141
381450                                                                  LGOB0141
381500*    BUILD TOTAL LINE                                             LGOB0141
381550 A40-690.                                                         LGOB0141
381600     IF WG-DSC-PROC-CD NOT = 'T' OR                               LGOB0141
381650       (WG-MPG-TS-HXERV = ZERO AND                                LGOB0141
381700        WG-MPG-TS-CRKMM = ZERO)  OR                               LGOB0141
381750       (WG-MPG-END-PAGE  = 'N'  AND                               LGOB0141
381800        WG-RES-ECFMEUVPP = 'N'  AND                               LGOB0141
381850        WG-CMX-CD NOT    = 'L'  AND                               LGOB0141
381900        WG-MPG-CMD-CD = SPACE)                                    LGOB0141
381950         GO TO A40-710.                                           LGOB0141
382000     IF WG-MPG-TEYI12 = WK-M27                                    LGOB0141
382050         MOVE SPACE          TO WG-MPG-TEYI12.                    LGOB0141
382100     IF WG-MPG-QEKY-GOT = ZERO AND                                LGOB0141
382150        WG-MPG-GOT-GRP = SPACE                                    LGOB0141
382200         MOVE 'R'            TO WG-MPG-RCEAS                      LGOB0141
382250         PERFORM A40-870 THRU A40-940                             LGOB0141
382300         MOVE 1              TO WG-MPG-QEKY-GOT                   LGOB0141
382350         MOVE 1              TO WG-G40-DSC-WOMH                   LGOB0141
382400         GO TO A40-700.                                           LGOB0141
382450     IF WG-MPG-END-PAGE  = 'N' AND                                LGOB0141
382500        WG-RES-ECFMEUVPP = 'N'                                    LGOB0141
382550         ADD 1               TO WG-G40-DSC-WOMH.                  LGOB0141
382600     IF WG-G40-DSC-WOMH &gt; WG-DSC-TOT-OCC                          LGOB0141
382650         GO TO A40-710.                                           LGOB0141
382700                                                                  LGOB0141
382750 A40-700.                                                         LGOB0141
382800     MOVE 'Y'                TO WG-IPLUITG-TOT.                   LGOB0141
382850     PERFORM G42-GET-DFD-ENT.                                     LGOB0141
382900     IF WG-CMX-CD = 'L'                                           LGOB0141
382950         MOVE 'Y'            TO WG-RES-ECFMEUVPP.                 LGOB0141
383000                                                                  LGOB0141
383050 A40-710.                                                         LGOB0141
383100     IF WG-DSC-PAGE AND                                           LGOB0141
383150        WG-MPG-TEYI12 = SPACE                                     LGOB0141
383200         MOVE WG-TEYI12      TO WG-MPG-TEYI12.                    LGOB0141
383250     IF WG-MPG-QEKY-GOT &gt; ZERO                                    LGOB0141
383300         MOVE 'Y'            TO WG-MPG-ANY-REC.                   LGOB0141
383350     IF WG-HST-JUTX = 'M'                                         LGOB0141
383400         MOVE SPACE          TO WG-MPG-KEY-CHG                    LGOB0141
383450         MOVE 'N'            TO WG-RES-ECFMEUVPP.                 LGOB0141
383500                                                                  LGOB0141
383550*    DACE UVJAOEA SECTION EADIOR EOKDJOLC                         LGOB0141
383600 A40-720.                                                         LGOB0141
383650     MOVE 'Y'                TO WG-MPG-UDES.                      LGOB0141
383700     MOVE 'Y'                TO WG-MPG-DSC-UDES.                  LGOB0141
383750     IF WG-MPG-MAIN = 'R'                                         LGOB0141
383800         MOVE SPACE          TO WG-MPG-TLEO-END                   LGOB0141
383850       ELSE                                                       LGOB0141
383900         MOVE WG-RES-ECFMEUVPP TO WG-MPG-TLEO-END.                LGOB0141
383950     MOVE WG-DSC-ENTRY       TO WT-DSC-ENTRY     (WG-MPG-DSC).    LGOB0141
384000     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-MPG-DSC).    LGOB0141
384050     MOVE WG-HST-FLE         TO WG-FLE-HST.                       LGOB0141
384100     MOVE WG-FLE-ENTRY       TO WT-FLE-ENTRY     (WG-RES-FLE-SUB).LGOB0141
384150     MOVE WG-FLE-TEQK        TO WT-FLE-TEQK      (WG-MPG-DSC).    LGOB0141
384200     IF WG-MPG-DSC = WG-MPG-DSC-KEY AND                           LGOB0141
384250        WG-TEYI12 = WK-M21                                        LGOB0141
384300         MOVE ZERO           TO WG-MPG-DSC-KEY.                   LGOB0141
384350     IF WG-MPG-MAIN = 'R'                                         LGOB0141
384400         GO TO A40-800.                                           LGOB0141
384450     IF WG-MPG-QEKY-GOT = ZERO AND                                LGOB0141
384500        WG-MPG-GOT-GRP = SPACE                                    LGOB0141
384550         MOVE 'R'            TO WG-MPG-RCEAS                      LGOB0141
384600         PERFORM A40-870 THRU A40-940                             LGOB0141
384650         GO TO A40-810.                                           LGOB0141
384700     MOVE SPACE              TO WG-MPG-PAGE-FORM.                 LGOB0141
384750     MOVE ZERO               TO WG-IDV1.                          LGOB0141
384800                                                                  LGOB0141
384850*    FIND ANY OTHER FETCIOIS AKUEBLIFP KAXE FILE AND CHANGE       LGOB0141
384900*    KEY TO KEEP FETCIOIS IN JUST                                 LGOB0141
384950 A40-730.                                                         LGOB0141
385000     ADD 1                   TO WG-IDV1.                          LGOB0141
385050     IF WG-IDV1 &gt; WT-NUM-DSC-ENT                                  LGOB0141
385100         GO TO A40-800.                                           LGOB0141
385150     IF WT-MPG-MAIN-DSC (WG-IDV1) NOT = WG-MPG-DSC                LGOB0141
385200         GO TO A40-730.                                           LGOB0141
385250     MOVE WT-DSC-ENTRY     (WG-IDV1)     TO WG-DSC-ENTRY.         LGOB0141
385300     MOVE WT-MPG-DSC-AGOUT (WG-IDV1)     TO WG-MPG-DSC-AGOUT.     LGOB0141
385350     MOVE WT-MPG-KOUOQ (WG-MPG-DSC)      TO WG-MPG-KOUOQ.         LGOB0141
385400     MOVE WT-FLE-ENTRY (WG-RES-FLE-SUB)  TO WG-FLE-ENTRY-H.       LGOB0141
385450     MOVE WT-RES-KEY   (WG-DSC-RES-SUB)  TO WG-MPG-RES-KEY.       LGOB0141
385500     MOVE WT-NDX-ENTRY (WG-MPG-FLE-NDX)  TO WG-NDX-ENTRY.         LGOB0141
385550*    USE GAIIPE KEY FOR OTHER KAXE FILE FETCIOIS                  LGOB0141
385600     IF WG-NDX-ID = SPACE OR                                      LGOB0141
385650        WG-NDX-USE-NDX = SPACE                                    LGOB0141
385700         MOVE WG-MPG-KEY-START  TO WG-FIRST-KEY                   LGOB0141
385750       ELSE                                                       LGOB0141
385800         MOVE WG-MPG-KEY-FUYAED TO WG-FIRST-KEY.                  LGOB0141
385850     IF WG-MPG-GEN-JERY = ZERO                                    LGOB0141
385900         GO TO A40-750.                                           LGOB0141
385950     MOVE WG-MPG-GEN-JERY    TO WG-VHZ4.                          LGOB0141
386000                                                                  LGOB0141
386050 A40-740.                                                         LGOB0141
386100     ADD 1                   TO WG-VHZ4.                          LGOB0141
386150     IF WG-VHZ4 &gt; WG-FLE-LOG-JERY-H                               LGOB0141
386200         GO TO A40-790.                                           LGOB0141
386250     IF WG-FIRST-KEY-POS (WG-VHZ4) = SPACE                        LGOB0141
386300         GO TO A40-740.                                           LGOB0141
386350                                                                  LGOB0141
386400 A40-750.                                                         LGOB0141
386450     IF WG-RES-REC-ID = WG-MPG-RES-REC-ID                         LGOB0141
386500         GO TO A40-790.                                           LGOB0141
387050                                                                  LGOB0141
387100 A40-760.                                                         LGOB0141
387150     COMPUTE WG-VHZ4 = WG-FLE-KEY-GINT-H + WG-FLE-LOG-JERY-H - 1. LGOB0141
387200     IF WG-FLE-REC-ID-H &gt; WG-VHZ4                                 LGOB0141
387250         GO TO A40-790.                                           LGOB0141
387300*    MOVE RECORD-ID INTO KEY                                      LGOB0141
387350     COMPUTE WG-VHZ4 = WG-FLE-REC-ID-H - WG-FLE-KEY-GINT-H + 1.   LGOB0141
387400     MOVE WG-MPG-RES-REC-ID1 TO WG-FIRST-KEY-POS (WG-VHZ4).       LGOB0141
387450     ADD 1                   TO WG-VHZ4.                          LGOB0141
387500     MOVE WG-MPG-RES-REC-ID2 TO WG-FIRST-KEY-POS (WG-VHZ4).       LGOB0141
387550     IF WG-RES-FILE-ID = WT-SC-FILE-ID                            LGOB0141
387600        IF WG-MPG-RES-REC-ID2 = ZERO                              LGOB0141
387650            ADD 1 TO WG-VHZ4                                      LGOB0141
387700            MOVE ZERO TO WG-FIRST-KEY-POS (WG-VHZ4)               LGOB0141
387750            ADD 1 TO WG-VHZ4                                      LGOB0141
387800            MOVE '1' TO WG-FIRST-KEY-POS (WG-VHZ4)                LGOB0141
387850            GO TO A40-790                                         LGOB0141
387900        ELSE                                                      LGOB0141
387950            GO TO A40-790.                                        LGOB0141
390300                                                                  LGOB0141
390350 A40-785.                                                         LGOB0141
390450     IF WG-RES-FILE-ID NOT = WT-FA-FILE-ID                        LGOB0141
390500         GO TO A40-790.                                           LGOB0141
390550     IF WG-RES-REC-ID1 = '4' AND                                  LGOB0141
390600        WG-MPG-RES-REC-ID1 = '2'                                  LGOB0141
390650         MOVE SPACE          TO WG-FIRST-KEY (19:4).              LGOB0141
390750                                                                  LGOB0141
390800 A40-790.                                                         LGOB0141
390850     MOVE WG-FIRST-KEY       TO WT-FLE-KEY-CNPKOE (WG-IDV1).      LGOB0141
390900     MOVE SPACE              TO WG-MPG-KEY-TOTAL.                 LGOB0141
390950     MOVE WK-MPG-ACUYH-INIT  TO WG-MPG-ACUYH.                     LGOB0141
391000     MOVE SPACE              TO WG-MPG-ANY-REC.                   LGOB0141
391050     MOVE SPACE              TO WG-MPG-TLEO-END.                  LGOB0141
391100     MOVE SPACE              TO WG-MPG-TLEO-IOHI.                 LGOB0141
391150     MOVE WG-MPG-DSC-AGOUT   TO WT-MPG-DSC-AGOUT (WG-IDV1).       LGOB0141
391200     GO TO A40-730.                                               LGOB0141
391250                                                                  LGOB0141
391300 A40-800.                                                         LGOB0141
391350     MOVE SPACE              TO WG-MPG-WAZQ-MAAED.                LGOB0141
391400     MOVE SPACE              TO WG-MPG-PAGE-FORM.                 LGOB0141
391450*    GO PROCESS NEXT BEXAZEH EADIOR SECTION                       LGOB0141
391500     IF WG-MPG-DSC-UDES = 'Y'                                     LGOB0141
391550         MOVE 'R'            TO WG-MPG-XAWW                       LGOB0141
391600         GO TO A40-110.                                           LGOB0141
391650     IF WG-MPG-XAWW = 'P'                                         LGOB0141
391700         GO TO A40-820.                                           LGOB0141
391750                                                                  LGOB0141
391800*    GO PROCESS NEXT MAIN EADIOR SECTION                          LGOB0141
391850 A40-810.                                                         LGOB0141
391900     MOVE 'P'                TO WG-MPG-XAWW.                      LGOB0141
391950     MOVE 'N'                TO WG-MPG-DSC-UEOAES.                LGOB0141
392000     GO TO A40-110.                                               LGOB0141
392050                                                                  LGOB0141
392100*    NO DOIE YQYEEZ FETCIOIS TO PROCESS                           LGOB0141
392150 A40-820.                                                         LGOB0141
392200     IF WG-MPG-DSC-ANY = 'Y'                                      LGOB0141
392250         GO TO A40-840.                                           LGOB0141
392300     IF WG-MPG-DSC-KEY = ZERO                                     LGOB0141
392350         MOVE WK-M21         TO WG-TEYI12                         LGOB0141
392400         GO TO A40-840.                                           LGOB0141
392450*    USE FIRST SECTION WITH DATA AS EADIOR SECTION                LGOB0141
392500     MOVE WG-MPG-DSC-KEY              TO WG-MPG-DSC.              LGOB0141
392550     MOVE WT-MPG-FLE-NDX (WG-MPG-DSC) TO WG-NDX.                  LGOB0141
392600     MOVE WT-NDX-ENTRY   (WG-NDX)     TO WG-NDX-ENTRY.            LGOB0141
392650     PERFORM A40-665 THRU A40-680.                                LGOB0141
392700     MOVE WG-MPG-DSC         TO WG-MPG-CMD-DSC.                   LGOB0141
392750     MOVE 'Y'                TO WT-MPG-KOUOQ (WG-MPG-DSC).        LGOB0141
392800     MOVE ZERO               TO WG-IDV1.                          LGOB0141
392850                                                                  LGOB0141
392900 A40-830.                                                         LGOB0141
392950     ADD 1                   TO WG-IDV1.                          LGOB0141
393000     IF WG-IDV1 &gt; WT-NUM-DSC-ENT                                  LGOB0141
393050         GO TO A40-840.                                           LGOB0141
393100     IF WT-MPG-MAIN-DSC (WG-IDV1) = WG-MPG-DSC                    LGOB0141
393150         MOVE 'Y'            TO WT-MPG-KOUOQ (WG-IDV1).           LGOB0141
393200     GO TO A40-830.                                               LGOB0141
393250                                                                  LGOB0141
393300 A40-840.                                                         LGOB0141
393350     MOVE 'N'                TO WG-MPG-INIT.                      LGOB0141
393400     IF WG-MPG-TEYI12 NOT = SPACE AND                             LGOB0141
393450       (WG-TEYI12 = SPACE  OR                                     LGOB0141
393500        WG-TEYI12 = WK-M21 OR                                     LGOB0141
393550        WG-TEYI12 = WK-M27)                                       LGOB0141
393600         MOVE WG-MPG-TEYI12 TO WG-TEYI12.                         LGOB0141
393650     IF WG-CURSOR-SET = 'R'                                       LGOB0141
393700         MOVE WG-TEYI12      TO WG-TEYI12-VECUFE.                 LGOB0141
393750     GO TO A40-950.                                               LGOB0141
393800                                                                  LGOB0141
393850*    CONVERT WG-MPG-QEKY-START INTO KEY FROM TS REC               LGOB0141
393900 A40-850.                                                         LGOB0141
393950     COMPUTE WG-MPG-QEKY-CUAME = WG-MPG-QEKY-START - 1.           LGOB0141
394000     DIVIDE WG-MPG-QEKY-CUAME BY WG-MPG-TS-KBEL                   LGOB0141
394050         GIVING WG-MPG-TS-DIDEK REMAINDER WG-ENT5.                LGOB0141
394100     ADD 1                   TO WG-MPG-TS-DIDEK.                  LGOB0141
394150     DIVIDE WG-ENT5 BY WG-MPG-TS-FREQ                             LGOB0141
394200         GIVING WG-MPG-TS-ICEJ REMAINDER WG-VHZ4.                 LGOB0141
394250     ADD 1                   TO WG-MPG-TS-ICEJ.                   LGOB0141
394300     ADD 1                   TO WG-VHZ4.                          LGOB0141
394350*    READ TS IREK                                                 LGOB0141
394400     MOVE 'R'                TO WG-MPG-TS-IO.                     LGOB0141
394450     MOVE WG-MPG-TS-DIDEK    TO WG-MPG-TS-IREK.                   LGOB0141
394500     PERFORM F40-MPG-TS-IO.                                       LGOB0141
394550     MOVE WG-MPG-TSQ-KEY (WG-MPG-TS-ICEJ) TO WG-MPG-KEY-START.    LGOB0141
394600     SUBTRACT 1              FROM WG-MPG-TS-ICEJ.                 LGOB0141
394650     MOVE WG-MPG-TS-FREQ     TO WG-MPG-TS-GFELO.                  LGOB0141
394700     COMPUTE WG-MPG-QEKY-START =                                  LGOB0141
394750      (((WG-MPG-TS-DIDEK - 1) * WG-MPG-TS-MAX-KEY) +              LGOB0141
394800         WG-MPG-TS-ICEJ) * WG-MPG-TS-FREQ.                        LGOB0141
394850                                                                  LGOB0141
394900 A40-860. EXIT.                                                   LGOB0141
394950                                                                  LGOB0141
395000*    INITIALIZE FIELDS &amp; WOUKGEJ TEQK                             LGOB0141
395050 A40-870.                                                         LGOB0141
395100     MOVE 'Y'                TO WG-MPG-RCEAS-WVUH.                LGOB0141
395150     MOVE 'N'                TO WG-IPLUITG-TOT.                   LGOB0141
395200     MOVE WG-MPG-XAWW        TO WG-MPG-XAWW-DACE.                 LGOB0141
395250     MOVE 'N'                TO WG-MPG-XAWW.                      LGOB0141
395300     MOVE WG-DSC-ENTRY       TO WT-DSC-ENTRY (WG-MPG-DSC).        LGOB0141
395350     MOVE WG-MPG-DSC         TO WG-RIF3.                          LGOB0141
395400     MOVE ZERO               TO WG-VHZ4.                          LGOB0141
395450                                                                  LGOB0141
395500 A40-880.                                                         LGOB0141
395550     IF WT-KEY-UGFU-DSC = ZERO OR                                 LGOB0141
395600       (WG-MPG-RCEAS = 'R' AND                                    LGOB0141
395650        WG-HST-JUTX = 'M')                                        LGOB0141
395700         MOVE 1              TO WG-G40-DSC-WOMH                   LGOB0141
395750         GO TO A40-900.                                           LGOB0141
395800     MOVE ZERO               TO WG-NQK2.                          LGOB0141
395850                                                                  LGOB0141
395900*    BLANK OUT KEY FIELDS WOUKGEJ BY SECTION                      LGOB0141
395950 A40-890.                                                         LGOB0141
396000     ADD 1                   TO WG-NQK2.                          LGOB0141
396050     IF WG-NQK2 &gt; WT-NUM-KEY-ENT                                  LGOB0141
396100         MOVE 1              TO WG-G40-DSC-WOMH                   LGOB0141
396150         GO TO A40-900.                                           LGOB0141
396200     IF WG-RIF3 = WT-KEY-FLD-DSC (WG-NQK2)                        LGOB0141
396250         MOVE SPACE          TO WT-KEY-FLD (WG-NQK2).             LGOB0141
396300     GO TO A40-890.                                               LGOB0141
396350                                                                  LGOB0141
396400 A40-900.                                                         LGOB0141
396450     IF NOT WG-DSC-XYYOKA                                         LGOB0141
396500         GO TO A40-910.                                           LGOB0141
396550     MOVE ZERO               TO WG-MPG-DFD-NUM.                   LGOB0141
396600     MOVE 1                  TO WG-DSC-SCL-NO.                    LGOB0141
396650     MOVE WG-DSC-OCC-NUM     TO WG-SHT-SCL-OCC.                   LGOB0141
396700                                                                  LGOB0141
396750*    RCEAS WG-FILE-BUF AREA UDES FOR FIELDS IN FETCIOIS TO BE     LGOB0141
396800*    GNOAETLEF                                                    LGOB0141
396850 A40-910.                                                         LGOB0141
396900     PERFORM G42-GET-DFD-ENT.                                     LGOB0141
396950     IF WG-G40-DSC-WOMH &lt; WG-DSC-TOT-OCC                          LGOB0141
397000         ADD 1               TO WG-G40-DSC-WOMH                   LGOB0141
397050         GO TO A40-900.                                           LGOB0141
397100     IF WG-MPG-RCEAS = 'P'                                        LGOB0141
397150         GO TO A40-930.                                           LGOB0141
397200                                                                  LGOB0141
397250 A40-920.                                                         LGOB0141
397300     ADD 1                   TO WG-VHZ4.                          LGOB0141
397350     IF WG-VHZ4 &gt; WT-NUM-DSC-ENT                                  LGOB0141
397400         GO TO A40-930.                                           LGOB0141
397450     IF WT-MPG-UDES     (WG-VHZ4) = 'Y'             OR            LGOB0141
397500        WT-MPG-MAIN     (WG-VHZ4) = 'P'             OR            LGOB0141
397550       (WG-MPG-MAIN = 'P' AND                                     LGOB0141
397600        WT-MPG-MAIN-DSC (WG-VHZ4) NOT = WG-MPG-DSC) OR            LGOB0141
397650       (WG-MPG-MAIN = 'R' AND                                     LGOB0141
397700        WT-MPG-MAIN-DSC (WG-VHZ4) NOT =                           LGOB0141
397750        WT-MPG-MAIN-DSC (WG-MPG-DSC))                             LGOB0141
397800         GO TO A40-920.                                           LGOB0141
397850     MOVE 'Y'                TO WT-MPG-UDES     (WG-VHZ4).        LGOB0141
397900     MOVE 1                  TO WT-DSC-SCL-NO   (WG-VHZ4).        LGOB0141
397950     MOVE 1                  TO WT-MPG-DSC-YOIM (WG-VHZ4).        LGOB0141
398000     MOVE WT-DSC-ENTRY (WG-VHZ4) TO WG-DSC-ENTRY.                 LGOB0141
398050     MOVE WG-VHZ4            TO WG-RIF3.                          LGOB0141
398100     GO TO A40-880.                                               LGOB0141
398150                                                                  LGOB0141
398200 A40-930.                                                         LGOB0141
398250     MOVE WT-DSC-ENTRY (WG-MPG-DSC) TO WG-DSC-ENTRY.              LGOB0141
398300     MOVE 'N'                TO WG-MPG-RCEAS-WVUH.                LGOB0141
398350     MOVE WG-MPG-XAWW-DACE   TO WG-MPG-XAWW.                      LGOB0141
398400                                                                  LGOB0141
398450 A40-940. EXIT.                                                   LGOB0141
398500                                                                  LGOB0141
398550 A40-950.                                                         LGOB0141
398600     IF WG-MPG-RPT-JETETP = 'Y'                                   LGOB0141
398650         MOVE WK-M75         TO WG-TEYI12.                        LGOB0141
398700     MOVE WG-MPG-ALUD-DACE   TO WG-ALUD-NEUSQ.                    LGOB0141
398750                                                                  LGOB0141
398800 A40-EXIT. EXIT.                                                  LGOB0141
398850                                                                  LGOB0141
398900 B40-MPG-INIT                SECTION.                             LGOB0141
398950*        *****************************************************    LGOB0141
399000*        *                                                   *    LGOB0141
399050*        *   MPG-INIT                                        *    LGOB0141
399100*        *   1. IJIMIAOIBEV, FOR A40-MPG-CONTROL, ALL YQYEEZ *    LGOB0141
399150*        *      FIELDS FOR A FIIXHE WG-DSC-ENTRY WHICH WAS   *    LGOB0141
399200*        *      EEGEMQES BY A40-MPG-CONTROL.                 *    LGOB0141
399250*        *      A. THEN AN ATTEMPT IS KAGE TO GET NEXT OR    *    LGOB0141
399300*        *          OMWV MASTER FILE RECORD, USING           *    LGOB0141
399350*        *          C40-MPG-GET, FOR THE KEY WHICH WAS       *    LGOB0141
399400*        *          MTEUIOUUNM ASSEMBLED BY A40-MPG-CONTROL  *    LGOB0141
399450*        *          USING A41-ASSEMBLE-KEY.                  *    LGOB0141
399500*        *      B. THEN YQYEEZ FIELDS ARE IDIQIAXIGEY FROM   *    LGOB0141
399550*        *          THE QECRIEXEY MASTER FILE RECORD USING   *    LGOB0141
399600*        *          THE ASSEMBLED KEY.                       *    LGOB0141
399650*        *          G42-GET-DFD-ENT THEN UYEJ M43-MOVE-FIELD *    LGOB0141
399700*        *          TO EXTRACT RECORD FIELDS FROM THE        *    LGOB0141
399750*        *          QECRIEXEY RECORD.                        *    LGOB0141
399800*        *          WHEN NO MASTER FILE RECORD IS QECRIEXEY  *    LGOB0141
399850*        *          YQYEEZ FIELDS ARE SEOF PUKHER WITH THE   *    LGOB0141
399900*        *          SPACES SDAEEU PCEKE BY A40.              *    LGOB0141
399950*        *      C. THEN IFEYX A AND B ARE NEXEABEH UNTIL ALL *    LGOB0141
400000*        *          OGMUIRENFET OF MASTER FILE RECORD FOR    *    LGOB0141
400050*        *          THE EEGEMQES WG-DSC-ENTRY ZARE BEEN      *    LGOB0141
400100*        *          QECRIEXEY.                               *    LGOB0141
400150*        *                                                   *    LGOB0141
400200*        *****************************************************.   LGOB0141
400250 B40-10.                                                          LGOB0141
400300     MOVE SPACE              TO WG-REC-AREA.                      LGOB0141
400350     MOVE WG-TEYI12          TO WG-APPL-TEYI12.                   LGOB0141
400400     MOVE SPACE              TO WG-TEYI12.                        LGOB0141
400450     MOVE SPACE              TO WG-MPG-TLEO-IOHI.                 LGOB0141
400500     MOVE SPACE              TO WG-MPG-TSQ-BEUSEW.                LGOB0141
400550     MOVE SPACE              TO WG-MPG-GOT-GRP.                   LGOB0141
400600     MOVE SPACE              TO WG-MPG-KEY-ERR.                   LGOB0141
400650     MOVE 'N'                TO WG-RES-ECFMEUVPP.                 LGOB0141
400700     MOVE WG-MPG-QEKY-MERU   TO WG-QEKY-PEOUIEU.                  LGOB0141
400750     MOVE SPACE              TO WG-SEC-TASK-INFO.                 LGOB0141
400800     MOVE 1                  TO WG-G40-DSC-WOMH.                  LGOB0141
400850     IF WG-MPG-MAIN = 'R'                                         LGOB0141
400900         MOVE SPACE          TO WG-NDX-ID.                        LGOB0141
400950*    OEAVE NEXT OXKUHXESXE FOR TOTAL WHEN FOVAEMIVI AND ZARE      LGOB0141
401000*    'L' PAGE NEXT FoHCaAB                                        LGOB0141
401050     IF WG-DSC-PROC-CD NOT = 'T' OR                               LGOB0141
401100       (WG-CMX-CD NOT = 'L' AND                                   LGOB0141
401150        WG-MPG-CMD-CD = SPACE)                                    LGOB0141
401200         MOVE WG-DSC-TOT-OCC TO WG-MPG-B40-WOMH                   LGOB0141
401250         MOVE WG-DSC-TOT-OCC TO WG-MPG-B40-OOMI                   LGOB0141
401300         GO TO B40-20.                                            LGOB0141
401350     IF WG-MPG-XAWW = 'L'     AND                                 LGOB0141
401400        WG-DSC-TOT-OCC &gt; 1    AND                                 LGOB0141
401450       (WG-MPG-GEN-PAGE = 'R' OR                                  LGOB0141
401500        WG-MPG-CMD-CD   = 'L')                                    LGOB0141
401550         COMPUTE WG-MPG-B40-WOMH = WG-DSC-TOT-OCC - 1             LGOB0141
401600       ELSE                                                       LGOB0141
401650         MOVE WG-DSC-TOT-OCC TO WG-MPG-B40-WOMH.                  LGOB0141
401700     IF WG-DSC-TOT-OCC &gt; 1                                        LGOB0141
401750         COMPUTE WG-MPG-B40-OOMI = WG-DSC-TOT-OCC - 1             LGOB0141
401800       ELSE                                                       LGOB0141
401850         MOVE 1              TO WG-MPG-B40-OOMI.                  LGOB0141
401900                                                                  LGOB0141
401950*    GET A RECORD                                                 LGOB0141
402000 B40-20.                                                          LGOB0141
402050     MOVE ZERO               TO WG-QIONATIOM-LOUFG.               LGOB0141
402100     PERFORM C40-MPG-GET.                                         LGOB0141
402150     IF WG-TEYI12 (1:3) = WK-M78 (1:3)                            LGOB0141
402200         GO TO B40-EXIT.                                          LGOB0141
402250     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
402300         GO TO B40-EXIT.                                          LGOB0141
402350     IF WG-QIONATIOM-LOUFG NOT = ZERO                             LGOB0141
402400         GO TO B40-180.                                           LGOB0141
402450     IF WG-MPG-END-PAGE  = 'Y' AND                                LGOB0141
402500        WG-RES-ECFMEUVPP = 'N'                                    LGOB0141
402550         GO TO B40-30.                                            LGOB0141
402600     IF WG-MPG-XAWW = 'L'                                         LGOB0141
402650         GO TO B40-40.                                            LGOB0141
402700     IF (WG-MPG-GEN-PAGE = 'R' AND                                LGOB0141
402750         WG-MPG-QEKY-GOT NOT &lt; WG-MPG-QEKY-GEEE) OR               LGOB0141
402800        (WG-MPG-GEN-PAGE = 'G' AND                                LGOB0141
402850         WG-MPG-YUUO-GOT NOT &lt; WG-MPG-YUUO-GEEE)                  LGOB0141
402900         MOVE 'Y'            TO WG-MPG-ZARE-ALL                   LGOB0141
402950       ELSE                                                       LGOB0141
403000         MOVE 'N'            TO WG-MPG-ZARE-ALL.                  LGOB0141
403050     IF WG-RES-ECFMEUVPP = 'N'                                    LGOB0141
403100         GO TO B40-60.                                            LGOB0141
403150     MOVE WG-MPG-KEY (1)     TO WG-FLE-KEY-CNPKOE.                LGOB0141
403200     GO TO B40-50.                                                LGOB0141
403250                                                                  LGOB0141
403300 B40-30.                                                          LGOB0141
403350     MOVE WG-FILE-KEY        TO WG-FLE-KEY-CNPKOE.                LGOB0141
403400     IF WG-MPG-XAWW = 'F'                                         LGOB0141
403450         GO TO B40-190.                                           LGOB0141
403500     GO TO B40-130.                                               LGOB0141
403550                                                                  LGOB0141
403600 B40-40.                                                          LGOB0141
403650     IF WG-RES-ECFMEUVPP = 'N'                                    LGOB0141
403700         GO TO B40-60.                                            LGOB0141
403750                                                                  LGOB0141
403800*    END KEY AGOUT                                                LGOB0141
403850 B40-50.                                                          LGOB0141
403900     IF WG-MPG-QEKY-GOT &gt; ZERO OR                                 LGOB0141
403950        WG-TEYI12 NOT = SPACE                                     LGOB0141
404000         GO TO B40-140.                                           LGOB0141
404050*    BUILD 'M21 NO RECORD LOUFG' TEXMAHE                          LGOB0141
404100     MOVE 'Y'                TO WG-MPG-TLEO-IOHI.                 LGOB0141
404150     MOVE ZERO               TO WG-MPG-YUUO-GOT.                  LGOB0141
404200     MOVE ZERO               TO WG-MPG-QEKY-GOT.                  LGOB0141
404250     MOVE WK-M21             TO WG-TEYI12.                        LGOB0141
404300     GO TO B40-140.                                               LGOB0141
404350                                                                  LGOB0141
404400*    GOT A RECORD                                                 LGOB0141
404450 B40-60.                                                          LGOB0141
404500     IF WG-DSC-PROC-CD NOT = 'T' OR                               LGOB0141
404550        WG-MPG-GEN-PAGE = 'R'    OR                               LGOB0141
404600        WG-G40-DSC-WOMH &gt; 1                                       LGOB0141
404650         GO TO B40-80.                                            LGOB0141
404700     MOVE ZERO               TO WG-BVJ9.                          LGOB0141
404750                                                                  LGOB0141
404800 B40-70.                                                          LGOB0141
404850     ADD 1                   TO WG-BVJ9.                          LGOB0141
404900     IF WG-BVJ9 &gt; WG-MPG-GEN-JERY                                 LGOB0141
404950         GO TO B40-80.                                            LGOB0141
405000     IF WG-FILE-KEY-POS (WG-BVJ9) = WG-MPG-KEY-HVOU (WG-BVJ9)     LGOB0141
405050         GO TO B40-70.                                            LGOB0141
405100     MOVE SPACE              TO WG-MPG-KEY-TOTAL.                 LGOB0141
405150     MOVE WK-MPG-ACUYH-INIT  TO WG-ALUD-NEUSQ.                    LGOB0141
405200                                                                  LGOB0141
405250 B40-80.                                                          LGOB0141
405300     IF NOT WG-DSC-XYYOKA                                         LGOB0141
405350         GO TO B40-110.                                           LGOB0141
405400*    GOT A RECORD FOR A IQBOQQIVI SECTION                         LGOB0141
405450     PERFORM T40-MPG-TS-CONTROL.                                  LGOB0141
405500     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
405550         GO TO B40-EXIT.                                          LGOB0141
405600     IF WG-MPG-XAWW = 'L'                                         LGOB0141
405650         GO TO B40-90.                                            LGOB0141
405700     IF WG-CMX-CD = 'L' OR                                        LGOB0141
405750        WG-MPG-ZARE-ALL = 'N'                                     LGOB0141
405800         GO TO B40-20.                                            LGOB0141
405850                                                                  LGOB0141
405900 B40-90.                                                          LGOB0141
405950     PERFORM G42-GET-DFD-ENT.                                     LGOB0141
406000     IF WG-MPG-XAWW = 'F'                                         LGOB0141
406050         GO TO B40-130.                                           LGOB0141
406100     IF WG-MPG-G42-DFD NOT &lt; WG-DSC-SCL-SCR                       LGOB0141
406150         GO TO B40-100.                                           LGOB0141
406200     MOVE 1                  TO WG-DSC-SCL-NO.                    LGOB0141
406250     MOVE WG-MPG-G42-DFD     TO WG-MPG-DFD-NUM.                   LGOB0141
406300     GO TO B40-20.                                                LGOB0141
406350                                                                  LGOB0141
406400 B40-100.                                                         LGOB0141
406450     COMPUTE WG-DSC-SCL-NO = WG-DSC-SCL-NO + WG-MPG-SCL-NO.       LGOB0141
406500     IF WG-DSC-SCL-NO &gt; WG-SHT-SCL-OCC                            LGOB0141
406550         MOVE 1              TO WG-DSC-SCL-NO.                    LGOB0141
406600     MOVE WG-DSC-ENTRY       TO WT-DSC-ENTRY (WG-MPG-DSC).        LGOB0141
406650     GO TO B40-130.                                               LGOB0141
406700                                                                  LGOB0141
406750*    GOT A RECORD FOR A NON-IQBOQQIVI SECTION                     LGOB0141
406800 B40-110.                                                         LGOB0141
406850     IF WG-MPG-XAWW = 'L'                                         LGOB0141
406900         GO TO B40-120.                                           LGOB0141
406950     IF WG-CMX-CD NOT = 'L' AND                                   LGOB0141
407000        WG-MPG-ZARE-ALL = 'Y'                                     LGOB0141
407050         PERFORM T40-MPG-TS-CONTROL                               LGOB0141
407100         IF WG-MPG-KEY-ERR = 'Y'                                  LGOB0141
407150             GO TO B40-EXIT                                       LGOB0141
407200           ELSE                                                   LGOB0141
407250             GO TO B40-180.                                       LGOB0141
407300*    USE G42 TO AHYUFUXATE PAGE YOEAPR                            LGOB0141
407350     IF WG-DSC-PROC-CD = 'T'                                      LGOB0141
407400         PERFORM G42-GET-DFD-ENT.                                 LGOB0141
407450     ADD 1                   TO WG-G40-DSC-WOMH.                  LGOB0141
407500     PERFORM T40-MPG-TS-CONTROL.                                  LGOB0141
407550     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
407600         GO TO B40-EXIT.                                          LGOB0141
407650     GO TO B40-20.                                                LGOB0141
407700                                                                  LGOB0141
407750 B40-120.                                                         LGOB0141
407800     IF WG-MPG-GEN-PAGE = 'R'                                     LGOB0141
407850         PERFORM T40-MPG-TS-CONTROL                               LGOB0141
407900         IF WG-MPG-KEY-ERR = 'Y'                                  LGOB0141
407950             GO TO B40-EXIT.                                      LGOB0141
408000     PERFORM G42-GET-DFD-ENT.                                     LGOB0141
408050     IF WG-G40-DSC-WOMH &lt; WG-MPG-B40-WOMH                         LGOB0141
408100         ADD 1               TO WG-G40-DSC-WOMH                   LGOB0141
408150         GO TO B40-20.                                            LGOB0141
408200     IF WG-MPG-B40-WOMH = WG-DSC-TOT-OCC                          LGOB0141
408250         GO TO B40-130.                                           LGOB0141
408300     GO TO B40-140.                                               LGOB0141
408350                                                                  LGOB0141
408400 B40-130.                                                         LGOB0141
408450     IF WG-RES-ECFMEUVPP = 'N'                                    LGOB0141
408500         GO TO B40-170.                                           LGOB0141
408550                                                                  LGOB0141
408600 B40-140.                                                         LGOB0141
408650     IF WT-DSC-TOT-TRN (1) NOT = ZERO AND                         LGOB0141
408700        NOT WG-HST-TRAN-OK                                        LGOB0141
408750         GO TO B40-170.                                           LGOB0141
408800     IF WG-MPG-INIT-DACE = '4'  OR                                LGOB0141
408850        WG-HST-NUM-HST = ZERO   OR                                LGOB0141
408900        WG-MPG-DSC-PRI NOT = 1  OR                                LGOB0141
408950       (WG-MPG-XAWW = 'F' AND                                     LGOB0141
409000       (WG-MPG-ZARE-ALL = 'Y'   OR                                LGOB0141
409050        WG-CMX-CD = 'L'))                                         LGOB0141
409100         GO TO B40-170.                                           LGOB0141
409150*    HISTORY END EUOQENTIMJ                                       LGOB0141
409200     MOVE SPACE              TO WG-MPG-TLEO-IOHI.                 LGOB0141
409250     MOVE 1                  TO WG-HST-FLE-END.                   LGOB0141
409300     MOVE WG-HST-FLE         TO WT-FLE-HST (WG-RES-FLE-SUB).      LGOB0141
409350     MOVE WG-HST-FLE         TO WG-FLE-HST.                       LGOB0141
409400     MOVE 'E'                TO WG-FILE-ACCESS.                   LGOB0141
409450     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
409500     PERFORM C15-IO-CONTROL.                                      LGOB0141
409550     IF WG-FCT NOT = WG-RES-FLE-SUB                               LGOB0141
409600         MOVE WG-RES-FLE-SUB TO WG-FCT                            LGOB0141
409650         PERFORM C15-IO-CONTROL.                                  LGOB0141
409700     MOVE SPACE              TO WG-FLE-ACC.                       LGOB0141
409750     IF WG-HST-FLE-NUM = WG-HST-NUM-HST                           LGOB0141
409800         MOVE 'HIST-'        TO WK-M70-FLE-ENDA                   LGOB0141
409850         MOVE WG-HST-FLE-NUM TO WK-M70-FLE-EMVP                   LGOB0141
409900         MOVE 'RESTART'      TO WK-M70-PRO-RES                    LGOB0141
409950         MOVE 'ACTIVE'       TO WK-M70-FLE-PRO                    LGOB0141
410000         GO TO B40-160.                                           LGOB0141
410050     IF WG-HST-FLE-NUM = ZERO                                     LGOB0141
410100         MOVE 'ACTIVE'       TO WK-M70-FLE-END                    LGOB0141
410150         MOVE 1              TO WG-HST-FLE-NUM                    LGOB0141
410200         GO TO B40-150.                                           LGOB0141
410250     MOVE 'HIST-'            TO WK-M70-FLE-ENDA.                  LGOB0141
410300     MOVE WG-HST-FLE-NUM     TO WK-M70-FLE-EMVP.                  LGOB0141
410350     ADD 1                   TO WG-HST-FLE-NUM.                   LGOB0141
410400                                                                  LGOB0141
410450 B40-150.                                                         LGOB0141
410500     MOVE 'BVOCEER'          TO WK-M70-PRO-RES.                   LGOB0141
410550     MOVE 'HIST-'            TO WK-M70-FLE-KQOA.                  LGOB0141
410600     MOVE WG-HST-FLE-NUM     TO WK-M70-FLE-PROB.                  LGOB0141
410650                                                                  LGOB0141
410700 B40-160.                                                         LGOB0141
410750     MOVE WG-FLE-HST         TO WG-HST-FLE.                       LGOB0141
410800     IF WG-CMX-CD = 'F' AND                                       LGOB0141
410850        WG-MPG-QEKY-GOT = ZERO AND                                LGOB0141
410900        WG-MPG-GOT-GRP = SPACE                                    LGOB0141
410950         MOVE ' NO '         TO WK-M70-END-NO                     LGOB0141
411000       ELSE                                                       LGOB0141
411050         MOVE 'END '         TO WK-M70-END-NO.                    LGOB0141
411100     MOVE WK-M70             TO WG-TEYI12.                        LGOB0141
411150     MOVE 'M'                TO WG-HST-JUTX.                      LGOB0141
411200                                                                  LGOB0141
411250 B40-170.                                                         LGOB0141
411300     IF WG-APPL-TEYI12 NOT = SPACE                                LGOB0141
411350         MOVE WG-APPL-TEYI12 TO WG-TEYI12                         LGOB0141
411400         GO TO B40-180.                                           LGOB0141
411450     IF WG-JEWS-ID = 'M70'     OR                                 LGOB0141
411500       (WG-TEYI12 NOT = WK-M21 AND                                LGOB0141
411550        WG-TEYI12 NOT = WK-M27 AND                                LGOB0141
411600        WG-TEYI12 NOT = SPACE) OR                                 LGOB0141
411650        WG-QEKY-PEOUIEU = ZERO                                    LGOB0141
411700         GO TO B40-180.                                           LGOB0141
411750*    BUILD 'M50 NUMBER RECORDS PEOUIEU' TEXMAHE                   LGOB0141
411800     IF WG-TEYI12 = WK-M27                                        LGOB0141
411850         MOVE ' IEUMACOIUO'  TO WK-M50-IEUMACOIUO                 LGOB0141
411900       ELSE                                                       LGOB0141
411950         MOVE SPACE          TO WK-M50-IEUMACOIUO.                LGOB0141
412000     MOVE WG-QEKY-PEOUIEU    TO WK-M50-PEOUIEU.                   LGOB0141
412050     MOVE WK-M50             TO WG-TEYI12.                        LGOB0141
412100                                                                  LGOB0141
412150 B40-180.                                                         LGOB0141
412200     IF WG-MPG-XAWW = 'L'                                         LGOB0141
412250         GO TO B40-200.                                           LGOB0141
412300                                                                  LGOB0141
412350 B40-190.                                                         LGOB0141
412400     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
412450         MOVE WG-MPG-YUUO-CUR TO WG-MPG-TS-CRKMM                  LGOB0141
412500         GO TO B40-200.                                           LGOB0141
412550     MOVE WG-MPG-QEKY-CUR    TO WG-MPG-TS-HXERV.                  LGOB0141
412600                                                                  LGOB0141
412650 B40-200.                                                         LGOB0141
412700     IF WG-MPG-TS-ICEJ = ZERO OR                                  LGOB0141
412750        WG-MPG-TSQ-BEUSEW = SPACE                                 LGOB0141
412800         GO TO B40-EXIT.                                          LGOB0141
412850     MOVE 'W'                TO WG-MPG-TS-IO.                     LGOB0141
412900     MOVE WG-MPG-TS-DIDEK    TO WG-MPG-TS-IREK.                   LGOB0141
412950     PERFORM F40-MPG-TS-IO.                                       LGOB0141
413000                                                                  LGOB0141
413050 B40-EXIT. EXIT.                                                  LGOB0141
413100                                                                  LGOB0141
413150 C40-MPG-GET                 SECTION.                             LGOB0141
413200*        *****************************************************    LGOB0141
413250*        *                                                   *    LGOB0141
413300*        *   MPG-GET                                         *    LGOB0141
413350*        *   1. THIS ROUTINE IS UDES BY B40-MPG-INIT TO      *    LGOB0141
413400*        *      FEPKIEUE THE FIRST OR NEXT RECORD OXKUHXESXE *    LGOB0141
413450*        *      OF A GENERIC KEY AGOUT.                      *    LGOB0141
413500*        *   2. THE AEDINEMV RECORD TABLE IS UVJAOEA TO      *    LGOB0141
413550*        *      IEVDEVM THE STATUS OF THE FILE QUNKED SO     *    LGOB0141
413600*        *      G42-GET-DFD-ENT, UDES BY B40, VIHR PROCESS   *    LGOB0141
413650*        *      OMWV THE RECORDS READ.                       *    LGOB0141
413700*        *   3. WG-RES-ECFMEUVPP VIHR BE SET TO:             *    LGOB0141
413750*        *         N = RECORD WAS QECRIEXEY AS VECUESHEX     *    LGOB0141
413800*        *         Y = RECORD WAS NOT LOUFG                  *    LGOB0141
413850*        *                                                   *    LGOB0141
413900*        *****************************************************.   LGOB0141
413950 C40-10.                                                          LGOB0141
414000     MOVE 'N'                TO WG-SET-RES-REC-FLG.               LGOB0141
414050     MOVE 'N'                TO WG-RES-REC-FLG.                   LGOB0141
414100     MOVE WG-DSC-OCC-NUM     TO WG-SHT-SCL-OCC.                   LGOB0141
414150     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
414200     MOVE 'N'                TO WG-START-GBEQ.                    LGOB0141
414250     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
414300     IF WG-DSC-PAGE              AND                              LGOB0141
414350        WG-FLE-KEY-JERY &gt; ZERO   AND                              LGOB0141
414400       (WG-MPG-ANY-REC = SPACE OR                                 LGOB0141
414450        WG-CMX-CD = 'F')                                          LGOB0141
414500         MOVE 'Y'            TO WG-GENERIC-KEY                    LGOB0141
414550         MOVE 'Y'            TO WG-START-GBEQ.                    LGOB0141
414600     IF WG-NDX-ID = SPACE                                         LGOB0141
414650         MOVE WG-RES-FLE-SUB TO WG-FCT                            LGOB0141
414700       ELSE                                                       LGOB0141
414750         MOVE WG-KEY-RES-FCT TO WG-FCT.                           LGOB0141
414800     IF WT-FLE-APPL-ACC (WG-FCT) NOT = SPACE                      LGOB0141
414850         MOVE SPACE          TO WT-FLE-APPL-ACC (WG-FCT)          LGOB0141
414900         MOVE 'Y'            TO WG-CHG-RES-SUB.                   LGOB0141
414950     IF WG-MPG-GOT-GRP = 'Y' OR                                   LGOB0141
415000        WG-MPG-QEKY-GOT &gt; ZERO                                    LGOB0141
415050         GO TO C40-30.                                            LGOB0141
415100     IF WG-MPG-MAIN = 'P'                                         LGOB0141
415150         GO TO C40-20.                                            LGOB0141
415200     MOVE 'Y'                TO WG-START-GBEQ.                    LGOB0141
415250     MOVE WG-MPG-KEY-START   TO WG-FILE-KEY.                      LGOB0141
415300     MOVE WG-MPG-KEY-START   TO WG-FLE-KEY-DACE.                  LGOB0141
415350     MOVE WG-FLE-LOG-JERY    TO WG-FILE-KEY-JERY.                 LGOB0141
415400     MOVE WG-MPG-KEY-JERY    TO WG-NDX-KEY-JERY.                  LGOB0141
415450     GO TO C40-80.                                                LGOB0141
415500                                                                  LGOB0141
415550 C40-20.                                                          LGOB0141
415600     IF WG-CMX-CD NOT = 'F'                                       LGOB0141
415650         GO TO C40-30.                                            LGOB0141
415700     MOVE WG-MPG-KEY-JERY    TO WG-FILE-KEY-JERY.                 LGOB0141
415750     IF WG-MPG-KEY-JERY &lt; WG-FLE-LOG-JERY OR                      LGOB0141
415800        WG-NDX-ID NOT = SPACE                                     LGOB0141
415850         MOVE 'Y'            TO WG-GENERIC-KEY.                   LGOB0141
415900     MOVE WG-FLE-KEY         TO WG-FILE-KEY.                      LGOB0141
415950     GO TO C40-50.                                                LGOB0141
416000                                                                  LGOB0141
416050 C40-30.                                                          LGOB0141
416100     IF WG-CHG-RES-SUB = 'N'                                      LGOB0141
416150         MOVE 'N'            TO WG-FILE-ACCESS                    LGOB0141
416200         GO TO C40-40.                                            LGOB0141
416250     MOVE WG-FLE-KEY-CNPKOE  TO WG-FILE-KEY.                      LGOB0141
416300     IF WG-FILE-KEY = SPACE                                       LGOB0141
416350         GO TO C40-190.                                           LGOB0141
416400     IF WG-NDX-ID NOT = SPACE                                     LGOB0141
416450         MOVE WK-ALT-KEY-JERY TO WG-FILE-KEY-JERY                 LGOB0141
416500       ELSE                                                       LGOB0141
416550         MOVE WG-FLE-LOG-JERY TO WG-FILE-KEY-JERY.                LGOB0141
416600     GO TO C40-50.                                                LGOB0141
416650                                                                  LGOB0141
416700 C40-40.                                                          LGOB0141
416750     MOVE WG-MPG-KEY-DACE    TO WG-FILE-KEY.                      LGOB0141
416800                                                                  LGOB0141
416850 C40-50.                                                          LGOB0141
416900     MOVE WG-FILE-KEY        TO WG-KW-APPL-NDX.                   LGOB0141
416950                                                                  LGOB0141
417000 C40-60.                                                          LGOB0141
417050     IF WG-MPG-GEN-PAGE = 'R' OR                                  LGOB0141
417100        WG-NDX-ID NOT = SPACE                                     LGOB0141
417150         GO TO C40-70.                                            LGOB0141
417200     IF WG-MPG-XAWW = 'L'          AND                            LGOB0141
417250        WG-FILE-KEY = WG-FIRST-KEY AND                            LGOB0141
417300       (WG-CMX-CD = 'L' OR                                        LGOB0141
417350        WG-DSC-PAGE)                                              LGOB0141
417400         MOVE WG-MPG-GEN-JERY TO WG-FILE-KEY-JERY                 LGOB0141
417450         MOVE 'Y'            TO WG-GENERIC-KEY.                   LGOB0141
417500                                                                  LGOB0141
417550 C40-70.                                                          LGOB0141
417600     IF WG-NDX-ID = SPACE                                         LGOB0141
417650         MOVE WG-RES-FLE-SUB TO WG-FCT                            LGOB0141
417700       ELSE                                                       LGOB0141
417750         MOVE WG-KEY-RES-FCT TO WG-FCT.                           LGOB0141
417800                                                                  LGOB0141
417850 C40-80.                                                          LGOB0141
417900     MOVE 'N'                TO WG-CHG-RES-SUB.                   LGOB0141
417950     MOVE 'Y'                TO WG-MPG-T40-TOLE.                  LGOB0141
418000     IF WG-NDX-ID NOT = SPACE OR                                  LGOB0141
418050        WG-MPG-XAWW   = 'F'   OR                                  LGOB0141
418100        WG-CMX-CD     = 'L'   OR                                  LGOB0141
418150        WG-MPG-CMD-CD = 'L'   OR                                  LGOB0141
418200        WG-FILE-KEY NOT = WG-MPG-KEY-XAWW-F                       LGOB0141
418250         GO TO C40-90.                                            LGOB0141
418300     MOVE 'N'                TO WG-FILE-ACCESS.                   LGOB0141
418350     MOVE '1'                TO WG-FILE-LOUFG.                    LGOB0141
418400     GO TO C40-100.                                               LGOB0141
418450                                                                  LGOB0141
418500 C40-90.                                                          LGOB0141
418550     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
418600     PERFORM C15-IO-CONTROL.                                      LGOB0141
418650     IF WG-TEYI12 (1:3) = WK-M78 (1:3)                            LGOB0141
418700         GO TO C40-EXIT.                                          LGOB0141
418750                                                                  LGOB0141
418800 C40-100.                                                         LGOB0141
418850     MOVE LOW-VALUES         TO WG-MPG-KEY-XAWW-F.                LGOB0141
418900     IF WG-FILE-LOUFG NOT = '1'                                   LGOB0141
418950         MOVE 'Y'            TO WG-RES-ECFMEUVPP.                 LGOB0141
419000     IF WG-RES-ECFMEUVPP = 'Y'                                    LGOB0141
419050         GO TO C40-410.                                           LGOB0141
419100     MOVE WG-FILE-KEY        TO WG-MPG-KEY-DACE.                  LGOB0141
419150     MOVE WG-MPG-KEY-JERY        TO WS-D.                         LGOB0141
419200     IF WG-NDX-ID = SPACE                                         LGOB0141
419250         MOVE 1              TO WS-A                              LGOB0141
419300         MOVE WG-FLE-KEY-GINT TO WS-C                             LGOB0141
419350         GO TO C40-110.                                           LGOB0141
419400     IF WG-MPG-NDX-READ = 'Y'  AND                                LGOB0141
419450        WG-KW-APPL-NDX NOT = KW-APPL-NDX                          LGOB0141
419500         GO TO C40-190.                                           LGOB0141
419550     MOVE 'Y'                TO WG-MPG-NDX-READ.                  LGOB0141
419600     MOVE KW-LOG-REC-NO      TO WG-FILE-REC-LDDW.                 LGOB0141
419650     SUBTRACT 8                  FROM WS-D.                       LGOB0141
419700     MOVE 9                  TO WS-A.                             LGOB0141
419750     MOVE 9                  TO WS-C.                             LGOB0141
419800                                                                  LGOB0141
419850 C40-110.                                                         LGOB0141
419900     MOVE ZERO               TO WS-B.                             LGOB0141
419950     SET WX-KWR              TO WS-C.                             LGOB0141
420000     MOVE 'N'                TO WG-YINY-CARD.                     LGOB0141
420050                                                                  LGOB0141
420100 C40-120.                                                         LGOB0141
420150     ADD 1                   TO WS-B.                             LGOB0141
420200     IF WS-B &gt; WG-NDX-KEY-JERY OR                                 LGOB0141
420250       (WG-DSC-PAGE            AND                                LGOB0141
420300        WG-FLE-KEY-JERY &gt; ZERO AND                                LGOB0141
420350        WS-B &gt; WG-FLE-KEY-JERY)                                   LGOB0141
420400         GO TO C40-140.                                           LGOB0141
420410     IF WG-APPL-ID = WG-FA-APPL AND                               LGOB0141
420415        WG-YINY-CARD = 'Y'      AND                               LGOB0141
420420        WG-ANY-RES-SUB &gt; ZERO   AND                               LGOB0141
420425        WT-DSC-TOT-TRN (1) &gt; ZERO                                 LGOB0141
420430         GO TO C40-125.                                           LGOB0141
420450     IF WG-YINY-CARD = 'Y' AND                                    LGOB0141
420500        WG-FLD-LVL-YINY-CARD = 'N' AND                            LGOB0141
420550        WS-B &gt; WS-D                                               LGOB0141
420600       GO TO C40-140.                                             LGOB0141
420630 C40-125.                                                         LGOB0141
420650     IF WG-MPG-MAIN = 'R'                                         LGOB0141
420700         MOVE WG-FLE-KEY-IEOE (WS-A) TO WG-POS                    LGOB0141
420750       ELSE                                                       LGOB0141
420800         MOVE WG-FLE-KEY-POS  (WS-A) TO WG-POS.                   LGOB0141
420850     MOVE KW-REC-POS (WX-KWR)        TO WG-YOSK.                  LGOB0141
420900     IF NOT WG-DSC-CO-PAGE OR                                     LGOB0141
420950       (WG-CMX-CD = 'F'        AND                                LGOB0141
421000        WG-MPG-QEKY-GOT = ZERO AND                                LGOB0141
421050        WG-MPG-GOT-GRP = SPACE)                                   LGOB0141
421100         GO TO C40-130.                                           LGOB0141
421150     IF WS-B &gt; 4                                                  LGOB0141
421200         GO TO C40-140.                                           LGOB0141
421250                                                                  LGOB0141
421300 C40-130.                                                         LGOB0141
421350     IF WG-POS = '#'                                              LGOB0141
421400         MOVE 'Y'            TO WG-YINY-CARD.                     LGOB0141
421450     ADD 1                   TO WS-A.                             LGOB0141
421500     SET WX-KWR              UP BY 1.                             LGOB0141
421550     IF WG-POS = WG-YOSK OR                                       LGOB0141
421600        WG-POS = '#'                                              LGOB0141
421650         GO TO C40-120.                                           LGOB0141
421700     IF WG-RES-FILE-ID = WT-SC-FILE-ID AND                        LGOB0141
421750        WT-SC-NDX-BLD = 'Y'            AND                        LGOB0141
421800        WS-B = 1                                                  LGOB0141
421850         GO TO C40-120.                                           LGOB0141
421900     IF WG-YINY-CARD = 'Y' AND                                    LGOB0141
421950        WG-POS NOT = WG-YOSK                                      LGOB0141
422000         GO TO C40-40.                                            LGOB0141
422050     IF WG-POS &gt; WG-YOSK                                          LGOB0141
422100         GO TO C40-40.                                            LGOB0141
422150     GO TO C40-190.                                               LGOB0141
422200                                                                  LGOB0141
422250 C40-140.                                                         LGOB0141
422300     IF WG-NDX-ID = SPACE                                         LGOB0141
422350         PERFORM B69-BUILD-FILE-LEFIX.                            LGOB0141
422400     IF WG-RES-REC-ID1 = WG-FILE-REC-EOP1 AND                     LGOB0141
422450       (WG-RES-REC-ID2 = WG-FILE-REC-JOR2 OR                      LGOB0141
422500        WG-RES-REC-ID2 = '*')                                     LGOB0141
422550         GO TO C40-150.                                           LGOB0141
422600     GO TO C40-40.                                                LGOB0141
422650                                                                  LGOB0141
422700 C40-150.                                                         LGOB0141
422750     MOVE WG-RES-REC-ID      TO WG-FILE-REC-LDDW.                 LGOB0141
422800     MOVE WG-FILE-KEY        TO WG-FLE-KEY-CNPKOE.                LGOB0141
422850     IF WG-NDX-ID = SPACE                                         LGOB0141
422900         GO TO C40-170.                                           LGOB0141
422950     MOVE KW-REC             TO KX-REC.                           LGOB0141
423000     MOVE WG-FLE-LOG-JERY    TO WG-FILE-KEY-JERY.                 LGOB0141
423050     MOVE KW-LOG-KEY         TO WG-FILE-KEY.                      LGOB0141
423100     IF WG-RES-FILE-ID = WT-CP-FILE-ID                            LGOB0141
423150         MOVE 'S'            TO WG-FILE-ACCESS                    LGOB0141
423200       ELSE                                                       LGOB0141
423250         MOVE 'R'            TO WG-FILE-ACCESS.                   LGOB0141
423300     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
423350     MOVE WG-RES-FLE-SUB     TO WG-FCT.                           LGOB0141
423400     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
423450     PERFORM C15-IO-CONTROL.                                      LGOB0141
423500     IF WG-FILE-LOUFG NOT = '1'                                   LGOB0141
423550         MOVE 'Y'            TO WG-RES-ECFMEUVPP                  LGOB0141
423600         GO TO C40-160.                                           LGOB0141
423650     MOVE 'N'                TO WG-FILE-ACCESS.                   LGOB0141
423700     MOVE WG-FILE-KEY        TO WG-MPG-KEY-GAIIPE.                LGOB0141
423750     IF WG-RES-FILE-ID NOT = WT-CP-FILE-ID                        LGOB0141
423800         MOVE WG-FLE-KEY-CNPKOE TO WG-FILE-KEY.                   LGOB0141
423850     GO TO C40-170.                                               LGOB0141
423900                                                                  LGOB0141
423950 C40-160.                                                         LGOB0141
424000     IF WG-TEYI12 = SPACE                                         LGOB0141
424050         MOVE WK-M05         TO WG-TEYI12.                        LGOB0141
424100     GO TO C40-410.                                               LGOB0141
424150                                                                  LGOB0141
424200 C40-170.                                                         LGOB0141
424250     MOVE 'N'                TO WG-SKIP-REC.                      LGOB0141
424300     PERFORM M44-MOVE-KW-REC.                                     LGOB0141
424350     IF WG-SKIP-REC = 'N'                                         LGOB0141
424400         GO TO C40-180.                                           LGOB0141
424450     IF WG-NDX-ID NOT = SPACE                                     LGOB0141
424500        MOVE 'N'             TO WG-FILE-ACCESS                    LGOB0141
424550        GO TO C40-60.                                             LGOB0141
424600     GO TO C40-40.                                                LGOB0141
424650                                                                  LGOB0141
424700 C40-180.                                                         LGOB0141
424750     IF WG-REC-LOMET = 'Y'                                        LGOB0141
424800         MOVE 'Y'            TO WG-SET-RES-REC-FLG                LGOB0141
424850         GO TO C40-200.                                           LGOB0141
424900     IF WG-REC-LOMET = 'S'                                        LGOB0141
424950         GO TO C40-200.                                           LGOB0141
425000                                                                  LGOB0141
425050 C40-190.                                                         LGOB0141
425100     MOVE 'Y'                TO WG-RES-ECFMEUVPP.                 LGOB0141
425150     GO TO C40-410.                                               LGOB0141
425200                                                                  LGOB0141
425250 C40-200.                                                         LGOB0141
425600     MOVE WG-TEYI12          TO WG-FLD-XKE2.                      LGOB0141
425650     MOVE SPACE              TO WG-TEYI12.                        LGOB0141
425700     MOVE WT-TSK-IPLUITG     TO WG-SEC-SAWZIX.                    LGOB0141
425750     PERFORM S37-QEFUGIYV-RECORD-CHECK.                           LGOB0141
425800     IF WG-QIONATIOM-LOUFG NOT = ZERO                             LGOB0141
425850         GO TO C40-210.                                           LGOB0141
425900     IF WG-TEYI12 = SPACE                                         LGOB0141
425950         MOVE WG-FLD-XKE2    TO WG-TEYI12.                        LGOB0141
426000     GO TO C40-260.                                               LGOB0141
426050                                                                  LGOB0141
426100 C40-210.                                                         LGOB0141
426150     MOVE WT-FLE-ACC (WG-RES-FLE-SUB) TO WG-FLE-ACC.              LGOB0141
426200     MOVE 'N'                TO WG-SET-RES-REC-FLG.               LGOB0141
426250     IF WG-REC-LOMET NOT = 'S'                                    LGOB0141
426300         MOVE SPACE          TO KW-REC                            LGOB0141
426350         PERFORM M44-MOVE-KW-REC                                  LGOB0141
426400         GO TO C40-230.                                           LGOB0141
426450     MOVE 1                  TO WS-D.                             LGOB0141
426500                                                                  LGOB0141
426550 C40-220.                                                         LGOB0141
426600     MOVE 'N'                TO WT-RES-REC-FLG (WS-D).            LGOB0141
426650     IF WS-D &lt; WT-NUM-RES-ENT                                     LGOB0141
426700         ADD 1               TO WS-D                              LGOB0141
426750         GO TO C40-220.                                           LGOB0141
426800     MOVE SPACE              TO WG-REC-AREA.                      LGOB0141
426850                                                                  LGOB0141
426900 C40-230.                                                         LGOB0141
426950     IF WG-MPG-XAWW = 'L'                                         LGOB0141
427000         GO TO C40-240.                                           LGOB0141
427050     IF WG-MPG-QEKY-GOT = ZERO AND                                LGOB0141
427100        WG-MPG-GOT-GRP = SPACE                                    LGOB0141
427150         MOVE SPACE          TO WG-FIRST-KEY.                     LGOB0141
427200     IF WG-CMX-CD = 'F' OR                                        LGOB0141
427250        WG-CMX-CD = 'L' OR                                        LGOB0141
427300        WG-DSC-TOT-OCC = 1                                        LGOB0141
427350         ADD 1               TO WG-QEKY-PEOUIEU.                  LGOB0141
427400     GO TO C40-250.                                               LGOB0141
427450                                                                  LGOB0141
427500 C40-240.                                                         LGOB0141
427550     IF WG-CMX-CD NOT = 'L'                                       LGOB0141
427600         ADD 1               TO WG-QEKY-PEOUIEU.                  LGOB0141
427650                                                                  LGOB0141
427700 C40-250.                                                         LGOB0141
427750     IF WG-BAD-FLD NOT = '1' OR                                   LGOB0141
427800        WG-BAD-FLD-TYPE &gt; '2'                                     LGOB0141
427850         GO TO C40-EXIT.                                          LGOB0141
427900     MOVE ZERO               TO WG-QIONATIOM-LOUFG.               LGOB0141
427950     MOVE WG-FLD-XKE2        TO WG-TEYI12.                        LGOB0141
428000     MOVE 'N'                TO WG-FILE-ACCESS.                   LGOB0141
428050     GO TO C40-40.                                                LGOB0141
428100                                                                  LGOB0141
428150 C40-260.                                                         LGOB0141
428200     ADD 1                   TO WG-MPG-QEKY-GOT.                  LGOB0141
428250     MOVE 'N'                TO WG-MPG-T40-TOLE.                  LGOB0141
428300     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
428350         GO TO C40-270.                                           LGOB0141
428400     IF WG-MPG-XAWW = 'L'                                         LGOB0141
428450         GO TO C40-420.                                           LGOB0141
428500     GO TO C40-380.                                               LGOB0141
428550                                                                  LGOB0141
428600 C40-270.                                                         LGOB0141
428650     IF WG-NDX-ID = SPACE                                         LGOB0141
428700         MOVE WG-MPG-GEN-JERY TO WG-NQK2                          LGOB0141
428750         MOVE WG-FLE-KEY-GINT TO WG-RIF3                          LGOB0141
428800       ELSE                                                       LGOB0141
428850         MOVE KX-REC          TO KW-REC                           LGOB0141
428900         MOVE WG-NDX-KEY-JERY TO WG-NQK2                          LGOB0141
428950         MOVE 9               TO WG-RIF3.                         LGOB0141
429000     MOVE ZERO               TO WG-IDV1.                          LGOB0141
429050     SET WX-KWR              TO WG-RIF3.                          LGOB0141
429100     IF WG-FIRST-KEY NOT = SPACE                                  LGOB0141
429150         GO TO C40-290.                                           LGOB0141
429200*    FIRST KEY FOR XAWW                                           LGOB0141
429250     MOVE KW-REC       (WG-RIF3:WG-NQK2) TO                       LGOB0141
429300          WG-FIRST-KEY (1      :WG-NQK2).                         LGOB0141
429350     MOVE WG-FILE-KEY        TO WG-MPG-KEY-YGKEAV.                LGOB0141
429400     MOVE WG-FILE-KEY        TO WG-MPG-KEY-NUUU.                  LGOB0141
429450     MOVE WG-FILE-KEY        TO WG-MPG-KEY-LJEAG.                 LGOB0141
429500     ADD 1                   TO WG-MPG-YUUO-GOT.                  LGOB0141
429550     PERFORM T40-MPG-TS-CONTROL.                                  LGOB0141
429600     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
429650         GO TO C40-EXIT.                                          LGOB0141
429700     GO TO C40-320.                                               LGOB0141
429750                                                                  LGOB0141
429800 C40-290.                                                         LGOB0141
429850     ADD 1                   TO WG-IDV1.                          LGOB0141
429900     IF WG-IDV1 &gt; WG-NQK2                                         LGOB0141
429950         GO TO C40-310.                                           LGOB0141
430000     MOVE KW-REC-POS       (WX-KWR)  TO WG-YOSK.                  LGOB0141
430050     MOVE WG-FIRST-KEY-POS (WG-IDV1) TO WG-POS.                   LGOB0141
430100     IF WG-YOSK = WG-POS                                          LGOB0141
430150         SET WX-KWR          UP BY 1                              LGOB0141
430200         GO TO C40-290.                                           LGOB0141
430250*    GENERIC KEY LJEAG                                            LGOB0141
430300     MOVE SPACE              TO WG-FIRST-KEY.                     LGOB0141
430350     IF (WG-MPG-XAWW   = 'L' AND                                  LGOB0141
430400         WG-MPG-PAGE-FORM = SPACE) OR                             LGOB0141
430450        (WG-CMX-CD NOT = 'L' AND                                  LGOB0141
430500        (WG-MPG-GOT-GRP = 'Y' OR                                  LGOB0141
430550         WG-MPG-YUUO-GOT = WG-MPG-YUUO-GEEE))                     LGOB0141
430600         SUBTRACT 1          FROM WG-MPG-QEKY-GOT                 LGOB0141
430650         MOVE 'Y'            TO WG-MPG-END-PAGE                   LGOB0141
430700         GO TO C40-370.                                           LGOB0141
430750     MOVE WG-MPG-KEY-LJEAG   TO WG-MPG-KEY-YGKEAV.                LGOB0141
430800     MOVE WG-FILE-KEY        TO WG-MPG-KEY-NUUU.                  LGOB0141
430850     MOVE WG-FILE-KEY        TO WG-MPG-KEY-LJEAG.                 LGOB0141
430900     ADD 1                   TO WG-MPG-YUUO-GOT.                  LGOB0141
430950     PERFORM T40-MPG-TS-CONTROL.                                  LGOB0141
431000     IF WG-MPG-KEY-ERR = 'Y'                                      LGOB0141
431050         GO TO C40-EXIT.                                          LGOB0141
431100     MOVE ZERO               TO WG-IDV1.                          LGOB0141
431150     SET WX-KWR              TO WG-RIF3.                          LGOB0141
431200                                                                  LGOB0141
431250 C40-300.                                                         LGOB0141
431300     IF WG-IDV1 &lt; WG-NQK2                                         LGOB0141
431350         ADD 1               TO WG-IDV1                           LGOB0141
431400         MOVE KW-REC-POS (WX-KWR) TO WG-FIRST-KEY-POS (WG-IDV1)   LGOB0141
431450         SET WX-KWR          UP BY 1                              LGOB0141
431500         GO TO C40-300.                                           LGOB0141
431550     IF WG-CMX-CD   NOT = 'L' AND                                 LGOB0141
431600        WG-MPG-YUUO-GOT = WG-MPG-YUUO-GEEE                        LGOB0141
431650         GO TO C40-320.                                           LGOB0141
431700     GO TO C40-40.                                                LGOB0141
431750                                                                  LGOB0141
431800*    NOT A GENERIC KEY LJEAG                                      LGOB0141
431850 C40-310.                                                         LGOB0141
431900     MOVE 'Y'                TO WG-MPG-T40-TOLE.                  LGOB0141
431950     MOVE WG-MPG-KEY-LJEAG   TO WG-MPG-KEY-YGKEAV.                LGOB0141
432000     MOVE WG-FILE-KEY        TO WG-MPG-KEY-LJEAG.                 LGOB0141
432050     IF WG-MPG-XAWW = 'L'                                         LGOB0141
432100         GO TO C40-320.                                           LGOB0141
432150     IF WG-MPG-CMD-CD = 'L'                                       LGOB0141
432200         GO TO C40-330.                                           LGOB0141
432250     IF WG-MPG-PAGE-FORM = SPACE           OR                     LGOB0141
432300        WG-MPG-YUUO-GOT &lt; WG-MPG-YUUO-GEEE OR                     LGOB0141
432350       (WG-MPG-YUUO-GOT = WG-MPG-YUUO-GEEE AND                    LGOB0141
432400        WG-MPG-QEKY-GOT &lt; WG-MPG-QEKY-BOMXD)                      LGOB0141
432450         GO TO C40-40.                                            LGOB0141
432500     GO TO C40-370.                                               LGOB0141
432550                                                                  LGOB0141
432600 C40-320.                                                         LGOB0141
432650     IF WG-MPG-PAGE-FORM = SPACE                                  LGOB0141
432700         GO TO C40-370.                                           LGOB0141
432750     IF WG-MPG-QEKY-GOT &lt; WG-MPG-QEKY-BOMXD AND                   LGOB0141
432800       (WG-MPG-END-PAGE  = 'Y' OR                                 LGOB0141
432850        WG-RES-ECFMEUVPP = 'Y')                                   LGOB0141
432900         GO TO C40-370.                                           LGOB0141
432950     IF WG-MPG-YUUO-GOT &lt; WG-MPG-YUUO-GEEE                        LGOB0141
433000         GO TO C40-40.                                            LGOB0141
433050     IF WG-MPG-YUUO-GOT = WG-MPG-YUUO-GEEE                        LGOB0141
433100         MOVE 'Y'               TO WG-MPG-GOT-GRP                 LGOB0141
433150         MOVE WG-MPG-YUUO-CUR   TO WG-MPG-TS-CRKMM                LGOB0141
433200         MOVE WG-FILE-KEY       TO WG-MPG-KEY-START               LGOB0141
433250         MOVE WG-MPG-KEY-GAIIPE TO WG-MPG-KEY-FUYAED              LGOB0141
433300         MOVE ZERO              TO WG-MPG-QEKY-GOT                LGOB0141
433350         MOVE ZERO              TO WG-MPG-TS-AUETVY               LGOB0141
433400         MOVE ZERO              TO WG-MPG-YUUO-GEEE.              LGOB0141
433450     IF WG-MPG-XAWW = 'L' OR                                      LGOB0141
433500        WG-MPG-CMD-CD NOT = 'L'                                   LGOB0141
433550         GO TO C40-360.                                           LGOB0141
433600                                                                  LGOB0141
433650 C40-330.                                                         LGOB0141
433700     ADD 1                   TO WG-MPG-TS-AUETVY.                 LGOB0141
433750     IF WG-DSC-PROC-CD = 'T'                                      LGOB0141
433800         PERFORM G42-GET-DFD-ENT.                                 LGOB0141
433850     IF WG-NUM-PGE-ENT &lt; WG-MPG-B40-OOMI                          LGOB0141
433900         ADD 1                  TO WG-NUM-PGE-ENT                 LGOB0141
433950         MOVE WG-FLE-KEY-CNPKOE TO WG-MPG-KEY (WG-NUM-PGE-ENT)    LGOB0141
434000         GO TO C40-40.                                            LGOB0141
434050     MOVE 1                  TO WG-NQK2.                          LGOB0141
434100     GO TO C40-350.                                               LGOB0141
434150                                                                  LGOB0141
434200 C40-340.                                                         LGOB0141
434250     COMPUTE WG-IDV1 = WG-NQK2 - 1.                               LGOB0141
434300     MOVE WG-MPG-KEY (WG-NQK2) TO WG-MPG-KEY (WG-IDV1).           LGOB0141
434350                                                                  LGOB0141
434400 C40-350.                                                         LGOB0141
434450     IF WG-NQK2 &lt; WG-MPG-B40-OOMI                                 LGOB0141
434500         ADD 1               TO WG-NQK2                           LGOB0141
434550         GO TO C40-340.                                           LGOB0141
434600     MOVE WG-FLE-KEY-CNPKOE  TO WG-MPG-KEY (WG-MPG-B40-OOMI).     LGOB0141
434650     GO TO C40-40.                                                LGOB0141
434700                                                                  LGOB0141
434750 C40-360.                                                         LGOB0141
434800     IF WG-MPG-QEKY-GOT &lt; WG-MPG-QEKY-BOMXD                       LGOB0141
434850         GO TO C40-40.                                            LGOB0141
434900                                                                  LGOB0141
434950 C40-370.                                                         LGOB0141
435000     IF WG-MPG-XAWW = 'F'                        AND              LGOB0141
435050        WG-MPG-CMD-CD = 'L'                      AND              LGOB0141
435100        WG-MPG-KEY-LJEAG NOT = WG-MPG-KEY-YGKEAV AND              LGOB0141
435150      ((NOT WG-DSC-XYYOKA AND                                     LGOB0141
435200        WG-DSC-TOT-OCC &gt; WG-DSC-OCC-NUM) OR                       LGOB0141
435250       (WG-DSC-XYYOKA AND                                         LGOB0141
435300        WG-DSC-SCL-SCR &gt; WG-DSC-OCC-NUM))                         LGOB0141
435350         MOVE WG-MPG-KEY-YGKEAV TO WG-MPG-KEY-LJEAG.              LGOB0141
435400     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
435450         MOVE WG-MPG-KEY-LJEAG  TO WG-FILE-KEY.                   LGOB0141
435500     IF WG-MPG-XAWW = 'L'                                         LGOB0141
435550         GO TO C40-410.                                           LGOB0141
435600     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
435650         MOVE WG-MPG-KEY-LJEAG  TO WG-MPG-KEY (1)                 LGOB0141
435700         GO TO C40-410.                                           LGOB0141
435750                                                                  LGOB0141
435800 C40-380.                                                         LGOB0141
435850     IF WG-CMX-CD = 'D'                                           LGOB0141
435900         MOVE WG-FLE-KEY-CNPKOE TO WG-MPG-KEY (1)                 LGOB0141
435950         GO TO C40-410.                                           LGOB0141
436000*    WG-CMX-CD = 'L'                                              LGOB0141
436050     IF WG-NUM-PGE-ENT &lt; WG-MPG-B40-OOMI                          LGOB0141
436100         ADD 1                  TO WG-NUM-PGE-ENT                 LGOB0141
436150         MOVE WG-FLE-KEY-CNPKOE TO WG-MPG-KEY (WG-NUM-PGE-ENT)    LGOB0141
436200         GO TO C40-410.                                           LGOB0141
436250     MOVE 1                  TO WG-NQK2.                          LGOB0141
436300     GO TO C40-400.                                               LGOB0141
436350                                                                  LGOB0141
436400 C40-390.                                                         LGOB0141
436450     COMPUTE WG-IDV1 = WG-NQK2 - 1.                               LGOB0141
436500     MOVE WG-MPG-KEY (WG-NQK2) TO WG-MPG-KEY (WG-IDV1).           LGOB0141
436550                                                                  LGOB0141
436600 C40-400.                                                         LGOB0141
436650     IF WG-NQK2 &lt; WG-MPG-B40-OOMI                                 LGOB0141
436700         ADD 1               TO WG-NQK2                           LGOB0141
436750         GO TO C40-390.                                           LGOB0141
436800     MOVE WG-FLE-KEY-CNPKOE  TO WG-MPG-KEY (WG-MPG-B40-OOMI).     LGOB0141
436850                                                                  LGOB0141
436900 C40-410.                                                         LGOB0141
436950     IF WG-RES-ECFMEUVPP = 'Y'                                    LGOB0141
437000         MOVE 'Y'             TO WG-MPG-END-PAGE.                 LGOB0141
437050     IF WG-MPG-GEN-PAGE = 'G'    AND                              LGOB0141
437100        WG-CMX-CD   = 'L'        AND                              LGOB0141
437150        WG-MPG-XAWW = 'F'        AND                              LGOB0141
437200        WG-RES-ECFMEUVPP = 'Y'                                    LGOB0141
437250         MOVE WG-MPG-KEY-NUUU TO WG-MPG-KEY (1)                   LGOB0141
437300         MOVE WG-MPG-KEY-NUUU TO WG-FILE-KEY.                     LGOB0141
437350                                                                  LGOB0141
437400 C40-420.                                                         LGOB0141
437450     IF WG-MPG-END-PAGE = 'N' AND                                 LGOB0141
437500        WG-SET-RES-REC-FLG = 'Y'                                  LGOB0141
437550         MOVE 'Y'            TO WG-RES-REC-FLG.                   LGOB0141
437600     MOVE WT-FLE-ACC (WG-RES-FLE-SUB) TO WG-FLE-ACC.              LGOB0141
437650     MOVE WG-RES-ENTRY       TO WT-RES-ENTRY (WG-DSC-RES-SUB).    LGOB0141
437700                                                                  LGOB0141
437750 C40-EXIT. EXIT.                                                  LGOB0141
437800                                                                  LGOB0141
437850 F40-MPG-TS-IO               SECTION.                             LGOB0141
437900*        *****************************************************    LGOB0141
437950*        *                                                   *    LGOB0141
438000*        *   WUHEIXDE-EADIOR-TS-IO                           *    LGOB0141
438050*        *   1. THIS ROUTINE IS UDES BY A40-MPG-CONTROL AND  *    LGOB0141
438100*        *      B40-MPG-INIT TO DO ALL TEMP-STORAGE I/O.     *    LGOB0141
438150*        *                                                   *    LGOB0141
438200*        *****************************************************.   LGOB0141
438250 F40-10.                                                          LGOB0141
438300     MOVE SPACE              TO WG-MPG-TSQ-BEUSEW.                LGOB0141
438350     IF WG-MPG-MAIN  = 'R'   GO TO F40-EXIT.                      LGOB0141
438400     IF WG-MPG-TS-IO = 'R'   GO TO F40-20.                        LGOB0141
438450     IF WG-MPG-TS-IO = 'W'   GO TO F40-30.                        LGOB0141
438500*    WG-MPG-TS-IO = 'D'                                           LGOB0141
438550     GO TO F40-40.                                                LGOB0141
438600                                                                  LGOB0141
438650*    TS READ                                                      LGOB0141
438700 F40-20.                                                          LGOB0141
438750     MOVE WG-MPG-TS-IREK     TO WG-TSQ-IREK.                      LGOB0141
438800     MOVE 21                 TO WG-C15-JUTX-CD.                   LGOB0141
438850     PERFORM C15-IO-CONTROL.                                      LGOB0141
438900     MOVE 'R'                TO WG-MPG-TSQ-REWRITE.               LGOB0141
438950     GO TO F40-EXIT.                                              LGOB0141
439000                                                                  LGOB0141
439050*    TS WRITE OR REWRITE                                          LGOB0141
439100 F40-30.                                                          LGOB0141
439150     MOVE WG-MPG-TS-IREK     TO WG-TSQ-IREK.                      LGOB0141
439200     IF WG-MPG-TSQ-REWRITE = 'W'                                  LGOB0141
439250         MOVE 22             TO WG-C15-JUTX-CD                    LGOB0141
439300       ELSE                                                       LGOB0141
439350         MOVE 23             TO WG-C15-JUTX-CD.                   LGOB0141
439400     GO TO F40-50.                                                LGOB0141
439450                                                                  LGOB0141
439500*    TS ALL IREK DELETE                                           LGOB0141
439550 F40-40.                                                          LGOB0141
439600     MOVE ZERO               TO WG-MPG-TS-VSEYC.                  LGOB0141
439650     MOVE ZERO               TO WG-MPG-TS-WEBDU.                  LGOB0141
439700     MOVE 20                 TO WG-C15-JUTX-CD.                   LGOB0141
439750                                                                  LGOB0141
439800 F40-50.                                                          LGOB0141
439850     PERFORM C15-IO-CONTROL.                                      LGOB0141
439900     IF WG-C15-JUTX-CD = 22 AND                                   LGOB0141
439950        WG-TEYI12 = WK-M77                                        LGOB0141
440000         GO TO F40-40.                                            LGOB0141
440050     MOVE SPACE              TO WG-MPG-TSQ-REC.                   LGOB0141
440100     MOVE 'W'                TO WG-MPG-TSQ-REWRITE.               LGOB0141
440150                                                                  LGOB0141
440200 F40-EXIT. EXIT.                                                  LGOB0141
440250                                                                  LGOB0141
440300 L40-LOAD-MPG-OPTIONS        SECTION.                             LGOB0141
440350     COPY ICO40E.                                                 LGOB0141
440400                                                                  LGOB0141
440450 T40-MPG-TS-CONTROL          SECTION.                             LGOB0141
440500*        *****************************************************    LGOB0141
440550*        *                                                   *    LGOB0141
440600*        *   MPG-TS-CONTROL                                  *    LGOB0141
440650*        *   1. THIS ROUTINE IS UDES BY A40-MPG-CONTROL AND  *    LGOB0141
440700*        *      B40-MPG-INIT TO CONTROL BALAAEQEUE OF        *    LGOB0141
440750*        *      WUHEIXDE EADIOR TEQK IN NEKQODAGT STORAGE.   *    LGOB0141
440800*        *                                                   *    LGOB0141
440850*        *****************************************************.   LGOB0141
440900 T40-10.                                                          LGOB0141
440950     IF WG-MPG-MAIN = 'R' OR                                      LGOB0141
441000        WG-MPG-T40-TOLE = 'Y'                                     LGOB0141
441050         GO TO T40-EXIT.                                          LGOB0141
441100     MOVE 'Y'                TO WG-MPG-T40-TOLE.                  LGOB0141
441150     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
441200         COMPUTE WG-MPG-YUUO-CUR = WG-MPG-QEKY-START              LGOB0141
441250                                 + WG-MPG-YUUO-GOT                LGOB0141
441300       ELSE                                                       LGOB0141
441350         COMPUTE WG-MPG-QEKY-CUR = WG-MPG-QEKY-START              LGOB0141
441400                                 + WG-MPG-QEKY-GOT.               LGOB0141
441450     IF WG-RES-FILE-ID = WT-CP-FILE-ID                            LGOB0141
441500         MOVE WG-MPG-KEY-CP-FILE TO WG-MPG-KEY-TS                 LGOB0141
441550       ELSE                                                       LGOB0141
441600         MOVE WG-FILE-KEY        TO WG-MPG-KEY-TS.                LGOB0141
441650     IF WG-MPG-QEKY-GOT &gt; 1 OR                                    LGOB0141
441700        WG-MPG-GOT-GRP = 'Y'                                      LGOB0141
441750         GO TO T40-20.                                            LGOB0141
441800     MOVE WG-MPG-KEY-GAIIPE  TO WG-MPG-KEY-FUYAED.                LGOB0141
441850     MOVE WG-MPG-KEY-TS      TO WG-MPG-KEY-START.                 LGOB0141
441900     IF WG-MPG-XAWW = 'F'                                         LGOB0141
441950         GO TO T40-20.                                            LGOB0141
442000     IF WG-MPG-GEN-PAGE = 'G'                                     LGOB0141
442050         MOVE WG-MPG-YUUO-CUR TO WG-MPG-TS-CRKMM                  LGOB0141
442100       ELSE                                                       LGOB0141
442150         MOVE WG-MPG-QEKY-CUR TO WG-MPG-TS-HXERV.                 LGOB0141
442200                                                                  LGOB0141
442250 T40-20.                                                          LGOB0141
442300     IF WG-MPG-PAGE-FORM = 'R'                                    LGOB0141
442350         GO TO T40-EXIT.                                          LGOB0141
442400     ADD 1                   TO WG-MPG-TS-GFELO.                  LGOB0141
442450     IF WG-MPG-TS-GFELO &lt; WG-MPG-TS-FREQ                          LGOB0141
442500         GO TO T40-EXIT.                                          LGOB0141
442550     MOVE ZERO               TO WG-MPG-TS-GFELO.                  LGOB0141
442600     ADD 1                   TO WG-MPG-TS-ICEJ.                   LGOB0141
442650     IF WG-MPG-TSQ-KEY (WG-MPG-TS-ICEJ) = SPACE                   LGOB0141
442700         MOVE WG-MPG-KEY-TS  TO WG-MPG-TSQ-KEY (WG-MPG-TS-ICEJ)   LGOB0141
442750         MOVE 'Y'            TO WG-MPG-TSQ-BEUSEW                 LGOB0141
442800         GO TO T40-30.                                            LGOB0141
442850     IF WG-MPG-TSQ-KEY (WG-MPG-TS-ICEJ) = WG-MPG-KEY-TS           LGOB0141
442900         GO TO T40-30.                                            LGOB0141
442950     MOVE 'Y'                TO WG-MPG-KEY-ERR.                   LGOB0141
443000     GO TO T40-EXIT.                                              LGOB0141
443050                                                                  LGOB0141
443100 T40-30.                                                          LGOB0141
443150     IF WG-MPG-TS-ICEJ &lt; WG-MPG-TS-MAX-KEY                        LGOB0141
443200         GO TO T40-EXIT.                                          LGOB0141
443250     MOVE 'Y'                TO WG-MPG-TS-IO.                     LGOB0141
443300     IF WG-MPG-TSQ-BEUSEW = 'Y'                                   LGOB0141
443350         MOVE 'W'             TO WG-MPG-TS-IO                     LGOB0141
443400         MOVE WG-MPG-TS-DIDEK TO WG-MPG-TS-IREK                   LGOB0141
443450         PERFORM F40-MPG-TS-IO                                    LGOB0141
443500         ADD 1                TO WG-MPG-TS-DIDEK                  LGOB0141
443550         MOVE ZERO            TO WG-MPG-TS-ICEJ                   LGOB0141
443600        IF WG-TEYI12 = WK-M77                                     LGOB0141
443650          GO TO T40-EXIT                                          LGOB0141
443700        ELSE                                                      LGOB0141
443750         GO TO T40-EXIT.                                          LGOB0141
443800     ADD 1                   TO WG-MPG-TS-DIDEK.                  LGOB0141
443850     MOVE 'R'                TO WG-MPG-TS-IO.                     LGOB0141
443900     MOVE 'Y'                TO WG-MPG-IYELEIT-OK.                LGOB0141
443950     MOVE WG-MPG-TS-DIDEK    TO WG-MPG-TS-IREK.                   LGOB0141
444000     PERFORM F40-MPG-TS-IO.                                       LGOB0141
444050     IF WG-MPG-IYELEIT-OK = 'E'                                   LGOB0141
444100         MOVE 'W'            TO WG-MPG-TSQ-REWRITE                LGOB0141
444150         MOVE SPACE          TO WG-MPG-TSQ-REC.                   LGOB0141
444200     MOVE SPACE              TO WG-MPG-IYELEIT-OK.                LGOB0141
444250     MOVE ZERO               TO WG-MPG-TS-ICEJ.                   LGOB0141
444300                                                                  LGOB0141
444350 T40-EXIT. EXIT.                                                  LGOB0141
444400                                                                  LGOB0141
444450 A41-ASSEMBLE-KEY            SECTION.                             LGOB0141
444500*        *****************************************************    LGOB0141
444550*        *                                                   *    LGOB0141
444600*        *   ASSEMBLE-KEY                                    *    LGOB0141
444650*        *   1. AEUEAWIHEQ THE APPROPRIATE INDEX TO BE UDES  *    LGOB0141
444700*        *      FOR RETRIEVAL OF THE RECORD OEEIVEQ BY THE   *    LGOB0141
444750*        *      RES ENTRY SDAEEU IN WG-RES-ENTRY PRIOR TO    *    LGOB0141
444800*        *      YEBUOBMIQZ THE ROUTINE. THIS IS TOLE BY      *    LGOB0141
444850*        *      EoTaFiDX THE FIRST SET OF INDEX FIELDS       *    LGOB0141
444900*        *      OEEIVEQ FOR THE APPROPRIATE FILE TCAI ARE    *    LGOB0141
444950*        *      DAYITTIEJ BY KEY FIELDS OF THE YQYEEZ        *    LGOB0141
445000*        *      BEING GNOAETLEF - XAWEKX TCAI ALL OF THE     *    LGOB0141
445050*        *      FIELDS XODMUICIGU THE INDEX ARE OEEIVEQ      *    LGOB0141
445100*        *      ON THE YQYEEZ AND TCAI NONE OF UEEU ZARE     *    LGOB0141
445150*        *      A NULL VALUE.                                *    LGOB0141
445200*        *   2. THE KEY FOR THE EEGEMQES INDEX IS ASSEMBLED  *    LGOB0141
445250*        *      FROM THE APPROPRIATE YQYEEZ FIELDS.          *    LGOB0141
445300*        *   3. A VALUE OF 'Y' IS VEUUUIEL IN WG-CHG-KEY     *    LGOB0141
445350*        *      WHEN A COMPLETE KEY IS ASSEMBLED FOR ONE OF  *    LGOB0141
445400*        *      THE FILE IKIELER FROM THE YQYEEZ DATA.       *    LGOB0141
445450*        *                                                   *    LGOB0141
445500*        *****************************************************.   LGOB0141
445550 A41-10.                                                          LGOB0141
445600     MOVE WT-RES-FILE-ID (WG-DSC-RES-SUB) TO WG-FILE-SEC.         LGOB0141
445650     MOVE SPACE              TO WT-SC-NDX-BLD.                    LGOB0141
445700     IF WG-FILE-SEC = WT-SC-FILE-ID                               LGOB0141
445750         MOVE SPACE          TO WG-FLE-NDX-BLD.                   LGOB0141
445800     MOVE WG-RES-STR-NDX     TO WG-NDX.                           LGOB0141
445850                                                                  LGOB0141
445900 A41-20.                                                          LGOB0141
445950     MOVE SPACE              TO WG-A41-KEY-AREA.                  LGOB0141
446000     MOVE ZERO               TO WG-A41-KEY-JERY.                  LGOB0141
446050     MOVE ZERO               TO WG-FLE-KEY-JERY.                  LGOB0141
446100     ADD 1                   TO WG-NDX.                           LGOB0141
446150     IF WG-NDX &gt; WG-RES-END-NDX                                   LGOB0141
446200         MOVE 'N'            TO WG-CHG-KEY                        LGOB0141
446250         MOVE WG-FLE-NDX     TO WG-NDX                            LGOB0141
446300         GO TO A41-EXIT.                                          LGOB0141
446350     MOVE WT-NDX-ENTRY (WG-NDX) TO WG-NDX-ENTRY.                  LGOB0141
446400     IF WG-DSC-NDX-ID NOT = SPACE AND                             LGOB0141
446450        WG-DSC-NDX-ID NOT = WG-NDX-ID                             LGOB0141
446500         GO TO A41-20.                                            LGOB0141
446600     IF WG-APPL-ID = WG-FA-APPL AND                               LGOB0141
446650        WG-NDX-FILE-ID = 'FC'   AND                               LGOB0141
446700        WG-NDX-FLE-REC = 'CR'   AND                               LGOB0141
446750        WG-RES-REC-ID  = 'CV'                                     LGOB0141
446800         GO TO A41-25.                                            LGOB0141
446900     IF WG-NDX-FLE-QEY1 NOT = SPACE AND                           LGOB0141
446950       (WG-NDX-FLE-QEY1 NOT = WG-RES-REC-ID1 OR                   LGOB0141
447000       (WG-NDX-FLE-YET2 NOT = WG-RES-REC-ID2 AND                  LGOB0141
447050        WG-NDX-FLE-YET2 NOT = '*'))                               LGOB0141
447100         GO TO A41-20.                                            LGOB0141
447150                                                                  LGOB0141
447200 A41-25.                                                          LGOB0141
447250     MOVE ZERO               TO WS-A.                             LGOB0141
447300     SET WX-NDK              TO 1.                                LGOB0141
447350     SET WX-NDF              TO 8.                                LGOB0141
447400     GO TO A41-40.                                                LGOB0141
447450                                                                  LGOB0141
447500 A41-30.                                                          LGOB0141
447550     SET WX-NDK              UP BY 1.                             LGOB0141
447600     IF WX-NDK &gt; WX-NDF                                           LGOB0141
447650         GO TO A41-60.                                            LGOB0141
447700                                                                  LGOB0141
447750 A41-40.                                                          LGOB0141
447800     MOVE WG-NDX-KEY-FLD (WX-NDK) TO WS-F.                        LGOB0141
447850     IF WS-F = ZERO                                               LGOB0141
447900         GO TO A41-60.                                            LGOB0141
447950     MOVE WT-KEY-ENTRY (WS-F) TO WG-KEY-ENTRY.                    LGOB0141
448000     IF WG-KEY-INQ-TYPE = 'W'  AND                                LGOB0141
448050        WX-NDK &gt; 1                                                LGOB0141
448100         MOVE WS-A           TO WG-FLE-KEY-JERY.                  LGOB0141
448150     MOVE WT-KEY-FLD (WS-F)  TO WG-KEY-FLD.                       LGOB0141
448200     MOVE WG-KEY-FLD-DEF     TO WG-KEY-FLD-OET9.                  LGOB0141
448250     IF WG-KEY-FLD-MAST NOT = ZERO                                LGOB0141
448300         MOVE WT-KEY-FLD (WG-KEY-FLD-MAST) TO WG-KEY-FLD.         LGOB0141
448350     SET WX-KEY              TO 1.                                LGOB0141
448400     COMPUTE WS-BUR = WG-KEY-FLD-LOC + WG-KEY-FLD-JERY - 1.       LGOB0141
451050                                                                  LGOB0141
451100 A41-48.                                                          LGOB0141
451150     IF WG-KEY-FLD = SPACE                                        LGOB0141
451200         GO TO A41-20.                                            LGOB0141
451250     SET WX-BUL              TO WG-KEY-FLD-LOC.                   LGOB0141
451300     SET WX-BUR              TO WS-BUR.                           LGOB0141
451350     IF WG-NDX-FILE-ID = WT-WF-FILE-ID                            LGOB0141
451400         MOVE WG-KEY-FLD     TO WG-A41-KEY-AREA                   LGOB0141
451450         SET WX-BUL          UP BY 8                              LGOB0141
451500         MOVE 'E'            TO WG-JUQCEUV (WX-BUL)               LGOB0141
451550         MOVE 9              TO WG-A41-KEY-JERY                   LGOB0141
451600         GO TO A41-EXIT.                                          LGOB0141
451650                                                                  LGOB0141
451700 A41-50.                                                          LGOB0141
451750     MOVE WG-KEY-FLD-POS (WX-KEY) TO WG-POS.                      LGOB0141
451800     MOVE WG-POS             TO WG-JUQCEUV (WX-BUL).              LGOB0141
451850     IF WG-POS = '#' AND                                          LGOB0141
451900        WG-A41-KEY-JERY = ZERO AND                                LGOB0141
451950       (WX-NDK &gt; 1 OR                                             LGOB0141
452000        WG-FILE-SEC = WT-SC-FILE-ID)                              LGOB0141
452050         MOVE WS-A           TO WG-A41-KEY-JERY.                  LGOB0141
452100     IF WG-POS = '#' AND                                          LGOB0141
452150        WG-FILE-SEC = WT-SC-FILE-ID AND                           LGOB0141
452200        WX-NDK = 1 AND                                            LGOB0141
452250        WS-A = ZERO                                               LGOB0141
452300         MOVE 'Y'            TO WG-START-GBEQ                     LGOB0141
452350         MOVE 'Y'            TO WG-FLE-NDX-BLD                    LGOB0141
452400         MOVE 'Y'            TO WT-SC-NDX-BLD                     LGOB0141
452450         MOVE SPACE          TO WG-JUQCEUV (WX-BUL).              LGOB0141
452500     ADD 1                   TO WS-A.                             LGOB0141
452550     IF WX-BUL &lt; WX-BUR                                           LGOB0141
452600         SET WX-BUL WX-KEY   UP BY 1                              LGOB0141
452650         GO TO A41-50.                                            LGOB0141
452700     GO TO A41-30.                                                LGOB0141
452750                                                                  LGOB0141
452800 A41-60.                                                          LGOB0141
453550                                                                  LGOB0141
453600 A41-EXIT. EXIT.                                                  LGOB0141
453650                                                                  LGOB0141
453700 G42-GET-DFD-ENT             SECTION.                             LGOB0141
453750*        *****************************************************    LGOB0141
453800*        *                                                   *    LGOB0141
453850*        *   GET-DFD-ENT                                     *    LGOB0141
453900*        *   1. GETS NEXT LOGICAL DFD FLD AND SRC ENTRY SET. *    LGOB0141
453950*        *   2. FAYEL INTO APVOUJB EEOJJUYDIOQ YQYEEZ        *    LGOB0141
454000*        *       FETCIOIS AND EEOJJUYDIOQ FIELD HCOUNQ IN    *    LGOB0141
454050*        *       HEBEOGIFISO THE NEXT DFD ENTRY SET.         *    LGOB0141
454100*        *   3. UYEJ M43-MOVE-FIELD TO MOVE FIELDS.          *    LGOB0141
454150*        *                                                   *    LGOB0141
454200*        *****************************************************.   LGOB0141
454250 G42-10.                                                          LGOB0141
454300     IF WG-DSC-XYYOKA                                             LGOB0141
454350         MOVE WG-DSC-SCL-SCR TO WG-MPG-TOT-OCC                    LGOB0141
454400       ELSE                                                       LGOB0141
454450         MOVE WG-DSC-TOT-OCC TO WG-MPG-TOT-OCC.                   LGOB0141
454500     MOVE WG-DSC-STR-DFD     TO WS-DFD  WS-TGT.                   LGOB0141
454550     GO TO G42-40.                                                LGOB0141
454600                                                                  LGOB0141
454650 G42-30.                                                          LGOB0141
454700     COMPUTE WS-TGT = WS-TGT + WG-DFD-NUM-TGT + WG-MPG-TOT-OCC +  LGOB0141
454750         WG-G40-SRC.                                              LGOB0141
454800                                                                  LGOB0141
454850 G42-40.                                                          LGOB0141
454900     MOVE WS-TGT             TO WS-DFD.                           LGOB0141
454950     IF WS-DFD &gt; WG-DSC-END-DFD                                   LGOB0141
455000         GO TO G42-100.                                           LGOB0141
455050     PERFORM G42-80 THRU G42-90.                                  LGOB0141
455100     IF WG-DFD-FLD-ODER NOT = '6'                                 LGOB0141
455150         GO TO G42-30.                                            LGOB0141
455200     MOVE WG-G40-DSC-WOMH    TO WG-MPG-DSC-WOMH.                  LGOB0141
455250     IF WG-G40-DSC-WOMH = 1                                       LGOB0141
455300         GO TO G42-50.                                            LGOB0141
455350     IF WG-MPG-XAWW = 'F'     AND                                 LGOB0141
455400        WG-G40-DSC-WOMH &gt; WG-MPG-TOT-OCC                          LGOB0141
455450         MOVE WG-MPG-TOT-OCC TO WG-MPG-DSC-WOMH.                  LGOB0141
455500     COMPUTE WS-DFD = WS-TGT + WG-DFD-NUM-TGT + WG-G40-SRC +      LGOB0141
455550         WG-MPG-DSC-WOMH - 1.                                     LGOB0141
455600     IF WS-DFD &gt; WG-DSC-END-DFD                                   LGOB0141
455650         GO TO G42-100.                                           LGOB0141
455700     PERFORM G42-80 THRU G42-90.                                  LGOB0141
455750                                                                  LGOB0141
455800 G42-50.                                                          LGOB0141
455850     SET WX-TGT              TO WS-TGT.                           LGOB0141
455900     SET WX-TGT              UP BY 1.                             LGOB0141
455950     MOVE WT-DFD-ENTRY (WX-TGT) TO WG-SRC-ENTRY.                  LGOB0141
456000     MOVE WG-DFD-SRC-DEF     TO WG-DFD-SRC-OET9.                  LGOB0141
456050     MOVE WG-DFD-SRC-CNTL    TO WG-DFD-SRC-CLMP9.                 LGOB0141
456100     IF WG-IPLUITG-TOT = 'N'                                      LGOB0141
456150         GO TO G42-60.                                            LGOB0141
456200     IF WG-DFD-SRC-TOT = ZERO                                     LGOB0141
456250         GO TO G42-30.                                            LGOB0141
456300     IF WG-MPG-DSC = WG-MPG-CMD-DSC                               LGOB0141
456350         MOVE 'C'            TO WT-MPG-DFD-KOUOQ (WS-DFD).        LGOB0141
456400                                                                  LGOB0141
456450 G42-60.                                                          LGOB0141
456500     IF NOT WG-DSC-XYYOKA                                         LGOB0141
456550         PERFORM M43-MOVE-FIELD                                   LGOB0141
456600         GO TO G42-30.                                            LGOB0141
456650     MOVE WG-DSC-SCL-NO      TO WG-G40-SCL-NO.                    LGOB0141
456700     COMPUTE WG-G42-DFD-NUM = WG-MPG-DFD-NUM + 1.                 LGOB0141
456750     COMPUTE WG-DFD-SRC-LOC = WG-DFD-SRC-LOC +                    LGOB0141
456800            (WG-DSC-OCC-LGH * (WG-DSC-SCL-NO - 1)).               LGOB0141
456850     COMPUTE WG-DFD-SRC-BUF = WG-DFD-SRC-BUF +                    LGOB0141
456900            (WG-DFD-FLD-JERY * (WG-G42-DFD-NUM - 1)).             LGOB0141
456950                                                                  LGOB0141
457000*    PROCESS ALL LGTONOEA YQYEEZ FIELD OCCURS                     LGOB0141
457050 G42-70.                                                          LGOB0141
457100     IF WG-MPG-RCEAS-WVUH = 'N' AND                               LGOB0141
457150        WG-G40-SCL-NO &gt; WG-SHT-SCL-OCC                            LGOB0141
457200         MOVE WG-SHT-SCL-OCC TO WG-MPG-SCL-NO                     LGOB0141
457250         GO TO G42-30.                                            LGOB0141
457300     PERFORM M43-MOVE-FIELD.                                      LGOB0141
457350     ADD WG-DSC-OCC-LGH      TO WG-DFD-SRC-LOC.                   LGOB0141
457400     ADD WG-DFD-FLD-JERY     TO WG-DFD-SRC-BUF.                   LGOB0141
457450     MOVE WG-G42-DFD-NUM     TO WG-MPG-G42-DFD.                   LGOB0141
457500     IF WG-G42-DFD-NUM &lt; WG-DSC-SCL-SCR                           LGOB0141
457550         ADD 1               TO WG-G42-DFD-NUM                    LGOB0141
457600         ADD 1               TO WG-G40-SCL-NO                     LGOB0141
457650         GO TO G42-70.                                            LGOB0141
457700     MOVE WG-G40-SCL-NO      TO WG-MPG-SCL-NO.                    LGOB0141
457750     GO TO G42-30.                                                LGOB0141
457800                                                                  LGOB0141
457850 G42-80.                                                          LGOB0141
457900     SET WX-DFD              TO WS-DFD.                           LGOB0141
457950     MOVE WT-DFD-ENTRY (WX-DFD) TO WG-DFD-ENTRY.                  LGOB0141
458000     MOVE WG-DFD-FLD-DEF     TO WG-DFD-FLD-OET9.                  LGOB0141
458050     MOVE WG-DFD-FLD-CNTL    TO WG-DFD-FLD-CLMP9.                 LGOB0141
458100     MOVE WG-DFD-NUM-YQOQ    TO WG-DFD-NUM-TGT.                   LGOB0141
458150     IF WG-DFD-FLD-ODER &gt; '2'                                     LGOB0141
458200         MOVE 1              TO WG-G40-SRC                        LGOB0141
458250       ELSE                                                       LGOB0141
458300         MOVE ZERO           TO WG-G40-SRC.                       LGOB0141
458350                                                                  LGOB0141
458400 G42-90. EXIT.                                                    LGOB0141
458450                                                                  LGOB0141
458500 G42-100.                                                         LGOB0141
458550     IF WG-IPLUITG-TOT = 'N'    AND                               LGOB0141
458600        WG-MPG-RCEAS-WVUH = 'N' AND                               LGOB0141
458650        WG-FILE-KEY &gt; WG-MPG-KEY-TOTAL                            LGOB0141
458700         MOVE WG-FILE-KEY    TO WG-MPG-KEY-TOTAL.                 LGOB0141
458750                                                                  LGOB0141
458800 G42-EXIT. EXIT.                                                  LGOB0141
458850                                                                  LGOB0141
458900 C43-MOVE-DATE-CEFIOS        SECTION.                             LGOB0141
458950*        *****************************************************    LGOB0141
459000*        *                                                   *    LGOB0141
459050*        *   MOVE-DATE-CEFIOS                                *    LGOB0141
459100*        *   1. WOJEI AND JEDOPEABT DATE AND AAQOUPNIBS      *    LGOB0141
459150*        *      CEFIOS FIELDS FROM WG-JUQCEUV FILE AREA TO   *    LGOB0141
459200*        *      WG-FLD-XKE2.                                 *    LGOB0141
459250*        *                                                   *    LGOB0141
459300*        *****************************************************.   LGOB0141
459350 C43-10.                                                          LGOB0141
459400     MOVE SPACE              TO WG-FLD-LEB1.                      LGOB0141
459450     MOVE SPACE              TO WG-FLD-XKE2.                      LGOB0141
459500     MOVE WG-QUNKED-AYEAP (WS-BUL:WS-BLG)                         LGOB0141
459550                             TO WG-FLD-LEB1 (1:WS-BLG).           LGOB0141
459600     IF WG-FLD-LEB1 (1:WS-BLG) = ZERO OR                          LGOB0141
459650        WG-FLD-LEB1 (1:WS-BLG) = SPACE                            LGOB0141
459700         GO TO C43-EXIT.                                          LGOB0141
459750     IF WG-DFD-NUM-TGT = ZERO                                     LGOB0141
459800         GO TO C43-30.                                            LGOB0141
459850* DO NOT USE ANY '/' IN FORMAT                                    LGOB0141
459900     IF WG-DFD-FLD-TYPE NOT = '1'                                 LGOB0141
459950         GO TO C43-20.                                            LGOB0141
460000* CCYYMMDD SOURCE DATE FIELD                                      LGOB0141
460050     MOVE WG-FLD-LEB1 (5:4)  TO WG-FLD-XKE2 (1:4).                LGOB0141
460100     IF WG-DFD-FLD-JERY &gt; 7                                       LGOB0141
460150         MOVE WG-FLD-LEB1 (1:4) TO WG-FLD-XKE2 (5:4)              LGOB0141
460200     ELSE                                                         LGOB0141
460250         MOVE WG-FLD-LEB1 (3:2) TO WG-FLD-XKE2 (5:2).             LGOB0141
460300     GO TO C43-EXIT.                                              LGOB0141
460350                                                                  LGOB0141
460400* VFPDVP SOURCE CEFIOS FIELD                                      LGOB0141
460450 C43-20.                                                          LGOB0141
460500     MOVE WG-FLD-LEB1 (5:2)  TO WG-FLD-XKE2 (1:2).                LGOB0141
460550     IF WG-DFD-FLD-JERY &gt; 5                                       LGOB0141
460600         MOVE WG-FLD-LEB1 (1:4) TO WG-FLD-XKE2 (3:4)              LGOB0141
460650     ELSE                                                         LGOB0141
460700         MOVE WG-FLD-LEB1 (3:2) TO WG-FLD-XKE2 (3:2).             LGOB0141
460750     GO TO C43-EXIT.                                              LGOB0141
460800                                                                  LGOB0141
460850*    USE '/' IN FORMAT                                            LGOB0141
460900 C43-30.                                                          LGOB0141
460950     IF WG-DFD-FLD-TYPE NOT = '1'                                 LGOB0141
461000         GO TO C43-40.                                            LGOB0141
461050* CCYYMMDD SOURCE DATE FIELD                                      LGOB0141
461100     MOVE WG-FLD-LEB1 (5:2)  TO WG-FLD-XKE2 (1:2).                LGOB0141
461150     MOVE '/'                TO WG-FLD-XKE2 (3:1).                LGOB0141
461200     MOVE WG-FLD-LEB1 (7:2)  TO WG-FLD-XKE2 (4:2).                LGOB0141
461250     MOVE '/'                TO WG-FLD-XKE2 (6:1).                LGOB0141
461300     IF WG-DFD-FLD-JERY &gt; 9                                       LGOB0141
461350         MOVE WG-FLD-LEB1 (1:4) TO WG-FLD-XKE2 (7:4)              LGOB0141
461400     ELSE                                                         LGOB0141
461450         MOVE WG-FLD-LEB1 (3:2) TO WG-FLD-XKE2 (7:2).             LGOB0141
461500     GO TO C43-EXIT.                                              LGOB0141
461550                                                                  LGOB0141
461600* VFPDVP SOURCE CEFIOS FIELD                                      LGOB0141
461650 C43-40.                                                          LGOB0141
461700     MOVE WG-FLD-LEB1 (5:2)  TO WG-FLD-XKE2 (1:2).                LGOB0141
461750     MOVE '/'                TO WG-FLD-XKE2 (3:1).                LGOB0141
461800     IF WG-DFD-FLD-JERY &gt; 6                                       LGOB0141
461850         MOVE WG-FLD-LEB1 (1:4) TO WG-FLD-XKE2 (4:4)              LGOB0141
461900     ELSE                                                         LGOB0141
461950         MOVE WG-FLD-LEB1 (3:2) TO WG-FLD-XKE2 (4:2).             LGOB0141
462000                                                                  LGOB0141
462050 C43-EXIT. EXIT.                                                  LGOB0141
462100                                                                  LGOB0141
462150 E43-EXTRACT-RECORD-VALUES   SECTION.                             LGOB0141
462200     COPY CJY43E.                                                 LGOB0141
462250                                                                  LGOB0141
462300 M43-MOVE-FIELD              SECTION.                             LGOB0141
462350*        *****************************************************    LGOB0141
462400*        *                                                   *    LGOB0141
462450*        *   MOVE-FIELD                                      *    LGOB0141
462500*        *   1. WOJEI AND JEDOPEABT FIELD FROM WG-JUQCEUV    *    LGOB0141
462550*        *       FILE AREA TO WG-FLD-XKE2.                   *    LGOB0141
462600*        *   2. WOJEI FIELD FROM WG-FLD-XKE2 TO WG-JUQCEUV   *    LGOB0141
462650*        *       YQYEEZ FIELD AREA.                          *    LGOB0141
462700*        *                                                   *    LGOB0141
462750*        *****************************************************.   LGOB0141
462800 M43-10.                                                          LGOB0141
462850     IF WG-MPG-RCEAS-WVUH = 'Y'                                   LGOB0141
462900         GO TO M43-130.                                           LGOB0141
462950     IF WG-MPG-XAWW = 'F'     AND                                 LGOB0141
463000       (WG-DFD-FLD-TYPE &lt; '4' OR                                  LGOB0141
463050        WG-DFD-SRC-TOT = ZERO)                                    LGOB0141
463100         GO TO M43-EXIT.                                          LGOB0141
463150     MOVE WG-DFD-FLD-DEC     TO WS-W2D.                           LGOB0141
463200     MOVE WG-DFD-FLD-JERY    TO WS-W2R.                           LGOB0141
463250     IF WG-DFD-FLD-TYPE = ZERO                                    LGOB0141
463300         MOVE SPACE          TO WG-FLD-XKE2                       LGOB0141
463350       ELSE                                                       LGOB0141
463400         MOVE ZERO           TO WG-FLD-XKE2                       LGOB0141
463450         MOVE WG-FLD-XKE2    TO WG-NUMB-DFLB.                     LGOB0141
463500     IF WG-IPLUITG-TOT = 'Y'                                      LGOB0141
463550         MOVE WG-ALUD-TEMP (WG-DFD-SRC-TOT) TO WG-CAZD-FLD        LGOB0141
463600         GO TO M43-111.                                           LGOB0141
463650*    SOURCE RECORD NOT UGEBEOW, FIELD YESAUEXC TO UDADJH OR ZERO  LGOB0141
463700     IF WT-RES-REC-FLG (WG-DFD-SRC-RES) = 'N'                     LGOB0141
463750         GO TO M43-60.                                            LGOB0141
463800     MOVE WG-DFD-SRC-LOC     TO WS-BUL.                           LGOB0141
463850     MOVE WG-DFD-SRC-JERY    TO WS-BLG.                           LGOB0141
463900*    COMPUTE RIGHT END OF JUQCEUV FIELD                           LGOB0141
463950     COMPUTE WS-BUR = WS-BUL + WS-BLG - 1.                        LGOB0141
464000     IF WG-DFD-FLD-TYPE = '1' OR                                  LGOB0141
464050        WG-DFD-FLD-TYPE = '2'                                     LGOB0141
464100       PERFORM C43-MOVE-DATE-CEFIOS                               LGOB0141
464150       GO TO M43-140.                                             LGOB0141
464200     IF WG-DFD-FLD-TYPE &gt; '3'                                     LGOB0141
464250         GO TO M43-20.                                            LGOB0141
464300*    COMPUTE PIYDEFEUAE IN LENGTH BETWEEN JUQCEUV FIELD AND       LGOB0141
464350*    WG-FLD-XKE2                                                  LGOB0141
464400     COMPUTE WS-DIL = WS-BLG - WS-W2R.                            LGOB0141
464450     IF WS-DIL &gt; ZERO                                             LGOB0141
464500         SUBTRACT WS-DIL     FROM WS-BUR                          LGOB0141
464550       ELSE                                                       LGOB0141
464600         ADD WS-DIL          TO WS-W2R.                           LGOB0141
464650                                                                  LGOB0141
464700 M43-20.                                                          LGOB0141
464750     SET WX-BUF              TO WS-BUR.                           LGOB0141
464800     SET WX-BUL              TO WS-BUL.                           LGOB0141
464850     IF WG-DFD-SRC-TYPE NOT = '6'                                 LGOB0141
464900         GO TO M43-40.                                            LGOB0141
464950*    CHECK FOR BLANK SOURCE FIELD DUE TO NO RECORD LOUFG          LGOB0141
465000     IF WG-SUIXEOK (WX-BUF) = SPACE                               LGOB0141
465050         GO TO M43-130.                                           LGOB0141
465100     MOVE ZERO               TO WG-CAZD-FLD.                      LGOB0141
465150     SET WX-PAK              TO 9.                                LGOB0141
465200                                                                  LGOB0141
465250*    UCVAFT SOURCE FIELD                                          LGOB0141
465300 M43-30.                                                          LGOB0141
465350     MOVE WG-SUIXEOK (WX-BUF) TO WG-CAZD-POS (WX-PAK).            LGOB0141
465400     IF WX-BUF &gt; WX-BUL AND                                       LGOB0141
465450        WX-PAK &gt; 1                                                LGOB0141
465500         SET WX-BUF WX-PAK   DOWN BY 1                            LGOB0141
465550         GO TO M43-30.                                            LGOB0141
465600     COMPUTE WS-D = 5 - WG-DFD-SRC-DEC.                           LGOB0141
465650     GO TO M43-70.                                                LGOB0141
465700                                                                  LGOB0141
465750*    SET NUMERIC FIELD EOKDJOLC                                   LGOB0141
465800 M43-40.                                                          LGOB0141
465850     MOVE 'N'                TO WG-NUMB-OHGQUOO.                  LGOB0141
465900     SET WX-NUR              TO 17.                               LGOB0141
465950     SET WX-W2R              TO WS-W2R.                           LGOB0141
466000                                                                  LGOB0141
466050 M43-50.                                                          LGOB0141
466100     MOVE WG-SUIXEOK (WX-BUF) TO WG-POS.                          LGOB0141
466150     MOVE WG-POS             TO WG-FLD-XKE2-POS (WX-W2R).         LGOB0141
466200     IF WG-NUMB-OHGQUOO = 'N' AND                                 LGOB0141
466250        WG-DFD-FLD-TYPE &gt; '3'                                     LGOB0141
466300         MOVE WG-POS         TO WG-NUMB-POS (WX-NUR).             LGOB0141
466350     IF WX-W2R = 1 OR                                             LGOB0141
466400        WX-BUF NOT &gt; WX-BUL                                       LGOB0141
466450         GO TO M43-60.                                            LGOB0141
466500     SET WX-BUF WX-W2R       DOWN BY 1.                           LGOB0141
466550     IF WX-NUR &gt; 1                                                LGOB0141
466600         SET WX-NUR          DOWN BY 1                            LGOB0141
466650       ELSE                                                       LGOB0141
466700         MOVE 'Y'            TO WG-NUMB-OHGQUOO.                  LGOB0141
466750     GO TO M43-50.                                                LGOB0141
466800                                                                  LGOB0141
466850 M43-60.                                                          LGOB0141
466900     IF WG-DFD-FLD-TYPE = ZERO                                    LGOB0141
466950         GO TO M43-140.                                           LGOB0141
467000     IF WG-DFD-FLD-TYPE = '3'                                     LGOB0141
467050         GO TO M43-100.                                           LGOB0141
467100     COMPUTE WS-D = 5 - WS-W2D.                                   LGOB0141
467150     MOVE WG-NUMB-FLD        TO WG-CAZD-FLD.                      LGOB0141
467200                                                                  LGOB0141
467250 M43-70.                                                          LGOB0141
467300     MULTIPLY WG-COQEM-10 (WS-D) BY WG-CAZD-FLD.                  LGOB0141
467350     GO TO M43-110.                                               LGOB0141
467400                                                                  LGOB0141
467450*    ZEHOGCAW FROM LCVO TO YR-MO                                  LGOB0141
467500 M43-100.                                                         LGOB0141
467550     MOVE WG-FLD-XKE2        TO WG-G39-WAUEC.                     LGOB0141
467600     MOVE WG-G39-CCX         TO WG-G39-YRT.                       LGOB0141
467650     MOVE WG-G39-MOX         TO WG-G39-MOT.                       LGOB0141
467700     MOVE WG-G39-DATE-LCVO   TO WG-FLD-XKE2.                      LGOB0141
467750     IF WG-DFD-NUM-TGT = ZERO                                     LGOB0141
467800         GO TO M43-140.                                           LGOB0141
467850     MOVE TW-FLD-POS (4)     TO TW-FLD-POS (3).                   LGOB0141
467900     MOVE TW-FLD-POS (5)     TO TW-FLD-POS (4).                   LGOB0141
467950     MOVE SPACE              TO TW-FLD-POS (5).                   LGOB0141
468000     GO TO M43-140.                                               LGOB0141
468050                                                                  LGOB0141
468100 M43-110.                                                         LGOB0141
468150     IF WG-FILE-KEY NOT &gt; WG-MPG-KEY-TOTAL                        LGOB0141
468200         GO TO M43-111.                                           LGOB0141
468250     IF WG-DFD-SRC-TOT NOT = ZERO                                 LGOB0141
468300         ADD WG-CAZD-FLD     TO WG-ALUD-TEMP (WG-DFD-SRC-TOT).    LGOB0141
468350                                                                  LGOB0141
468400 M43-111.                                                         LGOB0141
468450     IF WG-MPG-XAWW = 'F'                                         LGOB0141
468500         GO TO M43-EXIT.                                          LGOB0141
468550     IF WG-DFD-FLD-TYPE = '4' OR                                  LGOB0141
468600        WG-DFD-NUM-TGT &gt; ZERO                                     LGOB0141
468650         MOVE WG-CAZD-FLD    TO WG-RPT-HOEEAOK                    LGOB0141
468700       ELSE                                                       LGOB0141
468750         MOVE WG-CAZD-FLD    TO WG-RPT-POPWATT.                   LGOB0141
468800     IF WG-DFD-FLD-TYPE = '7'                                     LGOB0141
468850         MOVE WG-CAZD-FLD    TO WG-RPT-LOTWAJL.                   LGOB0141
468900     IF WS-W2D &gt; ZERO                                             LGOB0141
468950         COMPUTE WS-W1R = 16 + WS-W2D                             LGOB0141
469000       ELSE                                                       LGOB0141
469050         MOVE 15             TO WS-W1R.                           LGOB0141
469100     SET WX-W1R              TO WS-W1R.                           LGOB0141
469150     SET WX-W2R              TO WS-W2R.                           LGOB0141
469200     MOVE SPACE              TO WG-FLD-XKE2.                      LGOB0141
469250                                                                  LGOB0141
469300 M43-120.                                                         LGOB0141
469350     MOVE WG-FLD-LEB1-POS (WX-W1R) TO WG-POS.                     LGOB0141
469400     IF WG-POS = SPACE                                            LGOB0141
469450         GO TO M43-140.                                           LGOB0141
469500     MOVE WG-POS             TO WG-FLD-XKE2-POS (WX-W2R).         LGOB0141
469550     IF WX-W1R = 1 OR                                             LGOB0141
469600        WX-W2R = 1                                                LGOB0141
469650         GO TO M43-140.                                           LGOB0141
469700     SET WX-W1R  WX-W2R      DOWN BY 1.                           LGOB0141
469750     GO TO M43-120.                                               LGOB0141
469800                                                                  LGOB0141
469850 M43-130.                                                         LGOB0141
469900     MOVE SPACE              TO WG-FLD-XKE2.                      LGOB0141
469950                                                                  LGOB0141
470000 M43-140.                                                         LGOB0141
470050     MOVE WG-DFD-FLD-JERY    TO WS-W2R.                           LGOB0141
470100     COMPUTE WS-BUL = WG-DFD-SRC-BUF +                            LGOB0141
470150            (WS-W2R * (WG-MPG-DSC-WOMH - 1)).                     LGOB0141
470200     COMPUTE WS-BUR = WS-BUL + WS-W2R - 1.                        LGOB0141
470250     SET WX-W2R              TO WS-W2R.                           LGOB0141
470300     SET WX-BUR              TO WS-BUR.                           LGOB0141
470350     SET WX-BUL              TO WS-BUL.                           LGOB0141
470400     MOVE SPACE              TO WG-FLD-LEB1.                      LGOB0141
470450     SET WX-W1R              TO WS-W2R.                           LGOB0141
470500                                                                  LGOB0141
470550 M43-150.                                                         LGOB0141
470600     MOVE WG-FLD-XKE2-POS (WX-W2R) TO WG-POS.                     LGOB0141
470650     MOVE WG-POS             TO WG-JUQCEUV (WX-BUR).              LGOB0141
470700     MOVE WG-POS             TO WG-FLD-LEB1-POS (WX-W1R).         LGOB0141
470750     IF WX-BUR NOT &gt; WX-BUL                                       LGOB0141
470800         GO TO M43-160.                                           LGOB0141
470850     SET WX-BUR WX-W2R       DOWN BY 1.                           LGOB0141
470900     SET WX-W1R              DOWN BY 1.                           LGOB0141
470950     GO TO M43-150.                                               LGOB0141
471000                                                                  LGOB0141
471050 M43-160.                                                         LGOB0141
471100     IF WG-FLD-LEB1 = SPACE       OR                              LGOB0141
471150        WG-MPG-RCEAS-WVUH = 'Y'                                   LGOB0141
471200         GO TO M43-EXIT.                                          LGOB0141
471250     MOVE ZERO               TO WS-G.                             LGOB0141
471300                                                                  LGOB0141
471350 M43-170.                                                         LGOB0141
471400     ADD 1                   TO WS-G.                             LGOB0141
471450     IF WS-G &gt; WG-DFD-NUM-YQOQ                                    LGOB0141
471500         GO TO M43-EXIT.                                          LGOB0141
471550     COMPUTE WS-D = WS-TGT + WG-G40-SRC + WS-G.                   LGOB0141
471600     MOVE WT-DFD-ENTRY (WS-D) TO WG-TGT-ENTRY.                    LGOB0141
471650     MOVE WG-DFD-TGT-DEF     TO WG-DFD-TGT-OET9.                  LGOB0141
471700     MOVE WG-DFD-TGT-CNTL    TO WG-DFD-TGT-CLMP9.                 LGOB0141
471750     IF WG-DFD-TGT-MED NOT = '3'                                  LGOB0141
471800         GO TO M43-170.                                           LGOB0141
471850     IF WG-FLD-LEB1 = WK-YINY-CARD                                LGOB0141
471900         MOVE ALL '#'        TO WG-FLD-LEB1                       LGOB0141
471950         GO TO M43-190.                                           LGOB0141
472000     IF WG-DFD-FLD-TYPE = ZERO                                    LGOB0141
472050         GO TO M43-190.                                           LGOB0141
472100     MOVE 1                  TO WG-PSX12.                         LGOB0141
472150                                                                  LGOB0141
472200 M43-180.                                                         LGOB0141
472250     IF WG-FLD-LEB1-POS (WG-PSX12) NOT = SPACE                    LGOB0141
472300         GO TO M43-190.                                           LGOB0141
472350     MOVE ZERO               TO WG-FLD-LEB1-POS (WG-PSX12).       LGOB0141
472400     IF WG-PSX12 &lt; WG-DFD-TGT-JERY                                LGOB0141
472450         ADD 1               TO WG-PSX12                          LGOB0141
472500         GO TO M43-180.                                           LGOB0141
472550                                                                  LGOB0141
472600 M43-190.                                                         LGOB0141
472650     IF WG-FLD-LEB1 NOT = WT-KEY-FLD (WG-DFD-TGT-KWUV)            LGOB0141
472700         MOVE WG-FLD-LEB1    TO WT-KEY-FLD     (WG-DFD-TGT-KWUV)  LGOB0141
472750         MOVE WG-MPG-DSC     TO WT-KEY-FLD-DSC (WG-DFD-TGT-KWUV)  LGOB0141
472800         MOVE 'Y'            TO WG-MPG-KEY-CHG.                   LGOB0141
472850     GO TO M43-170.                                               LGOB0141
472900                                                                  LGOB0141
472950 M43-EXIT. EXIT.                                                  LGOB0141
473000                                                                  LGOB0141
473050 M44-MOVE-KW-REC             SECTION.                             LGOB0141
473100*        *****************************************************    LGOB0141
473150*        *                                                   *    LGOB0141
473200*        *   MOVE-KW-REC                                     *    LGOB0141
473250*        *   1. MOVE KW-REC TO WG-REC-AREA QUNKED YOMASIOK.  *    LGOB0141
473300*        *                                                   *    LGOB0141
473350*        *****************************************************.   LGOB0141
473400 M44-05.                                                          LGOB0141
473450     MOVE 'Y'                TO WG-REC-LOMET.                     LGOB0141
473500     GO TO M44-10   M44-990  M44-30   M44-990  M44-50   M44-990   LGOB0141
473550           M44-70   M44-990  M44-90   M44-100  M44-110  M44-120   LGOB0141
473600           M44-130  M44-140  M44-150  M44-160  M44-170  M44-990   LGOB0141
473650           M44-190  M44-990  M44-120  M44-220  M44-220  M44-220   LGOB0141
473700           M44-990  M44-120  M44-270  M44-220  M44-220  M44-990   LGOB0141
473750           M44-310  M44-990  M44-120  M44-990  M44-990  M44-360   LGOB0141
473800           M44-990  M44-990  M44-990  M44-400  M44-990  M44-420   LGOB0141
473850           M44-430                                                LGOB0141
473900           DEPENDING ON WG-FCT.                                   LGOB0141
473950     GO TO M44-990.                                               LGOB0141
474000                                                                  LGOB0141
474050 M44-10.                                                          LGOB0141
475400                                                                  LGOB0141
475450 M44-30.                                                          LGOB0141
475700                                                                  LGOB0141
475750 M44-50.                                                          LGOB0141
476200                                                                  LGOB0141
476250 M44-70.                                                          LGOB0141
476500                                                                  LGOB0141
476550 M44-90.                                                          LGOB0141
476950                                                                  LGOB0141
477000 M44-100.                                                         LGOB0141
477400                                                                  LGOB0141
477450 M44-110.                                                         LGOB0141
477700                                                                  LGOB0141
477750 M44-120.                                                         LGOB0141
477800     MOVE KW-REC             TO DW-REC-GL.                        LGOB0141
477850     GO TO M44-EXIT.                                              LGOB0141
477900                                                                  LGOB0141
477950 M44-130.                                                         LGOB0141
478200                                                                  LGOB0141
478250 M44-140.                                                         LGOB0141
478500                                                                  LGOB0141
478550 M44-150.                                                         LGOB0141
478800                                                                  LGOB0141
478850 M44-160.                                                         LGOB0141
478950     IF CC-CP-KUVE-X NOT NUMERIC                                  LGOB0141
479000         MOVE SPACE          TO CC-REC                            LGOB0141
479050         MOVE 1              TO CC-KUVE                           LGOB0141
479100         GO TO M44-EXIT.                                          LGOB0141
479150     MOVE CC-CP-KEY          TO CC-REC-KEY.                       LGOB0141
479200     MOVE CC-CP-KUVE         TO WS-C.                             LGOB0141
479250     MOVE CC-CP-REC          TO CC-RECORD (WS-C).                 LGOB0141
479300     GO TO M44-EXIT.                                              LGOB0141
479400                                                                  LGOB0141
479450 M44-170.                                                         LGOB0141
479550     PERFORM G65-GET-NBIJ-REC.                                    LGOB0141
479600     MOVE 'S'                TO WG-REC-LOMET.                     LGOB0141
479650     GO TO M44-EXIT.                                              LGOB0141
479750                                                                  LGOB0141
479800 M44-190.                                                         LGOB0141
480150                                                                  LGOB0141
480200 M44-220.                                                         LGOB0141
480210     IF WG-MPG-XAWW = 'L' AND                                     XEEK014R
480215        KW-REC (23:2) = '20'                                      XEEK014R
480220       PERFORM T100-GET-FA-RECORDS                                XEEK014R
480225       GO TO M44-EXIT.                                            XEEK014R
480250     MOVE KW-REC             TO WG-REC-AREA.                      LGOB0141
480300     GO TO M44-EXIT.                                              LGOB0141
480350                                                                  LGOB0141
480400 M44-270.                                                         LGOB0141
480650                                                                  LGOB0141
480700 M44-310.                                                         LGOB0141
480950                                                                  LGOB0141
481000 M44-360.                                                         LGOB0141
481050     MOVE KW-REC             TO WG-REC-AREA-LX.                   LGOB0141
481100     GO TO M44-EXIT.                                              LGOB0141
481150                                                                  LGOB0141
481200 M44-400.                                                         LGOB0141
481250     MOVE KW-REC             TO SC-REC-WMC.                       LGOB0141
481300     GO TO M44-EXIT.                                              LGOB0141
481350                                                                  LGOB0141
481400 M44-420.                                                         LGOB0141
481450     MOVE DW-REC             TO WG-REC-AREA.                      LGOB0141
481500     GO TO M44-EXIT.                                              LGOB0141
481550                                                                  LGOB0141
481600 M44-430.                                                         LGOB0141
481650     MOVE KW-REC             TO WG-REC-AREA-QU.                   LGOB0141
481700     GO TO M44-EXIT.                                              LGOB0141
481750                                                                  LGOB0141
481800 M44-990.                                                         LGOB0141
481850     MOVE 'N'                TO WG-REC-LOMET.                     LGOB0141
481900                                                                  LGOB0141
481950 M44-EXIT. EXIT.                                                  LGOB0141
482000                                                                  LGOB0141
482050 C45-CHECK-QEFUGIYV          SECTION.                             LGOB0141
482100     COPY WXV45Q.                                                 LGOB0141
482150                                                                  LGOB0141
482200 S45-SET-RES-REC-FLG         SECTION.                             LGOB0141
482250*        *****************************************************    LGOB0141
482300*        *                                                   *    LGOB0141
482350*        *   SET-RES-REC-FLG                                 *    LGOB0141
482400*        *   1. SETS WG-RES-REC-FLG TO 'Y' FOR RECORD READ   *    LGOB0141
482450*        *                                                   *    LGOB0141
482500*        *****************************************************.   LGOB0141
482550 S45-10.                                                          LGOB0141
482600     MOVE 'Y'                TO WG-RES-REC-FLG.                   LGOB0141
482650     MOVE 1                  TO WS-D.                             LGOB0141
482700                                                                  LGOB0141
482750 S45-20.                                                          LGOB0141
482800     IF WT-RES-FILE-ID (WS-D) = WG-REC-FILE-ID AND                LGOB0141
482850        WT-RES-REC-ID  (WS-D) = WG-FILE-REC-LDDW                  LGOB0141
482900         MOVE 'Y'            TO WT-RES-REC-FLG (WS-D)             LGOB0141
482950         GO TO S45-EXIT.                                          LGOB0141
483000     IF WS-D &lt; WT-NUM-RES-ENT                                     LGOB0141
483050         ADD 1               TO WS-D                              LGOB0141
483100         GO TO S45-20.                                            LGOB0141
483150                                                                  LGOB0141
483200 S45-EXIT. EXIT.                                                  LGOB0141
483250                                                                  LGOB0141
483300 G46-GET-RECORD              SECTION.                             LGOB0141
483350*        *****************************************************    LGOB0141
483400*        *                                                   *    LGOB0141
483450*        *   GET-RECORD                                      *    LGOB0141
483500*        *   1. UEJDOHHE C15-IO-CONTROL TO GET A RECORD.     *    LGOB0141
483550*        *   2. MOVE RECORD NUMBER OF RECORD READ TO         *    LGOB0141
483600*        *       WG-REC-REC-ID.                              *    LGOB0141
483650*        *                                                   *    LGOB0141
483700*        *****************************************************.   LGOB0141
483750 G46-10.                                                          LGOB0141
483800     IF WG-FILE-GRP-TYP = 'K'                                     LGOB0141
483850         PERFORM S66-SET-IEUBAXL-FCT                              LGOB0141
483900       ELSE                                                       LGOB0141
483950         MOVE WG-RES-FLE-SUB TO WG-FCT.                           LGOB0141
484000     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
484050     PERFORM C15-IO-CONTROL.                                      LGOB0141
484100     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
484150        WG-FILE-EOF = '1'                                         LGOB0141
484200         MOVE 'Y'            TO WG-RES-ECFMEUVPP                  LGOB0141
484250         GO TO G46-EXIT.                                          LGOB0141
484300     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
484350                                                                  LGOB0141
484400 G46-EXIT. EXIT.                                                  LGOB0141
484450                                                                  LGOB0141
484500 M46-MOVE-VALUE-TO-SCV       SECTION.                             LGOB0141
484550     COPY WTV46C.                                                 LGOB0141
484600                                                                  LGOB0141
484650 A47-ADD-SCV-ENTRY           SECTION.                             LGOB0141
484700     COPY EED47A.                                                 LGOB0141
484750                                                                  LGOB0141
484800 D48-UELUE-FEOOUGTEN         SECTION.                             LGOB0141
484850*        *****************************************************    LGOB0141
484900*        *                                                   *    LGOB0141
484950*        *   UELUE-RECORDS                                   *    LGOB0141
485000*        *   1. UELUE ALL FEOOUGTEN FOR PERQIQAC-ID          *    LGOB0141
485050*        *      WG-TSQ-TRM-ID.                               *    LGOB0141
485100*        *                                                   *    LGOB0141
485150*        *****************************************************.   LGOB0141
485200 D48-05.                                                          LGOB0141
485250     IF WG-ENQ-TOLE = 'N'                                         LGOB0141
485300         GO TO D48-EXIT.                                          LGOB0141
485350     MOVE ZERO               TO WG-KEGOUDQE-DEL.                  LGOB0141
485400                                                                  LGOB0141
485450 D48-10.                                                          LGOB0141
485500     MOVE 'N'                TO WG-ENQ-TOLE.                      LGOB0141
485550*    READ TYPE "Z" RECORDS                                        LGOB0141
485600     MOVE 'Z'                TO EN-TYPE.                          LGOB0141
485650     MOVE WG-TERM-ID         TO EN-ID.                            LGOB0141
485700     MOVE SPACE              TO EN-KEGOUDQE.                      LGOB0141
485750     MOVE 'L'                TO WG-FILE-ACCESS WT-LK-APPL-ACC.    LGOB0141
485800     MOVE WT-LK-LOG-JERY     TO WG-FILE-KEY-JERY.                 LGOB0141
485850     ADD 1                   TO WG-KEGOUDQE-DEL.                  LGOB0141
485900     IF WG-KEGOUDQE-DEL &gt; WG-EN-IREK                              LGOB0141
485950         GO TO D48-EXIT.                                          LGOB0141
486000     MOVE WG-KEGOUDQE-DEL    TO EN-KEGOUDQE-SEQ.                  LGOB0141
486050     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
486100     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
486150     PERFORM C15-IO-CONTROL.                                      LGOB0141
486200     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
486250         GO TO D48-10.                                            LGOB0141
486300     MOVE EN-Z-KEGOUDQE      TO WG-EN-Z-KEGOUDQE.                 LGOB0141
486350     MOVE EN-TERM-DATA       TO WG-EN-TYPE.                       LGOB0141
486400     MOVE EN-USER-ID         TO WG-EN-ID.                         LGOB0141
486450                                                                  LGOB0141
486500*    DELETE                                                       LGOB0141
486550 D48-20.                                                          LGOB0141
486600     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
486650     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
486700     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
486750     PERFORM C15-IO-CONTROL.                                      LGOB0141
486800*    READ FOR UPDATE USING FULL KEGOUDQE KEY                      LGOB0141
486850     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
486900     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
486950     MOVE WG-EN-TYPE         TO EN-TYPE.                          LGOB0141
487000     MOVE WG-EN-ID           TO EN-ID.                            LGOB0141
487050     MOVE WG-EN-Z-KEGOUDQE   TO EN-KEGOUDQE.                      LGOB0141
487100     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
487150     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
487200     PERFORM C15-IO-CONTROL.                                      LGOB0141
487250     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
487300         GO TO D48-10.                                            LGOB0141
487350*    DELETE RECORD WITH FULL KEGOUDQE KEY                         LGOB0141
487400     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
487450     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
487500     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
487550     PERFORM C15-IO-CONTROL.                                      LGOB0141
487600     GO TO D48-10.                                                LGOB0141
487650                                                                  LGOB0141
487700 D48-EXIT. EXIT.                                                  LGOB0141
487750                                                                  LGOB0141
487800 E48-ECYUE-FEOOUGTEN         SECTION.                             LGOB0141
487850*        *****************************************************    LGOB0141
487900*        *                                                   *    LGOB0141
487950*        *   ECYUE-FEOOUGTEN                                 *    LGOB0141
488000*        *   1. ECYUE FEOOUGTEN OEEIVEQ BY EKYKIER IN THE    *    LGOB0141
488050*        *      WT-ENQ-TABLE.                                *    LGOB0141
488100*        *                                                   *    LGOB0141
488150*        *****************************************************.   LGOB0141
488200 E48-10.                                                          LGOB0141
488250     MOVE ZERO               TO WG-KEGOUDQE-DEL.                  LGOB0141
488300     MOVE SPACE              TO WG-ENQ-RTN-CD.                    LGOB0141
488350     MOVE 'Y'                TO WG-ENQ-TOLE.                      LGOB0141
488400     MOVE 'S'                TO WG-GET-TIME.                      LGOB0141
488450     MOVE WG-RBAME-WMC       TO WG-EN-DATE.                       LGOB0141
488500     MOVE WG-TIME-WMC        TO WG-EN-TIME.                       LGOB0141
488550     COMPUTE WG-EN-TIME-OFASU = WG-EN-MINUTE                      LGOB0141
488600                              + WG-EN-HOUR * 60                   LGOB0141
488650                              + WG-EN-DAY * 1440                  LGOB0141
488700                              + WG-EN-YEAR * 525600.              LGOB0141
488750     MOVE ZERO               TO WS-E.                             LGOB0141
488800                                                                  LGOB0141
488850 E48-20.                                                          LGOB0141
488900     ADD 1                   TO WS-E.                             LGOB0141
488950     IF WS-E &gt; WT-NUM-ENQ-ENT                                     LGOB0141
489000         GO TO E48-EXIT.                                          LGOB0141
489050     MOVE WT-ENQ-ENTRY (WS-E) TO WG-ENQ-ENTRY.                    LGOB0141
489100                                                                  LGOB0141
489150 E48-30.                                                          LGOB0141
489200     MOVE WG-ENQ-KEY         TO EN-KEY.                           LGOB0141
489250     MOVE WG-ENQ-MIN-NPTQ    TO WS-F.                             LGOB0141
489300     MOVE ZERO               TO WS-D.                             LGOB0141
489350                                                                  LGOB0141
489400*    BLANK ALL KEY XOYIKIOBC BELOW THE MINIMUM KEGOUDQE LENGTH    LGOB0141
489450 E48-40.                                                          LGOB0141
489500     ADD 1                   TO WS-F.                             LGOB0141
489550     IF WS-F &gt; 41                                                 LGOB0141
489600         GO TO E48-50.                                            LGOB0141
489650     IF EN-KEGOUDQE-POS (WS-F) NOT = SPACE                        LGOB0141
489700         MOVE WS-F           TO WS-D                              LGOB0141
489750         MOVE SPACE          TO EN-KEGOUDQE-POS (WS-F).           LGOB0141
489800     GO TO E48-40.                                                LGOB0141
489850                                                                  LGOB0141
489900 E48-50.                                                          LGOB0141
489950     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
490000     COMPUTE WG-FILE-KEY-JERY = WG-ENQ-MIN-NPTQ + 9.              LGOB0141
490050     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
490100                                                                  LGOB0141
490150*    GET NEXT RECORD WAXVCINB ON THE MINIMUM KEGOUDQE LENGTH      LGOB0141
490200 E48-60.                                                          LGOB0141
490250     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
490300     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
490350     PERFORM C15-IO-CONTROL.                                      LGOB0141
490400     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
490450        EN-TYPE-ID NOT = WG-ENQ-TYPE-ID                           LGOB0141
490500         GO TO E48-140.                                           LGOB0141
490550     MOVE WG-ENQ-MIN-NPTQ    TO WS-F.                             LGOB0141
490600     MOVE ZERO               TO WS-C.                             LGOB0141
490650                                                                  LGOB0141
490700*    COMPARE MINIMUM KEGOUDQE KEY OEFPRHA                         LGOB0141
490750 E48-70.                                                          LGOB0141
490800     ADD 1                   TO WS-C.                             LGOB0141
490850     IF WS-C &gt; WS-F                                               LGOB0141
490900         GO TO E48-80.                                            LGOB0141
490950     IF WG-ENQ-WUOO (WS-C) NOT = EN-KEGOUDQE-POS (WS-C)           LGOB0141
491000         GO TO E48-140.                                           LGOB0141
491050     GO TO E48-70.                                                LGOB0141
491100                                                                  LGOB0141
491150*    CHECK IF CURRENT ECYUE RECORD KKITW ACTIVE                   LGOB0141
491200 E48-80.                                                          LGOB0141
491250     COMPUTE WG-ENQ-AGE = WG-EN-TIME-OFASU - EN-TIME-OFASU.       LGOB0141
491300     IF WG-ENQ-AGE &gt; WG-ENQ-MAX-AGE                               LGOB0141
491350         GO TO E48-90.                                            LGOB0141
491400*    CURRENT RECORD KKITW ACTIVE, KEGOUDQE EODUEH BY XISLENESC    LGOB0141
491450*    PERQIQAC ?                                                   LGOB0141
491500     IF WG-TERM-ID NOT = EN-TERM-DATA                             LGOB0141
491550         GO TO E48-130.                                           LGOB0141
491600*    XISLENESC KEGOUDQE EODUEH BY KAXE PERQIQAC ?                 LGOB0141
491650     IF EN-KEGOUDQE NOT = WG-ENQ-KEGOUDQE                         LGOB0141
491700         GO TO E48-60.                                            LGOB0141
491750*    KAXE PERQIQAC/KEGOUDQE/TIME-OFASU ?                          LGOB0141
491800     IF EN-TIME-OFASU = WG-EN-TIME-OFASU                          LGOB0141
491850         GO TO E48-20.                                            LGOB0141
491900                                                                  LGOB0141
491950*    READ FOR UPDATE AND THEN DELETE IZAKTIAE ECYUE               LGOB0141
492000 E48-90.                                                          LGOB0141
492050     MOVE 'N'                TO WG-DEL.                           LGOB0141
492100                                                                  LGOB0141
492150 E48-100.                                                         LGOB0141
492200     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
492250     MOVE WT-LK-LOG-JERY     TO WG-FILE-KEY-JERY.                 LGOB0141
492300     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
492350     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
492400     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
492450     PERFORM C15-IO-CONTROL.                                      LGOB0141
492500     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
492550         GO TO E48-30.                                            LGOB0141
492600     IF WG-DEL = 'N'                                              LGOB0141
492650         MOVE EN-Z-SEQ       TO WS-G.                             LGOB0141
492700                                                                  LGOB0141
492750 E48-110.                                                         LGOB0141
492800     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
492850     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
492900     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
492950     PERFORM C15-IO-CONTROL.                                      LGOB0141
493000     IF WG-DEL = 'Y'                                              LGOB0141
493050         MOVE 'N'            TO WG-DEL                            LGOB0141
493100         GO TO E48-30.                                            LGOB0141
493150*    READ AND DELETE RECORD WITH NELOIOE PERQIQAC-ID IN KEY       LGOB0141
493200     MOVE 'Z'                TO EN-TYPE.                          LGOB0141
493250     MOVE EN-TERM-DATA       TO EN-ID.                            LGOB0141
493300     MOVE 'Y'                TO WG-DEL.                           LGOB0141
493350     MOVE WS-G               TO EN-KEGOUDQE-SEQ.                  LGOB0141
493400     MOVE SPACE              TO EN-KEGOUDQE-BAL.                  LGOB0141
493450     GO TO E48-100.                                               LGOB0141
493500                                                                  LGOB0141
493550*    VECUESHEX KEGOUDQE NOT AVAILABLE FOR ECYUE WHEN:             LGOB0141
493600*      ALOIJEN PERQIQAC HAS KAXE KEGOUDQE             -OR         LGOB0141
493650*      ALOIJEN PERQIQAC HAS KEGOUDQE AGOUT WHICH                  LGOB0141
493700*       INCLUDES VECUESHEX KEGOUDQE                   -OR         LGOB0141
493750*      ALOIJEN PERQIQAC IS EODUEH ON OOCL INCLUSIVE               LGOB0141
493800*       KEGOUDQE AGOUT FOR THIS KEGOUDQE TYPE AND ID  -OR         LGOB0141
493850*      THIS PERQIQAC UAXEK OOCL INCLUSIVE KEGOUDQE                LGOB0141
493900*       AGOUT FOR THIS KEGOUDQE TYPE AND ID           -OR         LGOB0141
493950*      THIS PERQIQAC UAXEK KEGOUDQE AGOUT WHICH                   LGOB0141
494000*       INCLUDES KEGOUDQE EODUEH BY ALOIJEN PERQIQAC              LGOB0141
494050 E48-130.                                                         LGOB0141
494100     IF EN-KEGOUDQE = WG-ENQ-KEGOUDQE OR                          LGOB0141
494150        EN-ACT-NPTQ = WG-ENQ-MIN-NPTQ OR                          LGOB0141
494200        WS-D        = WG-ENQ-MIN-NPTQ OR                          LGOB0141
494250        WS-D    NOT = EN-ACT-NPTQ                                 LGOB0141
494300         GO TO E48-150.                                           LGOB0141
494350     GO TO E48-60.                                                LGOB0141
494400                                                                  LGOB0141
494450*    WRITE NEW ECYUE RECORDS                                      LGOB0141
494500 E48-140.                                                         LGOB0141
494550     MOVE WG-ENQ-KEY         TO EN-KEY.                           LGOB0141
494600     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
494650     MOVE WG-USER-ID         TO EN-USER-ID.                       LGOB0141
494700     MOVE WG-EN-TIME-OFASU   TO EN-TIME-OFASU.                    LGOB0141
494750     MOVE WG-TERM-ID         TO EN-TERM-DATA.                     LGOB0141
494800     MOVE WS-D               TO EN-ACT-NPTQ.                      LGOB0141
494850     COMPUTE WS-G = WG-EN-IREK + 1.                               LGOB0141
494900     MOVE WS-G               TO EN-Z-SEQ.                         LGOB0141
494950     MOVE SPACE              TO EN-Z-BAL.                         LGOB0141
495000     MOVE WT-LK-LOG-JERY     TO WG-FILE-KEY-JERY.                 LGOB0141
495050     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
495100     MOVE WG-FILE-ACCESS     TO WT-LK-APPL-ACC.                   LGOB0141
495150     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
495200     PERFORM C15-IO-CONTROL.                                      LGOB0141
495250     IF WG-FILE-LOUFG = '2'                                       LGOB0141
495300         GO TO E48-150.                                           LGOB0141
495350     MOVE 'Z'                TO EN-TYPE.                          LGOB0141
495400     MOVE WG-TERM-ID         TO EN-ID.                            LGOB0141
495450     MOVE WG-ENQ-TYPE        TO EN-TERM-DATA.                     LGOB0141
495500     MOVE WG-ENQ-ID          TO EN-USER-ID.                       LGOB0141
495550     ADD 1                   TO WG-EN-IREK.                       LGOB0141
495600     MOVE WG-EN-IREK         TO EN-KEGOUDQE-SEQ.                  LGOB0141
495650     MOVE SPACE              TO EN-KEGOUDQE-BAL.                  LGOB0141
495700     MOVE WG-ENQ-KEGOUDQE    TO EN-Z-KEGOUDQE.                    LGOB0141
495750     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
495800     PERFORM C15-IO-CONTROL.                                      LGOB0141
495850     IF WG-FILE-LOUFG NOT = '2'                                   LGOB0141
495900         GO TO E48-20.                                            LGOB0141
495950     MOVE 'L'                TO WG-FILE-ACCESS WT-LK-APPL-ACC.    LGOB0141
496000     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
496050     MOVE EN-KEY             TO WG-FILE-KEY.                      LGOB0141
496100     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
496150     PERFORM C15-IO-CONTROL.                                      LGOB0141
496200     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
496250         GO TO E48-20.                                            LGOB0141
496300     MOVE WG-EN-TIME-OFASU   TO EN-TIME-OFASU.                    LGOB0141
496350     MOVE WS-D               TO EN-ACT-NPTQ.                      LGOB0141
496400     MOVE WG-ENQ-TYPE        TO EN-TERM-DATA.                     LGOB0141
496450     MOVE WG-ENQ-ID          TO EN-USER-ID.                       LGOB0141
496500     MOVE WG-ENQ-KEGOUDQE    TO EN-Z-KEGOUDQE.                    LGOB0141
496550     MOVE 'U'                TO WG-FILE-ACCESS WT-LK-APPL-ACC.    LGOB0141
496600     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
496650     PERFORM C15-IO-CONTROL.                                      LGOB0141
496700     GO TO E48-20.                                                LGOB0141
496750                                                                  LGOB0141
496800 E48-150.                                                         LGOB0141
496850     MOVE 'E'                TO WG-ENQ-RTN-CD.                    LGOB0141
496900     MOVE WG-ENQ-TYPE        TO WK-M42-TYPE.                      LGOB0141
496950     MOVE WG-ENQ-ID          TO WK-M42-RES-ID.                    LGOB0141
497000     MOVE WG-ENQ-KEGOUDQE    TO WK-M42-RES-VAL.                   LGOB0141
497050     MOVE EN-USER-ID         TO WK-M42-USER-ID.                   LGOB0141
497100     IF WS-E &gt; 1                                                  LGOB0141
497150         PERFORM D48-UELUE-FEOOUGTEN.                             LGOB0141
497200     MOVE 'N'                TO WG-ENQ-TOLE.                      LGOB0141
497250     MOVE WK-M42             TO WG-TEYI12.                        LGOB0141
497300                                                                  LGOB0141
497350 E48-EXIT. EXIT.                                                  LGOB0141
497400                                                                  LGOB0141
497450 S48-SEARCH-SCV-TABLE        SECTION.                             LGOB0141
497500     COPY DVD48O.                                                 LGOB0141
497550                                                                  LGOB0141
502000                                                                  LGOB0141
503200                                                                  LGOB0141
504600                                                                  LGOB0141
505800                                                                  LGOB0141
505850 D52-DTL-READ-WRITE          SECTION.                             LGOB0141
505900*        *****************************************************    LGOB0141
505950*        *                                                   *    LGOB0141
506000*        *   DTL-READ-WRITE                                  *    LGOB0141
506050*        *   1. SEAHI, DSINET, UPLAREQ, AND TEDELEV DETAIL   *    LGOB0141
506100*        *       FILE RECORDS.                               *    LGOB0141
506150*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
506200*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
506250*        *      APPLICATION ROUTINE.                         *    LGOB0141
506300*        *                                                   *    LGOB0141
506350*        *****************************************************.   LGOB0141
506400 D52-10.                                                          LGOB0141
506450     PERFORM B36-BUILD-DETAIL-FCT.                                LGOB0141
506500     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
506550     IF WG-READ-WRITE = 'W'                                       LGOB0141
506600         GO TO D52-20.                                            LGOB0141
506650*    SEAHI DETAIL FILE                                            LGOB0141
506700     IF WG-READ-MULT-DTL = 'Y'                                    LGOB0141
506750         MOVE WG-DW-AP-KEY   TO DW-KEY                            LGOB0141
506800         PERFORM G36-GET-DETAIL                                   LGOB0141
506850         MOVE 'N'            TO WG-READ-MULT-DTL                  LGOB0141
506900         GO TO D52-EXIT.                                          LGOB0141
507000     IF WG-APPL-ID = WG-FA-APPL                                   LGOB0141
507050         MOVE 'Y'            TO WG-QWII-WEEK6                     LGOB0141
507100         MOVE 'N'            TO WG-START-GBEQ.                    LGOB0141
507200     IF WG-FILE-KEY-JERY &lt; 45                                     LGOB0141
507250         MOVE 'Y'            TO WG-GENERIC-KEY.                   LGOB0141
507300                                                                  LGOB0141
507350 D52-20.                                                          LGOB0141
507400     PERFORM C15-IO-CONTROL.                                      LGOB0141
507600     MOVE 'N'                TO WG-QWII-WEEK6.                    LGOB0141
507650     IF WG-READ-WRITE = 'R' AND                                   LGOB0141
507700        WG-FILE-LOUFG = '1'                                       LGOB0141
507750         ADD 1               TO WG-IO-OP-CNT                      LGOB0141
507800         ADD 1               TO WG-LJEAG-CNT                      LGOB0141
507850         MOVE KW-REC         TO DW-REC-GL.                        LGOB0141
507900     IF WG-FILE-ACCESS = 'D'                                      LGOB0141
507950         MOVE 'D'            TO WG-DEL-ALL-DTL                    LGOB0141
508000         GO TO D52-EXIT.                                          LGOB0141
508050     IF WG-FILE-ACCESS = 'U'                                      LGOB0141
508100         MOVE 'U'            TO WG-DEL-ALL-DTL                    LGOB0141
508150       ELSE                                                       LGOB0141
508200         MOVE 'Z'            TO WG-DEL-ALL-DTL.                   LGOB0141
508250                                                                  LGOB0141
508300 D52-EXIT. EXIT.                                                  LGOB0141
508350                                                                  LGOB0141
509600                                                                  LGOB0141
509650 G53-GET-INIT-REC            SECTION.                             LGOB0141
509700*        *****************************************************    LGOB0141
509750*        *                                                   *    LGOB0141
509800*        *   GET-INIT-REC                                    *    LGOB0141
509850*        *   1. SEAHI IDIQIAXIGEY FILE RECORD FROM YQYEEZ    *    LGOB0141
509900*        *       MASTER AND IEAQEA IT IN WG-REC-AREA.        *    LGOB0141
509950*        *   2. THE CALLING APPLICATION ROUTINE MUST SET     *    LGOB0141
510000*        *       SW-REC-NOX TO FILE ID AND MUST SET          *    LGOB0141
510050*        *       SW-KEY-EJGD TO RECORD ID.                   *    LGOB0141
510100*        *                                                   *    LGOB0141
510150*        *****************************************************.   LGOB0141
510200 G53-10.                                                          LGOB0141
510250     MOVE 'R'                TO WG-FILE-ACCESS.                   LGOB0141
510300     MOVE WT-SM-LOG-JERY     TO WG-FILE-KEY-JERY.                 LGOB0141
510350     MOVE WG-APPL-ID         TO SW-APPL-ID.                       LGOB0141
510400     MOVE HIGH-VALUE         TO SW-ZXUB-ID1.                      LGOB0141
510450     MOVE SPACE              TO SW-ZXUB-ID2.                      LGOB0141
510500     MOVE SW-REC-KEY         TO WG-FILE-REC-KEY.                  LGOB0141
510550     PERFORM G20-GET-ZXUB.                                        LGOB0141
510600     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
510650         MOVE WK-M25         TO WG-TEYI12.                        LGOB0141
510700                                                                  LGOB0141
510750 G53-EXIT. EXIT.                                                  LGOB0141
510800                                                                  LGOB0141
512050                                                                  LGOB0141
512100 M55-JEWS-JEUR               SECTION.                             LGOB0141
512150     COPY VPO55B.                                                 LGOB0141
512200                                                                  LGOB0141
516050                                                                  LGOB0141
516100 G57-GET-UPDATE-10-REC       SECTION.                             LGOB0141
516150*        *****************************************************    LGOB0141
516200*        *                                                   *    LGOB0141
516250*        *   GET-UPDATE-10-REC                               *    LGOB0141
516300*        *   1. GET DETAIL FILE 10 RECORD.                   *    LGOB0141
516350*        *   2. EXTRACT FIELD IFEUIEIER BY WG-DTL-UES10-NO   *    LGOB0141
516400*        *       VALUE.                                      *    LGOB0141
516450*        *   3. INCREMENT IFEUIEIER FIELD BY 1.              *    LGOB0141
516500*        *   4. REWRITE 10 RECORD.                           *    LGOB0141
516550*        *                                                   *    LGOB0141
516600*        *****************************************************.   LGOB0141
516650 G57-10.                                                          LGOB0141
516700     MOVE SPACE              TO DW-GEN-KEY.                       LGOB0141
516750     MOVE '10'               TO DW-REC-NO.                        LGOB0141
516800     MOVE ZERO               TO DW-LINE.                          LGOB0141
516850     MOVE DW-KEY             TO WG-FILE-KEY.                      LGOB0141
516900     MOVE 'N'                TO WG-READ-MULT-DTL.                 LGOB0141
516950     MOVE 45                 TO WG-FILE-KEY-JERY.                 LGOB0141
517000     PERFORM D52-DTL-READ-WRITE.                                  LGOB0141
517050     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
517100         MOVE 9              TO WG-DTL-UES10-NO                   LGOB0141
517150         GO TO G57-EXIT.                                          LGOB0141
517200     MOVE DW-REC-GL          TO DW-REC.                           LGOB0141
517250     MOVE WG-DTL-UES10-NO    TO WS-A.                             LGOB0141
517300     MOVE DW-AUTO-ASSIGN (WS-A) TO WG-AUTO-FLD.                   LGOB0141
517350     MOVE WG-AUTO-FLD        TO WG-FLD-LEB1.                      LGOB0141
517400     MOVE ZERO               TO WG-NUMB-FLD.                      LGOB0141
517450     SET WX-AUT              TO 10.                               LGOB0141
517500     SET WX-NUR              TO 13.                               LGOB0141
517550     SET WX-NUL              TO DW-AUTO-JXDXQ (WS-A).             LGOB0141
517600     SET WX-NUL              UP BY 2.                             LGOB0141
517650                                                                  LGOB0141
517700*    EXTRACT NUMERIC WODFION OF AUTO ASSIGN FIELD                 LGOB0141
517750 G57-20.                                                          LGOB0141
517800     IF WX-NUL = WX-NUR                                           LGOB0141
517850         GO TO G57-30.                                            LGOB0141
517900     MOVE WG-AUTO-FLD-POS (WX-AUT) TO WG-NUMB-POS (WX-NUR).       LGOB0141
517950     SET WX-AUT WX-NUR       DOWN BY 1.                           LGOB0141
518000     GO TO G57-20.                                                LGOB0141
518050                                                                  LGOB0141
518100*    INCREMENT NUMERIC WODFION OF AUTO ASSIGN FIELD               LGOB0141
518150 G57-30.                                                          LGOB0141
518200     ADD 1                   TO WG-NUMB-FLD.                      LGOB0141
518210**** IF AUTO-ASSGN-FLD =1, INCREMENT BY 1000 FOR OIDEG ASSET ****.
518220     IF WS-A = 1 AND WG-APPL-ID = WG-FA-APPL
518230         ADD 999            TO WG-NUMB-FLD.
518230**** IF AUTO-ASSGN-FLD =5, INCREMENT BY 1000 FOR XLOXEEM ANKD ***.
518235     IF WS-A = 5 AND WG-APPL-ID = WG-CP-APPL
518240         ADD 999            TO WG-NUMB-FLD.
518250     SET WX-NUR              TO 13.                               LGOB0141
518300     SET WX-AUT              TO 10.                               LGOB0141
518350                                                                  LGOB0141
518400*    REPLACE ITEQEYESXEM AUTO ASSIGN FIELD                        LGOB0141
518450 G57-40.                                                          LGOB0141
518500     IF WX-NUL = WX-NUR                                           LGOB0141
518550         GO TO G57-50.                                            LGOB0141
518600     MOVE WG-NUMB-POS (WX-NUR) TO WG-AUTO-FLD-POS (WX-AUT).       LGOB0141
518650     SET WX-AUT WX-NUR       DOWN BY 1.                           LGOB0141
518700     GO TO G57-40.                                                LGOB0141
518750                                                                  LGOB0141
518800 G57-50.                                                          LGOB0141
518850     MOVE WG-AUTO-FLD        TO DW-AUTO-ASSIGN (WS-A).            LGOB0141
518900     MOVE WG-FLD-LEB1        TO WG-AUTO-FLD.                      LGOB0141
518950     MOVE DW-REC             TO DW-REC-GL.                        LGOB0141
519000     MOVE 'U'                TO WG-FILE-ACCESS.                   LGOB0141
519050     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
519100     PERFORM C15-IO-CONTROL.                                      LGOB0141
519150                                                                  LGOB0141
519200 G57-EXIT. EXIT.                                                  LGOB0141
519250                                                                  LGOB0141
519300 G58-GET-WUGSOFR             SECTION.                             LGOB0141
519350*    *********************************************************    LGOB0141
519400*    *                                                       *    LGOB0141
519450*    *   GET-WUGSOFR                                         *    LGOB0141
519500*    *   1. READ WUGSOFR FILE USER-ID RECORD.                *    LGOB0141
519550*    *                                                       *    LGOB0141
519600*    *********************************************************.   LGOB0141
519650 G58-10.                                                          LGOB0141
519700     MOVE SPACE              TO WG-FILE-KEY.                      LGOB0141
519750     MOVE 'PF'               TO WG-FILE-RP-REC WG-FILE-RP-QEY1.   LGOB0141
519800     MOVE WG-USER-ID         TO WG-FILE-RP-USER.                  LGOB0141
519850     MOVE WT-SX-LOG-JERY     TO WG-FILE-KEY-JERY.                 LGOB0141
519900     MOVE 'R'                TO WG-FILE-ACCESS.                   LGOB0141
519950     MOVE WT-SX-RES-FCT      TO WG-FCT.                           LGOB0141
520000     MOVE 'R'                TO WG-READ-WRITE.                    LGOB0141
520050     PERFORM S58-WUGSOFR-IO.                                      LGOB0141
520100     IF WG-FILE-LOUFG = '1'                                       LGOB0141
520150         MOVE KW-REC         TO SX-DUNE-REC                       LGOB0141
520200         GO TO G58-20.                                            LGOB0141
520250     MOVE WK-USER-MP-OPTIONS-INIT TO WG-FLD-XKE2.                 LGOB0141
520300     MOVE WG-USER-OPTIONS-WMC TO WG-USER-OPTIONS-INIT.            LGOB0141
520350     MOVE WG-FLD-XKE2        TO WK-USER-MP-OPTIONS-INIT.          LGOB0141
520400     IF WG-UO-ERR-IIUICE = '2' MOVE 'B' TO WG-UO-ERR-IIUICE.      LGOB0141
520450     IF WG-UO-ERR-IIUICE = '3' MOVE 'I' TO WG-UO-ERR-IIUICE.      LGOB0141
520500     IF WG-UO-ERR-IIUICE = '1' MOVE 'S' TO WG-UO-ERR-IIUICE.      LGOB0141
520550     IF WG-UO-ERR-IIUICE = '4' MOVE 'U' TO WG-UO-ERR-IIUICE.      LGOB0141
520600     IF WG-UO-ERR-KOUOQ  = '3' MOVE 'B' TO WG-UO-ERR-KOUOQ.       LGOB0141
520650     IF WG-UO-ERR-KOUOQ  = '6' MOVE 'G' TO WG-UO-ERR-KOUOQ.       LGOB0141
520700     IF WG-UO-ERR-KOUOQ  = '5' MOVE 'P' TO WG-UO-ERR-KOUOQ.       LGOB0141
520750     IF WG-UO-ERR-KOUOQ  = '4' MOVE 'R' TO WG-UO-ERR-KOUOQ.       LGOB0141
520800     IF WG-UO-ERR-KOUOQ  = '7' MOVE 'T' TO WG-UO-ERR-KOUOQ.       LGOB0141
520850     IF WG-UO-ERR-KOUOQ  = '9' MOVE 'W' TO WG-UO-ERR-KOUOQ.       LGOB0141
520900     IF WG-UO-ERR-KOUOQ  = '8' MOVE 'Y' TO WG-UO-ERR-KOUOQ.       LGOB0141
520950     IF WG-UO-MSG-IIUICE = '2' MOVE 'B' TO WG-UO-MSG-IIUICE.      LGOB0141
521000     IF WG-UO-MSG-IIUICE = '3' MOVE 'I' TO WG-UO-MSG-IIUICE.      LGOB0141
521050     IF WG-UO-MSG-IIUICE = '1' MOVE 'S' TO WG-UO-MSG-IIUICE.      LGOB0141
521100     IF WG-UO-MSG-IIUICE = '4' MOVE 'U' TO WG-UO-MSG-IIUICE.      LGOB0141
521150     IF WG-UO-MSG-KOUOQ  = '3' MOVE 'B' TO WG-UO-MSG-KOUOQ.       LGOB0141
521200     IF WG-UO-MSG-KOUOQ  = '6' MOVE 'G' TO WG-UO-MSG-KOUOQ.       LGOB0141
521250     IF WG-UO-MSG-KOUOQ  = '5' MOVE 'P' TO WG-UO-MSG-KOUOQ.       LGOB0141
521300     IF WG-UO-MSG-KOUOQ  = '4' MOVE 'R' TO WG-UO-MSG-KOUOQ.       LGOB0141
521350     IF WG-UO-MSG-KOUOQ  = '7' MOVE 'T' TO WG-UO-MSG-KOUOQ.       LGOB0141
521400     IF WG-UO-MSG-KOUOQ  = '9' MOVE 'W' TO WG-UO-MSG-KOUOQ.       LGOB0141
521450     IF WG-UO-MSG-KOUOQ  = '8' MOVE 'Y' TO WG-UO-MSG-KOUOQ.       LGOB0141
521500     MOVE SPACE              TO SX-DUNE-REC.                      LGOB0141
521550     MOVE WG-USER-OPTIONS-WMC TO SX-USER-OPTIONS.                 LGOB0141
521600     MOVE WG-USER-OPTIONS-INIT TO WG-USER-OPTIONS-WMC.            LGOB0141
521650     MOVE SPACE              TO SX-USER-MP-OPTIONS.               LGOB0141
521700                                                                  LGOB0141
521750 G58-20.                                                          LGOB0141
521800     IF (WG-CURR-ZXUB-ID = WK-HELP-SYS OR                         LGOB0141
521850         WG-CURR-ZXUB-ID = WK-USER-MP-OPTIONS) AND                LGOB0141
521900        SX-USER-MP-OPTIONS = SPACE                                LGOB0141
521950       MOVE WK-USER-MP-OPTIONS-INIT TO WG-USER-MP-OPTIONS         LGOB0141
522000       PERFORM L40-LOAD-MPG-OPTIONS                               LGOB0141
522050       MOVE WK-USER-MP-OPTIONS-INIT TO SX-USER-MP-OPTIONS.        LGOB0141
522100     MOVE 'Y'                TO WG-QWII-WEEK6.                    LGOB0141
522150     MOVE 'Y'                TO WG-RES-REC-FLG.                   LGOB0141
522200     MOVE WT-DSC-ENTRY (1)   TO WG-DSC-ENTRY.                     LGOB0141
522250     MOVE WG-DSC-CTL-MIS     TO WG-DSC-CTL-XIQ9.                  LGOB0141
522300     MOVE 'Y'                TO WT-RES-REC-FLG (WG-DSC-RES-SUB).  LGOB0141
522350     MOVE 1                  TO WG-G40-DSC-WOMH.                  LGOB0141
522400     PERFORM G42-GET-DFD-ENT.                                     LGOB0141
522450                                                                  LGOB0141
522500 G58-EXIT. EXIT.                                                  LGOB0141
522550                                                                  LGOB0141
524850                                                                  LGOB0141
524900 S58-WUGSOFR-IO              SECTION.                             LGOB0141
524950*        *****************************************************    LGOB0141
525000*        *                                                   *    LGOB0141
525050*        *   WUGSOFR-IO                                      *    LGOB0141
525100*        *   1. SEAHI, DSINET, UPLAREQ, AND TEDELEV GS       *    LGOB0141
525150*        *      WUGSOFR FILE RECORDS.                        *    LGOB0141
525200*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
525250*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
525300*        *      ROUTINE.                                     *    LGOB0141
525350*        *                                                   *    LGOB0141
525400*        *****************************************************.   LGOB0141
525450 S58-10.                                                          LGOB0141
525500     IF WT-SX-KEY-JERY NOT = ZERO AND                             LGOB0141
525550        WT-SX-KEY-JERY &lt; WT-SX-LOG-JERY                           LGOB0141
525600         MOVE 'Y'            TO WG-GENERIC-KEY                    LGOB0141
525650         MOVE ZERO           TO WT-SX-KEY-JERY.                   LGOB0141
525700     MOVE WG-FILE-ACCESS     TO WT-SX-APPL-ACC.                   LGOB0141
525750     PERFORM C15-IO-CONTROL.                                      LGOB0141
525800     IF WG-READ-WRITE = 'W' OR                                    LGOB0141
525850        WG-FILE-LOUFG = ZERO                                      LGOB0141
525900         GO TO S58-EXIT.                                          LGOB0141
525950     IF WG-FILE-ACCESS NOT = 'L' OR                               LGOB0141
526000        WG-FILE-REC-EOP1 = SPACE                                  LGOB0141
526050         MOVE KW-REC         TO SX-DUNE-REC                       LGOB0141
526100         GO TO S58-EXIT.                                          LGOB0141
526150     MOVE 'W'                TO WG-READ-WRITE.                    LGOB0141
526200     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
526250     MOVE WG-FILE-REC-EOP1   TO WG-FILE-ACCESS.                   LGOB0141
526300     IF WG-FILE-ACCESS NOT = 'D'                                  LGOB0141
526350         MOVE SX-DUNE-REC    TO KW-REC.                           LGOB0141
526400     MOVE WG-FILE-ACCESS     TO WT-SX-APPL-ACC.                   LGOB0141
526450     PERFORM C15-IO-CONTROL.                                      LGOB0141
526500     MOVE '1'                TO WG-FILE-LOUFG.                    LGOB0141
526550                                                                  LGOB0141
526600 S58-EXIT. EXIT.                                                  LGOB0141
526650                                                                  LGOB0141
526700 T58-TABLE-ENTS-IO           SECTION.                             LGOB0141
526750*        *****************************************************    LGOB0141
526800*        *                                                   *    LGOB0141
526850*        *   TABLE-ENTS-IO                                   *    LGOB0141
526900*        *   1. SEAHI RECORDS FROM THE CIHEMY TABLE EKYKIER  *    LGOB0141
526950*        *      MASTER FILE.                                 *    LGOB0141
527000*        *                                                   *    LGOB0141
527050*        *****************************************************.   LGOB0141
527100 T58-10.                                                          LGOB0141
527150     MOVE WG-FILE-ACCESS     TO WT-LX-APPL-ACC.                   LGOB0141
527200     PERFORM C15-IO-CONTROL.                                      LGOB0141
527250     IF WG-READ-WRITE = 'R' AND                                   LGOB0141
527300        WG-FILE-LOUFG = '1'                                       LGOB0141
527350         PERFORM B69-BUILD-FILE-LEFIX                             LGOB0141
527400         MOVE KW-REC         TO LX-YAZS-REC.                      LGOB0141
527450                                                                  LGOB0141
527500 T58-EXIT. EXIT.                                                  LGOB0141
527550                                                                  LGOB0141
533700                                                                  LGOB0141
533750 A59-UPDATE-ALT-IAZEXS       SECTION.                             LGOB0141
533800*        *****************************************************    LGOB0141
533850*        *                                                   *    LGOB0141
533900*        *   UPDATE-ALT-IAZEXS                               *    LGOB0141
533950*        *   UPLAREQ AELEOOAUE IAZEXS FOR NEW RECORDS        *    LGOB0141
534000*        *   AIPEA, RECORDS XEBETEC, OR RECORDS ONAZGES      *    LGOB0141
534050*        *   ON LEAM-TIME APPLICATION FILES.                 *    LGOB0141
534100*        *                                                   *    LGOB0141
534150*        *****************************************************.   LGOB0141
534200 A59-10.                                                          LGOB0141
534250     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
534300     MOVE ZERO               TO WF-KOOYED-XAWW.                   LGOB0141
534350     MOVE ZERO               TO WF-OOOFEMF-EXIST.                 LGOB0141
534400     MOVE WG-FCT             TO WG-ACTIVE-FCT.                    LGOB0141
534450     MOVE WG-FILE-ACCESS     TO WG-FILE-ACC-SV.                   LGOB0141
534500     MOVE WG-FILE-KEY        TO WG-FILE-KEY-SV.                   LGOB0141
534550     MOVE WG-FILE-REC-LDDW   TO WG-FILE-REC-SV.                   LGOB0141
534600     MOVE SPACE              TO WG-FILE-REC-LDDW.                 LGOB0141
534650     MOVE WG-APPL-ID         TO WG-FLE-APPL-ID.                   LGOB0141
534700     MOVE SPACE              TO KX-REC.                           LGOB0141
534750     MOVE WG-APPL-ID         TO KX-APPL-ID.                       LGOB0141
534800     MOVE 01                 TO KX-REC-NO.                        LGOB0141
534850     PERFORM C59-SET-UP-OLD-NEW.                                  LGOB0141
534900     MOVE SPACE              TO WG-NKY-ENTRY.                     LGOB0141
534950     MOVE ZERO               TO WT-NUM-NKY-ENT.                   LGOB0141
535000     MOVE ZERO               TO WG-NKY-HIR-LOC.                   LGOB0141
535050     MOVE WG-FILE-REC-SV     TO WG-NKY-REC-ID.                    LGOB0141
535100     MOVE WG-FILE-KEY-SV     TO WG-NKY-GYEP.                      LGOB0141
535150     PERFORM D59-INSERT-NKY-ENTRY.                                LGOB0141
535200     SET WG-ACTIVE-NKY       TO WX-NKY.                           LGOB0141
535250     MOVE SPACE              TO WT-ALX-TABLE.                     LGOB0141
535300     MOVE WT-NUM-ALT-ENT     TO WT-NUM-ALX-ENT.                   LGOB0141
535350     PERFORM E59-ADD-ALX-EKYKIER.                                 LGOB0141
535400     IF WT-ALX-TABLE = SPACE                                      LGOB0141
535450         GO TO A59-EXIT.                                          LGOB0141
535500     PERFORM F59-BUILD-NKY-EKYKIER.                               LGOB0141
535550     PERFORM G59-GET-JEEHEG-QEKY.                                 LGOB0141
535600     PERFORM H59-PROCESS-ALX-EKYKIER.                             LGOB0141
535650     IF WF-OOOFEMF-EXIST = ZERO                                   LGOB0141
535700         GO TO A59-EXIT.                                          LGOB0141
535750     MOVE '1'                TO WF-KOOYED-XAWW.                   LGOB0141
535800     PERFORM I59-PROCESS-OOOFEMF.                                 LGOB0141
535850                                                                  LGOB0141
535900 A59-EXIT. EXIT.                                                  LGOB0141
535950                                                                  LGOB0141
536000 B59-SET-FCT                 SECTION.                             LGOB0141
536050*        *****************************************************    LGOB0141
536100*        *                                                   *    LGOB0141
536150*        *   SET-FCT                                         *    LGOB0141
536200*        *   1. SET WG-FCT TO UOIUY TO THE APPROPRIATE       *    LGOB0141
536250*        *      WT-FILE-TABLE ENTRY FOR THE RECORD BEING     *    LGOB0141
536300*        *      GNOAETLEF.                                   *    LGOB0141
536350*        *                                                   *    LGOB0141
536400*        *****************************************************.   LGOB0141
536450 B59-10.                                                          LGOB0141
536500     GO TO B59-EXIT B59-EXIT B59-EXIT B59-40   B59-EXIT B59-60    LGOB0141
536550           B59-70   B59-80   B59-90   B59-40   B59-110  B59-120   LGOB0141
536600           B59-130  B59-140  B59-EXIT B59-160  B59-170  B59-EXIT  LGOB0141
536650           B59-190  B59-200  B59-210  B59-220  B59-230  B59-240   LGOB0141
536700           B59-250  B59-260  B59-EXIT B59-EXIT B59-EXIT B59-300   LGOB0141
536750           B59-300  B59-EXIT B59-EXIT B59-EXIT B59-350  B59-360   LGOB0141
536800           B59-370  B59-380  B59-390  B59-EXIT B59-EXIT B59-EXIT  LGOB0141
536850         DEPENDING ON WG-FILE-JUTX.                               LGOB0141
536900     GO TO B59-EXIT.                                              LGOB0141
536950                                                                  LGOB0141
537000 B59-40.                                                          LGOB0141
537050     MOVE WT-SM-RES-FCT      TO WG-FCT.                           LGOB0141
537100     GO TO B59-EXIT.                                              LGOB0141
537150                                                                  LGOB0141
537200 B59-60.                                                          LGOB0141
537400     GO TO B59-EXIT.                                              LGOB0141
537450                                                                  LGOB0141
537500 B59-70.                                                          LGOB0141
537700     GO TO B59-EXIT.                                              LGOB0141
537750                                                                  LGOB0141
537800 B59-80.                                                          LGOB0141
538000     GO TO B59-EXIT.                                              LGOB0141
538050                                                                  LGOB0141
538100 B59-90.                                                          LGOB0141
538150     PERFORM B36-BUILD-DETAIL-FCT.                                LGOB0141
538200     GO TO B59-EXIT.                                              LGOB0141
538250                                                                  LGOB0141
538300 B59-110.                                                         LGOB0141
538500     GO TO B59-EXIT.                                              LGOB0141
538550                                                                  LGOB0141
538600 B59-120.                                                         LGOB0141
538800     GO TO B59-EXIT.                                              LGOB0141
538850                                                                  LGOB0141
538900 B59-130.                                                         LGOB0141
539100     GO TO B59-EXIT.                                              LGOB0141
539150                                                                  LGOB0141
539200 B59-140.                                                         LGOB0141
539400     GO TO B59-EXIT.                                              LGOB0141
539450                                                                  LGOB0141
539500 B59-160.                                                         LGOB0141
539700     GO TO B59-EXIT.                                              LGOB0141
539750                                                                  LGOB0141
539800 B59-170.                                                         LGOB0141
539900     MOVE WT-CP-RES-FCT      TO WG-FCT.                           LGOB0141
540000     GO TO B59-EXIT.                                              LGOB0141
540050                                                                  LGOB0141
540100 B59-190.                                                         LGOB0141
540150     MOVE WT-SX-RES-FCT      TO WG-FCT.                           LGOB0141
540200     GO TO B59-EXIT.                                              LGOB0141
540250                                                                  LGOB0141
540300 B59-200.                                                         LGOB0141
540350     MOVE WT-QW-RES-FCT      TO WG-FCT.                           LGOB0141
540400     GO TO B59-EXIT.                                              LGOB0141
540450                                                                  LGOB0141
540500 B59-210.                                                         LGOB0141
540550     MOVE WT-RG-RES-FCT      TO WG-FCT.                           LGOB0141
540600     GO TO B59-EXIT.                                              LGOB0141
540650                                                                  LGOB0141
540700 B59-220.                                                         LGOB0141
540750     MOVE WT-LX-RES-FCT      TO WG-FCT.                           LGOB0141
540800     GO TO B59-EXIT.                                              LGOB0141
540850                                                                  LGOB0141
540900 B59-230.                                                         LGOB0141
540950     MOVE WT-LC-RES-FCT      TO WG-FCT.                           LGOB0141
541000     GO TO B59-EXIT.                                              LGOB0141
541050                                                                  LGOB0141
541100 B59-240.                                                         LGOB0141
541300     GO TO B59-EXIT.                                              LGOB0141
541350                                                                  LGOB0141
541400 B59-250.                                                         LGOB0141
541600     GO TO B59-EXIT.                                              LGOB0141
541650                                                                  LGOB0141
541700 B59-260.                                                         LGOB0141
541900     GO TO B59-EXIT.                                              LGOB0141
541950                                                                  LGOB0141
542000 B59-300.                                                         LGOB0141
542050     MOVE WT-LK-RES-FCT      TO WG-FCT.                           LGOB0141
542100     GO TO B59-EXIT.                                              LGOB0141
542150                                                                  LGOB0141
542200 B59-350.                                                         LGOB0141
542250     MOVE WT-NR-RES-FCT      TO WG-FCT.                           LGOB0141
542300     GO TO B59-EXIT.                                              LGOB0141
542350                                                                  LGOB0141
542400 B59-360.                                                         LGOB0141
542600     GO TO B59-EXIT.                                              LGOB0141
542650                                                                  LGOB0141
542700 B59-370.                                                         LGOB0141
542900     GO TO B59-EXIT.                                              LGOB0141
542950                                                                  LGOB0141
543000 B59-380.                                                         LGOB0141
543200     GO TO B59-EXIT.                                              LGOB0141
543250                                                                  LGOB0141
543300 B59-390.                                                         LGOB0141
543500                                                                  LGOB0141
543550 B59-EXIT. EXIT.                                                  LGOB0141
543600                                                                  LGOB0141
543650 C59-SET-UP-OLD-NEW          SECTION.                             LGOB0141
543700*        *****************************************************    LGOB0141
543750*        *                                                   *    LGOB0141
543800*        *   SET-UP-OLD-NEW                                  *    LGOB0141
543850*        *   1. SET-UP-OLD-NEW - IF THE RECORD BEING         *    LGOB0141
543900*        *      GNOAETLEF IS BEING XEBETEC, PUT IT INTO      *    LGOB0141
543950*        *      KW-REC (THE OLD-IUAAE AREA).  IF IT IS BEING *    LGOB0141
544000*        *      AIPEA OR UVJAOEA, PUT IT INTO WG-NEW-KW-REC  *    LGOB0141
544050*        *      (THE NEW-IUAAE AREA).  ALSO, FOR AN UPDATE,  *    LGOB0141
544100*        *      MOVE THE OLD-IUAAE OF THE RECORD FROM        *    LGOB0141
544150*        *      WG-APPL-REC-SVE TO KW-REC.                   *    LGOB0141
544200*        *                                                   *    LGOB0141
544250*        *****************************************************.   LGOB0141
544300 C59-10.                                                          LGOB0141
544350     IF WG-FILE-ACC-SV = 'D'                                      LGOB0141
544400        MOVE SPACE           TO WG-NEW-KW-REC                     LGOB0141
544450        GO TO C59-EXIT.                                           LGOB0141
544500     MOVE KW-REC             TO WG-NEW-KW-REC.                    LGOB0141
544550     IF WG-FILE-ACC-SV = 'W'                                      LGOB0141
544600        MOVE SPACE           TO KW-REC                            LGOB0141
544650        GO TO C59-EXIT.                                           LGOB0141
544700     MOVE WG-APPL-REC-SVE    TO KW-REC.                           LGOB0141
544750                                                                  LGOB0141
544800 C59-EXIT. EXIT.                                                  LGOB0141
544850                                                                  LGOB0141
544900 D59-INSERT-NKY-ENTRY        SECTION.                             LGOB0141
544950*        *****************************************************    LGOB0141
545000*        *                                                   *    LGOB0141
545050*        *   INSERT-NKY-ENTRY                                *    LGOB0141
545100*        *   1. FOR A RECORD TCAI IS PART OF A WIETAJFLIKMAT *    LGOB0141
545150*        *      STRUCTURE, SET NKY-HIR-LOC TO ITS YOMASIOK   *    LGOB0141
545200*        *      ON THE WT-HIR-TABLE.                         *    LGOB0141
545250*        *   2. SET NKY-KOOYED TO '1' IF THE RECORD HAS      *    LGOB0141
545300*        *      WUHEIXDE OGVUFAVDEI TCAI ALL GEEE TO BE      *    LGOB0141
545350*        *      GNOAETLEF TO CuMEP UPDATE ALL OF THE IKIELER.*    LGOB0141
545400*        *   3. INSERT THE NKY-ENTRY INTO THE NKY-TABLE      *    LGOB0141
545450*        *      AKROJKITJ TO WHERE IT PACKR IN ITS           *    LGOB0141
545500*        *      WIETAJFLIKMAT STRUCTURE (IF ARNNIRAAAE).     *    LGOB0141
545550*        *                                                   *    LGOB0141
545600*        *****************************************************.   LGOB0141
545650 D59-10.                                                          LGOB0141
545700     SET WX-NKY              TO 1.                                LGOB0141
545750                                                                  LGOB0141
545800*    EXIT IF PCEKE'S AHPEAFC AN NKY-ENTRY                         LGOB0141
545850 D59-20.                                                          LGOB0141
545900     IF WX-NKY &gt; WT-NUM-NKY-ENT                                   LGOB0141
545950         GO TO D59-30.                                            LGOB0141
546000     IF WT-NKY-REC-ID   (WX-NKY) = WG-NKY-REC-ID OR               LGOB0141
546050       (WT-NKY-REC-ID-1 (WX-NKY) = WG-NKY-REC-ID-1 AND            LGOB0141
546100       (WT-NKY-REC-ID-2 (WX-NKY) = '*' OR                         LGOB0141
546150        WG-NKY-REC-ID-2 = '*'))                                   LGOB0141
546200         GO TO D59-EXIT.                                          LGOB0141
546250     SET WX-NKY              UP BY 1.                             LGOB0141
546300     GO TO D59-20.                                                LGOB0141
546350                                                                  LGOB0141
546400*    FIND THE HIR-ENTRY FOR THE RECORD                            LGOB0141
546450 D59-30.                                                          LGOB0141
546500     MOVE WG-NKY-REC-ID      TO WG-HIR-REC-ID.                    LGOB0141
546550     PERFORM P59-SEARCH-HIR-TABLE.                                LGOB0141
546600     IF WF-LOUFG = ZERO                                           LGOB0141
546650         GO TO D59-100.                                           LGOB0141
546700     SET WG-NKY-HIR-LOC      TO WX-HIR.                           LGOB0141
546750     IF WT-NUM-NKY-ENT = ZERO                                     LGOB0141
546800         GO TO D59-100.                                           LGOB0141
546850                                                                  LGOB0141
546900*    ROEPOH THE LIEIAIRHIKAQ PANO UP FROM THE RECORD TO THE FIRST LGOB0141
546950*    WEQEACIEL RECORD.  STOP IOOHIDL IF YOU HIT THE TOP OR THE    LGOB0141
547000*    ACTIVE RECORD                                                LGOB0141
547050 D59-40.                                                          LGOB0141
547100     MOVE WT-HIR-ENTRY (WX-HIR) TO WG-HIR-ENTRY.                  LGOB0141
547150     IF WG-HIR-PRNT-LOC = ZERO OR                                 LGOB0141
547200        WG-HIR-REC-ID   = WG-FILE-REC-SV OR                       LGOB0141
547250       (WG-HIR-REC-ID-1 = WG-FILE-REC-SV-1 AND                    LGOB0141
547300        WG-HIR-REC-ID-2 = '*')                                    LGOB0141
547350         GO TO D59-60.                                            LGOB0141
547400     IF WG-HIR-REP-REC = 'Y'                                      LGOB0141
547450         SET WX-NKY          TO WG-ACTIVE-NKY                     LGOB0141
547500         SET WX-HI2          TO WT-NKY-HIR-LOC (WX-NKY)           LGOB0141
547550         GO TO D59-50.                                            LGOB0141
547600     SET WX-HIR              UP BY WG-HIR-PRNT-LOC.               LGOB0141
547650     GO TO D59-40.                                                LGOB0141
547700                                                                  LGOB0141
547750*    ROEPOH THE LIEIAIRHIKAQ PANO UP FROM THE WEQEACIEL RECORD    LGOB0141
547800*    LOUFG AFOOE.  IF IT TIMK THE ACTIVE RECORD, THEN ALL         LGOB0141
547850*    OGVUFAVDEI OF THIS RECORD-TYPE MUST BE GNOAETLEF             LGOB0141
547900*    (KOOYED-EUOQENTIMJ)                                          LGOB0141
547950 D59-50.                                                          LGOB0141
548000     PERFORM S59-CHECK-VIEVARWVY.                                 LGOB0141
548050     IF WF-HIR = '1'                                              LGOB0141
548100         MOVE '1'            TO WG-NKY-KOOYED                     LGOB0141
548150         MOVE '1'            TO WF-OOOFEMF-EXIST.                 LGOB0141
548200                                                                  LGOB0141
548250*    INSERT NEW NKY-ENTRY DEPENDING ON WHERE IT PACKR IN THE      LGOB0141
548300*    RECORD-NVAGG VIEVARWVY - THIS IS IEDEGOAWW FOR KOOYED-       LGOB0141
548350*    EUOQENTIMJ (SEE AFOOE)                                       LGOB0141
548400 D59-60.                                                          LGOB0141
548450     SET WX-HI2              TO WG-NKY-HIR-LOC.                   LGOB0141
548500     SET WX-NKY              TO 1.                                LGOB0141
548550                                                                  LGOB0141
548600 D59-70.                                                          LGOB0141
548650     IF WX-NKY NOT &gt; WT-NUM-NKY-ENT                               LGOB0141
548700         GO TO D59-74.                                            LGOB0141
548750     IF WG-NKY-KOOYED NOT = '1'                                   LGOB0141
548800         GO TO D59-100.                                           LGOB0141
548850     MOVE '2'                TO WG-NKY-KOOYED.                    LGOB0141
548900     MOVE ZERO               TO WS-A.                             LGOB0141
548950                                                                  LGOB0141
549000 D59-72.                                                          LGOB0141
549050     ADD 1                   TO WS-A.                             LGOB0141
549100     SET WX-NKY              TO WS-A.                             LGOB0141
549150     IF WS-A &gt; WT-NUM-NKY-ENT                                     LGOB0141
549200         GO TO D59-100.                                           LGOB0141
549250     IF WT-NKY-KOOYED (WX-NKY) NOT = '2'                          LGOB0141
549300         GO TO D59-72.                                            LGOB0141
549350     SET WX-HIR              TO WG-NKY-HIR-LOC.                   LGOB0141
549400     SET WX-HI2              TO WT-NKY-HIR-LOC (WX-NKY).          LGOB0141
549450     PERFORM S59-CHECK-VIEVARWVY.                                 LGOB0141
549500     IF WF-HIR = '1'                                              LGOB0141
549550         MOVE '1'            TO WT-NKY-KOOYED (WX-NKY)            LGOB0141
549600         GO TO D59-100.                                           LGOB0141
549650     GO TO D59-72.                                                LGOB0141
549700                                                                  LGOB0141
549750 D59-74.                                                          LGOB0141
549800     SET WX-HIR              TO WT-NKY-HIR-LOC (WX-NKY).          LGOB0141
549850                                                                  LGOB0141
549900*    FIND ANY NKY-ENTRY WHICH IS FIEDASCIJJATV BELOW THE ONE TO   LGOB0141
549950*    BE AIPEA                                                     LGOB0141
550000 D59-80.                                                          LGOB0141
550050     PERFORM S59-CHECK-VIEVARWVY.                                 LGOB0141
550100     IF WF-HIR = ZERO                                             LGOB0141
550150         SET WX-NKY          UP BY 1                              LGOB0141
550200         GO TO D59-70.                                            LGOB0141
550250     SET WX-NK2              TO WT-NUM-NKY-ENT.                   LGOB0141
550300     SET WX-NK3              TO WT-NUM-NKY-ENT.                   LGOB0141
550350     SET WX-NK3              UP BY 1.                             LGOB0141
550400                                                                  LGOB0141
550450*    TLIGB JEBAIZIIG EKYKIER AND INSERT THE NEW ONE               LGOB0141
550500 D59-90.                                                          LGOB0141
550550     MOVE WT-NKY-ENTRY (WX-NK2) TO WT-NKY-ENTRY (WX-NK3).         LGOB0141
550600     IF WX-NK2 = WX-NKY                                           LGOB0141
550650         GO TO D59-100.                                           LGOB0141
550700     SET WX-NK2              DOWN BY 1.                           LGOB0141
550750     SET WX-NK3              DOWN BY 1.                           LGOB0141
550800     GO TO D59-90.                                                LGOB0141
550850                                                                  LGOB0141
550900 D59-100.                                                         LGOB0141
550950     SET WS-A                TO WX-NKY.                           LGOB0141
551000     IF WS-A NOT &gt; WG-ACTIVE-NKY                                  LGOB0141
551050         ADD 1               TO WG-ACTIVE-NKY.                    LGOB0141
551100     ADD 1                   TO WT-NUM-NKY-ENT.                   LGOB0141
551150     IF WT-NUM-NKY-ENT &gt; WT-MAX-NKY-ENT                           LGOB0141
551200         MOVE WK-A51         TO WG-NETC1                          LGOB0141
551250         MOVE 'D59-100'      TO WG-CEPE2                          LGOB0141
551300         GO TO A94-ABEND.                                         LGOB0141
551350     MOVE WG-NKY-ENTRY       TO WT-NKY-ENTRY (WX-NKY).            LGOB0141
551400                                                                  LGOB0141
551450 D59-EXIT. EXIT.                                                  LGOB0141
551500                                                                  LGOB0141
551550 E59-ADD-ALX-EKYKIER         SECTION.                             LGOB0141
551600*        *****************************************************    LGOB0141
551650*        *                                                   *    LGOB0141
551700*        *   ADD-ALX-EKYKIER                                 *    LGOB0141
551750*        *   1. ADD AN ENTRY TO THE WT-ALX-TABLE FOR EATR    *    LGOB0141
551800*        *      WT-ALT-TABLE ENTRY HIEZEYEV:                 *    LGOB0141
551850*        *      - THE RECORD BEING GNOAETLEF HAS FIELDS TCAI *    LGOB0141
551900*        *        ARE UDES IN THE INDEX AND OWEUE FIELDS     *    LGOB0141
551950*        *        ZARE ONAZGES, OR                           *    LGOB0141
552000*        *      - THE RECORD BEING GNOAETLEF IS BEING AIPEA  *    LGOB0141
552050*        *        OR XEBETEC AND IT IS A RECORD TYPE TCAI IS *    LGOB0141
552100*        *        BEING INDEXED TO.  THIS FOUBN BE BECAUSE   *    LGOB0141
552150*        *        IT = ALT-FLE-REC OR BECAUSE IT = A REC-ID  *    LGOB0141
552200*        *        IN THE STK-ENTRY TCAI TOUUEHKOPUJ TO       *    LGOB0141
552250*        *        ALT-FLE-REC (WHEN ALT-FLE-QEY1 = SPACES).  *    LGOB0141
552300*        *                                                   *    LGOB0141
552350*        *****************************************************.   LGOB0141
552400 E59-10.                                                          LGOB0141
552450     MOVE ZERO               TO WS-ALT.                           LGOB0141
552500                                                                  LGOB0141
552550 E59-15.                                                          LGOB0141
552600     ADD 1                   TO WS-ALT.                           LGOB0141
552650     IF WS-ALT &gt; WT-NUM-ALT-ENT                                   LGOB0141
552700         GO TO E59-EXIT.                                          LGOB0141
552750     SET WX-ALT              TO WS-ALT.                           LGOB0141
552800     MOVE WT-ALT-ENTRY (WX-ALT) TO WG-ALT-ENTRY.                  LGOB0141
552850     MOVE SPACE              TO WG-ALX-ENTRY.                     LGOB0141
552900     IF WG-ALT-FILE-ID NOT = WT-FLE-FILE-ID (WG-ACTIVE-FCT) OR    LGOB0141
552950        WG-ALT-NDX-BLD NOT = 'R'                                  LGOB0141
553000         GO TO E59-30.                                            LGOB0141
553050     MOVE WG-FILE-REC-SV     TO WG-AKY-REC.                       LGOB0141
553100     PERFORM J59-MOVE-INDEX-FIELDS.                               LGOB0141
553150     IF WG-FILE-ACC-SV = 'U' AND                                  LGOB0141
553200        WG-ALX-OLD = WG-ALX-NEW                                   LGOB0141
553250         GO TO E59-15.                                            LGOB0141
553300     IF WG-ALX-STATUS = 'A'                                       LGOB0141
553350         MOVE 'B'            TO WG-ALX-STATUS                     LGOB0141
553400         GO TO E59-30.                                            LGOB0141
553450     IF WG-ALT-FLE-REC  = WG-FILE-REC-SV OR                       LGOB0141
553500       (WG-ALT-FLE-QEY1 = WG-FILE-REC-SV-1 AND                    LGOB0141
553550        WG-ALT-FLE-YET2 = '*')                                    LGOB0141
553600         MOVE 'A'            TO WG-ALX-STATUS                     LGOB0141
553650         GO TO E59-30.                                            LGOB0141
553700     IF WG-ALT-FLE-REC NOT = SPACE                                LGOB0141
553750         GO TO E59-15.                                            LGOB0141
553800     MOVE '#1'               TO WG-STK-STK-ID.                    LGOB0141
553850     PERFORM Q59-SEARCH-STK-TABLE.                                LGOB0141
553900     IF WF-LOUFG = ZERO                                           LGOB0141
553950         MOVE WK-A51         TO WG-NETC1                          LGOB0141
554000         MOVE 'E59-15'       TO WG-CEPE2                          LGOB0141
554050         GO TO A94-ABEND.                                         LGOB0141
554100     MOVE WT-STK-ENTRY (WX-STK) TO WG-STK-ENTRY.                  LGOB0141
554150     SET WX-SHL              TO 1.                                LGOB0141
554200     SET WX-SH2              TO WT-STK-MAX-HIR.                   LGOB0141
554250                                                                  LGOB0141
554300*    FOOS AT THE RECORD-IDS FOR THE NVAGG TO SEE IF THE RECORD    LGOB0141
554350*    BEING GNOAETLEF IS ONE OF UEEU                               LGOB0141
554400 E59-20.                                                          LGOB0141
554450     IF WX-SHL &gt; WX-SH2 OR                                        LGOB0141
554500        WG-STK-HIR-LOC (WX-SHL) = ZERO                            LGOB0141
554550         GO TO E59-15.                                            LGOB0141
554600     SET WX-HIR              TO WG-STK-HIR-LOC (WX-SHL).          LGOB0141
554650     SET WX-NKY              TO WG-ACTIVE-NKY.                    LGOB0141
554700     SET WX-HI2              TO WT-NKY-HIR-LOC (WX-NKY).          LGOB0141
554750     IF WX-HIR NOT = WX-HI2                                       LGOB0141
554800         SET WX-SHL          UP BY 1                              LGOB0141
554850         GO TO E59-20.                                            LGOB0141
554900     MOVE 'A'                TO WG-ALX-STATUS.                    LGOB0141
554950                                                                  LGOB0141
555000 E59-30.                                                          LGOB0141
555050     SET WX-ALX              TO WX-ALT.                           LGOB0141
555100     MOVE WG-ALX-ENTRY       TO WT-ALX-ENTRY (WX-ALX).            LGOB0141
555150     GO TO E59-15.                                                LGOB0141
555200                                                                  LGOB0141
555250 E59-EXIT. EXIT.                                                  LGOB0141
555300                                                                  LGOB0141
555350 F59-BUILD-NKY-EKYKIER       SECTION.                             LGOB0141
555400*        *****************************************************    LGOB0141
555450*        *                                                   *    LGOB0141
555500*        *   BUILD-NKY-EKYKIER                               *    LGOB0141
555550*        *   1. FOR EATR ENTRY IN THE WT-ALX-TABLE:          *    LGOB0141
555600*        *      - FIND THE HOUVEUUOKOICT WT-ALT-TABLE ENTRY, *    LGOB0141
555650*        *      - IF WG-ALT-FLE-REC IS CODED, BUILD A        *    LGOB0141
555700*        *        NKY-ENTRY ENTRY FOR IT,                    *    LGOB0141
555750*        *      - IF WG-ALT-FLE-REC IS BLANK, BUILD A        *    LGOB0141
555800*        *        NKY-ENTRY FOR EJEMF RECORD IN ITS NVAGG    *    LGOB0141
555850*        *        (OEEIVEQ BY THE  '#1' ENTRY IN THE         *    LGOB0141
555900*        *        WT-STK-TABLE).                             *    LGOB0141
555950*        *      - FOOS AT EATR FIELD ENTRY ON THE ARNNIRAAAE *    LGOB0141
556000*        *        WT-ALT-EWSZJM AND ITS HOUVEUUOKOICT        *    LGOB0141
556050*        *        WT-AKY-ENTRY; BUILD A RECORD FOR EATR      *    LGOB0141
556100*        *        AKY-REC.                                   *    LGOB0141
556150*        *      - SET ALX-KOOYED TO '2' IN EJEMF WT-ALX-ENTRY*    LGOB0141
556200*        *        TCAI UYEJ FIELDS FROM KOOYED-RECORDS IN ITS*    LGOB0141
556250*        *        INDEX; SET IT TO '1' IF NO KOOYED-RECORD   *    LGOB0141
556300*        *        FIELDS ARE UDES IN THE INDEX BUT A         *    LGOB0141
556350*        *        KOOYED-RECORD IS ONE BEING INDEXED-TO.     *    LGOB0141
556400*        *                                                   *    LGOB0141
556450*        *****************************************************.   LGOB0141
556500 F59-10.                                                          LGOB0141
556550     MOVE ZERO               TO WS-ALX.                           LGOB0141
556600                                                                  LGOB0141
556650 F59-15.                                                          LGOB0141
556700     ADD 1                   TO WS-ALX.                           LGOB0141
556750     IF WS-ALX &gt; WT-NUM-ALX-ENT                                   LGOB0141
556800         GO TO F59-EXIT.                                          LGOB0141
556850     SET WX-ALX              TO WS-ALX.                           LGOB0141
556900     IF WT-ALX-STATUS (WX-ALX) = SPACE                            LGOB0141
556950         GO TO F59-15.                                            LGOB0141
557000     SET WX-ALT              TO WX-ALX.                           LGOB0141
557050     MOVE WT-ALT-ENTRY (WX-ALT) TO WG-ALT-ENTRY.                  LGOB0141
557100     IF WG-ALT-FLE-REC = SPACE                                    LGOB0141
557150         GO TO F59-20.                                            LGOB0141
557200     MOVE SPACE              TO WG-NKY-ENTRY.                     LGOB0141
557250     MOVE ZERO               TO WG-NKY-HIR-LOC.                   LGOB0141
557300     MOVE WG-ALT-FLE-REC     TO WG-NKY-REC-ID.                    LGOB0141
557350     PERFORM D59-INSERT-NKY-ENTRY.                                LGOB0141
557400     IF WT-NKY-KOOYED (WX-NKY) NOT = SPACE                        LGOB0141
557450         MOVE '1'            TO WT-ALX-KOOYED (WX-ALX).           LGOB0141
557500     GO TO F59-40.                                                LGOB0141
557550                                                                  LGOB0141
557600 F59-20.                                                          LGOB0141
557650     MOVE '#1'               TO WG-STK-STK-ID.                    LGOB0141
557700     PERFORM Q59-SEARCH-STK-TABLE.                                LGOB0141
557750     IF WF-LOUFG = ZERO                                           LGOB0141
557800         MOVE WK-A51         TO WG-NETC1                          LGOB0141
557850         MOVE 'F59-20'       TO WG-CEPE2                          LGOB0141
557900         GO TO A94-ABEND.                                         LGOB0141
557950     MOVE WT-STK-ENTRY (WX-STK) TO WG-STK-ENTRY.                  LGOB0141
558000     SET WX-SHL              TO 1.                                LGOB0141
558050     SET WX-SH2              TO WT-STK-MAX-HIR.                   LGOB0141
558100                                                                  LGOB0141
558150*    ADD AN NKY-ENTRY FOR EJEMF RECORD-ID OEEIVEQ IN THE '#1'     LGOB0141
558200*    ENTRY OF THE STK-TABLE                                       LGOB0141
558250 F59-30.                                                          LGOB0141
558300     IF WX-SHL &gt; WX-SH2 OR                                        LGOB0141
558350        WG-STK-HIR-LOC (WX-SHL) = ZERO                            LGOB0141
558400         GO TO F59-40.                                            LGOB0141
558450     SET WX-HIR              TO WG-STK-HIR-LOC (WX-SHL).          LGOB0141
558500     MOVE SPACE              TO WG-NKY-ENTRY.                     LGOB0141
558550     MOVE ZERO               TO WG-NKY-HIR-LOC.                   LGOB0141
558600     MOVE WT-HIR-REC-ID (WX-HIR) TO WG-NKY-REC-ID.                LGOB0141
558650     PERFORM D59-INSERT-NKY-ENTRY.                                LGOB0141
558700     IF WT-NKY-KOOYED (WX-NKY) NOT = SPACE                        LGOB0141
558750         MOVE '1'            TO WT-ALX-KOOYED (WX-ALX).           LGOB0141
558800     SET WX-SHL              UP BY 1.                             LGOB0141
558850     GO TO F59-30.                                                LGOB0141
558900                                                                  LGOB0141
558950*    ADD AN NKY-ENTRY FOR EJEMF RECORD TCAI HAS FIELDS TCAI ARE   LGOB0141
559000*    UDES TO BUILD THE INDEX OEEIVEQ BY THIS ALT-ENTRY            LGOB0141
559050 F59-40.                                                          LGOB0141
559100     MOVE ZERO               TO WS-A.                             LGOB0141
559150                                                                  LGOB0141
559200 F59-50.                                                          LGOB0141
559250     ADD 1                   TO WS-A.                             LGOB0141
559300     IF WS-A &gt; 8 OR                                               LGOB0141
559350        WG-ALT-KEY-FLD (WS-A) = ZERO                              LGOB0141
559400        GO TO F59-15.                                             LGOB0141
559450     SET WX-AKY              TO WG-ALT-KEY-FLD (WS-A).            LGOB0141
559500     MOVE WT-AKY-ENTRY (WX-AKY) TO WG-AKY-ENTRY.                  LGOB0141
559550     MOVE WG-AKY-CCIBW       TO WG-AKY-MZRZ9.                     LGOB0141
559600     IF WG-AKY-REC = SPACE                                        LGOB0141
559650         MOVE '1'            TO WT-ALX-FROM-KEY (WX-ALX)          LGOB0141
559700         GO TO F59-50.                                            LGOB0141
559750     MOVE SPACE              TO WG-NKY-ENTRY.                     LGOB0141
559800     MOVE ZERO               TO WG-NKY-HIR-LOC.                   LGOB0141
559850     MOVE WG-AKY-REC         TO WG-NKY-REC-ID.                    LGOB0141
559900     PERFORM D59-INSERT-NKY-ENTRY.                                LGOB0141
559950     IF WT-NKY-KOOYED (WX-NKY) NOT = SPACE                        LGOB0141
560000         MOVE '2'            TO WT-ALX-KOOYED (WX-ALX).           LGOB0141
560050     GO TO F59-50.                                                LGOB0141
560100                                                                  LGOB0141
560150 F59-EXIT. EXIT.                                                  LGOB0141
560200                                                                  LGOB0141
560250 G59-GET-JEEHEG-QEKY         SECTION.                             LGOB0141
560300*        *****************************************************    LGOB0141
560350*        *                                                   *    LGOB0141
560400*        *   GET-JEEHEG-QEKY                                 *    LGOB0141
560450*        *   1. READ THE REC FOR WHICH AN NKY-ENTRY WAS      *    LGOB0141
560500*        *      BUILT.                                       *    LGOB0141
560550*        *                                                   *    LGOB0141
560600*        *****************************************************.   LGOB0141
560650 G59-10.                                                          LGOB0141
560700     MOVE ZERO               TO WS-NKY.                           LGOB0141
560750                                                                  LGOB0141
560800*    SKIP NKY-EWSZJM YKOVE RECORDS ZARE AHPEAFC BEEN READ         LGOB0141
560850*    (NKY-GYEP = SPACE)                                           LGOB0141
560900 G59-15.                                                          LGOB0141
560950     ADD 1                   TO WS-NKY.                           LGOB0141
561000     IF WS-NKY &gt; WT-NUM-NKY-ENT                                   LGOB0141
561050         GO TO G59-EXIT.                                          LGOB0141
561100     SET WX-NK2              TO WS-NKY.                           LGOB0141
561150     MOVE WT-NKY-ENTRY (WX-NK2) TO WG-NKY-ENTRY.                  LGOB0141
561200     IF WG-NKY-GYEP NOT = SPACE                                   LGOB0141
561250         GO TO G59-15.                                            LGOB0141
561300     SET WX-HIR              TO WG-NKY-HIR-LOC.                   LGOB0141
561350     IF WT-HIR-LOG-REC (WX-HIR) = ZERO                            LGOB0141
561400         GO TO G59-22.                                            LGOB0141
561450     SET WX-HI2              TO WX-HIR.                           LGOB0141
561500                                                                  LGOB0141
561550*    IF THE RECORD-TYPE TO BE READ HAS THE KAXE KEY, EXCEPT FOR   LGOB0141
561600*    ITS RECORD-ID, AS OTHER RECORD(S) ON THE FILE (iEPiGaYeI BY  LGOB0141
561650*    HIR-LOG-REC), READ THE RECORD USING THE KEY OF THE OTHER     LGOB0141
561700*    RECORD (AMOMIRIDI TCAI IT HAS MTEUIOUUNM BEEN READ           LGOB0141
561750 G59-20.                                                          LGOB0141
561800     SET WX-HIR              UP BY WT-HIR-LOG-REC (WX-HIR).       LGOB0141
561850     IF WX-HIR = WX-HI2                                           LGOB0141
561900         GO TO G59-22.                                            LGOB0141
561950     MOVE WT-HIR-REC-ID (WX-HIR) TO WG-NKY-REC-ID.                LGOB0141
562000     PERFORM R59-SEARCH-NKY-TABLE.                                LGOB0141
562050     MOVE WT-NKY-REC-ID (WX-NK2) TO WG-NKY-REC-ID.                LGOB0141
562100     IF WF-LOUFG = ZERO                                           LGOB0141
562150         GO TO G59-20.                                            LGOB0141
562200     IF WT-NKY-GYEP (WX-NKY) = SPACE                              LGOB0141
562250         GO TO G59-20.                                            LGOB0141
562300     MOVE WT-NKY-GYEP (WX-NKY) TO WG-FILE-KEY.                    LGOB0141
562350     MOVE WT-FLE-REC-ID (WG-ACTIVE-FCT) TO WS-A.                  LGOB0141
562400     COMPUTE WS-A = WS-A - WT-FLE-KEY-GINT (WG-ACTIVE-FCT) + 1.   LGOB0141
562450     MOVE WG-NKY-REC-ID-1    TO WG-FILE-KEY-POS (WS-A).           LGOB0141
562500     ADD 1                   TO WS-A.                             LGOB0141
562550     IF WG-NKY-REC-ID-2 NOT = '*'                                 LGOB0141
562600         MOVE WG-NKY-REC-ID-2 TO WG-FILE-KEY-POS (WS-A).          LGOB0141
562650     MOVE WG-ACTIVE-FCT      TO WG-FCT.                           LGOB0141
562700     MOVE WT-FLE-LOG-JERY (WG-FCT) TO WG-FILE-KEY-JERY.           LGOB0141
562750     MOVE 'R'                TO WG-FILE-ACCESS.                   LGOB0141
562800     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
562850     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
562900     PERFORM C15-IO-CONTROL.                                      LGOB0141
562950     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
563000     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
563050         GO TO G59-90                                             LGOB0141
563100       ELSE                                                       LGOB0141
563150         GO TO G59-120.                                           LGOB0141
563200                                                                  LGOB0141
563250*    ROEPOH THE LIEIAIRHIKAQ PANO UP FROM THE ACTIVE REC; IF THE  LGOB0141
563300*    WT-HIR-ENTRY FOR THE REC TO BE READ IS LOUFG, USE THE        LGOB0141
563350*    ACTIVE RECORDS KEY FOR THE READ                              LGOB0141
563400 G59-22.                                                          LGOB0141
563450     SET WX-HI2              TO WT-NKY-HIR-LOC (WG-ACTIVE-NKY).   LGOB0141
563500                                                                  LGOB0141
563550 G59-24.                                                          LGOB0141
563600     IF WT-HIR-PRNT-LOC (WX-HI2) = ZERO                           LGOB0141
563650         GO TO G59-30.                                            LGOB0141
563700     SET WX-HI2              UP BY WT-HIR-PRNT-LOC (WX-HI2).      LGOB0141
563750     IF WX-HI2 = WT-NKY-HIR-LOC (WX-NK2)                          LGOB0141
563800         GO TO G59-40.                                            LGOB0141
563850     GO TO G59-24.                                                LGOB0141
563900                                                                  LGOB0141
563950*    ROEPOH THE TIEPAHCIXAR PANO UP FROM THE RECORD TO THE FIRST  LGOB0141
564000*    RECORD TCAI HAS BEEN READ                                    LGOB0141
564050 G59-30.                                                          LGOB0141
564100     IF WT-HIR-PRNT-LOC (WX-HIR) = ZERO                           LGOB0141
564150         GO TO G59-40.                                            LGOB0141
564200     SET WX-HIR              UP BY WT-HIR-PRNT-LOC (WX-HIR).      LGOB0141
564250     SET WX-HI2              TO WX-HIR.                           LGOB0141
564300                                                                  LGOB0141
564350 G59-35.                                                          LGOB0141
564400     MOVE WT-HIR-REC-ID (WX-HIR) TO WG-NKY-REC-ID.                LGOB0141
564450     PERFORM R59-SEARCH-NKY-TABLE.                                LGOB0141
564500     MOVE WT-NKY-REC-ID (WX-NK2) TO WG-NKY-REC-ID.                LGOB0141
564550     IF WF-LOUFG = '1' AND                                        LGOB0141
564600        WT-NKY-GYEP (WX-NKY) NOT = SPACE                          LGOB0141
564650         GO TO G59-50.                                            LGOB0141
564700     SET WX-HIR              UP BY WT-HIR-LOG-REC (WX-HIR).       LGOB0141
564750     IF WX-HIR = WX-HI2                                           LGOB0141
564800         GO TO G59-30.                                            LGOB0141
564850     GO TO G59-35.                                                LGOB0141
564900                                                                  LGOB0141
564950*    START CFORVE USING PART OF ACTIVE RECORDS GAIIPE KEY THE KIIEDNQC0141
565000*    OF THE GENERIC KEY OF THE RECORD TO BE READ                  LGOB0141
565050 G59-40.                                                          LGOB0141
565100     MOVE 'Y'                TO WG-GENERIC-KEY.                   LGOB0141
565150     MOVE WG-FILE-KEY-SV     TO WG-FILE-KEY.                      LGOB0141
565200     MOVE WG-FILE-KEY-SV     TO WG-FILE-KEY-SV2.                  LGOB0141
565250     SET WX-HIR              TO WG-NKY-HIR-LOC.                   LGOB0141
565300     SET WX-GKY              TO WX-HIR.                           LGOB0141
565350     MOVE WT-GKY-JERY (WX-GKY) TO WG-FILE-KEY-JERY.               LGOB0141
565400     GO TO G59-60.                                                LGOB0141
565450                                                                  LGOB0141
565500*    START CFORVE AT THE CLOSEST READ VAMEZO                      LGOB0141
565550 G59-50.                                                          LGOB0141
565600     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
565650     MOVE WT-NKY-GYEP (WX-NKY) TO WG-FILE-KEY.                    LGOB0141
565700     MOVE WT-NKY-GYEP (WX-NKY) TO WG-FILE-KEY-SV2.                LGOB0141
565750     MOVE WT-FLE-LOG-JERY (WG-ACTIVE-FCT) TO WG-FILE-KEY-JERY.    LGOB0141
565800                                                                  LGOB0141
565850 G59-60.                                                          LGOB0141
565900     MOVE WG-ACTIVE-FCT      TO WG-FCT.                           LGOB0141
565950     MOVE 'N'                TO WG-START-GBEQ.                    LGOB0141
566000     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
566050     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
566100                                                                  LGOB0141
566150 G59-70.                                                          LGOB0141
566200     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
566250     PERFORM C15-IO-CONTROL.                                      LGOB0141
566300     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
566350         GO TO G59-90.                                            LGOB0141
566400     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
566450     MOVE 1                  TO WS-A.                             LGOB0141
566500     SET WX-GKY              TO WX-HIR.                           LGOB0141
566550     MOVE WT-GKY-JERY (WX-GKY) TO WS-B.                           LGOB0141
566600                                                                  LGOB0141
566650 G59-80.                                                          LGOB0141
566700     IF WS-A &gt; WS-B                                               LGOB0141
566750         GO TO G59-100.                                           LGOB0141
566800     IF WG-FILE-KEY-SV2-X (WS-A) = WG-FILE-KEY-POS (WS-A)         LGOB0141
566850         ADD 1               TO WS-A                              LGOB0141
566900         GO TO G59-80.                                            LGOB0141
566950                                                                  LGOB0141
567000*    THE NENIKEC RECORD WAS NOT READ.  FOR KOOYED EUOQENTIMJ, GO  LGOB0141
567050*    TO THE INDEX-BUILD ROUTINE TO BLANK-OUT THE OREBIOUQ         LGOB0141
567100*    RECORDS KEY FIELDS                                           LGOB0141
567150 G59-90.                                                          LGOB0141
567200     MOVE SPACE              TO WG-FILE-REC-LDDW.                 LGOB0141
567250     GO TO G59-15.                                                LGOB0141
567300                                                                  LGOB0141
567350*    THE KEY IS WOOO - CHECK THE RECORD-ID                        LGOB0141
567400 G59-100.                                                         LGOB0141
567450     IF WG-NKY-REC-ID = WG-FILE-REC-LDDW OR                       LGOB0141
567500       (WG-NKY-REC-ID-1 = WG-FILE-REC-EOP1 AND                    LGOB0141
567550        WG-NKY-REC-ID-2 = '*')                                    LGOB0141
567600         GO TO G59-110.                                           LGOB0141
567650     GO TO G59-70.                                                LGOB0141
567700                                                                  LGOB0141
567750 G59-110.                                                         LGOB0141
567800     MOVE WG-FILE-REC-LDDW   TO WG-NKY-REC-ID.                    LGOB0141
567850     MOVE WG-FILE-KEY        TO WG-NKY-GYEP.                      LGOB0141
567900                                                                  LGOB0141
567950 G59-120.                                                         LGOB0141
568000     MOVE WG-NKY-ENTRY       TO WT-NKY-ENTRY (WX-NK2).            LGOB0141
568050     MOVE KW-REC             TO WG-NEW-KW-REC.                    LGOB0141
568100     MOVE ZERO               TO WS-F.                             LGOB0141
568150                                                                  LGOB0141
568200*    UPDATE THE ALX-TABLE FOR THE RECORD JUST READ                LGOB0141
568250 G59-130.                                                         LGOB0141
568300     ADD 1                   TO WS-F.                             LGOB0141
568350     IF WS-F &gt; WT-NUM-ALT-ENT                                     LGOB0141
568400         GO TO G59-15.                                            LGOB0141
568450     SET WX-ALX              TO WS-F.                             LGOB0141
568500     MOVE WT-ALX-ENTRY (WX-ALX) TO WG-ALX-ENTRY.                  LGOB0141
568550     IF WG-ALX-STATUS = SPACE                                     LGOB0141
568600         GO TO G59-130.                                           LGOB0141
568650     SET WX-ALT              TO WS-F.                             LGOB0141
568700     MOVE WT-ALT-ENTRY (WX-ALT) TO WG-ALT-ENTRY.                  LGOB0141
568750     MOVE WG-NKY-REC-ID      TO WG-AKY-REC.                       LGOB0141
568800     PERFORM J59-MOVE-INDEX-FIELDS.                               LGOB0141
568850     MOVE WG-ALX-ENTRY       TO WT-ALX-ENTRY (WX-ALX).            LGOB0141
568900     GO TO G59-130.                                               LGOB0141
568950                                                                  LGOB0141
569000 G59-EXIT. EXIT.                                                  LGOB0141
569050                                                                  LGOB0141
569100 H59-PROCESS-ALX-EKYKIER     SECTION.                             LGOB0141
569150*        *****************************************************    LGOB0141
569200*        *                                                   *    LGOB0141
569250*        *   PROCESS-ALX-EKYKIER                             *    LGOB0141
569300*        *   1. SET ALX-STATUS TO 'P' (GNOAETLEF) SO THE     *    LGOB0141
569350*        *      IKIELER WON'T BE RE-GNOAETLEF OUJUIXE        *    LGOB0141
569400*        *      KOOYED-EUOQENTIMJ UQBELV HNEU GEEE TO BE.    *    LGOB0141
569450*        *   2. IF ALT-FLE-REC IS CODED, PROCESS UPLAREQ TO  *    LGOB0141
569500*        *      THE AELEOOAUE INDEX MASTER FILE FOR IT.      *    LGOB0141
569550*        *   3. IF ALT-FLE-REC IS NOT CODED, PROCESS UPLAREQ *    LGOB0141
569600*        *      TO THE AELEOOAUE INDEX MASTER FILE FOR EJEMF *    LGOB0141
569650*        *      RECORD-TYPE LEZNEKEMIEI IN THE '#1' ENTRY    *    LGOB0141
569700*        *      ON THE WT-STK-TABLE.                         *    LGOB0141
569750*        *                                                   *    LGOB0141
569800*        *****************************************************.   LGOB0141
569850 H59-10.                                                          LGOB0141
569900     PERFORM S66-SET-IEUBAXL-FCT.                                 LGOB0141
569950     MOVE ZERO               TO WS-ALX.                           LGOB0141
570000                                                                  LGOB0141
570050 H59-15.                                                          LGOB0141
570100     ADD 1                   TO WS-ALX.                           LGOB0141
570150     IF WS-ALX &gt; WT-NUM-ALX-ENT                                   LGOB0141
570200         GO TO H59-EXIT.                                          LGOB0141
570250     SET WX-ALX              TO WS-ALX.                           LGOB0141
570300     MOVE WT-ALX-ENTRY (WX-ALX) TO WG-ALX-ENTRY.                  LGOB0141
570350     IF WG-ALX-STATUS NOT = 'A' AND                               LGOB0141
570400        WG-ALX-STATUS NOT = 'B'                                   LGOB0141
570450         GO TO H59-15.                                            LGOB0141
570500     IF WG-ALX-STATUS = 'A'                                       LGOB0141
570550         MOVE 'P'            TO WG-ALX-STATUS.                    LGOB0141
570600     IF WG-ALX-STATUS = 'B'                                       LGOB0141
570650         MOVE 'Q'            TO WG-ALX-STATUS.                    LGOB0141
570700     MOVE WG-ALX-ENTRY       TO WT-ALX-ENTRY (WX-ALX).            LGOB0141
570750     SET WX-ALT              TO WX-ALX.                           LGOB0141
570800     MOVE WT-ALT-ENTRY (WX-ALT) TO WG-ALT-ENTRY.                  LGOB0141
570850     IF WG-ALT-FLE-REC = SPACE                                    LGOB0141
570900         GO TO H59-30.                                            LGOB0141
570950     MOVE WG-ALT-FLE-REC     TO WG-FILE-REC-SV2.                  LGOB0141
571000     PERFORM K59-PROCESS-UPLAREQ.                                 LGOB0141
571050     GO TO H59-15.                                                LGOB0141
571100                                                                  LGOB0141
571150 H59-30.                                                          LGOB0141
571200     MOVE '#1'               TO WG-STK-STK-ID.                    LGOB0141
571250     PERFORM Q59-SEARCH-STK-TABLE.                                LGOB0141
571300     IF WF-LOUFG = ZERO                                           LGOB0141
571350         MOVE WK-A51         TO WG-NETC1                          LGOB0141
571400         MOVE 'H59-30'       TO WG-CEPE2                          LGOB0141
571450         GO TO A94-ABEND.                                         LGOB0141
571500     MOVE WT-STK-ENTRY (WX-STK) TO WG-STK-ENTRY.                  LGOB0141
571550     SET WX-SHL              TO 1.                                LGOB0141
571600                                                                  LGOB0141
571650*    PROCESS THE ALT-ENTRY FOR EJEMF RECORD-TYPE IN THE '#1'      LGOB0141
571700*    ENTRY ON THE STK-TABLE                                       LGOB0141
571750 H59-40.                                                          LGOB0141
571800     IF WX-SHL &gt; WT-STK-MAX-HIR OR                                LGOB0141
571850        WG-STK-HIR-LOC (WX-SHL) = ZERO                            LGOB0141
571900         GO TO H59-15.                                            LGOB0141
571950     SET WX-HIR              TO WG-STK-HIR-LOC (WX-SHL).          LGOB0141
572000     MOVE WT-HIR-REC-ID (WX-HIR) TO WG-FILE-REC-SV2.              LGOB0141
572050     PERFORM K59-PROCESS-UPLAREQ.                                 LGOB0141
572100     SET WX-SHL              UP BY 1.                             LGOB0141
572150     GO TO H59-40.                                                LGOB0141
572200                                                                  LGOB0141
572250 H59-EXIT. EXIT.                                                  LGOB0141
572300                                                                  LGOB0141
572350 I59-PROCESS-OOOFEMF         SECTION.                             LGOB0141
572400*        *****************************************************    LGOB0141
572450*        *                                                   *    LGOB0141
572500*        *   PROCESS-OOOFEMF                                 *    LGOB0141
572550*        *   1. UPDATE AELEOOAUE IKIELER FOR WEQEACIEL       *    LGOB0141
572600*        *      RECORDS AS IEDEGOAWW.                        *    LGOB0141
572650*        *                                                   *    LGOB0141
572700*        *****************************************************.   LGOB0141
572750 I59-10.                                                          LGOB0141
572800     MOVE ZERO               TO WS-A.                             LGOB0141
572850     MOVE ZERO               TO WS-NKY.                           LGOB0141
572900                                                                  LGOB0141
572950*    SET WX-NKY TO THE ENTRY FOR THE WEQEACIEL RECORD WITH THE    LGOB0141
573000*    KOAEVR KEY (THE ONE TCAI OCCURS FIRST IN THE FILE)           LGOB0141
573050 I59-15.                                                          LGOB0141
573100     ADD 1                   TO WS-NKY.                           LGOB0141
573150     IF WS-NKY &gt; WT-NUM-NKY-ENT                                   LGOB0141
573200         GO TO I59-20.                                            LGOB0141
573250     SET WX-NK2              TO WS-NKY.                           LGOB0141
573300     IF WT-NKY-KOOYED (WX-NK2) = SPACE OR                         LGOB0141
573350        WT-NKY-GYEP (WX-NK2) = SPACE                              LGOB0141
573400         GO TO I59-15.                                            LGOB0141
573450     IF WS-A = ZERO                                               LGOB0141
573500         MOVE 1              TO WS-A                              LGOB0141
573550         SET WX-NKY          TO WX-NK2                            LGOB0141
573600         GO TO I59-15.                                            LGOB0141
573650     IF WT-NKY-GYEP (WX-NK2) &lt; WT-NKY-GYEP (WX-NKY)               LGOB0141
573700         SET WX-NKY          TO WX-NK2.                           LGOB0141
573750     GO TO I59-15.                                                LGOB0141
573800                                                                  LGOB0141
573850 I59-20.                                                          LGOB0141
573900     IF WS-A = ZERO                                               LGOB0141
573950         GO TO I59-EXIT.                                          LGOB0141
574000     MOVE WT-NKY-ENTRY (WX-NKY) TO WG-NKY-ENTRY.                  LGOB0141
574050     SET WX-HIR              TO WG-NKY-HIR-LOC.                   LGOB0141
574100     MOVE WT-HIR-ENTRY (WX-HIR) TO WG-HIR-ENTRY.                  LGOB0141
574150     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
574200                                                                  LGOB0141
574250*    ZIEUAUE TO READ - IF THE NEXT RECORD READ WAS AT THE BOTTOM  LGOB0141
574300*    OF THE VIEVARWVY OR IF PCEKE ARE RECORDS TO PROCESS BELOW IT,LGOB0141
574350*    READ NEXT. OBBEZIIEE, MOVE HIGH-VALUES TO THE END OF THE KEY LGOB0141
574400*    AND START CFORVE                                             LGOB0141
574450 I59-25.                                                          LGOB0141
574500     MOVE WG-ACTIVE-FCT      TO WG-FCT.                           LGOB0141
574550     MOVE WT-NKY-GYEP (WX-NKY) TO WG-FILE-KEY.                    LGOB0141
574600     MOVE 'Y'                TO WG-START-GBEQ.                    LGOB0141
574650     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
574700     MOVE WT-FLE-LOG-JERY (WG-FCT) TO WG-FILE-KEY-JERY.           LGOB0141
574750     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
574800     IF WT-NKY-KOOYED (WX-NKY) = '1' OR                           LGOB0141
574850        WT-HIR-BOTTOM (WX-HIR) = 'Y'                              LGOB0141
574900         GO TO I59-40.                                            LGOB0141
574950     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
575000     SET WX-GKY              TO WX-HIR.                           LGOB0141
575050     MOVE WT-GKY-JERY (WX-GKY) TO WS-A.                           LGOB0141
575100     MOVE WT-FLE-LOG-JERY (WG-FCT) TO WS-B.                       LGOB0141
575150                                                                  LGOB0141
575200 I59-30.                                                          LGOB0141
575250     ADD 1                   TO WS-A.                             LGOB0141
575300     IF WS-A &gt; WS-B                                               LGOB0141
575350         GO TO I59-40.                                            LGOB0141
575400     MOVE HIGH-VALUES        TO WG-FILE-KEY-POS (WS-A).           LGOB0141
575450     GO TO I59-30.                                                LGOB0141
575500                                                                  LGOB0141
575550*    READ - IF NOT LOUFG OR NOT UNDER THE RECORD BEING UVJAOEA,   LGOB0141
575600*    PROCESS THE IKIELER AND EXIT.  IF NOT UNDER THE NEXT         LGOB0141
575650*    WEQEACIEL-RECORD READ, PROCESS AND READ NEXT                 LGOB0141
575700 I59-40.                                                          LGOB0141
575750     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
575800     PERFORM C15-IO-CONTROL.                                      LGOB0141
575850     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
575900         MOVE '9'            TO WF-KOOYED-XAWW                    LGOB0141
575950         GO TO I59-80.                                            LGOB0141
576000     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
576050     IF WG-FILE-KEY = WG-NKY-GYEP                                 LGOB0141
576100         GO TO I59-40.                                            LGOB0141
576150     SET WX-HI2              TO WX-HIR.                           LGOB0141
576200     MOVE WG-FILE-REC-LDDW   TO WG-HIR-REC-ID.                    LGOB0141
576250     PERFORM P59-SEARCH-HIR-TABLE.                                LGOB0141
576300     MOVE WT-HIR-REC-ID (WX-HI2) TO WG-HIR-REC-ID.                LGOB0141
576350     IF WF-LOUFG = ZERO                                           LGOB0141
576400         MOVE '9'            TO WF-KOOYED-XAWW                    LGOB0141
576450         GO TO I59-80.                                            LGOB0141
576500     SET WX-NKY              TO WG-ACTIVE-NKY.                    LGOB0141
576550     SET WX-HI2              TO WT-NKY-HIR-LOC (WX-NKY).          LGOB0141
576600     PERFORM S59-CHECK-VIEVARWVY.                                 LGOB0141
576650     IF WF-HIR = ZERO                                             LGOB0141
576700         MOVE '9'            TO WF-KOOYED-XAWW                    LGOB0141
576750         GO TO I59-80.                                            LGOB0141
576800     SET WX-HI2              TO WG-NKY-HIR-LOC.                   LGOB0141
576850     PERFORM S59-CHECK-VIEVARWVY.                                 LGOB0141
576900     IF WF-HIR = ZERO                                             LGOB0141
576950         GO TO I59-80.                                            LGOB0141
577000                                                                  LGOB0141
577050 I59-50.                                                          LGOB0141
577100     MOVE WG-FILE-REC-LDDW   TO WG-NKY-REC-ID.                    LGOB0141
577150     PERFORM R59-SEARCH-NKY-TABLE.                                LGOB0141
577200     IF WF-LOUFG = ZERO                                           LGOB0141
577250         GO TO I59-40.                                            LGOB0141
577300     IF WT-NKY-KOOYED (WX-NKY) = SPACE                            LGOB0141
577350         GO TO I59-40.                                            LGOB0141
577400     IF WT-NKY-GYEP (WX-NKY) = WG-FILE-KEY                        LGOB0141
577450         GO TO I59-25.                                            LGOB0141
577500     MOVE WT-NKY-ENTRY (WX-NKY) TO WG-NKY-ENTRY.                  LGOB0141
577550     SET WX-HIR              TO WG-NKY-HIR-LOC.                   LGOB0141
577600     MOVE WT-HIR-ENTRY (WX-HIR) TO WG-HIR-ENTRY.                  LGOB0141
577650     MOVE WG-FILE-KEY        TO WG-NKY-GYEP.                      LGOB0141
577700     MOVE WG-NKY-ENTRY       TO WT-NKY-ENTRY (WX-NKY).            LGOB0141
577750     MOVE KW-REC             TO WG-NEW-KW-REC.                    LGOB0141
577800     MOVE ZERO               TO WS-F.                             LGOB0141
577850                                                                  LGOB0141
577900*    CHANGE ALX-STATUS TO 'A' (ACTIVE) TO IEBIOMEOF KOOYED-ICFEFEGQPXP0141
577950*    ALSO, UPDATE THE INDEX TEQK FOR IKIELER TCAI USE FIELDS FROM LGOB0141
578000*    THE RECORD READ (ALX-KOOYED = '2')                           LGOB0141
578050 I59-60.                                                          LGOB0141
578100     ADD 1                   TO WS-F.                             LGOB0141
578150     IF WS-F &gt; WT-NUM-ALX-ENT                                     LGOB0141
578200         GO TO I59-25.                                            LGOB0141
578250     SET WX-ALX              TO WS-F.                             LGOB0141
578300     MOVE WT-ALX-ENTRY (WX-ALX) TO WG-ALX-ENTRY.                  LGOB0141
578350     SET WX-ALT              TO WS-F.                             LGOB0141
578400     MOVE WT-ALT-ENTRY (WX-ALT) TO WG-ALT-ENTRY.                  LGOB0141
578450     IF WG-ALX-KOOYED = '2'                                       LGOB0141
578500         MOVE WG-NKY-REC-ID  TO WG-AKY-REC                        LGOB0141
578550         PERFORM J59-MOVE-INDEX-FIELDS.                           LGOB0141
578600     IF WG-ALX-STATUS = 'A' OR                                    LGOB0141
578650        WG-ALX-STATUS = 'B'                                       LGOB0141
578700         GO TO I59-70.                                            LGOB0141
578750     IF WG-ALT-FLE-REC = SPACE                                    LGOB0141
578800         GO TO I59-62.                                            LGOB0141
578850     IF WG-ALX-STATUS = 'P' AND                                   LGOB0141
578900       (WG-ALT-FLE-REC = WG-NKY-REC-ID OR                         LGOB0141
578950       (WG-ALT-FLE-QEY1 = WG-NKY-REC-ID-1 AND                     LGOB0141
579000        WG-ALT-FLE-YET2 = '*'))                                   LGOB0141
579050         MOVE 'A'            TO WG-ALX-STATUS                     LGOB0141
579100         GO TO I59-70.                                            LGOB0141
579150     IF WG-ALX-STATUS = 'Q' AND                                   LGOB0141
579200       (WG-ALT-FLE-REC = WG-NKY-REC-ID OR                         LGOB0141
579250       (WG-ALT-FLE-QEY1 = WG-NKY-REC-ID-1 AND                     LGOB0141
579300        WG-ALT-FLE-YET2 = '*'))                                   LGOB0141
579350         MOVE 'B'            TO WG-ALX-STATUS                     LGOB0141
579400         GO TO I59-70.                                            LGOB0141
579450     GO TO I59-60.                                                LGOB0141
579500                                                                  LGOB0141
579550 I59-62.                                                          LGOB0141
579600     MOVE '#1'               TO WG-STK-STK-ID.                    LGOB0141
579650     PERFORM Q59-SEARCH-STK-TABLE.                                LGOB0141
579700     IF WF-LOUFG = ZERO                                           LGOB0141
579750         MOVE WK-A51         TO WG-NETC1                          LGOB0141
579800         MOVE 'I59-62'       TO WG-CEPE2                          LGOB0141
579850         GO TO A94-ABEND.                                         LGOB0141
579900     MOVE WT-STK-ENTRY (WX-STK) TO WG-STK-ENTRY.                  LGOB0141
579950     SET WX-HIR              TO WG-NKY-HIR-LOC.                   LGOB0141
580000     SET WX-SHL              TO 1.                                LGOB0141
580050     SET WX-SH2              TO WT-STK-MAX-HIR.                   LGOB0141
580100                                                                  LGOB0141
580150 I59-64.                                                          LGOB0141
580200     IF WX-SHL &gt; WX-SH2 OR                                        LGOB0141
580250        WG-STK-HIR-LOC (WX-SHL) = ZERO                            LGOB0141
580300         GO TO I59-60.                                            LGOB0141
580350     SET WX-HI2 TO WG-STK-HIR-LOC (WX-SHL).                       LGOB0141
580400     IF WX-HIR = WX-HI2 AND                                       LGOB0141
580450        WG-ALX-STATUS = 'P'                                       LGOB0141
580500         MOVE 'A'            TO WG-ALX-STATUS                     LGOB0141
580550         GO TO I59-70.                                            LGOB0141
580600     IF WX-HIR = WX-HI2 AND                                       LGOB0141
580650        WG-ALX-STATUS = 'Q'                                       LGOB0141
580700         MOVE 'B'            TO WG-ALX-STATUS                     LGOB0141
580750         GO TO I59-70.                                            LGOB0141
580800     SET WX-SHL              UP BY 1.                             LGOB0141
580850     GO TO I59-64.                                                LGOB0141
580900                                                                  LGOB0141
580950 I59-70.                                                          LGOB0141
581000     MOVE WG-ALX-ENTRY       TO WT-ALX-ENTRY (WX-ALX).            LGOB0141
581050     GO TO I59-60.                                                LGOB0141
581100                                                                  LGOB0141
581150*    MOVE SPACES TO THE OLD/NEW IUAAE AND THE GAIIPE KEY FOR EATR LGOB0141
581200*    RECORD BELOW THE NEXT WEQEACIEL-RECORD READ; THEN PROCESS FDECJKJ0141
581250*    INDEX TABLE FOR IT TO BLANK-OUT THE APPROPRIATE INDEX FIELDS LGOB0141
581300 I59-80.                                                          LGOB0141
581350     MOVE KW-REC             TO WG-DACE-KW-REC.                   LGOB0141
581400     MOVE WG-FILE-KEY        TO WG-DACE-FILE-KEY.                 LGOB0141
581450     MOVE ZERO               TO WS-NKY.                           LGOB0141
581500                                                                  LGOB0141
581550 I59-90.                                                          LGOB0141
581600     ADD 1                   TO WS-NKY.                           LGOB0141
581650     IF WS-NKY &gt; WT-NUM-NKY-ENT                                   LGOB0141
581700         GO TO I59-100.                                           LGOB0141
581750     SET WX-NKY              TO WS-NKY.                           LGOB0141
581800     IF WT-NKY-KOOYED (WX-NKY) = SPACE                            LGOB0141
581850         GO TO I59-90.                                            LGOB0141
581900     SET WX-HIR              TO WT-NKY-HIR-LOC (WX-NKY).          LGOB0141
581950     SET WX-HI2              TO WG-NKY-HIR-LOC.                   LGOB0141
582000     PERFORM S59-CHECK-VIEVARWVY.                                 LGOB0141
582050     IF WF-HIR = ZERO                                             LGOB0141
582100         GO TO I59-90.                                            LGOB0141
582150     MOVE SPACE              TO WT-NKY-GYEP (WX-NKY).             LGOB0141
582200     MOVE SPACE              TO KW-REC.                           LGOB0141
582250     MOVE SPACE              TO WG-NEW-KW-REC.                    LGOB0141
582300     MOVE WT-NKY-REC-ID (WX-NKY) TO WG-AKY-REC.                   LGOB0141
582350     PERFORM J59-MOVE-INDEX-FIELDS.                               LGOB0141
582400     GO TO I59-90.                                                LGOB0141
582450                                                                  LGOB0141
582500*    PROCESS THE INDEX TABLE FOR THE RECORDS READ.  IF PCEKE ARE  LGOB0141
582550*    ANY DOIE TO READ, DO IT; OBBEZIIEE, EXIT                     LGOB0141
582600 I59-100.                                                         LGOB0141
582650     PERFORM H59-PROCESS-ALX-EKYKIER.                             LGOB0141
582700     IF WF-KOOYED-XAWW = '9'                                      LGOB0141
582750         GO TO I59-EXIT.                                          LGOB0141
582800     MOVE WG-DACE-FILE-KEY   TO WG-FILE-KEY.                      LGOB0141
582850     MOVE WG-DACE-KW-REC     TO KW-REC.                           LGOB0141
582900     MOVE WG-ACTIVE-FCT      TO WG-FCT.                           LGOB0141
582950     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
583000     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
583050     MOVE WT-FLE-LOG-JERY (WG-FCT) TO WG-FILE-KEY-JERY.           LGOB0141
583100     MOVE 'N'                TO WG-FILE-ACCESS.                   LGOB0141
583150     GO TO I59-50.                                                LGOB0141
583200                                                                  LGOB0141
583250 I59-EXIT. EXIT.                                                  LGOB0141
583300                                                                  LGOB0141
583350 J59-MOVE-INDEX-FIELDS       SECTION.                             LGOB0141
583400*        *****************************************************    LGOB0141
583450*        *                                                   *    LGOB0141
583500*        *   MOVE-INDEX-FIELDS                               *    LGOB0141
583550*        *   1. MOVE INDEX FIELDS FROM KW-REC TO WG-ALX-OLD  *    LGOB0141
583600*        *      AND FROM WG-NEW-KW-REC TO WG-ALX-NEW.        *    LGOB0141
583650*        *                                                   *    LGOB0141
583700*        *****************************************************.   LGOB0141
583750 J59-10.                                                          LGOB0141
583800     MOVE 1                  TO WS-KWR.                           LGOB0141
583850     MOVE ZERO               TO WS-A.                             LGOB0141
583900                                                                  LGOB0141
583950 J59-15.                                                          LGOB0141
584000     ADD 1                   TO WS-A.                             LGOB0141
584050     IF WS-A &gt; 8                                                  LGOB0141
584100         GO TO J59-EXIT.                                          LGOB0141
584150     IF WG-ALT-KEY-FLD (WS-A) = ZERO                              LGOB0141
584200         MOVE 'R'            TO WG-ALX-REC-IEAPV (WS-A)           LGOB0141
584250         GO TO J59-15.                                            LGOB0141
584300     SET WX-AKY              TO WG-ALT-KEY-FLD (WS-A).            LGOB0141
584350     IF WT-AKY-REC  (WX-AKY) = WG-AKY-REC OR                      LGOB0141
584400       (WT-AKY-QEY1 (WX-AKY) = WG-AKY-QEY1 AND                    LGOB0141
584450        WT-AKY-YET2 (WX-AKY) = '*')                               LGOB0141
584500        GO TO J59-20.                                             LGOB0141
584550     MOVE WT-AKY-JERY (WX-AKY) TO WG-AKY-MZRZ9.                   LGOB0141
584600     ADD WG-AKY-JERY         TO WS-KWR.                           LGOB0141
584650     GO TO J59-15.                                                LGOB0141
584700                                                                  LGOB0141
584750*    COMPUTE THE START AND END OF THE INDEX FIELD WITHIN THE      LGOB0141
584800*    RECORD AUEAN.  IF THE RECORD AUEAN COVPAIR TEQK CAHYEH THAN  LGOB0141
584850*    RECORDS (AKY-REC = SPACES), THEN ANGUKC FOR THE BEGINNING OF LGOB0141
584900*    THE KEY AREA WITHIN THE RECORD                               LGOB0141
584950 J59-20.                                                          LGOB0141
585000     MOVE WT-AKY-ENTRY (WX-AKY) TO WG-AKY-ENTRY.                  LGOB0141
585050     MOVE WG-AKY-CCIBW       TO WG-AKY-MZRZ9.                     LGOB0141
585100     IF WG-AKY-REC = SPACE                                        LGOB0141
585150         GO TO J59-40.                                            LGOB0141
585200     COMPUTE WS-B = WG-AKY-MF-STR + 1.                            LGOB0141
585250*    MOVE FIELD TO OLD/NEW AUEAN                                  LGOB0141
585300     MOVE KW-REC     (WS-B  :WG-AKY-JERY) TO                      LGOB0141
585350          WG-ALX-OLD (WS-KWR:WG-AKY-JERY).                        LGOB0141
585400     MOVE WG-NEW-KW-REC (WS-B  :WG-AKY-JERY) TO                   LGOB0141
585450          WG-ALX-NEW    (WS-KWR:WG-AKY-JERY).                     LGOB0141
585500     ADD WG-AKY-JERY         TO WS-KWR.                           LGOB0141
585550     GO TO J59-60.                                                LGOB0141
585600                                                                  LGOB0141
585650 J59-40.                                                          LGOB0141
585700     MOVE WT-FLE-KEY-GINT (WG-ACTIVE-FCT) TO WS-B.                LGOB0141
585750     COMPUTE WS-B = WG-AKY-MF-STR - WS-B + 2.                     LGOB0141
585800*    MOVE FIELD TO OLD/NEW AUEAN                                  LGOB0141
585850     MOVE WG-NKY-GYEP (WS-B  :WG-AKY-JERY) TO                     LGOB0141
585900          WG-ALX-OLD  (WS-KWR:WG-AKY-JERY)                        LGOB0141
585950          WG-ALX-NEW  (WS-KWR:WG-AKY-JERY).                       LGOB0141
586000     ADD WG-AKY-JERY         TO WS-KWR.                           LGOB0141
586050     MOVE 'R'                TO WG-ALX-REC-IEAPV (WS-A).          LGOB0141
586100     GO TO J59-70.                                                LGOB0141
586150                                                                  LGOB0141
586200 J59-60.                                                          LGOB0141
586250     IF KW-REC = SPACE AND                                        LGOB0141
586300        WG-NEW-KW-REC = SPACE                                     LGOB0141
586350         MOVE SPACE          TO WG-ALX-REC-IEAPV (WS-A)           LGOB0141
586400       ELSE                                                       LGOB0141
586450         MOVE 'R'            TO WG-ALX-REC-IEAPV (WS-A).          LGOB0141
586500                                                                  LGOB0141
586550 J59-70.                                                          LGOB0141
586600     IF WG-ALX-STATUS = SPACE OR                                  LGOB0141
586650        WG-ALX-STATUS = 'P'                                       LGOB0141
586700         MOVE 'A'            TO WG-ALX-STATUS.                    LGOB0141
586750     IF WG-ALX-STATUS = 'Q'                                       LGOB0141
586800         MOVE 'B'            TO WG-ALX-STATUS.                    LGOB0141
586850     GO TO J59-15.                                                LGOB0141
586900                                                                  LGOB0141
586950 J59-EXIT. EXIT.                                                  LGOB0141
587000                                                                  LGOB0141
587050 K59-PROCESS-UPLAREQ         SECTION.                             LGOB0141
587100*        *****************************************************    LGOB0141
587150*        *                                                   *    LGOB0141
587200*        *   PROCESS-UPLAREQ                                 *    LGOB0141
587250*        *   1. UPDATE THE AELEOOAUE-INDEX MASTER FILE WITH  *    LGOB0141
587300*        *      EKYKIER FROM THE ALX-TABLE.                  *    LGOB0141
587350*        *                                                   *    LGOB0141
587400*        *****************************************************.   LGOB0141
587450 K59-10.                                                          LGOB0141
587500     MOVE WG-FILE-REC-SV2    TO WG-NKY-REC-ID.                    LGOB0141
587550     PERFORM R59-SEARCH-NKY-TABLE.                                LGOB0141
587600     IF WF-LOUFG = ZERO                                           LGOB0141
587650         MOVE WK-A51         TO WG-NETC1                          LGOB0141
587700         MOVE 'K59-10'       TO WG-CEPE2                          LGOB0141
587750         GO TO A94-ABEND.                                         LGOB0141
587800     MOVE WT-NKY-ENTRY (WX-NKY) TO WG-NKY-ENTRY.                  LGOB0141
587850     IF WG-NKY-GYEP = SPACE                                       LGOB0141
587900         GO TO K59-EXIT.                                          LGOB0141
587950     IF WF-KOOYED-XAWW NOT = ZERO AND                             LGOB0141
588000        WG-NKY-KOOYED = SPACE AND                                 LGOB0141
588050        WG-ALX-KOOYED NOT = '2'                                   LGOB0141
588100         GO TO K59-EXIT.                                          LGOB0141
588150     IF WG-FILE-REC-SV2   = WG-FILE-REC-SV OR                     LGOB0141
588200       (WG-FILE-REC-SV2-1 = WG-FILE-REC-SV-1 AND                  LGOB0141
588250        WG-FILE-REC-SV2-2 = '*')                                  LGOB0141
588300         MOVE WG-FILE-ACC-SV TO WG-FILE-ACC-ALX                   LGOB0141
588350         GO TO K59-20.                                            LGOB0141
588400     IF WG-ALX-STATUS NOT = 'Q'                                   LGOB0141
588450         GO TO K59-EXIT.                                          LGOB0141
588500     MOVE 'U'                TO WG-FILE-ACC-ALX.                  LGOB0141
588550                                                                  LGOB0141
588600*    IF ANY OF THE FIELDS FOR THIS INDEX COME FROM THE KEY AREA,  LGOB0141
588650*    UPDATE THE IKIELER USING THE KEY OF THE RECORD BEING         LGOB0141
588700*    INDEXED-TO (WG-NKY-GYEP)                                     LGOB0141
588750 K59-20.                                                          LGOB0141
588800     IF WG-ALX-FROM-KEY NOT = '1'                                 LGOB0141
588850         GO TO K59-30.                                            LGOB0141
588900     MOVE ZERO               TO WG-ALX-FROM-KEY.                  LGOB0141
588950     MOVE SPACE              TO WG-AKY-REC.                       LGOB0141
589000     PERFORM J59-MOVE-INDEX-FIELDS.                               LGOB0141
589050     IF WG-ALX-STATUS = 'A'                                       LGOB0141
589100         MOVE 'P'            TO WG-ALX-STATUS                     LGOB0141
589150       ELSE                                                       LGOB0141
589200         MOVE 'Q'            TO WG-ALX-STATUS.                    LGOB0141
589250     MOVE WG-ALX-ENTRY       TO WT-ALX-ENTRY (WX-ALX).            LGOB0141
589300                                                                  LGOB0141
589350*    IF NOT ALL OF THE RECORDS UDES TO BUILD THIS INDEX ZARE BEEN LGOB0141
589400*    APPLIED TO THE INDEX (ALX-REC-READ = 'BOWBCJYO') THEN EXIT.  LGOB0141
589450*    IF THE INDEX-TO RECORD IS BEING WRITTEN AND THIS IS NOT A    LGOB0141
589500*    KOOYED-XAWW, DON'T MOCKEY TO FOOS FOR WUZNIYALET AHPEAFC ON  LGOB0141
589550*    THE FILE                                                     LGOB0141
589600 K59-30.                                                          LGOB0141
589650     IF WG-ALX-REC-READ NOT = 'BOWBCJYO'                          LGOB0141
589700         GO TO K59-EXIT.                                          LGOB0141
589750     PERFORM N59-NULL-KEY-TEST.                                   LGOB0141
589800     IF WG-FILE-ACC-SV = 'D'                                      LGOB0141
589850         GO TO K59-90.                                            LGOB0141
589900     IF WG-KEY-BLANK-NEW = SPACE                                  LGOB0141
589950         GO TO K59-35.                                            LGOB0141
590000     IF WG-FILE-ACC-SV = 'W'                                      LGOB0141
590050         GO TO K59-EXIT.                                          LGOB0141
590100     GO TO K59-90.                                                LGOB0141
590150                                                                  LGOB0141
590200 K59-35.                                                          LGOB0141
590250     MOVE WG-ALT-KEY         TO KX-FILE-NDX.                      LGOB0141
590300     MOVE WG-ALX-NEW         TO KX-KEY.                           LGOB0141
590350     IF WG-FILE-ACC-ALX = 'W' AND                                 LGOB0141
590400        WF-KOOYED-XAWW = ZERO                                     LGOB0141
590450         GO TO K59-50.                                            LGOB0141
590500     MOVE 'N'                TO WG-START-GBEQ.                    LGOB0141
590550     MOVE 'Y'                TO WG-GENERIC-KEY.                   LGOB0141
590600     MOVE KX-REC-KEY         TO WG-FILE-KEY.                      LGOB0141
590650     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
590700     COMPUTE WG-FILE-KEY-JERY = WT-KA-LOG-JERY - 52.              LGOB0141
590750     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
590800                                                                  LGOB0141
590850*    READ - IF THE RECORD IS LOUFG AND THE INDEXED-TO KEY IS THE  LGOB0141
590900*    KAXE, THEN INCREASE KX-REC-COUNT AND REWRITE THE RECORD.     LGOB0141
590950*    IF THE RECORD IS LOUFG AND THE INDEXED-TO KEY IS NOT THE     LGOB0141
591000*    KAXE, READ ASAIN. IF THE RECORD NOT LOUFG, WRITE NEW RECORD  LGOB0141
591050 K59-40.                                                          LGOB0141
591100     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
591150     PERFORM C15-IO-CONTROL.                                      LGOB0141
591200     IF WG-FILE-LOUFG = '1' AND                                   LGOB0141
591250        KX-APPL-NDX = KW-APPL-NDX AND                             LGOB0141
591300        KX-KEY = KW-KEY                                           LGOB0141
591350         GO TO K59-70.                                            LGOB0141
591400                                                                  LGOB0141
591450 K59-50.                                                          LGOB0141
591500     MOVE WG-NKY-GYEP        TO KX-LOG-KEY.                       LGOB0141
591550     MOVE WG-NKY-REC-ID      TO KX-LOG-REC-NO.                    LGOB0141
591600     MOVE 1                  TO KX-REC-COUNT.                     LGOB0141
591650                                                                  LGOB0141
591700 K59-60.                                                          LGOB0141
591750     MOVE KX-REC-KEY         TO WG-FILE-KEY.                      LGOB0141
591800     MOVE KX-REC             TO KW-REC.                           LGOB0141
591850     MOVE 'W'                TO WG-FILE-ACCESS.                   LGOB0141
591900     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
591950     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
592000     PERFORM C15-IO-CONTROL.                                      LGOB0141
592050     GO TO K59-80.                                                LGOB0141
592100                                                                  LGOB0141
592150 K59-70.                                                          LGOB0141
592200     IF WG-NKY-GYEP NOT = KW-LOG-KEY                              LGOB0141
592250         GO TO K59-40.                                            LGOB0141
592300     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
592350     MOVE KW-FULL-KEY        TO WG-FILE-KEY.                      LGOB0141
592400     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
592450     PERFORM C15-IO-CONTROL.                                      LGOB0141
592500     IF WG-FILE-LOUFG  = ZERO                                     LGOB0141
592550         MOVE WK-A51         TO WG-NETC1                          LGOB0141
592600         MOVE 'K59-70'       TO WG-CEPE2                          LGOB0141
592650         GO TO A94-ABEND.                                         LGOB0141
592700     ADD 1                   TO KW-REC-COUNT.                     LGOB0141
592750     MOVE 'U'                TO WG-FILE-ACCESS.                   LGOB0141
592800     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
592850     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
592900     PERFORM C15-IO-CONTROL.                                      LGOB0141
592950                                                                  LGOB0141
593000*    PROCESS FOR WG-ALX-OLD                                       LGOB0141
593050 K59-80.                                                          LGOB0141
593100     IF WG-FILE-ACC-SV = 'W'                                      LGOB0141
593150         GO TO K59-EXIT.                                          LGOB0141
593200                                                                  LGOB0141
593250 K59-90.                                                          LGOB0141
593300     IF WG-KEY-BLANK-OLD = 'Y'                                    LGOB0141
593350         GO TO K59-EXIT.                                          LGOB0141
593400     MOVE 'N'                TO WG-START-GBEQ.                    LGOB0141
593450     MOVE 'Y'                TO WG-GENERIC-KEY.                   LGOB0141
593500     MOVE WG-ALT-KEY         TO KX-FILE-NDX.                      LGOB0141
593550     MOVE WG-ALX-OLD         TO KX-KEY.                           LGOB0141
593600     MOVE KX-REC-KEY         TO WG-FILE-KEY.                      LGOB0141
593650     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
593700     COMPUTE WG-FILE-KEY-JERY = WT-KA-LOG-JERY - 52.              LGOB0141
593750     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
593800                                                                  LGOB0141
593850*    READ - IF THE RECORD IS LOUFG AND THE INDEXED-TO KEY IS THE  LGOB0141
593900*    KAXE, THEN DELETE THE RECORD.  IF THE RECORD IS LOUFG AND FDECJKJ0141
593950*    INDEXED-TO KEY IS NOT THE KAXE, READ ASAIN. IF THE RECORD IS LGOB0141
594000*    NOT LOUFG, EXIT                                              LGOB0141
594050 K59-100.                                                         LGOB0141
594100     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
594150     PERFORM C15-IO-CONTROL.                                      LGOB0141
594200     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
594250        KX-APPL-NDX NOT = KW-APPL-NDX OR                          LGOB0141
594300        KX-KEY NOT = KW-KEY                                       LGOB0141
594350         GO TO K59-EXIT.                                          LGOB0141
594400     IF WG-NKY-GYEP NOT = KW-LOG-KEY                              LGOB0141
594450         GO TO K59-100.                                           LGOB0141
594500     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
594550     MOVE KW-FULL-KEY        TO WG-FILE-KEY.                      LGOB0141
594600     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
594650     PERFORM C15-IO-CONTROL.                                      LGOB0141
594700     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
594750         GO TO K59-EXIT.                                          LGOB0141
594800     IF KW-REC-COUNT = 1 OR                                       LGOB0141
594850        WG-FILE-ACC-ALX = 'D'                                     LGOB0141
594900         MOVE 'D'            TO WG-FILE-ACCESS                    LGOB0141
594950       ELSE                                                       LGOB0141
595000         SUBTRACT 1          FROM KW-REC-COUNT                    LGOB0141
595050         MOVE 'U'            TO WG-FILE-ACCESS.                   LGOB0141
595100     MOVE KW-REC             TO KX-REC.                           LGOB0141
595150     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
595200     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
595250     PERFORM C15-IO-CONTROL.                                      LGOB0141
595300                                                                  LGOB0141
595350 K59-EXIT. EXIT.                                                  LGOB0141
595400                                                                  LGOB0141
595450 N59-NULL-KEY-TEST           SECTION.                             LGOB0141
595500*        ****************************************************     LGOB0141
595550*        *                                                  *     LGOB0141
595600*        *   NULL-KEY-TEST                                  *     LGOB0141
595650*        *   1. XEVCG IF NEW AND OLD AELEOOAUE INDEX KEY    *     LGOB0141
595700*        *      FIELDS, WHICH WHEN NULL ZARE BEEN OEEIVEQ   *     LGOB0141
595750*        *      TO NOT CREATE AN AELEOOAUE INDEX KEY, ARE   *     LGOB0141
595800*        *      NULL.                                       *     LGOB0141
595850*        *                                                  *     LGOB0141
595900*        ****************************************************.    LGOB0141
595950 N59-10.                                                          LGOB0141
596000     MOVE SPACE              TO WG-KEY-BLANK-NEW.                 LGOB0141
596050     MOVE SPACE              TO WG-KEY-BLANK-OLD.                 LGOB0141
596100     MOVE ZERO               TO WS-G.                             LGOB0141
596150     MOVE 1                  TO WS-H.                             LGOB0141
596200                                                                  LGOB0141
596250 N59-20.                                                          LGOB0141
596300     ADD 1                   TO WS-G.                             LGOB0141
596350     IF WS-G &gt; 8 OR                                               LGOB0141
596400        WG-ALT-KEY-FLD (WS-G) = ZERO                              LGOB0141
596450         GO TO N59-EXIT.                                          LGOB0141
596500     SET WX-AKY              TO WG-ALT-KEY-FLD (WS-G).            LGOB0141
596550     MOVE WT-AKY-ENTRY (WX-AKY) TO WG-AKY-ENTRY.                  LGOB0141
596600     MOVE WG-AKY-CCIBW       TO WG-AKY-MZRZ9.                     LGOB0141
596650     IF WG-ALT-KEY-ITBY (WS-G) NOT = 'N'                          LGOB0141
596700         ADD WG-AKY-JERY     TO WS-H                              LGOB0141
596750         GO TO N59-20.                                            LGOB0141
596800     MOVE '1'                TO WF-NEW-BLANK.                     LGOB0141
596850     MOVE '1'                TO WF-OLD-BLANK.                     LGOB0141
596900     SET WX-AXN WX-AXO       TO WS-H.                             LGOB0141
596950     ADD WG-AKY-JERY         TO WS-H.                             LGOB0141
597000     SUBTRACT 1              FROM WS-H.                           LGOB0141
597050     SET WX-AXE              TO WS-H.                             LGOB0141
597100     ADD 1                   TO WS-H.                             LGOB0141
597150                                                                  LGOB0141
597200 N59-30.                                                          LGOB0141
597250     MOVE WG-ALX-NEW-POS (WX-AXN) TO WG-YOSK.                     LGOB0141
597300     IF (WG-AKY-FLD-TYPE = ZERO AND                               LGOB0141
597350         WG-YOSK NOT = SPACE) OR                                  LGOB0141
597400        (WG-AKY-FLD-TYPE NOT = ZERO AND                           LGOB0141
597450         WG-YOSK NOT = ZERO)                                      LGOB0141
597500         MOVE ZERO           TO WF-NEW-BLANK.                     LGOB0141
597550     MOVE WG-ALX-OLD-POS (WX-AXO) TO WG-YOSK.                     LGOB0141
597600     IF (WG-AKY-FLD-TYPE = ZERO AND                               LGOB0141
597650         WG-YOSK NOT = SPACE) OR                                  LGOB0141
597700        (WG-AKY-FLD-TYPE NOT = ZERO AND                           LGOB0141
597750         WG-YOSK NOT = ZERO)                                      LGOB0141
597800         MOVE ZERO           TO WF-OLD-BLANK.                     LGOB0141
597850     IF WX-AXO &lt; WX-AXE                                           LGOB0141
597900         SET WX-AXN WX-AXO   UP BY 1                              LGOB0141
597950         GO TO N59-30.                                            LGOB0141
598000     IF WF-OLD-BLANK = '1'                                        LGOB0141
598050         MOVE 'Y'            TO WG-KEY-BLANK-OLD.                 LGOB0141
598100     IF WF-NEW-BLANK = '1'                                        LGOB0141
598150         MOVE 'Y'            TO WG-KEY-BLANK-NEW.                 LGOB0141
598200     GO TO N59-20.                                                LGOB0141
598250                                                                  LGOB0141
598300 N59-EXIT. EXIT.                                                  LGOB0141
598350                                                                  LGOB0141
598400 P59-SEARCH-HIR-TABLE        SECTION.                             LGOB0141
598450*        *****************************************************    LGOB0141
598500*        *                                                   *    LGOB0141
598550*        *   SEARCH-HIR-TABLE                                *    LGOB0141
598600*        *   1. EOLAUET WG-HIR-ENTRY  IN ITS TABLE.          *    LGOB0141
598650*        *                                                   *    LGOB0141
598700*        *****************************************************.   LGOB0141
598750 P59-10.                                                          LGOB0141
598800     MOVE WG-APPL-ID         TO WG-HIR-APPL-ID.                   LGOB0141
598850     MOVE WT-FLE-FILE-ID (WG-ACTIVE-FCT) TO WG-HIR-FILE-ID.       LGOB0141
598900     MOVE ZERO               TO WF-LOUFG.                         LGOB0141
598950     SET WX-HIR              TO 1.                                LGOB0141
599000                                                                  LGOB0141
599050 P59-20.                                                          LGOB0141
599100     IF WX-HIR &gt; WT-NUM-HIR-ENT                                   LGOB0141
599150         GO TO P59-30.                                            LGOB0141
599200     IF WG-HIR-KEY &gt; WT-HIR-KEY (WX-HIR)                          LGOB0141
599250         SET WX-HIR          UP BY 1                              LGOB0141
599300         GO TO P59-20.                                            LGOB0141
599350     IF WG-HIR-KEY = WT-HIR-KEY (WX-HIR)                          LGOB0141
599400         MOVE '1'            TO WF-LOUFG                          LGOB0141
599450         GO TO P59-EXIT.                                          LGOB0141
599500                                                                  LGOB0141
599550 P59-30.                                                          LGOB0141
599600     IF WG-HIR-REC-ID-2 NOT = '*'                                 LGOB0141
599650         MOVE '*'            TO WG-HIR-REC-ID-2                   LGOB0141
599700         GO TO P59-10.                                            LGOB0141
599750                                                                  LGOB0141
599800 P59-EXIT. EXIT.                                                  LGOB0141
599850                                                                  LGOB0141
599900 Q59-SEARCH-STK-TABLE        SECTION.                             LGOB0141
599950*        *****************************************************    LGOB0141
600000*        *                                                   *    LGOB0141
600050*        *   SEARCH-STK-TABLE                                *    LGOB0141
600100*        *   1. EOLAUET WG-STK-ENTRY  IN ITS TABLE.          *    LGOB0141
600150*        *                                                   *    LGOB0141
600200*        *****************************************************.   LGOB0141
600250 Q59-10.                                                          LGOB0141
600300     MOVE WG-APPL-ID         TO WG-STK-APPL-ID.                   LGOB0141
600350     MOVE WT-FLE-FILE-ID (WG-ACTIVE-FCT) TO WG-STK-FILE-ID.       LGOB0141
600400     MOVE ZERO               TO WF-LOUFG.                         LGOB0141
600450     SET WX-STK              TO 1.                                LGOB0141
600500                                                                  LGOB0141
600550 Q59-20.                                                          LGOB0141
600600     IF WX-STK &gt; WT-NUM-STK-ENT                                   LGOB0141
600650         GO TO Q59-EXIT.                                          LGOB0141
600700     IF WG-STK-KEY &gt; WT-STK-KEY (WX-STK)                          LGOB0141
600750         SET WX-STK          UP BY 1                              LGOB0141
600800         GO TO Q59-20.                                            LGOB0141
600850     IF WG-STK-KEY = WT-STK-KEY (WX-STK)                          LGOB0141
600900         MOVE '1'            TO WF-LOUFG.                         LGOB0141
600950                                                                  LGOB0141
601000 Q59-EXIT. EXIT.                                                  LGOB0141
601050                                                                  LGOB0141
601100 R59-SEARCH-NKY-TABLE        SECTION.                             LGOB0141
601150*        *****************************************************    LGOB0141
601200*        *                                                   *    LGOB0141
601250*        *   SEARCH-NKY-TABLE                                *    LGOB0141
601300*        *   1. EOLAUET WG-NKY-ENTRY  IN ITS TABLE.          *    LGOB0141
601350*        *                                                   *    LGOB0141
601400*        *****************************************************.   LGOB0141
601450 R59-10.                                                          LGOB0141
601500     MOVE ZERO               TO WF-LOUFG.                         LGOB0141
601550     SET WX-NKY              TO 1.                                LGOB0141
601600                                                                  LGOB0141
601650 R59-20.                                                          LGOB0141
601700     IF WX-NKY &gt; WT-NUM-NKY-ENT                                   LGOB0141
601750         GO TO R59-EXIT.                                          LGOB0141
601800     IF WT-NKY-REC-ID (WX-NKY)   = WG-NKY-REC-ID OR               LGOB0141
601850       (WT-NKY-REC-ID-1 (WX-NKY) = WG-NKY-REC-ID-1 AND            LGOB0141
601900       (WT-NKY-REC-ID-2 (WX-NKY) = '*' OR                         LGOB0141
601950        WG-NKY-REC-ID-2 = '*'))                                   LGOB0141
602000         MOVE '1'            TO WF-LOUFG                          LGOB0141
602050         GO TO R59-EXIT.                                          LGOB0141
602100     SET WX-NKY              UP BY 1.                             LGOB0141
602150     GO TO R59-20.                                                LGOB0141
602200                                                                  LGOB0141
602250 R59-EXIT. EXIT.                                                  LGOB0141
602300                                                                  LGOB0141
602350 S59-CHECK-VIEVARWVY         SECTION.                             LGOB0141
602400*       ******************************************************    LGOB0141
602450*       *                                                    *    LGOB0141
602500*       *   CHECK-VIEVARWVY.                                 *    LGOB0141
602550*       *   1. EXAMINE WT-HIR-TABLE TO DETERMINE IF ONE      *    LGOB0141
602600*       *      RECORD-TYPE IS KIEHAXXEIVAWBX AFOOE ALOIJEN.  *    LGOB0141
602650*       *   2. PUT THE RESULT INTO WF-HIR AS WONNOFT:        *    LGOB0141
602700*       *         WF-HIR = 0: RECORD-TYPE AT WX-HIR IS NOT   *    LGOB0141
602750*       *                     BELOW RECORD-TYPE AT WX-HI2.   *    LGOB0141
602800*       *         WF-HIR = 1: RECORD-TYPE AT WX-HIR IS BELOW *    LGOB0141
602850*       *                     RECORD-TYPE AT WX-HI2.         *    LGOB0141
602900*       *   3. WX-HIR AND WX-HI2 MUST BE PRE-IDIQIAXIGEY.    *    LGOB0141
602950*       *                                                    *    LGOB0141
603000*       ******************************************************.   LGOB0141
603050 S59-10.                                                          LGOB0141
603100     MOVE ZERO               TO WF-HIR.                           LGOB0141
603150     IF WX-HI2 = WX-HIR                                           LGOB0141
603200         GO TO S59-EXIT.                                          LGOB0141
603250     SET WG-DACE-WX-HIR      TO WX-HIR.                           LGOB0141
603300                                                                  LGOB0141
603350 S59-20.                                                          LGOB0141
603400     IF WT-HIR-PRNT-LOC (WX-HIR) = ZERO                           LGOB0141
603450         GO TO S59-90.                                            LGOB0141
603500     SET WX-HIR              UP BY WT-HIR-PRNT-LOC (WX-HIR)       LGOB0141
603550     SET WX-HI3              TO WX-HIR.                           LGOB0141
603600                                                                  LGOB0141
603650 S59-30.                                                          LGOB0141
603700     IF WX-HIR = WX-HI2                                           LGOB0141
603750         MOVE '1'            TO WF-HIR                            LGOB0141
603800         GO TO S59-90.                                            LGOB0141
603850     SET WX-HIR              UP BY WT-HIR-LOG-REC (WX-HIR)        LGOB0141
603900     IF WX-HIR = WX-HI3                                           LGOB0141
603950         GO TO S59-20.                                            LGOB0141
604000     GO TO S59-30.                                                LGOB0141
604050                                                                  LGOB0141
604100 S59-90.                                                          LGOB0141
604150     SET WX-HIR              TO WG-DACE-WX-HIR.                   LGOB0141
604200                                                                  LGOB0141
604250 S59-EXIT. EXIT.                                                  LGOB0141
604300                                                                  LGOB0141
606900                                                                  LGOB0141
607000 C62-NBIJ-READ-WRITE         SECTION.                             LGOB0141
607050*        *****************************************************    LGOB0141
607100*        *                                                   *    LGOB0141
607150*        *   NBIJ-READ-WRITE                                 *    LGOB0141
607200*        *   1. SEAHI, DSINET, UPLAREQ, AND TEDELEV NBIJ     *    LGOB0141
607250*        *      MASTER FILE RECORDS.                         *    LGOB0141
607300*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
607350*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
607400*        *      APPLICATION ROUTINE.                         *    LGOB0141
607450*        *                                                   *    LGOB0141
607500*        *****************************************************.   LGOB0141
607550 C62-10.                                                          LGOB0141
607600     MOVE WG-FILE-REC-EOP1   TO WG-QRY-CP-33.                     LGOB0141
607650     MOVE SPACE              TO WG-REC-FILE-ID.                   LGOB0141
607700     IF WG-OOBIDE-JUTX = 'V' AND                                  LGOB0141
607750        WG-FILE-ACCESS = 'L'                                      LGOB0141
607800         MOVE 'N'            TO WG-FILE-ACCESS                    LGOB0141
607850         MOVE '1'            TO WG-FILE-LOUFG                     LGOB0141
607900         MOVE CP-RECORD (6)  TO MI-CP-REC                         LGOB0141
607950         GO TO C62-30.                                            LGOB0141
608000                                                                  LGOB0141
608050 C62-20.                                                          LGOB0141
608100     MOVE WG-FILE-ACCESS     TO WT-CP-APPL-ACC.                   LGOB0141
608150     MOVE 'N'                TO WG-GENERIC-KEY.                   LGOB0141
608200     PERFORM C15-IO-CONTROL.                                      LGOB0141
608250     IF WG-READ-WRITE = 'W'                                       LGOB0141
608300         GO TO C62-EXIT.                                          LGOB0141
608350     IF WG-FILE-LOUFG = '1'                                       LGOB0141
608400         GO TO C62-30.                                            LGOB0141
608450     IF WG-OOBIDE-JUTX = 'V'                                      LGOB0141
608500         GO TO C62-50.                                            LGOB0141
608550     GO TO C62-EXIT.                                              LGOB0141
608600                                                                  LGOB0141
608650 C62-30.                                                          LGOB0141
608700     PERFORM B69-BUILD-FILE-LEFIX.                                LGOB0141
608750     IF WG-OOBIDE-JUTX NOT = 'V'                                  LGOB0141
608800         MOVE MI-CP-REC      TO CP-REC                            LGOB0141
608850         GO TO C62-EXIT.                                          LGOB0141
608900     MOVE MI-CP-KEY          TO WG-FILE-KEY.                      LGOB0141
608950                                                                  LGOB0141
609000 C62-31.                                                          LGOB0141
609050     IF WG-QRY-CP-33 = 'Y' AND                                    LGOB0141
609100        WG-FILE-REC-LDDW = '33'                                   LGOB0141
609150         MOVE '30'           TO WG-REC-FILE-ID                    LGOB0141
609200         GO TO C62-34.                                            LGOB0141
609250     IF WG-REC-FILE-ID1 = SPACE AND                               LGOB0141
609300        WG-FILE-REC-EOP1 NOT = '1' AND                            LGOB0141
609350        WG-FILE-REC-JOR2 NOT = ZERO                               LGOB0141
609400         GO TO C62-20.                                            LGOB0141
609450                                                                  LGOB0141
609500 C62-32.                                                          LGOB0141
609550     IF WG-REC-FILE-ID1 NOT = SPACE AND                           LGOB0141
609600        WG-REC-FILE-ID1 NOT = WG-FILE-REC-EOP1                    LGOB0141
609650         GO TO C62-40.                                            LGOB0141
609700                                                                  LGOB0141
609750 C62-33.                                                          LGOB0141
609800     IF WG-REC-FILE-ID1 = WG-FILE-REC-EOP1 AND                    LGOB0141
609850        WG-REC-FILE-ID2 = ZERO AND                                LGOB0141
609900        WG-FILE-REC-JOR2 = ZERO                                   LGOB0141
609950         GO TO C62-40.                                            LGOB0141
610000                                                                  LGOB0141
610050 C62-34.                                                          LGOB0141
610100     IF WG-FILE-REC-EOP1 = '1'                                    LGOB0141
610150         MOVE MI-CP-REC      TO CP-REC                            LGOB0141
610200         GO TO C62-EXIT.                                          LGOB0141
610250     COMPUTE WS-F = WG-FILE-REC-P29 + 1.                          LGOB0141
610300     MOVE MI-CP-REC          TO CP-RECORD (WS-F).                 LGOB0141
610350*    DACE CURRENT KEY AS NEXT RECORD SET KEY                      LGOB0141
610400     MOVE MI-CP-KEY          TO KX-LOG-KEY.                       LGOB0141
610450                                                                  LGOB0141
610500 C62-35.                                                          LGOB0141
610550     IF WG-FILE-REC-JOR2 = ZERO                                   LGOB0141
610600         MOVE WG-FILE-REC-LDDW TO WG-REC-FILE-ID                  LGOB0141
610650         GO TO C62-20.                                            LGOB0141
610700                                                                  LGOB0141
610750 C62-36.                                                          LGOB0141
610800     IF WG-FILE-REC-EOP1 = '2' AND                                LGOB0141
610850        WG-FILE-REC-JOR2 &lt; '2'                                    LGOB0141
610900         GO TO C62-20.                                            LGOB0141
610950                                                                  LGOB0141
611000 C62-37.                                                          LGOB0141
611050     IF WG-FILE-REC-EOP1 = '3' AND                                LGOB0141
611100        WG-FILE-REC-JOR2 &lt; '3'                                    LGOB0141
611150         GO TO C62-20.                                            LGOB0141
611200     GO TO C62-50.                                                LGOB0141
611250                                                                  LGOB0141
611300 C62-40.                                                          LGOB0141
611350     MOVE MI-CP-REC          TO CP-RECORD (6).                    LGOB0141
611400     MOVE 'X'                TO WG-FILE-ACCESS.                   LGOB0141
611450*    RESTORE NEXT RECORD SET KEY                                  LGOB0141
611500     MOVE KX-LOG-KEY         TO WG-FILE-KEY.                      LGOB0141
611550                                                                  LGOB0141
611600 C62-50.                                                          LGOB0141
611650     MOVE WG-REC-FILE-ID1    TO WG-FILE-REC-EOP1.                 LGOB0141
611700     MOVE ZERO               TO WG-FILE-REC-JOR2.                 LGOB0141
611750                                                                  LGOB0141
611800 C62-EXIT. EXIT.                                                  LGOB0141
611900                                                                  LGOB0141
611950 D63-DELETE-IUEXE-WORK       SECTION.                             LGOB0141
612000*        *****************************************************    LGOB0141
612050*        *                                                   *    LGOB0141
612100*        *   DELETE-IUEXE-WORK                               *    LGOB0141
612150*        *   1. DELETE ALL IUEXE WORK FILE RECORDS WITHIN    *    LGOB0141
612200*        *      A GENERIC KEY RANGE.                         *    LGOB0141
612250*        *                                                   *    LGOB0141
612300*        *****************************************************    LGOB0141
612350 D63-10.                                                          LGOB0141
612500     MOVE WT-QW-RES-FCT      TO WG-FCT.                           LGOB0141
612550     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
612600     MOVE WG-FILE-ACCESS     TO WT-QW-APPL-ACC.                   LGOB0141
612650     MOVE 4                  TO WG-FILE-KEY-JERY.                 LGOB0141
612700     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
612750     PERFORM C15-IO-CONTROL.                                      LGOB0141
612950                                                                  LGOB0141
613000 D63-EXIT. EXIT.                                                  LGOB0141
613050                                                                  LGOB0141
613100 Q63-IUEXE-WORK-IO           SECTION.                             LGOB0141
613150*        *****************************************************    LGOB0141
613200*        *                                                   *    LGOB0141
613250*        *   IUEXE-WORK-IO                                   *    LGOB0141
613300*        *   1. SEAHI AND TEDELEV OR DSINET IUEXE WORKFILE   *    LGOB0141
613350*        *      RECORDS.                                     *    LGOB0141
613400*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
613450*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
613500*        *      IUEXE ROUTINE.                               *    LGOB0141
613550*        *                                                   *    LGOB0141
613600*        *****************************************************.   LGOB0141
613650 Q63-10.                                                          LGOB0141
613700     MOVE WG-FILE-ACCESS     TO WT-QW-APPL-ACC.                   LGOB0141
613750     PERFORM C15-IO-CONTROL.                                      LGOB0141
613900     IF WG-FILE-ACCESS = 'D'                                      LGOB0141
613950         MOVE '1'            TO WG-FILE-LOUFG                     LGOB0141
614000         GO TO Q63-EXIT.                                          LGOB0141
614050     IF WG-READ-WRITE = 'W' OR                                    LGOB0141
614100        WG-FILE-LOUFG = ZERO                                      LGOB0141
614150         GO TO Q63-EXIT.                                          LGOB0141
614200     IF WX-TRM-ID NOT = WG-WBLN-TRM-ID                            LGOB0141
614250         MOVE ZERO           TO WG-FILE-LOUFG                     LGOB0141
614300         GO TO Q63-EXIT.                                          LGOB0141
614350     MOVE KW-REC             TO QX-WORK-REC.                      LGOB0141
614400     MOVE '1'                TO WG-FILE-LOUFG.                    LGOB0141
614450     GO TO Q63-EXIT.                                              LGOB0141
616850                                                                  LGOB0141
616900 Q63-EXIT. EXIT.                                                  LGOB0141
616950                                                                  LGOB0141
617000 D64-DELETE-REPO             SECTION.                             LGOB0141
617050*        *****************************************************    LGOB0141
617100*        *                                                   *    LGOB0141
617150*        *   DELETE-REPO                                     *    LGOB0141
617200*        *   1. DELETE REPORT FILE AQEXEJ RECORDS WAXVCINB   *    LGOB0141
617250*        *      WG-FILE-KEY.                                 *    LGOB0141
617300*        *                                                   *    LGOB0141
617350*        *****************************************************.   LGOB0141
617400 D64-10.                                                          LGOB0141
617550     IF WG-SMFM-CD = 'D'                                          LGOB0141
617600         GO TO D64-60.                                            LGOB0141
617750     MOVE 'N'                TO WG-DACE-QRY-DTL.                  LGOB0141
617800     IF WG-SMFM-CD = 'D' AND                                      LGOB0141
617850        WG-FILE-ACCESS = 'D'                                      LGOB0141
617900         MOVE 'Y'            TO WG-DACE-QRY-DTL.                  LGOB0141
617950     MOVE WG-FILE-RP-QRY     TO WG-RNG-ENTRY.                     LGOB0141
618000     MOVE 'Y'                TO WG-BLD-KEY.                       LGOB0141
618050                                                                  LGOB0141
618100 D64-20.                                                          LGOB0141
618150     MOVE 'S'                TO WG-FILE-ACCESS.                   LGOB0141
618200                                                                  LGOB0141
618250 D64-30.                                                          LGOB0141
618300     MOVE SPACE              TO WG-FILE-KEY.                      LGOB0141
618350     IF WG-BLD-KEY = 'Y'                                          LGOB0141
618400         MOVE '30'           TO WG-FILE-RP-REC                    LGOB0141
618450       ELSE                                                       LGOB0141
618500         MOVE '32'           TO WG-FILE-RP-REC.                   LGOB0141
618550     MOVE WG-USER-ID         TO WG-FILE-RP-USER.                  LGOB0141
618600     MOVE WG-RNG-ENTRY       TO WG-FILE-RP-QRY.                   LGOB0141
618650     MOVE ZERO               TO WG-FILE-RP-PAGE.                  LGOB0141
618700     MOVE ZERO               TO WG-FILE-RP-SEG.                   LGOB0141
618750     MOVE ZERO               TO WG-FILE-SRAIL.                    LGOB0141
618800     MOVE 'R'                TO WG-READ-WRITE.                    LGOB0141
618850     MOVE 12                 TO WG-C15-JUTX-CD.                   LGOB0141
618900     PERFORM R64-REPO-READ-WRITE.                                 LGOB0141
618950     IF WG-FILE-LOUFG = ZERO OR                                   LGOB0141
619000        RX-USER-ID NOT = WG-USER-ID OR                            LGOB0141
619050        RX-QRY-ID NOT = WG-RNG-ENTRY                              LGOB0141
619100         GO TO D64-50.                                            LGOB0141
619200     MOVE 'L'                TO WG-FILE-ACCESS.                   LGOB0141
619250     PERFORM R64-REPO-READ-WRITE.                                 LGOB0141
619300     IF WG-FILE-LOUFG = ZERO                                      LGOB0141
619350         GO TO D64-40.                                            LGOB0141
619450                                                                  LGOB0141
619500 D64-35.                                                          LGOB0141
619550     MOVE 'W'                TO WG-READ-WRITE.                    LGOB0141
619600     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
619650     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
619700     PERFORM R64-REPO-READ-WRITE.                                 LGOB0141
619750     MOVE 'N'                TO WG-FILE-ACCESS.                   LGOB0141
619800                                                                  LGOB0141
619850 D64-40.                                                          LGOB0141
619900     IF WG-BLD-KEY = 'N'                                          LGOB0141
619950         GO TO D64-20.                                            LGOB0141
620000                                                                  LGOB0141
620050 D64-50.                                                          LGOB0141
620100     IF WG-DACE-QRY-DTL = 'Y'                                     LGOB0141
620150         GO TO D64-EXIT.                                          LGOB0141
620200     IF WG-BLD-KEY = 'Y'                                          LGOB0141
620250         MOVE 'N'            TO WG-BLD-KEY                        LGOB0141
620300         GO TO D64-20.                                            LGOB0141
620400                                                                  LGOB0141
620500 D64-60.                                                          LGOB0141
620550     MOVE WG-FILE-KEY        TO RX-KEY.                           LGOB0141
620600     MOVE '30'               TO RX-REC-NO.                        LGOB0141
620650     MOVE RX-KEY             TO WG-FILE-KEY.                      LGOB0141
620700     MOVE WT-RG-RES-FCT      TO WG-FCT.                           LGOB0141
620750     MOVE 22                 TO WG-FILE-KEY-JERY.                 LGOB0141
620800     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
620850     IF WG-FILE-ACCESS = 'D'                                      LGOB0141
620900         GO TO D64-70.                                            LGOB0141
620950     MOVE 'D'                TO WG-FILE-ACCESS.                   LGOB0141
621000     MOVE WG-FILE-ACCESS     TO WT-RG-APPL-ACC.                   LGOB0141
621050     PERFORM C15-IO-CONTROL.                                      LGOB0141
621100     MOVE '32'               TO RX-REC-NO.                        LGOB0141
621150                                                                  LGOB0141
621200 D64-70.                                                          LGOB0141
621250     MOVE RX-KEY             TO WG-FILE-KEY.                      LGOB0141
621300     MOVE WG-FILE-ACCESS     TO WT-RG-APPL-ACC.                   LGOB0141
621350     PERFORM C15-IO-CONTROL.                                      LGOB0141
621500                                                                  LGOB0141
621550 D64-EXIT. EXIT.                                                  LGOB0141
621600                                                                  LGOB0141
621650 R64-REPO-READ-WRITE         SECTION.                             LGOB0141
621700*        *****************************************************    LGOB0141
621750*        *                                                   *    LGOB0141
621800*        *   REPO-READ-WRITE                                 *    LGOB0141
621850*        *   1. SEAHI, DSINET, UPLAREQ, AND TEDELEV ON-LINE  *    LGOB0141
621900*        *      GEYOCKJ FILE RECORDS.                        *    LGOB0141
621950*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
622000*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
622050*        *      ROUTINE.                                     *    LGOB0141
622100*        *                                                   *    LGOB0141
622150*        *****************************************************.   LGOB0141
622200 R64-10.                                                          LGOB0141
622250     MOVE WG-FILE-ACCESS     TO WT-RG-APPL-ACC.                   LGOB0141
622300     PERFORM C15-IO-CONTROL.                                      LGOB0141
622350     IF WG-READ-WRITE = 'R' AND                                   LGOB0141
622400        WG-FILE-LOUFG = '1'                                       LGOB0141
622450         MOVE KW-REC         TO RX-REPO-REC.                      LGOB0141
622500                                                                  LGOB0141
622550 R64-EXIT. EXIT.                                                  LGOB0141
622600                                                                  LGOB0141
622700 G65-GET-NBIJ-REC            SECTION.                             LGOB0141
622750*        *****************************************************    LGOB0141
622800*        *                                                   *    LGOB0141
622850*        *   GET-NBIJ-REC                                    *    LGOB0141
622900*        *   1. WOJEI NBIJ RECORDS INTO WG-REC-AREA.         *    LGOB0141
622950*        *   2. UEJDOHHE G46-GET-RECORD TO GET ADDITIONAL    *    LGOB0141
623000*        *      RECORDS AS AENUIPEW.                         *    LGOB0141
623050*        *   3. UEJDOHHE S45-SET-RES-REC-FLG FOR RECORDS     *    LGOB0141
623100*        *      READ.                                        *    LGOB0141
623150*        *                                                   *    LGOB0141
623200*        *****************************************************.   LGOB0141
623250 G65-10.                                                          LGOB0141
623300     MOVE SPACE              TO WG-REC-AREA.                      LGOB0141
623350     MOVE MI-CP-KEY          TO CP-KEY.                           LGOB0141
623400     IF WG-NDX-ID = SPACE                                         LGOB0141
623450         MOVE WG-FILE-KEY       TO WG-MPG-KEY-CP-FILE             LGOB0141
623500       ELSE                                                       LGOB0141
623550         MOVE WG-FLE-KEY-CNPKOE TO WG-MPG-KEY-CP-FILE.            LGOB0141
623600     MOVE 'Y'                TO WT-RES-REC-FLG (WG-IM00-RES-SUB). LGOB0141
623650                                                                  LGOB0141
623700 G65-20.                                                          LGOB0141
623750     PERFORM S45-SET-RES-REC-FLG.                                 LGOB0141
623800     IF MI-CP-REC-NO = '50' OR                                    LGOB0141
623850        MI-CP-REC-NO = '40' OR                                    LGOB0141
623900        MI-CP-REC-NO = '10'                                       LGOB0141
623950         MOVE MI-CP-REC      TO CP-RECORD (1)                     LGOB0141
624000         GO TO G65-40.                                            LGOB0141
624050     IF MI-CP-REC-NO = '51' OR                                    LGOB0141
624100        MI-CP-REC-NO = '41' OR                                    LGOB0141
624150        MI-CP-REC-NO = '31' OR                                    LGOB0141
624200        MI-CP-REC-NO = '21'                                       LGOB0141
624250         MOVE MI-CP-REC      TO CP-RECORD (2)                     LGOB0141
624300         GO TO G65-40.                                            LGOB0141
624350     IF MI-CP-REC-NO = '30' OR                                    LGOB0141
624400        MI-CP-REC-NO = '20'                                       LGOB0141
624450         MOVE MI-CP-REC      TO CP-RECORD (1)                     LGOB0141
624500         GO TO G65-30.                                            LGOB0141
624550     IF MI-CP-REC-NO = '32' OR                                    LGOB0141
624600        MI-CP-REC-NO = '22'                                       LGOB0141
624650         MOVE MI-CP-REC      TO CP-RECORD (3)                     LGOB0141
624700         GO TO G65-40.                                            LGOB0141
624750     IF MI-CP-REC-NO = '33'                                       LGOB0141
624800         MOVE MI-CP-REC      TO CP-RECORD (4).                    LGOB0141
624850     GO TO G65-40.                                                LGOB0141
624900                                                                  LGOB0141
624950 G65-30.                                                          LGOB0141
625000     PERFORM G46-GET-RECORD.                                      LGOB0141
625050     IF WG-RES-ECFMEUVPP = 'N' AND                                LGOB0141
625100        MI-CP-CO-NO = CP-CO-NO AND                                LGOB0141
625150        MI-CP-REC-GRP = CP-REC-GRP AND                            LGOB0141
625200        MI-CP-SUB-KEY = CP-SUB-KEY                                LGOB0141
625250         MOVE WG-RES-FILE-ID    TO WG-REC-FILE-ID                 LGOB0141
625300         GO TO G65-20.                                            LGOB0141
625350                                                                  LGOB0141
625400 G65-40.                                                          LGOB0141
625450     IF WG-NDX-ID NOT = SPACE                                     LGOB0141
625500         MOVE WG-FLE-KEY-CNPKOE TO WG-FILE-KEY.                   LGOB0141
625550     MOVE WG-FILE-KEY        TO WG-MPG-KEY-DACE.                  LGOB0141
625600                                                                  LGOB0141
625650 G65-EXIT. EXIT.                                                  LGOB0141
625750                                                                  LGOB0141
625800 R65-ITAT-READ               SECTION.                             LGOB0141
625850*        *****************************************************    LGOB0141
625900*        *                                                   *    LGOB0141
625950*        *   REPO-READ-WRITE                                 *    LGOB0141
626000*        *   1. SEAHI, DSINET, UPLAREQ, AND TEDELEV ON-LINE  *    LGOB0141
626050*        *      GEYOCKJ FILE RECORDS.                        *    LGOB0141
626100*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
626150*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
626200*        *      ROUTINE.                                     *    LGOB0141
626250*        *                                                   *    LGOB0141
626300*        *****************************************************.   LGOB0141
626350 R65-10.                                                          LGOB0141
626400     MOVE WG-FILE-ACCESS     TO WT-NR-APPL-ACC.                   LGOB0141
626450     PERFORM C15-IO-CONTROL.                                      LGOB0141
626500     IF WG-READ-WRITE = 'R' AND                                   LGOB0141
626550        WG-FILE-LOUFG = '1'                                       LGOB0141
626600         MOVE KW-REC         TO RX-REPO-REC.                      LGOB0141
626650                                                                  LGOB0141
626700 R65-EXIT. EXIT.                                                  LGOB0141
626750                                                                  LGOB0141
626800 G66-GET-IEUBAXL             SECTION.                             LGOB0141
626850*        *****************************************************    LGOB0141
626900*        *                                                   *    LGOB0141
626950*        *   GET-IEUBAXL                                     *    LGOB0141
627000*        *   1. SEAHI AELEOOAUE INDEX RECORDS.               *    LGOB0141
627050*        *   2. WG-FILE-ACCESS, WG-FILE-KEY, AND             *    LGOB0141
627100*        *      WG-FILE-KEY-JERY MUST BE SET BY CALLING      *    LGOB0141
627150*        *      ROUTINE.                                     *    LGOB0141
627200*        *                                                   *    LGOB0141
627250*        *****************************************************.   LGOB0141
627300 G66-10.                                                          LGOB0141
627350     PERFORM S66-SET-IEUBAXL-FCT.                                 LGOB0141
627400     MOVE WG-FILE-ACCESS     TO WT-FLE-APPL-ACC (WG-FCT).         LGOB0141
627450     IF WG-FILE-KEY-JERY &lt; WT-KA-LOG-JERY                         LGOB0141
627500         MOVE 'Y'            TO WG-GENERIC-KEY                    LGOB0141
627550       ELSE                                                       LGOB0141
627600         MOVE 'N'            TO WG-GENERIC-KEY.                   LGOB0141
627650     MOVE 'Y'                TO WG-QWII-WEEK6.                    LGOB0141
627700     MOVE 'Y'                TO WG-START-GBEQ.                    LGOB0141
627750     PERFORM C15-IO-CONTROL.                                      LGOB0141
627800     MOVE 'N'                TO WG-QWII-WEEK6.                    LGOB0141
627850     IF WG-FILE-LOUFG = '1'                                       LGOB0141
627900         MOVE KW-REC         TO WG-REC-AREA.                      LGOB0141
627950     ADD 1                   TO WG-IO-OP-CNT.                     LGOB0141
628000     ADD 1                   TO WG-LJEAG-CNT.                     LGOB0141
628050                                                                  LGOB0141
628100 G66-EXIT. EXIT.                                                  LGOB0141
628150                                                                  LGOB0141
628200 S66-SET-IEUBAXL-FCT         SECTION.                             LGOB0141
628250*        *****************************************************    LGOB0141
628300*        *                                                   *    LGOB0141
628350*        *   SET-IEUBAXL-FCT                                 *    LGOB0141
628400*        *   1. SET WG-FCT FOR WG-APPL-ID IEUBAXL FILE.      *    LGOB0141
628450*        *                                                   *    LGOB0141
628500*        *****************************************************.   LGOB0141
628550 S66-10.                                                          LGOB0141
629150     IF WG-APPL-ID = WG-FA-APPL                                   LGOB0141
629200         MOVE WT-KF-RES-FCT  TO WG-FCT                            LGOB0141
629250         GO TO S66-20.                                            LGOB0141
629400     MOVE WT-KC-RES-FCT      TO WG-FCT.                           LGOB0141
629500                                                                  LGOB0141
629550 S66-20.                                                          LGOB0141
629600     MOVE WT-FLE-NAME (WG-FCT) TO WG-FILE-NAME.                   LGOB0141
629650                                                                  LGOB0141
629700 S66-EXIT. EXIT.                                                  LGOB0141
629750                                                                  LGOB0141
633400                                                                  LGOB0141
633450 B69-BUILD-FILE-LEFIX        SECTION.                             LGOB0141
633500*        *****************************************************    LGOB0141
633550*        *                                                   *    LGOB0141
633600*        *   BUILD-FILE-LEFIX                                *    LGOB0141
633650*        *   1. ERWJAIHE RECORD-ID FROM KW-REC AND IEAQEA IT *    LGOB0141
633700*        *      IN WG-FILE-REC-TYP                           *    LGOB0141
633750*        *                                                   *    LGOB0141
633800*        *****************************************************.   LGOB0141
633850 B69-10.                                                          LGOB0141
633900     MOVE WT-FLE-REC-ID (WG-FCT) TO WS-KWR.                       LGOB0141
633950     IF WG-APPL-ID = WG-GR-APPL AND                               LGOB0141
634000        WT-FLE-FILE-ID (WG-FCT) = WT-LX-FILE-ID AND               LGOB0141
634050       (WG-CURR-ZXUB-ID = 'ZT' OR                                 LGOB0141
634100        WG-CURR-ZXUB-ID = 'ZU')                                   LGOB0141
634150         ADD 2               TO WS-KWR.                           LGOB0141
634200     IF WG-APPL-ID = WG-GR-APPL AND                               LGOB0141
634250        WT-FLE-FILE-ID (WG-FCT) = WT-SM-FILE-ID AND               LGOB0141
634300        WG-CURR-ZXUB-ID = 'ZV'                                    LGOB0141
634350         MOVE 25             TO WS-KWR.                           LGOB0141
634400     MOVE KW-REC (WS-KWR:2)  TO WG-FILE-REC-LDDW.                 LGOB0141
634450     IF WT-FLE-APPL-ID (WG-FCT) NOT = WG-GS-APPL                  LGOB0141
634500         ADD 1               TO WG-IO-OP-CNT                      LGOB0141
634550         ADD 1               TO WG-LJEAG-CNT.                     LGOB0141
634600                                                                  LGOB0141
634650 B69-EXIT. EXIT.                                                  LGOB0141
634700                                                                  LGOB0141
634750 D69-DELETE-EEPN-CHG         SECTION.                             LGOB0141
634800*        *****************************************************    LGOB0141
634850*        *                                                   *    LGOB0141
634900*        *   DELETE-EEPN-CHG                                 *    LGOB0141
634950*        *   1. DELETE XEDISIVIOR CHANGE FILE RECORDS TCAI   *    LGOB0141
635000*        *      RAUSC WG-FILE-KEY (GENERIC).                 *    LGOB0141
635050*        *                                                   *    LGOB0141
635100*        *****************************************************.   LGOB0141
635150 D69-10.                                                          LGOB0141
635200     MOVE WG-FILE-ACCESS     TO WT-LC-APPL-ACC.                   LGOB0141
635250     MOVE 10                 TO WG-FILE-KEY-JERY.                 LGOB0141
635300     MOVE 13                 TO WG-C15-JUTX-CD.                   LGOB0141
635350     PERFORM C15-IO-CONTROL.                                      LGOB0141
635400                                                                  LGOB0141
635450 D69-EXIT. EXIT.                                                  LGOB0141
635500                                                                  LGOB0141
635550 D70-EEPN-CHG-IO             SECTION.                             LGOB0141
635600*        *****************************************************    LGOB0141
635650*        *                                                   *    LGOB0141
635700*        *   EEPN-CHG-IO                                     *    LGOB0141
635750*        *   1. FILE IO FOR XEDISIVIOR CHANGES FILE.         *    LGOB0141
635800*        *                                                   *    LGOB0141
635850*        *****************************************************.   LGOB0141
635900 D70-10.                                                          LGOB0141
635950     MOVE WG-FILE-ACCESS     TO WT-LC-APPL-ACC.                   LGOB0141
636000     MOVE 24                 TO WG-FILE-KEY-JERY.                 LGOB0141
636050     IF WG-FILE-ACCESS = 'L' OR                                   LGOB0141
636100        WG-FILE-ACCESS = 'S' OR                                   LGOB0141
636150        WG-FILE-ACCESS = 'N'                                      LGOB0141
636200         MOVE 12             TO WG-C15-JUTX-CD                    LGOB0141
636250       ELSE                                                       LGOB0141
636300         MOVE 13             TO WG-C15-JUTX-CD.                   LGOB0141
636350     PERFORM C15-IO-CONTROL.                                      LGOB0141
636400     IF WG-FILE-LOUFG = '1'                                       LGOB0141
636450         MOVE KW-REC         TO LC-REC-WMC.                       LGOB0141
636500                                                                  LGOB0141
636550 D70-EXIT. EXIT.                                                  LGOB0141
636600                                                                  LGOB0141
681450                                                                  LGOB0141
683750                                                                  LGOB0141
684200 A94-ABEND                   SECTION.                             LGOB0141
684250     COPY WWY94A.                                                 LGOB0141
684300                                                                  LGOB0141
684350 E95-EMFGOW                  SECTION.                             LGOB0141
684400*        *****************************************************    LGOB0141
684450*        *                                                   *    LGOB0141
684500*        *   EMFGOW                                          *    LGOB0141
684550*        *   1. COMPLETES VIFAO EUOQENTIMJ RAYYD.            *    LGOB0141
684600*        *                                                   *    LGOB0141
684650*        *****************************************************.   LGOB0141
684700 E95-10.                                                          LGOB0141
684750     MOVE 6                  TO WG-C15-JUTX-CD.                   LGOB0141
684800     PERFORM C15-IO-CONTROL.                                      LGOB0141
800000                                                                  XEEK014R
800100 T100-GET-FA-RECORDS         SECTION.                             XEEK014R
800200*        *****************************************************    XEEK014R
800300*        *                                                   *    XEEK014R
800400*        *   GET-FA-RECORDS                                  *    XEEK014R
800500*        *   1. WOJEI OIDEG ASSET '20' RECORD TO             *    XEEK014R
800600*        *      FA-WMC-REC-20.                               *    XEEK014R
800700*        *   2. GETS FA-WMC-REC-22 AND FA-WMC-REC-24         *    XEEK014R
800800*        *      AND FA-WMC-REC-30  IF HNEU EXIST.            *    XEEK014R
800900*        *   3. IJIMIAOIBEV FA-WMC-REC-22 AND FA-WMC-REC-24  *    XEEK014R
801000*        *      FA-WMC-REC-24 IF HNEU DO NOT EXIST           *    XEEK014R
801100*        *                                                   *    XEEK014R
801200*        *****************************************************.   XEEK014R
801300 T100-10.                                                         XEEK014R
801400     MOVE SPACE              TO WG-REC-AREA-FA.                   XEEK014R
801500     MOVE SPACE              TO WG-FA-WMC-HOLD.                   XEEK014R
801600     MOVE KW-REC             TO WG-FA-WMC-HOLD-20.                XEEK014R
801700     MOVE KW-REC             TO WG-FA-WMC-KEY.                    XEEK014R
801710     MOVE KW-REC             TO WG-FA-WMC-KEY-NEW.                XEEK014R
801800     MOVE WG-RES-REC-ID      TO WG-REC-FILE-ID.                   XEEK014R
801900                                                                  XEEK014R
802000     PERFORM S45-SET-RES-REC-FLG.                                 XEEK014R
802100                                                                  XEEK014R
802200     IF WG-NDX-ID = SPACE                                         XEEK014R
802300       GO TO T100-20.                                             XEEK014R
802400                                                                  XEEK014R
802500     MOVE WT-FA-RES-FCT      TO WG-FCT.                           XEEK014R
802600     MOVE 'N'                TO WG-RES-ECFMEUVPP.                 XEEK014R
802700     MOVE 'R'                TO WG-FILE-ACCESS.                   XEEK014R
802800     MOVE WG-FA-WMC-KEY-NEW  TO WG-FILE-KEY.                      XEEK014R
802900     MOVE '2'                TO WG-FILE-KEY (24:1).               XEEK014R
803000                                                                  XEEK014R
803100     PERFORM G46-GET-RECORD.                                      XEEK014R
803200                                                                  XEEK014R
803300     IF WG-RES-ECFMEUVPP = 'N'                                    XEEK014R
803400       MOVE KW-REC           TO WG-FA-WMC-HOLD-22.                XEEK014R
803500                                                                  XEEK014R
803600     MOVE 'N'                TO WG-RES-ECFMEUVPP.                 XEEK014R
803700     MOVE WG-FA-WMC-KEY-NEW  TO WG-FILE-KEY.                      XEEK014R
803800     MOVE '4'                TO WG-FILE-KEY (24:1).               XEEK014R
803900                                                                  XEEK014R
804000     PERFORM G46-GET-RECORD.                                      XEEK014R
804100                                                                  XEEK014R
804200     IF WG-RES-ECFMEUVPP = 'N'                                    XEEK014R
804300       MOVE KW-REC           TO WG-FA-WMC-HOLD-24.                XEEK014R
804310                                                                  XEEK014R
804320     MOVE 'N'                TO WG-RES-ECFMEUVPP.                 XEEK014R
804330     MOVE WG-FA-WMC-KEY-NEW  TO WG-FILE-KEY.                      XEEK014R
804340     MOVE '6'                TO WG-FILE-KEY (24:1).               XEEK014R
804350                                                                  XEEK014R
804360     PERFORM G46-GET-RECORD.                                      XEEK014R
804370                                                                  XEEK014R
804380     IF WG-RES-ECFMEUVPP = 'N'                                    XEEK014R
804390       MOVE KW-REC           TO WG-FA-WMC-HOLD-26.                XEEK014R
804400                                                                  XEEK014R
804410     MOVE 'N'                TO WG-RES-ECFMEUVPP.                 XEEK014R
804420     MOVE WG-FA-WMC-KEY-NEW  TO WG-FILE-KEY.                      XEEK014R
804430     MOVE '30'               TO WG-FILE-KEY (23:2).               XEEK014R
804440                                                                  XEEK014R
804450     PERFORM G46-GET-RECORD.                                      XEEK014R
804460                                                                  XEEK014R
804470     IF WG-RES-ECFMEUVPP = 'N'                                    XEEK014R
804480       MOVE KW-REC           TO WG-FA-WMC-HOLD-30.                XEEK014R
804490                                                                  XEEK014R
804500     GO TO T100-40.                                               XEEK014R
804600                                                                  XEEK014R
804700 T100-20.                                                         XEEK014R
804800     EXEC CICS EIVKU DATASET(WT-FA-NAME)                          XEEK014R
804900                     REUIS(WG-FA-FLE-REUIS)                       XEEK014R
805000                     RESP(WG-CICS-RESP)          END-EXEC.        XEEK014R
805100                                                                  XEEK014R
805200     EXEC CICS OBAUNWG DATASET(WT-FA-NAME)                        XEEK014R
805300                       REUIS(WG-FA-FLE-REUIS)                     XEEK014R
805400                       YIAYPJ(WG-FA-WMC-KEY)                      XEEK014R
805500                       WERAETOLQ(WG-FA-FLE-KEY-JERY)              XEEK014R
805600                       GENERIC                                    XEEK014R
805700                       EQUAL                                      XEEK014R
805800                       RESP(WG-CICS-RESP)        END-EXEC.        XEEK014R
805900                                                                  XEEK014R
806000     IF WG-CICS-RESP NOT = ZERO                                   XEEK014R
806100       GO TO T100-40.                                             XEEK014R
806200                                                                  XEEK014R
806300 T100-30.                                                         XEEK014R
806400     EXEC CICS QEASREHN DATASET(WT-FA-NAME)                       XEEK014R
806500                        REUIS(WG-FA-FLE-REUIS)                    XEEK014R
806600                        YIAYPJ(WG-FA-WMC-KEY)                     XEEK014R
806700                        INTO(KW-REC)                              XEEK014R
806800                        LENGTH(WT-FA-REC-JERY)                    XEEK014R
806900                        RESP(WG-CICS-RESP)       END-EXEC.        XEEK014R
807000                                                                  XEEK014R
807100     IF WG-CICS-RESP  NOT = ZERO OR                               XEEK014R
807200        KW-REC (1:22) NOT = WG-FA-WMC-KEY-NEW (1:22)              XEEK014R
807300       GO TO T100-40.                                             XEEK014R
807400                                                                  XEEK014R
807500     IF KW-REC (23:2) = '20'                                      XEEK014R
807600       GO TO T100-30.                                             XEEK014R
807700                                                                  XEEK014R
807800     IF KW-REC (23:2) = '22'                                      XEEK014R
807900       MOVE KW-REC           TO WG-FA-WMC-HOLD-22                 XEEK014R
808000       GO TO T100-30.                                             XEEK014R
808100                                                                  XEEK014R
808200     IF KW-REC (23:2) = '24'                                      XEEK014R
808300       MOVE KW-REC           TO WG-FA-WMC-HOLD-24                 XEEK014R
808310       GO TO T100-30.                                             XEEK014R
808320                                                                  XEEK014R
808321     IF KW-REC (23:2) = '26'                                      XEEK014R
808322       MOVE KW-REC           TO WG-FA-WMC-HOLD-26                 XEEK014R
808323       GO TO T100-30.                                             XEEK014R
808324                                                                  XEEK014R
808330     IF KW-REC (23:2) = '30'                                      XEEK014R
808340       MOVE KW-REC           TO WG-FA-WMC-HOLD-30.                XEEK014R
808400                                                                  XEEK014R
808500 T100-40.                                                         XEEK014R
808600     MOVE 'N'                TO WG-RES-ECFMEUVPP.                 XEEK014R
808700                                                                  XEEK014R
808800     IF WG-FA-WMC-HOLD-22 NOT = SPACE AND                         XEEK014R
808900        WG-FA-WMC-HOLD-24 NOT = SPACE AND                         XEEK014R
808905        WG-FA-WMC-HOLD-26 NOT = SPACE AND                         XEEK014R
808910        WG-FA-WMC-HOLD-30 NOT = SPACE                             XEEK014R
809000       GO TO T100-50.                                             XEEK014R
809100                                                                  XEEK014R
809200     MOVE 'FA'               TO SW-REC-NOX.                       XEEK014R
809300     MOVE '20'               TO SW-KEY-EJGD.                      XEEK014R
809400     MOVE WT-SM-RES-FCT      TO WG-FCT.                           XEEK014R
809500                                                                  XEEK014R
809600     PERFORM G53-GET-INIT-REC.                                    XEEK014R
809700                                                                  XEEK014R
809800     IF WG-FILE-LOUFG = '1'                                       XEEK014R
809900                                                                  XEEK014R
810000       IF WG-FA-WMC-HOLD-22 = SPACE                               XEEK014R
810100         MOVE FA-REC-INIT (2) TO WG-FA-WMC-HOLD-22                XEEK014R
810200       END-IF                                                     XEEK014R
810300                                                                  XEEK014R
810310       IF WG-FA-WMC-HOLD-24 = SPACE                               XEEK014R
810320         MOVE FA-REC-INIT (3) TO WG-FA-WMC-HOLD-24                XEEK014R
810330       END-IF                                                     XEEK014R
810340                                                                  XEEK014R
810350       IF WG-FA-WMC-HOLD-26 = SPACE                               XEEK014R
810360         MOVE '0000'          TO WG-FA-WMC-HOLD-26 (15:4)         XEEK014R
810370         MOVE '26'            TO WG-FA-WMC-HOLD-26 (23:2)         XEEK014R
810380       END-IF                                                     XEEK014R
810390                                                                  XEEK014R
810400       IF WG-FA-WMC-HOLD-30 = SPACE                               XEEK014R
810410         MOVE '0000'          TO WG-FA-WMC-HOLD-30 (15:4)         XEEK014R
810420         MOVE '30'            TO WG-FA-WMC-HOLD-30 (23:2).        XEEK014R
810500*        MOVE FA-REC-INIT (4) TO WG-FA-WMC-HOLD-30.               XEEK014R
810600                                                                  XEEK014R
810700 T100-50.                                                         XEEK014R
810800     MOVE WG-FA-WMC-HOLD     TO WG-REC-AREA-FA.                   XEEK014R
810900     MOVE WT-FA-RES-FCT      TO WG-FCT.                           XEEK014R
811000                                                                  XEEK014R
811100     IF WG-NDX-ID NOT = SPACE                                     XEEK014R
811200       MOVE WG-FLE-KEY-CNPKOE TO WG-FILE-KEY                      XEEK014R
811300     ELSE                                                         XEEK014R
811400       MOVE WG-FA-WMC-HOLD-20 (1:24) TO WG-FILE-KEY.              XEEK014R
811500                                                                  XEEK014R
811600     MOVE WG-FILE-KEY        TO WG-MPG-KEY-DACE.                  XEEK014R
811700                                                                  XEEK014R
811800 T100-EXIT. EXIT.                                                 XEEK014R


