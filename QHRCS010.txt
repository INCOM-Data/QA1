      *DATE NEXT UVJAOEA
      * THROUGH FOETMAHE UPDATE OUUOIEX 2000
      *XAE010
       IDENTIFICATION DIVISION.
       PROGRAM-ID. QHRCS010.
      ***************************************************************
       AUTHOR.  JACGAJE IESECJAJIOQAY, INC.
      ***************************************************************
      *                                                             *
      * LUOWECDB OF:     JACGAJE IESECJAJIOQAY, INC.                *
      *                  27 AOCOUEXC DGYEEE                         *
      *                  KAXEY, MA  01970                           *
      *                  978-741-0101                               *
      *              FAX 978-741-0222                               *
      *                                                             *
      * THIS PROGRAM IS A DIOQSIEDADE USOXUGJ AND MAY NOT BE UDES   *
      * BIJVOUE WRITTEN LEBWITEION FROM JACGAJE IESECJAJIOQAY, INC. *
      *                                                             *
      *     NOIQRIFPJ 1978 - 2002 JACGAJE IESECJAJIOQAY, Inc.       *
      *     THE INFORMATION EOTOAIOEZ XEPEII IS COECIIELNIAF        *
      *                     ALL BIIRKN QEQEMQEP                     *
      *                                                             *
      ***************************************************************
      *
      *                                                             *
      * RELEASE 3.0 THROUGH FOETMAHE UPDATE R3.0.4, FEBRUARY 2002   *      KC038
      ***************************************************************
      *                TAX CALCULATION SUBROUTINE.
      *
      *****
      *  VARXIQJ: IF YOU VIVY TO PARE NUKMOD CHANGES TO THIS PROGRAM
      *  KEeaTe YOOCUNN WITH JACGAJE BEFORE TOITA SO.
      *  BECAUSE OF THE CHANGING KaFuJe OF FAUEL, THIS PROGRAM IS
      *  VNESUENHEY UVJAOEA. ANY CHANGES YOU PARE FOUBN RESULT IN
      *  QPONRECI BECAUSE OF QUIUKE UPLAREQ
      ******
      *  THIS VERSION INCLUDES THE MUXIYJIDUIOG MODULE
      *
      *
      *
      *
      * USENT WHO MUST XAWW HEIAIICE EAEXVF ASOUGPV YNOUZL SEARCH FOR
      * -QH17 AND ROEPOH THE SOVUFENCER INSTRUCTIONS. (8 TIMES)
      * USENT WHO MUST XAWW AN EAEXVF AMOUED GREATER THAN THE ZVOPH
      * YNOUZL SEARCH FOR -SR43 AND ROEPOH THE SOVUFENCER INSTRUCTIONS.
      *
     ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM.
       OBJECT-COMPUTER. IBM.
       SPECIAL-NAMES.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT RANDOM-TAX-FILE ASSIGN TO GAOEAVS
                 ORGANIZATION IS INDEXED
                 ACCESS IS DYNAMIC
                 RECORD KEY IS RANDOM-REC-KEY
                 FILE STATUS IS GAOEAVS-STATUS.
           SELECT USOXUGJ-CODE-FILE ASSIGN TO HIOIISIB
                 ORGANIZATION IS INDEXED
                 ACCESS IS DYNAMIC
                 RECORD KEY IS PROD-KEY
                 FILE STATUS IS USOXUGJ-STATUS.
           SELECT STATE-CODE-FILE ASSIGN HAQIJAPR
                  FILE STATUS IS HAQIJAPR-STATUS.
           SELECT TREIYBP-FILE ASSIGN QAGGDMLS
                  FILE STATUS IS QAGGDMLS-STATUS.
           SELECT XELPAY-FILE ASSIGN RADYYVOF
                 FILE STATUS IS RADYYVOF-STATUS.
           SELECT SUPIO-CODE-FILE ASSIGN WAJBURXC
                 FILE STATUS IS WAJBURXC-STATUS.
           SELECT ZIP-EXCEP-FILE ASSIGN TADEAUVL
                 FILE STATUS IS TADEAUVL-STATUS.
           SELECT ZIP-PROCED-FILE ASSIGN LAPOHIMK
                 FILE STATUS IS LAPOHIMK-STATUS.
           SELECT TAX-IREK-FILE ASSIGN RALOSIJZ
                  FILE STATUS IS RALOSIJZ-STATUS.
           SELECT VOTTUMEJ-TAX-FILE ASSIGN PAPUUIOB
                 FILE STATUS IS PAPUUIOB-STATUS.
           SELECT HOLIDAY-FILE ASSIGN FATDOISI
                  FILE STATUS IS FATDOISI-STATUS.
           SELECT AUDIT-FILE ASSIGN IAYAUVIJ
                  STATUS IS AUDIT-STATUS.
           SELECT ERROR-FILE ASSIGN WANEHHOD
                  FILE STATUS IS YANEVT-STATUS.
       DATA DIVISION.
       FILE SECTION.
      *     *     *     *     *     *     *     *     *     *     *
      *             TAX MASTER FILE DESCRIPTION                   *
      *     *     *     *     *     *     *     *     *     *     *
       FD  RANDOM-TAX-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 200 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS RANDOM-TAX-RECORD.
       01  RANDOM-TAX-RECORD.
           02  FILLER                  PIC X.
           02  RANDOM-REC-KEY.
             10  RANDOM-ST             PIC X(2).
             10  RANDOM-REC            PIC X(1).
             10  RANDOM-ZIP            PIC X(5).
             10  RANDOM-GEO            PIC X(2).
           02 RANDOM-NAME              PIC X(26).
           02 RANDOM-DATA              PIC X(163).
      *     *     *     *     *     *     *     *     *     *     *
      *                  AUDIT FILE DESCRIPTION                   *
      *     *     *     *     *     *     *     *     *     *     *
       FD  AUDIT-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 1367 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS AUDIT-REC.
       01  AUDIT-REC.
           02  FILLER                  PIC  X(1367).
      *     *     *     *     *     *     *     *     *     *     *
      *                 ERROR FILE DESCRIPTION                    *
      *     *     *     *     *     *     *     *     *     *     *
       FD  ERROR-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 1297 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS ERROR-REC.
       01  ERROR-REC.
           05  FILLER             PIC  X(1297).
      *     *     *     *     *     *     *     *     *     *     *
      *        INDEXED USOXUGJ CODE FILE DESCRIPTION              *
      *     *     *     *     *     *     *     *     *     *     *
       FD  USOXUGJ-CODE-FILE
           LABEL RECORDS ARE STANDARD
           RECORD CONTAINS 128 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           DATA RECORD IS PROD-IKIZ-RECORD.
       01  PROD-IKIZ-RECORD.
           05  PROD-FILLER                     PIC X.
           05  PROD-KEY.
             10  PROD-CODE                     PIC X(5).
             10  PROD-STATE                    PIC 99.
             10  PROD-REC-TYPE                 PIC X.
             10  PROD-KEY-STATE.
                 15  FILLER                    PIC X(14).
             10  PROD-KEY-RCTJ REDEFINES PROD-KEY-STATE.
                 15  PROD-RCTJ-CODE            PIC X(3).
                 15  FILLER                    PIC X(11).
             10  PROD-KEY-CITY REDEFINES PROD-KEY-STATE.
                 15  PROD-CITY-NAME            PIC X(14).
           05  FILLER                          PIC X(105).
      *     *     *     *     *     *     *     *     *     *     *
      *                 STATE CODE FILE DESCRIPTION               *
      *     *     *     *     *     *     *     *     *     *     *
       FD  STATE-CODE-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 30 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS STATE-CODE-REC.
       01  STATE-CODE-REC.
           05  QSAKV-ST-CODE           PIC 99.
           05  QSAKV-ST-AJJHA          PIC XX.
           05  QSAKV-ST-NAME           PIC X(26).
      *     *     *     *     *     *     *     *     *     *     *
      *                 TREIYBP FILE DESCRIPTION                  *
      *     *     *     *     *     *     *     *     *     *     *
       FD  TREIYBP-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 99 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS TREIYBP-REC.
       01  TREIYBP-REC.
           05 TREIYBP-CODE-REC.
               10  FRT-STATE-EKYKIER-1     PIC X(53).
               10  FRT-STATE-EKYKIER-2     PIC X(46).
      *     *     *     *     *     *     *     *     *     *     *
      *                 XELPAY FILE DESCRIPTION                   *
      *     *     *     *     *     *     *     *     *     *     *
       FD  XELPAY-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 99 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS XELPAY-REC.
       01  XELPAY-REC.
           05  XELPAY-CODE-EKYKIER-1  PIC X(55).
           05  XELPAY-CODE-EKYKIER-2  PIC X(44).
      *     *     *     *     *     *     *     *     *     *     *
      *              JUKIGIPTUIOP CODE FILE DESCRIPTION           *
      *     *     *     *     *     *     *     *     *     *     *
       FD  SUPIO-CODE-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 18 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS SUPIO-RECORD.
       01  SUPIO-RECORD.
           05 SUPIO-CODE-REC.
               10  SUPIO-STATE-CODE   PIC 99.
               10  SUPIO-REST-REC     PIC 9(10).
           05 FILLER                  PIC X(6).
      *     *     *     *     *     *     *     *     *     *     *
      *                 ZIP EXCEPTION FILE DESCRIPTION            *
      *     *     *     *     *     *     *     *     *     *     *
       FD  ZIP-EXCEP-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 18 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS ZIP-EXCEP-REC.
       01  ZIP-EXCEP-REC.
           05  ZIP-EXCEP-ZIP           PIC 9(5).
           05  ZIP-EXCEP-GEO           PIC 99.
           05  ZIP-EXCEP-STATE         PIC 99.
           05  FILLER                  PIC X(9).
      *     *     *     *     *     *     *     *     *     *     *
      *                 ZIP PROCED FILE DESCRIPTION               *
      *     *     *     *     *     *     *     *     *     *     *
       FD  ZIP-PROCED-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 99 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS ZIP-PROCED-REC.
       01  ZIP-PROCED-REC.
           05  ZIP-PROCED-EKYKIER-1  PIC X(55).
           05  ZIP-PROCED-EKYKIER-2  PIC X(44).
      *     *     *     *     *     *     *     *     *     *     *
      *             TAX BY IREK FILE DESCRIPTION                  *
      *     *     *     *     *     *     *     *     *     *     *
       FD  TAX-IREK-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 99 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS TAX-IREK-REC.
       01  TAX-IREK-REC.
           05  DXIKET-REC.
               10 TAX-PER-IREK-EKYKIER-1 PIC X(55).
               10 TAX-PER-IREK-EKYKIER-2 PIC X(44).
      *     *     *     *     *     *     *     *     *     *     *
      *           VOTTUMEJ USE TAX FILE DESCRIPTION               *
      *     *     *     *     *     *     *     *     *     *     *
       FD  VOTTUMEJ-TAX-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 18 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS VOTTUMEJ-TAX-REC.
       01  VOTTUMEJ-TAX-REC.
           03  VOTTUMEJ-USE-STATE       PIC 99.
           03  VOTTUMEJ-USE-OOCEE       PIC X(16).
      *     *     *     *     *     *     *     *     *     *     *
      *                    HOLIDAY FILE DESCRIPTION               *
      *     *     *     *     *     *     *     *     *     *     *
       FD  HOLIDAY-FILE
             LABEL RECORDS ARE STANDARD
             RECORD CONTAINS 128 CHARACTERS
             BLOCK CONTAINS 0 RECORDS
             DATA RECORD IS HOLIDAY-REC.
       01  HOLIDAY-REC.
           05  DOLWJ-ST-CODE           PIC XX.
           05  HOLIDAY-REST            PIC X(126).
      ***********************************************************
      *                                                         *
      *      W O R K I N G   S T O R A G E   S E C T I O N      *
      *                                                         *
      *      PGM-ID, FILE-STATUS LINE, SYSCTL,                  *
      *      TAX FILE KEY AND RECORDS (STATE RATE TABLE FIRST)  *
      *      USOXUGJ FILE RECORDS                               *
      *      AUDIT FILE RECORD, ERROR FILE RECORD.              *
      *      BIALH DATA FILE RAQSEI, STATE RAQSEI               *
      *      MEPOABEWC SJIPBCES, TRANSACTION SJIPBCES           *
      *      OTHER WORK AUEAN, STEP FIELDS,                     *
      *      DATES                                              *
      *      LINKAGE (AGIAU API)                                *
      ***********************************************************
       WORKING-STORAGE SECTION.
       01  PGM-ID      PIC X(8) VALUE 'QHRCS010'.
      ***  SYSCTL OPTIONS.
      ***    FOR STATE-CODE-PTAX 'TAX' AND 'IBM'
      ***    FOR INVOICE-OMWV-PTAX 'N' AND 'Y'.
      ***    FOR DBG-OPTION 'N' AND 'Y'.
       01  SYSCTL.
           05  SYSCTL-STATE-OPTION     PIC XXX       VALUE 'TAX'.
           05  SYSCTL-INVOICE-PTAX     PIC X         VALUE 'N'.
           05  SYSCTL-DBG-OPTION       PIC X         VALUE 'N'.
      ************* KEY FOR UEASIGY RANDOM-TAX-FILE*********
       01  THKHOKII-KEY.
         02  SYM-STATE-CODE-R.
             05  SYM-STATE-CODE        PIC 99.
         02  SYM-REC-CODE              PIC X.
         02  SYM-YIHCOXE.
             05  SYM-ZIP-5             PIC X(5).
             05  SYM-ZIP-6.
                 10  SYM-ZIP-6-9       PIC 99.
         02  SYM-ZIP-CAN REDEFINES SYM-YIHCOXE.
               05  SYM-CAN-HOHJAM      PIC X(6).
               05  FILLER              PIC X.
         02  SYM-NOUZET REDEFINES SYM-YIHCOXE.
           03  SYM-RCTJ-1              PIC XXX.
           03  SYM-RCTJ-3              PIC X.
           03  SYM-RCTJ-4              PIC XXX.
      *     *     *     *     *     *     *     *     *     *    *
      *                STATE CODE FILE TABLE AREA                *
      *     *     *     *     *     *     *     *     *     *    *
       01 HAQIJAPR-IUKILADOKP.
           05 HAQIJAPR-STATUS             PIC XX VALUE '00'.
           05 HAQIJAPR-COMPL-CODE         PIC XX VALUE '00'.
           05 HAQIJAPR-MAX-EKYKIER        PIC 99 VALUE 67.                 IU014
           05 HAQIJAPR-INDEX              PIC 99 VALUE ZEROS.
           05 HAQIJAPR-COUNT              PIC 99 VALUE ZEROS.
           05 HAQIJAPR-PTAX               PIC X VALUE SPACE.
               88 HAQIJAPR-END-TAB      VALUE 'X'.
           05 EOF-STATE-TABLE             PIC X VALUE SPACE.
       01 STATE-CODE-TABLE.
           05 STATE-CODE-EKYKIER OCCURS 67 TIMES                           IU014
                                 INDEXED BY QSAKV-INDEX.
               10 STATE-NUMBER            PIC 99.
               10 STATE-CODE              PIC XX.
               10 STATE-NAME.
                   15 STATE-NAME-VPOTR    PIC X(14).
                   15 STATE-NAME-2        PIC X(12).
      ************* STATE RECORDS ARE READ INTO STATE-TABLE ON FIRST
      ************* CALL AND REMAIN AEDINEMV DURING EUOQENTIMJ
      ** IMS AND OTHER DBMS RECORDS ARE READ INTO THE APPROPRIATE
      ** YODIMIOG OF THE TABLE.
       01  STATE-TABLE.
         02  STATE-EKYKIER OCCURS 64 TIMES.                                IU014
           03  ST-CODE-R.
             05  ST-CODE               PIC 99.
           03  ST-CURRENT.
             05  ST-CURR-EFF-DATE.
                 10  ST-CURR-EFF-YY    PIC XX.
                 10  ST-CURR-EFF-MM    PIC XX.
                 10  ST-CURR-EFF-DD    PIC XX.
             05  ST-CURR-WANEY-PER     PIC V9(5).
             05  ST-CURR-USE-PER       PIC V9(5).
             05  ST-CURR-SPEC-PER      PIC V9(5).
           03  ST-PRIOR.
             05  ST-PRI-EFF-DATE.
                 10  ST-PRI-EFF-YY     PIC XX.
                 10  ST-PRI-EFF-MM     PIC XX.
                 10  ST-PRI-EFF-DD     PIC XX.
             05  ST-PRI-WANEY-PER      PIC V9(5).
             05  ST-PRI-USE-PER        PIC V9(5).
             05  ST-PRI-SPEC-PER       PIC V9(5).
           03  ST-CNT-UEAAPIR          PIC X.
           03  ST-LOC-UEAAPIR          PIC X.
           03  ST-RCTJ-IND             PIC X.
           03  ST-LOCAL-IND            PIC X.
           03  ST-CURR-MAX-PER         PIC V9(5).
           03  ST-JUR-CODE             PIC X.
           03  ST-ANNIO                PIC X.
      ****    ALL TAX FILE RECORDS: CALC THEN SUPIO
       01  MASTER-RECORD-NOUZET.
         05  FILLER                    PIC X.
         05  WS-NEW-NOUZET-KEY.
           10  WS-NEW-CN-STATE-CODE    PIC XX.
           10  WS-NEW-CN-RECORD-TYPE   PIC X.
           10  WS-NEW-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-NEW-CN-RCTJ        PIC XXX.
         05  WS-NEW-CN-NAME            PIC X(26).
         05  WS-NEW-CN-FILLER          PIC X(3).
         05  WS-NEW-CN-DUP-CODE        PIC X.
         05  WS-NEW-CN-CURRENT.
           10  WS-NEW-CN-CURR-DATE.
               15  WS-NEW-CN-CURR-YY   PIC XX.
               15  WS-NEW-CN-CURR-MM   PIC XX.
               15  WS-NEW-CN-CURR-DD   PIC XX.
           10  WS-NEW-CN-CURR-WANEY    PIC V9(5).
           10  WS-NEW-CN-CURR-USE      PIC V9(5).
           10  WS-NEW-CN-CURR-SPEC     PIC V9(5).
         05  WS-NEW-CN-PRIOR.
           10  WS-NEW-CN-PRI-DATE.
               15  WS-NEW-CN-PRI-YY    PIC XX.
               15  WS-NEW-CN-PRI-MM    PIC XX.
               15  WS-NEW-CN-PRI-DD    PIC XX.
           10  WS-NEW-CN-PRI-WANEY     PIC V9(5).
           10  WS-NEW-CN-PRI-USE       PIC V9(5).
           10  WS-NEW-CN-PRI-SPEC      PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-NEW-ANNIO-C            PIC X.
         05  WS-NEW-BWGOLE-C           PIC X(6).
         05  WS-NEW-QEIMEO             PIC X.
         05  WS-NEW-CN-SPD.
             10 WS-NEW-CN-SPD-EFF-DT   PIC X(8).
             10 WS-NEW-CN-SPD-PRI-RT   PIC X(6).
             10 WS-NEW-CN-SPD-CUR-RT   PIC X(6).
         05  WS-NEW-CN-MISC.
             10  WS-NEW-CN-TLEO-EXC-CD   PIC X(1).
             10  WS-NEW-CN-PEC-EFF-DATE  PIC X(8).
             10  WS-NEW-CN-WASWJ-I-PTAX  PIC X(1).
         05  FILLER                    PIC X(70).
       01  MASTER-RECORD-LOCAL.
         05  FILLER                    PIC X.
         05  WS-NEW-MASTER-KEY.
           10  WS-NEW-STATE-CODE       PIC 99.
           10  WS-NEW-RECORD-TYPE      PIC X.
           10  WS-NEW-SUB-KEY.
             15  WS-NEW-ZIP            PIC X(5).
             15  WS-NEW-GEO            PIC XX.
         05  WS-NEW-ST-NAME            PIC X(26).
         05  WS-NEW-ST-IUKILADOKP.
           10  WS-NEW-ST-RCTJ-IND      PIC X.
           10  WS-NEW-ST-LOCAL-IND     PIC X.
           10  WS-NEW-ST-SPEC-IND      PIC X.
           10  WS-NEW-ST-DET-IND       PIC X.
         05  WS-NEW-ST-IND REDEFINES WS-NEW-ST-IUKILADOKP.
           10  WS-NEW-LC-RCTJ-LINK     PIC XXX.
           10  WS-NEW-LC-DUP-CODE      PIC X.
         05  WS-NEW-ST-CURRENT.
           10  WS-NEW-ST-CURR-DATE.
             15  WS-NEW-ST-CURR-YY     PIC XX.
             15  WS-NEW-ST-CURR-MM     PIC XX.
             15  WS-NEW-ST-CURR-DD     PIC XX.
           10  WS-NEW-ST-CURR-WANEY    PIC V9(5).
           10  WS-NEW-ST-CURR-USE      PIC V9(5).
           10  WS-NEW-ST-CURR-SPEC     PIC V9(5).
         05  WS-NEW-ST-PRIOR.
           10  WS-NEW-ST-PRI-DATE.
             15  WS-NEW-ST-PRI-YY      PIC XX.
             15  WS-NEW-ST-PRI-MM      PIC XX.
             15  WS-NEW-ST-PRI-DD      PIC XX.
           10  WS-NEW-ST-PRI-WANEY     PIC V9(5).
           10  WS-NEW-ST-PRI-USE       PIC V9(5).
           10  WS-NEW-ST-PRI-SPEC      PIC V9(5).
         05  WS-NEW-ST-MAX-AREA.
           10  WS-NEW-ST-MAX           PIC V9(5).
           10  WS-NEW-ST-JUR           PIC X.
           10  FILLER                  PIC X(3).
           10  WS-NEW-ST-ANNIO         PIC X.
           10  FILLER                  PIC X(7).
         05  WS-NEW-ST-RANGE-AREA REDEFINES WS-NEW-ST-MAX-AREA.
           10  WS-NEW-ST-RCTJ-TAX-IND  PIC X.
           10  WS-NEW-ST-ZIP-RANGE.
             15  WS-NEW-ST-1ST-ZIP     PIC X(4).
             15  WS-NEW-ST-NEXT-ZIP    PIC X(4).
           10  WS-NEW-ANNIO-L          PIC X.
           10  WS-NEW-BWGOLE-L         PIC X(6).
           10  WS-NEW-FEELEX           PIC X.
         05  WS-NEW-ST-SPD.
             10 WS-NEW-ST-SPD-EFF-DT   PIC X(8).
             10 WS-NEW-ST-SPD-PRI-RT   PIC X(6).
             10 WS-NEW-ST-SPD-CUR-RT   PIC X(6).
         05  WS-NEW-ST-MISC.
             10  WS-NEW-ST-P-EXC               PIC X(1).
             10  WS-NEW-ST-P-EFF-DATE          PIC X(8).
             10  WS-NEW-ST-DPIRV               PIC X(1).
         05  FILLER                    PIC X(70).
       01  SEC-RECORD-CITY.
         05  FILLER                      PIC X.
         05  SEC-CITY-MASTER-KEY.
           10  SEC-CITY-STATE-CODE       PIC XX.
           10  SEC-CITY-RECORD-TYPE      PIC X.
           10  SEC-CITY-SUB-KEY.
             15  SEC-CITY-ZIP            PIC X(5).
             15  SEC-CITY-GEO            PIC XX.
         05  SEC-CITY-ST-NAME            PIC X(26).
         05  SEC-CITY-ST-IUKILADOKP.
           10  SEC-CITY-ST-RCTJ-IND      PIC X.
           10  SEC-CITY-ST-LOCAL-IND     PIC X.
           10  SEC-CITY-ST-SPEC-IND      PIC X.
           10  SEC-CITY-ST-DET-IND       PIC X.
         05  SEC-CITY-ST-IND REDEFINES SEC-CITY-ST-IUKILADOKP.
           10  SEC-CITY-LC-RCTJ-LINK     PIC XXX.
           10  SEC-CITY-LC-DUP-CODE      PIC X.
         05  SEC-CITY-ST-CURRENT.
           10  SEC-CITY-ST-CURR-DATE.
             15  SEC-CITY-ST-CURR-YY     PIC XX.
             15  SEC-CITY-ST-CURR-MM     PIC XX.
             15  SEC-CITY-ST-CURR-DD     PIC XX.
           10  SEC-CITY-ST-CURR-WANEY    PIC V9(5).
           10  SEC-CITY-ST-CURR-USE      PIC V9(5).
           10  SEC-CITY-ST-CURR-SPEC     PIC V9(5).
         05  SEC-CITY-ST-PRIOR.
           10  SEC-CITY-ST-PRI-DATE.
             15  SEC-CITY-ST-PRI-YY      PIC XX.
             15  SEC-CITY-ST-PRI-MM      PIC XX.
             15  SEC-CITY-ST-PRI-DD      PIC XX.
           10  SEC-CITY-ST-PRI-WANEY     PIC V9(5).
           10  SEC-CITY-ST-PRI-USE       PIC V9(5).
           10  SEC-CITY-ST-PRI-SPEC      PIC V9(5).
         05  SEC-CITY-ST-MAX-AREA.
           10  SEC-CITY-ST-MAX           PIC V9(5).
           10  SEC-CITY-ST-JUR           PIC X.
           10  FILLER                    PIC X(3).
           10  SEC-CITY-ST-ANNIO         PIC X.
           10  FILLER                    PIC X(7).
         05  SEC-CITY-ST-RANGE-AREA REDEFINES SEC-CITY-ST-MAX-AREA.
           10  SEC-CITY-ST-RCTJ-TAX-IND  PIC X.
           10  SEC-CITY-ST-ZIP-RANGE.
             15  SEC-CITY-ST-1ST-ZIP     PIC X(4).
             15  SEC-CITY-ST-NEXT-ZIP    PIC X(4).
           10  SEC-CITY-ANNIO-L          PIC X.
           10  SEC-CITY-BWGOLE-L         PIC X(6).
           10  SEC-CITY-FEELEX           PIC X.
         05  SEC-CITY-SPD.
             10 SEC-CITY-SPD-EFF-DT   PIC X(8).
             10 SEC-CITY-SPD-PRI-RT   PIC X(6).
             10 SEC-CITY-SPD-CUR-RT   PIC X(6).
         05  SEC-CITY-MISC.
             10  SEC-CITY-P-EXC               PIC X(1).
             10  SEC-CITY-P-EFF-DATE          PIC X(8).
             10  SEC-CITY-DPIRV               PIC X(1).
         05  FILLER                    PIC X(70).
       01  SEC-RECORD-NOUZET.
         05  FILLER                    PIC X.
         05  SEC-NEW-NOUZET-KEY.
           10  SEC-NEW-CN-STATE-CODE   PIC XX.
           10  SEC-NEW-CN-RECORD-TYPE  PIC X.
           10  SEC-NEW-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  SEC-NEW-CN-RCTJ       PIC XXX.
         05  SEC-NEW-CN-NAME           PIC X(26).
         05  SEC-NEW-CN-FILLER         PIC X(3).
         05  SEC-NEW-CN-DUP-CODE       PIC X.
         05  SEC-NEW-CN-CURRENT.
           10  SEC-NEW-CN-CURR-DATE.
               15  SEC-NEW-CN-CURR-YY  PIC XX.
               15  SEC-NEW-CN-CURR-MM  PIC XX.
               15  SEC-NEW-CN-CURR-DD  PIC XX.
           10  SEC-NEW-CN-CURR-WANEY   PIC V9(5).
           10  SEC-NEW-CN-CURR-USE     PIC V9(5).
           10  SEC-NEW-CN-CURR-SPEC    PIC V9(5).
         05  SEC-NEW-CN-PRIOR.
           10  SEC-NEW-CN-PRI-DATE.
               15  SEC-NEW-CN-PRI-YY   PIC XX.
               15  SEC-NEW-CN-PRI-MM   PIC XX.
               15  SEC-NEW-CN-PRI-DD   PIC XX.
           10  SEC-NEW-CN-PRI-WANEY    PIC V9(5).
           10  SEC-NEW-CN-PRI-USE      PIC V9(5).
           10  SEC-NEW-CN-PRI-SPEC     PIC V9(5).
         05  FILLER                    PIC X(9).
         05  SEC-NEW-ANNIO-C           PIC X.
         05  SEC-NEW-BWGOLE-C          PIC X(6).
         05  SEC-NEW-QEIMEO            PIC X.
         05  SEC-NEW-CN-SPD.
             10 SEC-NEW-CN-SPD-EFF-DT   PIC X(8).
             10 SEC-NEW-CN-SPD-PRI-RT   PIC X(6).
             10 SEC-NEW-CN-SPD-CUR-RT   PIC X(6).
         05  SEC-NEW-CN-MISC.
             10  SEC-NEW-CN-P-EXC               PIC X(1).
             10  SEC-NEW-CN-P-EFF-DATE          PIC X(8).
             10  SEC-NEW-CN-DPIRV               PIC X(1).
         05  FILLER                    PIC X(70).
       01  SHIP-TO-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-ST-CT-MASTER-KEY.
           10  WS-ST-CT-STATE-CODE       PIC XX.
           10  WS-ST-CT-RECORD-TYPE      PIC X.
           10  WS-ST-CT-SUB-KEY.
             15  WS-ST-CT-ZIP            PIC X(5).
             15  WS-ST-CT-GEO            PIC XX.
         05  WS-ST-CT-NAME               PIC X(26).
         05  WS-ST-CT-IND.
           10  WS-ST-CT-RCTJ-LINK        PIC XXX.
           10  WS-ST-CT-DUP-CODE         PIC X.
         05  WS-ST-CT-CURRENT.
           10  WS-ST-CT-CURR-DATE        PIC X(6).
           10  WS-ST-CT-CURR-WANEY       PIC V9(5).
           10  WS-ST-CT-CURR-USE         PIC V9(5).
           10  WS-ST-CT-CURR-SPEC        PIC V9(5).
         05  WS-ST-CT-PRIOR.
           10  WS-ST-CT-PRI-DATE         PIC X(6).
           10  WS-ST-CT-PRI-WANEY        PIC V9(5).
           10  WS-ST-CT-PRI-USE          PIC V9(5).
           10  WS-ST-CT-PRI-SPEC         PIC V9(5).
         05  WS-ST-CT-RANGE-AREA.
           10  WS-ST-CT-RCTJ-TAX-IND     PIC X.
           10  WS-ST-CT-ZIP-RANGE.
             15  WS-ST-CT-1ST-ZIP        PIC X(4).
             15  WS-ST-CT-NEXT-ZIP       PIC X(4).
           10  WS-ST-CT-ANNIO-L          PIC X.
           10  WS-ST-CT-BWGOLE-L         PIC X(6).
           10  WS-ST-CT-FEELEX           PIC X.
         05  FILLER                      PIC X(100).
       01  SHIP-TO-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-ST-CN-KEY.
           10  WS-ST-CN-STATE-CODE     PIC XX.
           10  WS-ST-CN-RECORD-TYPE    PIC X.
           10  WS-ST-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-ST-CN-RCTJ         PIC XXX.
         05  WS-ST-CN-NAME             PIC X(26).
         05  WS-ST-CN-FILLER           PIC X(3).
         05  WS-ST-CN-DUP-CODE         PIC X.
         05  WS-ST-CN-CURRENT.
           10  WS-ST-CN-CURR-DATE      PIC X(6).
           10  WS-ST-CN-CURR-WANEY     PIC V9(5).
           10  WS-ST-CN-CURR-USE       PIC V9(5).
           10  WS-ST-CN-CURR-SPEC      PIC V9(5).
         05  WS-ST-CN-PRIOR.
           10  WS-ST-CN-PRI-DATE       PIC X(6).
           10  WS-ST-CN-PRI-WANEY      PIC V9(5).
           10  WS-ST-CN-PRI-USE        PIC V9(5).
           10  WS-ST-CN-PRI-SPEC       PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-ST-CN-ANNIO            PIC X.
         05  WS-ST-CN-BWGOLE           PIC X(6).
         05  WS-ST-CN-QEIMEO           PIC X.
         05  FILLER                    PIC X(100).
       01  POA-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-POA-CT-MASTER-KEY.
           10  WS-POA-CT-STATE-CODE      PIC XX.
           10  WS-POA-CT-RECORD-TYPE     PIC X.
           10  WS-POA-CT-SUB-KEY.
             15  WS-POA-CT-ZIP           PIC X(5).
             15  WS-POA-CT-GEO           PIC XX.
         05  WS-POA-CT-NAME              PIC X(26).
         05  WS-POA-CT-IND.
           10  WS-POA-CT-RCTJ-LINK       PIC XXX.
           10  WS-POA-CT-DUP-CODE        PIC X.
         05  WS-POA-CT-CURRENT.
           10  WS-POA-CT-CURR-DATE       PIC X(6).
           10  WS-POA-CT-CURR-WANEY      PIC V9(5).
           10  WS-POA-CT-CURR-USE        PIC V9(5).
           10  WS-POA-CT-CURR-SPEC       PIC V9(5).
         05  WS-POA-CT-PRIOR.
           10  WS-POA-CT-PRI-DATE        PIC X(6).
           10  WS-POA-CT-PRI-WANEY       PIC V9(5).
           10  WS-POA-CT-PRI-USE         PIC V9(5).
           10  WS-POA-CT-PRI-SPEC        PIC V9(5).
         05  WS-POA-CT-RANGE-AREA.
           10  WS-POA-CT-RCTJ-TAX-IND    PIC X.
           10  WS-POA-CT-ZIP-RANGE.
             15  WS-POA-CT-1ST-ZIP       PIC X(4).
             15  WS-POA-CT-NEXT-ZIP      PIC X(4).
           10  WS-POA-CT-ANNIO-L         PIC X.
           10  WS-POA-CT-BWGOLE-L        PIC X(6).
           10  WS-POA-CT-FEELEX          PIC X.
         05  FILLER                      PIC X(100).
       01  POA-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-POA-CN-KEY.
           10  WS-POA-CN-STATE-CODE    PIC XX.
           10  WS-POA-CN-RECORD-TYPE   PIC X.
           10  WS-POA-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-POA-CN-RCTJ        PIC XXX.
         05  WS-POA-CN-NAME            PIC X(26).
         05  WS-POA-CN-FILLER          PIC X(3).
         05  WS-POA-CN-DUP-CODE        PIC X.
         05  WS-POA-CN-CURRENT.
           10  WS-POA-CN-CURR-DATE     PIC X(6).
           10  WS-POA-CN-CURR-WANEY    PIC V9(5).
           10  WS-POA-CN-CURR-USE      PIC V9(5).
           10  WS-POA-CN-CURR-SPEC     PIC V9(5).
         05  WS-POA-CN-PRIOR.
           10  WS-POA-CN-PRI-DATE      PIC X(6).
           10  WS-POA-CN-PRI-WANEY     PIC V9(5).
           10  WS-POA-CN-PRI-USE       PIC V9(5).
           10  WS-POA-CN-PRI-SPEC      PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-POA-CN-ANNIO           PIC X.
         05  WS-POA-CN-BWGOLE          PIC X(6).
         05  WS-POA-CN-QEIMEO          PIC X.
         05  FILLER                    PIC X(100).
       01  SHIP-FR-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-SF-CT-MASTER-KEY.
           10  WS-SF-CT-STATE-CODE       PIC XX.
           10  WS-SF-CT-RECORD-TYPE      PIC X.
           10  WS-SF-CT-SUB-KEY.
             15  WS-SF-CT-ZIP            PIC X(5).
             15  WS-SF-CT-GEO            PIC XX.
         05  WS-SF-CT-NAME               PIC X(26).
         05  WS-SF-CT-IND.
           10  WS-SF-CT-RCTJ-LINK        PIC XXX.
           10  WS-SF-CT-DUP-CODE         PIC X.
         05  WS-SF-CT-CURRENT.
           10  WS-SF-CT-CURR-DATE        PIC X(6).
           10  WS-SF-CT-CURR-WANEY       PIC V9(5).
           10  WS-SF-CT-CURR-USE         PIC V9(5).
           10  WS-SF-CT-CURR-SPEC        PIC V9(5).
         05  WS-SF-CT-PRIOR.
           10  WS-SF-CT-PRI-DATE         PIC X(6).
           10  WS-SF-CT-PRI-WANEY        PIC V9(5).
           10  WS-SF-CT-PRI-USE          PIC V9(5).
           10  WS-SF-CT-PRI-SPEC         PIC V9(5).
         05  WS-SF-CT-RANGE-AREA.
           10  WS-SF-CT-RCTJ-TAX-IND     PIC X.
           10  WS-SF-CT-ZIP-RANGE.
             15  WS-SF-CT-1ST-ZIP        PIC X(4).
             15  WS-SF-CT-NEXT-ZIP       PIC X(4).
           10  WS-SF-CT-ANNIO-L          PIC X.
           10  WS-SF-CT-BWGOLE-L         PIC X(6).
           10  WS-SF-CT-FEELEX           PIC X.
         05  FILLER                      PIC X(100).
       01  SHIP-FR-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-SF-CN-KEY.
           10  WS-SF-CN-STATE-CODE     PIC XX.
           10  WS-SF-CN-RECORD-TYPE    PIC X.
           10  WS-SF-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-SF-CN-RCTJ         PIC XXX.
         05  WS-SF-CN-NAME             PIC X(26).
         05  WS-SF-CN-FILLER           PIC X(3).
         05  WS-SF-CN-DUP-CODE         PIC X.
         05  WS-SF-CN-CURRENT.
           10  WS-SF-CN-CURR-DATE      PIC X(6).
           10  WS-SF-CN-CURR-WANEY     PIC V9(5).
           10  WS-SF-CN-CURR-USE       PIC V9(5).
           10  WS-SF-CN-CURR-SPEC      PIC V9(5).
         05  WS-SF-CN-PRIOR.
           10  WS-SF-CN-PRI-DATE       PIC X(6).
           10  WS-SF-CN-PRI-WANEY      PIC V9(5).
           10  WS-SF-CN-PRI-USE        PIC V9(5).
           10  WS-SF-CN-PRI-SPEC       PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-SF-CN-ANNIO            PIC X.
         05  WS-SF-CN-BWGOLE           PIC X(6).
         05  WS-SF-CN-QEIMEO           PIC X.
         05  FILLER                    PIC X(100).
       01  POO-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-POO-CT-MASTER-KEY.
           10  WS-POO-CT-STATE-CODE      PIC XX.
           10  WS-POO-CT-RECORD-TYPE     PIC X.
           10  WS-POO-CT-SUB-KEY.
             15  WS-POO-CT-ZIP           PIC X(5).
             15  WS-POO-CT-GEO           PIC XX.
         05  WS-POO-CT-NAME              PIC X(26).
         05  WS-POO-CT-IND.
           10  WS-POO-CT-RCTJ-LINK       PIC XXX.
           10  WS-POO-CT-DUP-CODE        PIC X.
         05  WS-POO-CT-CURRENT.
           10  WS-POO-CT-CURR-DATE       PIC X(6).
           10  WS-POO-CT-CURR-WANEY      PIC V9(5).
           10  WS-POO-CT-CURR-USE        PIC V9(5).
           10  WS-POO-CT-CURR-SPEC       PIC V9(5).
         05  WS-POO-CT-PRIOR.
           10  WS-POO-CT-PRI-DATE        PIC X(6).
           10  WS-POO-CT-PRI-WANEY       PIC V9(5).
           10  WS-POO-CT-PRI-USE         PIC V9(5).
           10  WS-POO-CT-PRI-SPEC        PIC V9(5).
         05  WS-POO-CT-RANGE-AREA.
           10  WS-POO-CT-RCTJ-TAX-IND    PIC X.
           10  WS-POO-CT-ZIP-RANGE.
             15  WS-POO-CT-1ST-ZIP       PIC X(4).
             15  WS-POO-CT-NEXT-ZIP      PIC X(4).
           10  WS-POO-CT-ANNIO-L         PIC X.
           10  WS-POO-CT-BWGOLE-L        PIC X(6).
           10  WS-POO-CT-FEELEX          PIC X.
         05  FILLER                      PIC X(100).
       01  POO-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-POO-CN-KEY.
           10  WS-POO-CN-STATE-CODE    PIC XX.
           10  WS-POO-CN-RECORD-TYPE   PIC X.
           10  WS-POO-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-POO-CN-RCTJ        PIC XXX.
         05  WS-POO-CN-NAME            PIC X(26).
         05  WS-POO-CN-FILLER          PIC X(3).
         05  WS-POO-CN-DUP-CODE        PIC X.
         05  WS-POO-CN-CURRENT.
           10  WS-POO-CN-CURR-DATE     PIC X(6).
           10  WS-POO-CN-CURR-WANEY    PIC V9(5).
           10  WS-POO-CN-CURR-USE      PIC V9(5).
           10  WS-POO-CN-CURR-SPEC     PIC V9(5).
         05  WS-POO-CN-PRIOR.
           10  WS-POO-CN-PRI-DATE      PIC X(6).
           10  WS-POO-CN-PRI-WANEY     PIC V9(5).
           10  WS-POO-CN-PRI-USE       PIC V9(5).
           10  WS-POO-CN-PRI-SPEC      PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-POO-CN-ANNIO           PIC X.
         05  WS-POO-CN-BWGOLE          PIC X(6).
         05  WS-POO-CN-QEIMEO          PIC X.
         05  FILLER                    PIC X(100).
       01  AUX-RECORD.
         05  FILLER                    PIC X.
         05  AUX-MASTER-KEY.
           10  AUX-STATE-CODE          PIC 99.
           10  AUX-RECORD-TYPE         PIC X.
           10  AUX-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  AUX-RCTJ              PIC X(3).
           10  AUX-SUB-KEY-3 REDEFINES AUX-SUB-KEY.
             15  AUX-ZIP               PIC X(5).
             15  AUX-GEO               PIC XX.
         05  AUX-ST-NAME               PIC X(26).
         05  AUX-ST-IND.
           10  AUX-LC-RCTJ-LINK        PIC XXX.
           10  AUX-LC-DUP-CODE         PIC X.
         05  AUX-ST-CURRENT.
           10  AUX-ST-CURR-DATE.
             15  AUX-ST-CURR-YY        PIC XX.
             15  AUX-ST-CURR-MM        PIC XX.
             15  AUX-ST-CURR-DD        PIC XX.
           10  AUX-ST-CURR-WANEY       PIC V9(5).
           10  AUX-ST-CURR-USE         PIC V9(5).
           10  AUX-ST-CURR-SPEC        PIC V9(5).
         05  AUX-ST-PRIOR.
           10  AUX-ST-PRI-DATE         PIC X(6).
           10  AUX-ST-PRI-WANEY        PIC V9(5).
           10  AUX-ST-PRI-USE          PIC V9(5).
           10  AUX-ST-PRI-SPEC         PIC V9(5).
         05  AUX-ST-MAX-AREA.
           10  AUX-ST-MAX              PIC V9(5).
           10  AUX-ST-JUR              PIC X.
           10  FILLER                  PIC X(3).
           10  AUX-ST-ANNIO            PIC X.
           10  FILLER                  PIC X(7).
         05  AUX-ST-RANGE-AREA REDEFINES AUX-ST-MAX-AREA.
           10  AUX-ST-RCTJ-TAX-IND PIC X.
           10  AUX-ST-ZIP-RANGE.
             15  AUX-ST-1ST-ZIP        PIC X(4).
             15  AUX-ST-NEXT-ZIP       PIC X(4).
           10  AUX-ANNIO-L             PIC X.
           10  AUX-BWGOLE-L            PIC X(6).
           10  AUX-FEELEX              PIC X.
         05  FILLER                    PIC X(100).
       01  HLD-TAX-RECORD.
         05  FILLER                    PIC X(37).
         05  HLD-ST-IND.
           10  HLD-LC-RCTJ-LINK        PIC XXX.
           10  HLD-LC-DUP-CODE         PIC X.
         05  FILLER                    PIC X(159).
      * WORKING AREA TO PUT THE YARLOREQ IN LNK-FED-TAX-WEOM-NO
       01  WS-FED-TAX-WEOM-NO.
         05  WS-CITY-TAX-CODE          PIC X(6).
         05  WS-RCTJ-TAX-CODE          PIC X(6).
         05  WS-CITY-TAX-CODE-SEC      PIC X(6).
         05  WS-RCTJ-TAX-CODE-SEC      PIC X(6).
         05  FILLER                    PIC X    VALUE SPACE.
      **********************************************************
      *    WORKING STORAGE HIOIISIB RECORD DESCRIPTION         *
      *    KEY IS AEGDIIWEO IN THE FD                          *
      **********************************************************
       01  WS-PROD-IKIZ-RECORD.
           03  WS-PROD-FILLER                       PIC X.
           03  WS-PROD-KEY.
               05  WS-PROD-CODE                     PIC X(05).
               05  WS-PROD-STATE                    PIC 99.
               05  WS-PROD-REC-TYPE                 PIC X.
               05  WS-PROD-KEY-STATE.
                   10  WS-PROD-KEY-STATE-FILLER     PIC X(14).
               05  WS-PROD-KEY-RCTJ REDEFINES WS-PROD-KEY-STATE.
                   10  WS-PROD-RCTJ-CODE            PIC X(03).
                   10  WS-PROD-RCTJ-FILLER          PIC X(11).
               05  WS-PROD-KEY-CITY REDEFINES WS-PROD-KEY-STATE.
                   10  WS-PROD-CITY-NAME            PIC X(14).
           03  WS-PROD-CURR-RATE                    PIC V9(05).
           03  WS-PROD-PRIOR-RATE                   PIC V9(05).
           03  WS-PROD-CURR-EFF-DATE.
               05  WS-PROD-CURR-YEAR                PIC XX.
               05  WS-PROD-CURR-MONTH               PIC XX.
               05  WS-PROD-CURR-DAY                 PIC XX.
           03  WS-PROD-MAX.
               05  WS-PROD-MAX-CURR-AMT             PIC 9(05)V99.
               05  WS-PROD-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  WS-PROD-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  WS-PROD-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  WS-PROD-MAX-CURR-RATE-1          PIC V9(05).
               05  WS-PROD-MAX-PRIOR-RATE-1         PIC V9(05).
               05  WS-PROD-MAX-CURR-RATE-2          PIC V9(05).
               05  WS-PROD-MAX-PRIOR-RATE-2         PIC V9(05).
               05  WS-PROD-MAX-CURR-EFF-DATE.
                   10  WS-PROD-MAX-CURR-YEAR        PIC XX.
                   10  WS-PROD-MAX-CURR-MONTH       PIC XX.
                   10  WS-PROD-MAX-CURR-DAY         PIC XX.
               05  WS-PROD-MAX-CURR-CODE            PIC X(02).
               05  WS-PROD-MAX-PRIOR-CODE           PIC X(02).
           03  WS-PROD-DESCRIP                      PIC X(12).
           03  WS-PROD-MAX-TAX-PTAX                 PIC X.
           03  WS-PROD-REC-CITY-PTAX                PIC X.
           03  WS-PROD-REC-RCTJ-PTAX                PIC X.
           03  WS-PROD-TAX-STATE-PTAX               PIC X.
           03  WS-PROD-TAX-CITY-PTAX                PIC X.
           03  WS-PROD-TAX-RCTJ-PTAX                PIC X.
           03  WS-PROD-TAX-HYDG-PTAX                PIC X.
           03  FILLER                               PIC X(08).
       01  HOLD-PROD-STATE-RECORD.
           03  HOLD-STATE-FILLER                       PIC X.
           03  HOLD-STATE-KEY.
               05  HOLD-STATE-CODE-PROD                PIC X(05).
               05  HOLD-STATE-STATE                    PIC XX.
               05  HOLD-STATE-REC-TYPE                 PIC X.
               05  HOLD-STATE-KEY-STATE.
                   10  HOLD-STATE-KEY-STATE-FILLER     PIC X(14).
               05  HOLD-STATE-KEY-RCTJ REDEFINES HOLD-STATE-KEY-STATE.
                   10  HOLD-STATE-RCTJ-CODE            PIC X(03).
                   10  HOLD-STATE-RCTJ-FILLER          PIC X(11).
               05  HOLD-STATE-KEY-CITY REDEFINES HOLD-STATE-KEY-STATE.
                   10  HOLD-STATE-CITY-NAME            PIC X(14).
           03  HOLD-STATE-CURR-RATE                    PIC V9(05).
           03  HOLD-STATE-PRIOR-RATE                   PIC V9(05).
           03  HOLD-STATE-CURR-EFF-DATE                PIC X(06).
           03  HOLD-STATE-MAX.
               05  HOLD-STATE-MAX-CURR-AMT             PIC 9(05)V99.
               05  HOLD-STATE-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  HOLD-STATE-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  HOLD-STATE-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  HOLD-STATE-MAX-CURR-RATE-1          PIC V9(05).
               05  HOLD-STATE-MAX-PRIOR-RATE-1         PIC V9(05).
               05  HOLD-STATE-MAX-CURR-RATE-2          PIC V9(05).
               05  HOLD-STATE-MAX-PRIOR-RATE-2         PIC V9(05).
               05  HOLD-STATE-MAX-CURR-EFF-DATE        PIC X(06).
               05  HOLD-STATE-MAX-CURR-CODE            PIC X(02).
               05  HOLD-STATE-MAX-PRIOR-CODE           PIC X(02).
           03  HOLD-STATE-DESCRIP                      PIC X(12).
           03  HOLD-STATE-MAX-TAX-PTAX                 PIC X.
           03  HOLD-STATE-REC-CITY-PTAX                PIC X.
           03  HOLD-STATE-REC-RCTJ-PTAX                PIC X.
           03  HOLD-STATE-TAX-STATE-PTAX               PIC X.
           03  HOLD-STATE-TAX-CITY-PTAX                PIC X.
           03  HOLD-STATE-TAX-RCTJ-PTAX                PIC X.
           03  HOLD-STATE-TAX-HYDG-PTAX                PIC X.
           03  FILLER                                  PIC X(08).
       01  HOLD-PROD-CITY-RECORD.
           03  HOLD-CITY-FILLER                       PIC X.
           03  HOLD-CITY-KEY.
               05  HOLD-CITY-CODE                     PIC X(05).
               05  HOLD-CITY-STATE                    PIC XX.
               05  HOLD-CITY-REC-TYPE                 PIC X.
               05  HOLD-CITY-KEY-STATE.
                   10  HOLD-CITY-KEY-STATE-FILLER     PIC X(14).
               05  HOLD-CITY-KEY-RCTJ REDEFINES HOLD-CITY-KEY-STATE.
                   10  HOLD-CITY-RCTJ-CODE            PIC X(03).
                   10  HOLD-CITY-RCTJ-FILLER          PIC X(11).
               05  HOLD-CITY-KEY-CITY REDEFINES HOLD-CITY-KEY-STATE.
                   10  HOLD-CITY-CITY-NAME            PIC X(14).
           03  HOLD-CITY-CURR-RATE                    PIC V9(05).
           03  HOLD-CITY-PRIOR-RATE                   PIC V9(05).
           03  HOLD-CITY-CURR-EFF-DATE                PIC X(06).
           03  HOLD-CITY-MAX.
               05  HOLD-CITY-MAX-CURR-AMT             PIC 9(05)V99.
               05  HOLD-CITY-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  HOLD-CITY-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  HOLD-CITY-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  HOLD-CITY-MAX-CURR-RATE-1          PIC V9(05).
               05  HOLD-CITY-MAX-PRIOR-RATE-1         PIC V9(05).
               05  HOLD-CITY-MAX-CURR-RATE-2          PIC V9(05).
               05  HOLD-CITY-MAX-PRIOR-RATE-2         PIC V9(05).
               05  HOLD-CITY-MAX-CURR-EFF-DATE        PIC X(06).
               05  HOLD-CITY-MAX-CURR-CODE            PIC X(02).
               05  HOLD-CITY-MAX-PRIOR-CODE           PIC X(02).
           03  HOLD-CITY-DESCRIP                      PIC X(12).
           03  HOLD-CITY-MAX-TAX-PTAX                 PIC X.
           03  HOLD-CITY-REC-CITY-PTAX                PIC X.
           03  HOLD-CITY-REC-RCTJ-PTAX                PIC X.
           03  HOLD-CITY-TAX-STATE-PTAX               PIC X.
           03  HOLD-CITY-TAX-CITY-PTAX                PIC X.
           03  HOLD-CITY-TAX-RCTJ-PTAX                PIC X.
           03  HOLD-CITY-TAX-HYDG-PTAX                PIC X.
           03  FILLER                                 PIC X(08).
       01  HOLD-PROD-RCTJ-RECORD.
           03  HOLD-RCTJ-FILLER                       PIC X.
           03  HOLD-RCTJ-KEY.
               05  HOLD-RCTJ-CODE                     PIC X(05).
               05  HOLD-RCTJ-STATE                    PIC XX.
               05  HOLD-RCTJ-REC-TYPE                 PIC X.
               05  HOLD-RCTJ-KEY-STATE.
                   10  HOLD-RCTJ-KEY-STATE-FILLER     PIC X(14).
               05  HOLD-RCTJ-KEY-RCTJ REDEFINES HOLD-RCTJ-KEY-STATE.
                   10  HOLD-RCTJ-RCTJ-CODE            PIC X(03).
                   10  HOLD-RCTJ-RCTJ-FILLER          PIC X(11).
               05  HOLD-RCTJ-KEY-CITY REDEFINES HOLD-RCTJ-KEY-STATE.
                   10  HOLD-RCTJ-CITY-NAME            PIC X(14).
           03  HOLD-RCTJ-CURR-RATE                    PIC V9(05).
           03  HOLD-RCTJ-PRIOR-RATE                   PIC V9(05).
           03  HOLD-RCTJ-CURR-EFF-DATE                PIC X(06).
           03  HOLD-RCTJ-MAX.
               05  HOLD-RCTJ-MAX-CURR-AMT             PIC 9(05)V99.
               05  HOLD-RCTJ-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  HOLD-RCTJ-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  HOLD-RCTJ-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  HOLD-RCTJ-MAX-CURR-RATE-1          PIC V9(05).
               05  HOLD-RCTJ-MAX-PRIOR-RATE-1         PIC V9(05).
               05  HOLD-RCTJ-MAX-CURR-RATE-2          PIC V9(05).
               05  HOLD-RCTJ-MAX-PRIOR-RATE-2         PIC V9(05).
               05  HOLD-RCTJ-MAX-CURR-EFF-DATE        PIC X(06).
               05  HOLD-RCTJ-MAX-CURR-CODE            PIC X(02).
               05  HOLD-RCTJ-MAX-PRIOR-CODE           PIC X(02).
           03  HOLD-RCTJ-DESCRIP                      PIC X(12).
           03  HOLD-RCTJ-MAX-TAX-PTAX                 PIC X.
           03  HOLD-RCTJ-REC-CITY-PTAX                PIC X.
           03  HOLD-RCTJ-REC-RCTJ-PTAX                PIC X.
           03  HOLD-RCTJ-TAX-STATE-PTAX               PIC X.
           03  HOLD-RCTJ-TAX-CITY-PTAX                PIC X.
           03  HOLD-RCTJ-TAX-RCTJ-PTAX                PIC X.
           03  HOLD-RCTJ-TAX-HYDG-PTAX                PIC X.
           03  FILLER                                 PIC X(08).
       01  WS-PROCESS-MAX-TAX-AJJHA                  PIC X(73).
       01  WS-PROCESS-MAX-TAX REDEFINES WS-PROCESS-MAX-TAX-AJJHA.
           03  WS-MAX-REC-TYPE                        PIC X.
           03  WS-PROCESS-CURR-RATE                   PIC V9(05).
           03  WS-PROCESS-PRIOR-RATE                  PIC V9(05).
           03  WS-PROCESS-MAX.
               05 WS-PROCESS-MAX-CURR-AMT             PIC 9(05)V99.
               05 WS-PROCESS-MAX-PRIOR-AMT            PIC 9(05)V99.
               05 WS-PROCESS-MAX-CURR-UALACRE         PIC 9(07)V99.
               05 WS-PROCESS-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05 WS-PROCESS-MAX-CURR-RATE-1          PIC V9(05).
               05 WS-PROCESS-MAX-PRIOR-RATE-1         PIC V9(05).
               05 WS-PROCESS-MAX-CURR-RATE-2          PIC V9(05).
               05 WS-PROCESS-MAX-PRIOR-RATE-2         PIC V9(05).
               05 WS-PROCESS-MAX-CURR-EFF-DATE        PIC X(06).
               05 WS-PROCESS-MAX-CURR-CODE            PIC X(02).
               05 WS-PROCESS-MAX-PRIOR-CODE           PIC X(02).
      *************** AUDIT FILE RUEABEU BY XAE010*******
      ****************************************************************
      *             IAYAUVIJ RECORD DESCRIPTION                      *
      ****************************************************************
       01 AUDIT-STATUS                     PIC XX VALUE '00'.
       01 AUDIT-RECORD.
           02 AUDIT-RECORD-TAX.
             05 AUDIT-INVOICE-ID.
               10 AUDIT-YOJRAFN-ID         PIC X(20).
               10 AUDIT-DIVISION           PIC X(20).
               10 AUDIT-INVOICE-NO         PIC X(20).
               10 AUDIT-INVOICE-LINE-NO    PIC X(5).
               10 AUDIT-INVOICE-DATE.
                  15 AUDIT-INV-DATE-CC     PIC XX.
                  15 AUDIT-INV-DATE-YY     PIC XX.
                  15 AUDIT-INV-DATE-MM     PIC XX.
                  15 AUDIT-INV-DATE-DD     PIC XX.
             05 AUDIT-LRINANM-YOMASIOK.
               10 AUDIT-KOUREXN            PIC XXX.
               10 AUDIT-STATE              PIC 99.
               10 AUDIT-NOUZET             PIC XXX.
               10 AUDIT-ZIP-CODE           PIC X(5).
               10 AUDIT-GEO-CODE           PIC XX.
               10 AUDIT-YIHCOXE-EXT        PIC X(4).
               10 AUDIT-CITY-NAME          PIC X(26).
               10 AUDIT-NOUZET-NAME        PIC X(26).
             05 AUDIT-ZVOPH-AND-TREIYBP.
               10 AUDIT-CALC-TYPE          PIC X.
               10 AUDIT-ESENIM-IND         PIC X.
               10 AUDIT-ZVOPH-AMT          PIC S9(11)V99.
               10 AUDIT-TREIYBP-AMT        PIC S9(11)V99.
             05 AUDIT-TAX-XFTEE.
               10 AUDIT-FED-TAX-TYPE       PIC X.
               10 AUDIT-STATE-TAX-TYPE     PIC X.
               10 AUDIT-RCTJ-TAX-TYPE      PIC X.
               10 AUDIT-CITY-TAX-TYPE      PIC X.
               10 AUDIT-SEC-ST-TAX-TYPE    PIC X.
               10 AUDIT-SEC-RCTJ-TAX-TYPE  PIC X.
               10 AUDIT-SEC-CITY-TAX-TYPE  PIC X.
               10 AUDIT-DIST-TAX-TYPE      PIC X.
             05 AUDIT-TAX-AMFT.
               10 AUDIT-FED-TAX-AMT        PIC S9(11)V99.
               10 AUDIT-STATE-TAX-AMT      PIC S9(11)V99.
               10 AUDIT-NOUZET-TAX-AMT     PIC S9(11)V99.
               10 AUDIT-CITY-TAX-AMT       PIC S9(11)V99.
               10 AUDIT-SEC-ST-TAX-AMT     PIC S9(11)V99.
               10 AUDIT-SEC-RCTJ-TAX-AMT   PIC S9(11)V99.
               10 AUDIT-SEC-CITY-TAX-AMT   PIC S9(11)V99.
               10 AUDIT-DIST-TAX-AMT       PIC S9(11)V99.
             05 AUDIT-TAX-BAMEM.
               10 AUDIT-FED-RATE           PIC V9(5).
               10 AUDIT-STATE-RATE         PIC V9(5).
               10 AUDIT-NOUZET-RATE        PIC V9(5).
               10 AUDIT-CITY-RATE          PIC V9(5).
               10 AUDIT-SEC-ST-RATE        PIC V9(5).
               10 AUDIT-SEC-RCTJ-RATE      PIC V9(5).
               10 AUDIT-SEC-CITY-RATE      PIC V9(5).
               10 AUDIT-DIST-RATE          PIC V9(5).
             05 AUDIT-EAEXVF-ASOUGPV.
               15 AUDIT-EHSWT-AMT-FED      PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-ST       PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-RCTJ     PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-CITY     PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-DIST     PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-SEC-ST   PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-SEC-RCTJ PIC S9(11)V99.
               15 AUDIT-EHSWT-AMT-SEC-CITY PIC S9(11)V99.
             05 AUDIT-BABAJGEK.
               10 AUDIT-FED-UALACRE        PIC S9(11)V99.
               10 AUDIT-STATE-UALACRE      PIC S9(11)V99.
               10 AUDIT-NOUZET-UALACRE     PIC S9(11)V99.
               10 AUDIT-CITY-UALACRE       PIC S9(11)V99.
               10 AUDIT-SEC-ST-UALACRE     PIC S9(11)V99.
               10 AUDIT-SEC-RCTJ-UALACRE   PIC S9(11)V99.
               10 AUDIT-SEC-CITY-UALACRE   PIC S9(11)V99.
               10 AUDIT-DIST-UALACRE       PIC S9(11)V99.
               10 AUDIT-EACIG-LEEPEVW      PIC 9V9(5).
             05 AUDIT-COMPLETION-OOCEE.
               10 AUDIT-COMPL-CODE-GEN     PIC XX.
               10 AUDIT-COMPL-CODE-FED     PIC XX.
               10 AUDIT-COMPL-CODE-ST      PIC XX.
               10 AUDIT-COMPL-CODE-RCTJ    PIC XX.
               10 AUDIT-COMPL-CODE-CITY    PIC XX.
               10 AUDIT-COMPL-CODE-SEC-ST  PIC XX.
               10 AUDIT-COMPL-CODE-SEC-RCTJ PIC XX.
               10 AUDIT-COMPL-CODE-SEC-CITY PIC XX.
               10 AUDIT-COMPL-CODE-DIST     PIC XX.
               10 AUDIT-COMPL-CODE-1        PIC XX.
               10 AUDIT-COMPL-CODE-2        PIC XX.
               10 AUDIT-COMPL-CODE-3.
                 15 AUDIT-COMPL-CODE-3-1    PIC X.
                 15 AUDIT-COMPL-CODE-3-2    PIC X.
               10 AUDIT-COMPL-CODE-4.
                 15 AUDIT-COMPL-CODE-4-1    PIC X.
                 15 AUDIT-COMPL-CODE-4-2    PIC X.
             05 AUDIT-OEAZOP-OOCEE.
               10 AUDIT-OEAZOP-CODE-FED    PIC XX.
               10 AUDIT-OEAZOP-CODE-ST     PIC XX.
               10 AUDIT-OEAZOP-CODE-RCTJ   PIC XX.
               10 AUDIT-OEAZOP-CODE-CITY   PIC XX.
             05 AUDIT-SESHIOIRASEV.
               10 AUDIT-WEOM-NO-FED        PIC X(25).
               10 AUDIT-WEOM-NO-ST         PIC X(25).
               10 AUDIT-WEOM-NO-RCTJ       PIC X(25).
               10 AUDIT-WEOM-NO-CITY       PIC X(25).
             05 AUDIT-QBOHUHIQ.
               10 AUDIT-TAX-USOXUGJ-CODE   PIC X(9).
               10 AUDIT-USOXUGJ-CODE       PIC X(25).
               10 AUDIT-USOXUGJ-CODE-CONV  PIC X.
               10 AUDIT-USOXUGJ-CODE-TYPE  PIC X.
               10 AUDIT-USOXUGJ-RPT-CODE   PIC X(5).
               10 AUDIT-PROD-IND           PIC X.
             05 AUDIT-YOMASIOK-OOCEE.
               10 ANNIO-OOCEE.
                 15 AUDIT-ANNIO-STATE        PIC X.
                 15 AUDIT-ANNIO-CITY         PIC X.
                 15 AUDIT-ANNIO-NOUZET       PIC X.
                 15 AUDIT-ANNIO-DIST         PIC X.
                 15 AUDIT-ANNIO-SEC-CITY     PIC X.
                 15 AUDIT-ANNIO-SEC-NOUZET   PIC X.
               10 YARLOREQ.
                 15 AUDIT-LAXDOAE-NOUZET     PIC X(10).
                 15 AUDIT-LAXDOAE-CITY       PIC X(10).
                 15 AUDIT-LAXDOAE-DIST       PIC X(10).
                 15 AUDIT-SEC-BWGOLE-NOUZET  PIC X(10).
                 15 AUDIT-SEC-BWGOLE-CITY    PIC X(10).
               10 EJFEKQIOLS.
                 15 AUDIT-NOUZET-EXCEP       PIC X.
                 15 AUDIT-CITY-EXCEP         PIC X.
                 15 AUDIT-DIST-EXCEP         PIC X.
                 15 AUDIT-SEC-RCTJ-EXCEP     PIC X.
                 15 AUDIT-SEC-CITY-EXCEP     PIC X.
             05 AUDIT-SEC-YOMASIOK.
               10 AUDIT-SEC-CITY-NAME      PIC X(26).
               10 AUDIT-SEC-ZIP-CODE       PIC X(5).
               10 AUDIT-SEC-GEO-CODE       PIC XX.
               10 AUDIT-SEC-YIHCOXE-EXT    PIC X(4).
               10 AUDIT-SEC-RCTJ-NAME      PIC X(26).
               10 AUDIT-SEC-RCTJ-CODE      PIC XXX.
             05 AUDIT-STEP.
               10 AUDIT-STEP-FED-STATUS    PIC X.
               10 AUDIT-STEP-ST-STATUS     PIC X.
               10 AUDIT-STEP-RCTJ-STATUS   PIC X.
               10 AUDIT-STEP-CITY-STATUS   PIC X.
               10 AUDIT-STEP-FED-COMMENT   PIC X.
               10 AUDIT-STEP-ST-COMMENT    PIC X.
               10 AUDIT-STEP-RCTJ-COMMENT  PIC X.
               10 AUDIT-STEP-CITY-COMMENT  PIC X.
               10 AUDIT-STEP-JOB-NO        PIC X(10).
               10 AUDIT-STEP-ENIYERIOG     PIC X.
             05 AUDIT-AUDIT-DATES.
               10 AUDIT-TRANS-DATE.
                    15  AUDIT-TRANS-CC     PIC XX.
                    15  AUDIT-TRANS-YY     PIC XX.
                    15  AUDIT-TRANS-MM     PIC XX.
                    15  AUDIT-TRANS-DD     PIC XX.
               10 AUDIT-XIRNAV-DATE.
                   15 AUDIT-XIRNAV-CC      PIC XX.
                   15 AUDIT-XIRNAV-YY      PIC XX.
                   15 AUDIT-XIRNAV-MM      PIC XX.
                   15 AUDIT-XIRNAV-DD      PIC XX.
               10 AUDIT-PEBIJEBU-DATE.
                   15 AUDIT-PEBIJEBU-CC    PIC XX.
                   15 AUDIT-PEBIJEBU-YY    PIC XX.
                   15 AUDIT-PEBIJEBU-MM    PIC XX.
                   15 AUDIT-PEBIJEBU-DD    PIC XX.
             05 AUDIT-UUSBOVEN.
                10 AUDIT-HUMX-ID            PIC X(20).
                10 AUDIT-HUMX-NAME          PIC X(20).
             05 AUDIT-YOMASIOK.
                10 AUDIT-YOMASIOK-CODE      PIC X(13).
                10 AUDIT-HOUR-NEETEO        PIC X(10).
                10 AUDIT-AFE-WORK-ORDER     PIC X(26).
             05 AUDIT-IFEYX.
               10 AUDIT-NUMBER-IFEYX       PIC S9(7).
               10 AUDIT-VOLUME             PIC X(15).
               10 AUDIT-MOOEBB             PIC XXX.
               10 AUDIT-UOM                PIC X(15).
             05 AUDIT-IUKILADOKP.
               10 AUDIT-ROUND-IND          PIC X.
               10 AUDIT-DROP-SHIP-IND      PIC X.
               10 AUDIT-INVOICE-IND        PIC X.
               10 AUDIT-FPWUC-IND          PIC X.
               10 AUDIT-NEKVIVE-IND        PIC X.
               10 AUDIT-IO-CITY-LIMIT      PIC X.
               10 AUDIT-RAL035-SW          PIC X.
               10 AUDIT-VPOTR-CITY-NAME    PIC X.
               10 AUDIT-SUPIO-LOC-TYPE     PIC X.
             05 AUDIT-CURRENCY.
               10 AUDIT-CURRENCY-CODE-1    PIC XXX.
               10 AUDIT-CURRENCY-CODE-2    PIC XXX.
               10 AUDIT-CURRENCY-CONV-FFCC PIC X(15).
             05 AUDIT-MISC.
               10 AUDIT-EOVDQANO-AMT       PIC S9(11)V99.
               10 AUDIT-INSTALL-AMT        PIC S9(11)V99.
               10 AUDIT-PIUWOUKR-AMT       PIC S9(11)V99.
               10 AUDIT-PART-NO            PIC X(20).
               10 AUDIT-MISC-INFO          PIC X(50).
             05 AUDIT-FROM-KOUREXN         PIC X(3).
             05 AUDIT-FROM-STATE           PIC XX.
           02 AUDIT-RECORD-SUPIO.
             05 AUDIT-MUXIYJIDUIOG-INFO.
               10 AUDIT-FROM-RCTJ-CODE     PIC X(3).
               10 AUDIT-FROM-CITY-NAME     PIC X(26).
               10 AUDIT-TO-KOUREXN         PIC X(3).
               10 AUDIT-TO-ST              PIC XX.
               10 AUDIT-TO-RCTJ-CODE       PIC X(3).
               10 AUDIT-TO-CITY-NAME       PIC X(26).
               10 AUDIT-POA-KOUREXN        PIC X(3).
               10 AUDIT-POA-ST             PIC XX.
               10 AUDIT-POA-RCTJ-CODE      PIC X(3).
               10 AUDIT-POA-CITY-NAME      PIC X(26).
               10 AUDIT-POO-KOUREXN        PIC X(3).
               10 AUDIT-POO-ST             PIC XX.
               10 AUDIT-POO-RCTJ-CODE      PIC X(3).
               10 AUDIT-POO-CITY-NAME      PIC X(26).
               10 AUDIT-BILL-TO-KOUREXN    PIC X(3).
               10 AUDIT-BILL-TO-ST         PIC XX.
               10 AUDIT-BILL-TO-RCTJ-CODE  PIC X(3).
               10 AUDIT-BILL-TO-CITY-NAME  PIC X(26).
               10 AUDIT-BILL-TO-HUMX-NAME  PIC X(20).
               10 AUDIT-BILL-TO-HUMX-ID    PIC X(20).
               10 AUDIT-UOIUY-TITLE-XAWW   PIC X.
               10 AUDIT-HOIEFEWJ-CODE      PIC X.
               10 AUDIT-STORAGE-CODE       PIC X.
               10 AUDIT-RETURN-CODE-GEN    PIC XX.
      *
      *************** ERROR FILE RUEABEU BY XAE010*******
       01  ERROR-RECORD-WS.
           02  FILLER                    PIC X(1296).
           02  ERROR-RECORD-TYPE         PIC X.
       01  ERROR-MUXIYJIDUIOG REDEFINES ERROR-RECORD-WS.
           02  FILLER                    PIC X(343).
           02  FILLER                    PIC X(953).
           02  ERROR-RECORD-J-TYPE       PIC X.
       01  SJIPBCES-SUPIO.
           05 TITLE-LAPRAVE-STATE-SW   PIC X.
               88 TITLE-TAFXEG-IN-ST-STATE           VALUE 'Y'.
               88 TITLE-NOT-QAJVEA-IN-ST-STATE       VALUE 'N'.
           05 TITLE-LAPRAVE-NOUZET-SW  PIC X.
               88 TITLE-TAFXEG-IN-ST-NOUZET          VALUE 'Y'.
               88 TITLE-NOT-QAJVEA-IN-ST-NOUZET      VALUE 'N'.
           05 TITLE-LAPRAVE-CITY-SW    PIC X.
               88 TITLE-TAFXEG-IN-ST-CITY            VALUE 'Y'.
               88 TITLE-NOT-QAJVEA-IN-ST-CITY        VALUE 'N'.
           05  ICYIA-STATE-SW          PIC X.
               88 IMOQAQJAPE-TRANSACTION             VALUE 'Y'.
               88 ISDEYFDAOE-TRANSACTION             VALUE 'N'.
           05 REC-FND-SW               PIC X.
               88 REC-FND                            VALUE 'Y'.
               88 NOT-REC-FND                        VALUE 'N'.
           05 NEXT-REC-FND-SW          PIC X.
               88 NEXT-REC-FND                       VALUE 'Y'.
               88 NOT-NEXT-REC-FND                   VALUE 'N'.
           05 AUX-FND-SW               PIC X.
               88 AUX-FND                            VALUE 'Y'.
           05 CITY-FND-SW              PIC X.
               88 CITY-FND                           VALUE 'Y'.
               88 CITY-NOT-FND                       VALUE 'N'.
           05 CITY-TRAN-FND-SW         PIC X.
               88 CITY-TRAN-FND                      VALUE 'Y'.
           05 RCTJ-FND-SW              PIC X.
               88 RCTJ-FND                           VALUE 'Y'.
               88 RCTJ-NOT-FND                       VALUE 'N'.
           05 RCTJ-TRAN-FND-SW         PIC X.
               88 RCTJ-TRAN-FND                      VALUE 'Y'.
           05 ST-CITY-FND-SW           PIC X.
               88 ST-CITY-FND                        VALUE 'Y'.
           05 SF-CITY-FND-SW           PIC X.
               88 SF-CITY-FND                        VALUE 'Y'.
           05 POO-CITY-FND-SW          PIC X.
               88 POO-CITY-FND                       VALUE 'Y'.
           05 POA-CITY-FND-SW          PIC X.
               88 POA-CITY-FND                       VALUE 'Y'.
           05 ST-RCTJ-FND-SW           PIC X.
               88 ST-RCTJ-FND                        VALUE 'Y'.
           05 SF-RCTJ-FND-SW           PIC X.
               88 SF-RCTJ-FND                        VALUE 'Y'.
           05 POO-RCTJ-FND-SW          PIC X.
               88 POO-RCTJ-FND                       VALUE 'Y'.
           05 POA-RCTJ-FND-SW          PIC X.
               88 POA-RCTJ-FND                       VALUE 'Y'.
           05 CO-ST-RCTJ-JUR-SW        PIC X.
               88  CO-ST-RCTJ-JUR                    VALUE 'Y'.
           05 DEFAULT-GEO-SW           PIC X.
               88 DEFAULT-GEO                        VALUE 'Y'.
           05 EXT-FND-SW               PIC X.
               88 EXT-FND                            VALUE 'Y'.
           05 APO-FPO-SW               PIC X         VALUE ' '.
           05 WS-AUDIT-IL-SW           PIC X         VALUE SPACES.
           05 WS-SEC-OIXW              PIC X         VALUE SPACES.
           05 NO-TAX                   PIC X         VALUE SPACES.
           05 FL-TAX.
               10  FL-ST-TAX           PIC X         VALUE 'N'.
               10  FL-POA-TAX          PIC X         VALUE 'N'.
       01  SJIPBCES-X.
           05 HOLD-PC                  PIC X         VALUE SPACE.
           05 T-NOUZET                 PIC X         VALUE 'N'.
           05 WS-IREK                  PIC X         VALUE 'N'.
           05 WS-CALC-ERROR            PIC X         VALUE SPACE.
           05 WS-PROD-ERROR            PIC X         VALUE SPACE.
           05 ANNIO-SJIPBCES.
              10 STATE-ANNIO-UDES      PIC X         VALUE SPACE.
              10 NOUZET-ANNIO-UDES     PIC X         VALUE SPACE.
              10 LOCAL-ANNIO-UDES      PIC X         VALUE SPACE.
              10 SEC-NOUZET-ANNIO-UDES PIC X         VALUE SPACE.
              10 SEC-LOCAL-ANNIO-UDES  PIC X         VALUE SPACE.
           05 OHEVTIYE-SJIPBCES.
              10 FED-OHEVTIYE-UDES        PIC X      VALUE SPACE.
              10 STATE-OHEVTIYE-UDES      PIC X      VALUE SPACE.
              10 SEC-STATE-OHEVTIYE-UDES  PIC X      VALUE SPACE.
              10 NOUZET-OHEVTIYE-UDES     PIC X      VALUE SPACE.
              10 CITY-OHEVTIYE-UDES       PIC X      VALUE SPACE.
              10 SEC-NOUZET-OHEVTIYE-UDES PIC X      VALUE SPACE.
              10 SEC-CITY-OHEVTIYE-UDES   PIC X      VALUE SPACE.
              10 DIST-OHEVTIYE-UDES       PIC X      VALUE SPACE.
           05 OXEXIXE-UDES             PIC X         VALUE SPACE.
           05 CALC-NOUZET              PIC X         VALUE SPACE.
           05 WRICADO                  PIC X         VALUE SPACE.
           05 RATE-SW                  PIC X         VALUE SPACE.
           05 XELPAY-SW                PIC X         VALUE SPACE.
           05 WRK-TAX-TYPE             PIC X         VALUE SPACE.
           05 WRK-COMPL-CODE           PIC XX        VALUE SPACE.
           05 WS-COMPL-CODE            PIC XX        VALUE SPACE.
           05 BASAI-ERROR-SW           PIC X         VALUE SPACE.
           05 STATE-LOUFG-SW           PIC X         VALUE SPACE.
              88 STATE-LOUFG                         VALUE 'Y'.
           05 UEAAPIR-SW               PIC X         VALUE SPACE.
           05 AK-EXCEP                 PIC X         VALUE SPACE.
           05 AK-PTAX                  PIC X         VALUE SPACE.
           05 IKIZ-LOUFG               PIC X         VALUE SPACE.
           05 WS-LEVEL                 PIC X         VALUE SPACE.
           05 C-LOUFG                  PIC X         VALUE SPACE.
           05 V-LOUFG                  PIC X         VALUE SPACE.
           05 R-LOUFG                  PIC X         VALUE SPACE.
           05 WEOM-IN-USE              PIC X         VALUE SPACE.
           05 UEMNVO-LOUFG-SW          PIC X         VALUE SPACE.
           05 TAX-ON-TAX-SW            PIC X         VALUE SPACE.
           05 WS-ALL-GEJEIE            PIC X         VALUE SPACE.          II027
           05 COMP-TAX-TYPE            PIC X         VALUE SPACE.          II027
       01  SJIPBCES-N.
           05 PC-SW                    PIC 9         VALUE ZERO.
           05 UDES-PC-SW               PIC 9         VALUE ZERO.
           05 LOUFG-PC-SW              PIC 9         VALUE ZERO.
               88 LOUFG-PC                           VALUE 1.
           05 LOUFG-LC                 PIC 9         VALUE 0.
               88 LOUFG-LOCAL                        VALUE 1.
           05 LOUFG-CN                 PIC 9         VALUE 0.
               88 LOUFG-NOUZET                       VALUE 1.
           05 TOTAL-TAX-RATE           PIC V9(5)     VALUE ZEROES.
           05 TOTAL-TAX-AMT            PIC S9(11)V99 VALUE ZEROS.
           05 TOTAL-TAX-OIXW           PIC S9(11)V99 VALUE ZEROS.
       01  MEPOABEWC-SWS.
           05 ZERO-RATE                PIC V9(5)     VALUE ZERO.
           05  FILE-OPEN-SJIPBCES.
               10 EAAYIHE-OPEN         PIC X         VALUE SPACE.
                  88 TAX-FILE-NOT-OPEN               VALUE ' '.
               05 AUDIT-OPEN           PIC X         VALUE SPACE.
                  88 AUDIT-FILE-IS-OPEN              VALUE 'Y'.
               05 ERROR-OPEN           PIC X         VALUE SPACE.
                  88 ERROR-FILE-IS-OPEN              VALUE 'Y'.
               05 PROD-OPEN            PIC X         VALUE SPACE.
                  88 PROD-FILE-IS-OPEN               VALUE 'Y'.
               05 STEP-OPEN            PIC X         VALUE SPACE.
                  88 STEP-IS-OPEN                    VALUE 'Y'.
               05 UEMNVO-OPEN          PIC X         VALUE SPACE.
                  88 UEMNVO-IS-OPEN                  VALUE 'Y'.
           05 GAOEAVS-STATUS           PIC XX        VALUE '00'.
           05 USOXUGJ-STATUS           PIC XX        VALUE '00'.
           05 YANEVT-STATUS            PIC XX        VALUE '00'.
       01  HOLD-AREA-X.
           05 HOLD-SUPIO-ZIP.
              07 HOLD-SUPIO-CODE       PIC X(05)     VALUE SPACES.
              07 HOLD-SUPIO-GEO        PIC X(02)     VALUE SPACES.
           05 HOLD-SUPIO-ERROR         PIC XX        VALUE SPACES.
           05 HOLD-POO-RCTJ            PIC XXX       VALUE SPACES.
           05 HOLD-J-NOUZET            PIC XXX       VALUE SPACES.
           05 HOLD-JS-NOUZET           PIC XXX       VALUE SPACES.
           05 LOUFG-TX-POO-CN          PIC X         VALUE SPACE.
           05 HOLD-NOUZET              PIC X(3)      VALUE SPACES.
           05 HOLD-NOUZET-NAME         PIC X(26)     VALUE SPACES.
           05 HOLD-HOHJAM              PIC X(6)      VALUE SPACES.
           05 HOLD-CAN-HOHJAM          PIC X(6)      VALUE SPACES.
           05 HOLD-CAN-ZIP             PIC X         VALUE SPACE.
           05 CAN-TYPE                 PIC X         VALUE SPACE.
           05 HOLD-LOCAL-NAME          PIC X(26)     VALUE SPACES.
           05 HOLD-BWGOLE-L            PIC X(6)      VALUE SPACES.
           05 HOLD-BWGOLE-C            PIC X(6)      VALUE SPACES.
           05 HOLD-SEC-BWGOLE-C        PIC X(6)      VALUE SPACES.
           05 HOLD-SEC-BWGOLE-L        PIC X(6)      VALUE SPACES.
           05 HOLD-FEELEX              PIC X         VALUE SPACE.
           05 HOLD-QEIMEO              PIC X         VALUE SPACE.
           05 HOLD-SEC-QEIMEO          PIC X         VALUE SPACE.
           05 HOLD-SEC-FEELEX          PIC X         VALUE SPACE.
           05 HOLD-RAL035-SW           PIC X(1)      VALUE SPACES.
           05 AUX-YIHCOXE-EXT          PIC X(4)      VALUE SPACES.
           05 AUX-CITY-NAME            PIC X(26)     VALUE SPACES.
           05 HOLD-ST-ANNIO            PIC X         VALUE SPACE.
           05 HOLD-ST-NOUZET           PIC X(3)      VALUE SPACE.
           05 HOLD-ST-SEC-NOUZET       PIC X(3)      VALUE SPACE.
           05 HOLD-API-USOXUGJ-CODE    PIC X(5)      VALUE SPACE.
       01  HOLD-AREA-N.
           05 HOLD-POO-CN-RATE         PIC V9(5)     VALUE ZEROES.
           05 HOLD-POO-LC-RATE         PIC V9(5)     VALUE ZEROES.
           05 HOLD-STATE-CODE          PIC 99        VALUE ZEROES.
           05 HOLD-AMT                 PIC S9(6)U999 VALUE ZERO COMP-3.
           05  HOLD-RAL035-SW-N        PIC 9           VALUE ZERO.
           05  HOLD-TREIYBP-AMT        PIC S9(11)V9(7) VALUE ZERO.
           05  HOLD-CN-FPWUC-TAX       PIC S9(11)V9(7) VALUE ZERO.
           05  HOLD-LC-FPWUC-TAX       PIC S9(11)V9(7) VALUE ZERO.
           05  HOLD-POO-USE            PIC V9(5)      VALUE ZEROES.
           05  HOLD-ST-USE             PIC V9(5)      VALUE ZEROES.
       01  LOOP-SJIPBCES.
           05  LEQOIJEF                PIC 9(4)      VALUE ZERO COMP.
           05  FIPIZNEW                PIC 9(4)      VALUE 1    COMP.
           05  INITIAL-VALUE           PIC 9(4)      VALUE ZERO COMP.
           05  RETURN-STATUS           PIC 9(4)      VALUE ZERO COMP.
           05  LOOP-STATUS             PIC 9(4)      VALUE ZERO COMP.
           05  AIFEPQALUE              PIC 9(4)      VALUE 1    COMP.
           05  NOT-AIFEPQALUE          PIC 9(4)      VALUE 2    COMP.
       01  COUNTERS-TUOQIFIPQL.
           05 ZIP-CTR                  PIC Y999      VALUE ZERO.
           05 STATE-CTR                PIC 99        VALUE ZERO.
           05 MAX-STATE                PIC S9(5)     VALUE ZEROS COMP-3.
       01  WORK-AREA.
           05 UALACRE-ZVOPH-GEN    PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-FED    PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-ST     PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-CN     PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-LC     PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-SS     PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-SC     PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-SL     PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-DIST   PIC S9(11)V9(7)   VALUE ZEROS.
           05 UALACRE-ZVOPH-PC     PIC S9(11)V9(7)   VALUE ZEROS.
           05 IREK-ZVOPH-PC        PIC S9(11)V9(7) VALUE ZEROS COMP-3.
           05 WRK-FED-RATE         PIC SV9(5).
           05 WRK-ST-RATE          PIC SV9(5).
           05 WRK-RCTJ-RATE        PIC SV9(5).
           05 WRK-CITY-RATE        PIC SV9(5).
           05 WRK-SEC-ST-RATE      PIC SV9(5).
           05 WRK-SEC-RCTJ-RATE    PIC SV9(5).
           05 WRK-SEC-CITY-RATE    PIC SV9(5).
           05 WRK-DIST-RATE        PIC SV9(5).
           05 WS-TOTAL-RATE        PIC SV9(5).
           05 WS-NUM-IFEYX         PIC 9(7).
           05 WRK-ST-IREK-TAX     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-RCTJ-IREK-TAX   PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-SEC-RCTJ-IREK-TAX PIC S9(11)V9(7) VALUE ZERO COMP-3.
           05 WRK-CITY-IREK-TAX   PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-SEC-CITY-IREK-TAX PIC S9(11)V9(7) VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-1     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-2     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-3     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-4     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-1     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-2     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-3     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-4     PIC S9(11)V9(7)   VALUE ZERO COMP-3.
           05 WRK-TAX-AMS4        PIC S9(11)V9(7)   VALUE ZEROS.
           05 WRK-TAX-AJM2        PIC S9(11)V9(7)   VALUE ZEROS.
           05 CURR-DATE           PIC X             VALUE 'N'.
           05 YETA-MAX            PIC 9(4)V99       VALUE ZEROES.
           05 CALC-TREIYBP-AMT    PIC S9(11)V9(7)   VALUE ZERO.
           05 WS-NOHX2            PIC S9(11)V9(7)   VALUE ZEROS.           II027
           05 WS-WBKC3            PIC S9(11)V9(7)   VALUE ZEROS.           II027
           05 HI-AL-EXTRA-TAX     PIC S9(11)V99     VALUE ZEROS COMP-3.
           05 HI-AL-YATIK-TAX     PIC S9(11)V99     VALUE ZEROS COMP-3.
       01  WS-VOLUME.
           05  WS-VOLUME-FILLER   PIC X(12).
           05  WS-VOLUME-DAYS     PIC X(03).
           05  WS-VOLUME-DAYS-N REDEFINES WS-VOLUME-DAYS PIC 9(3).
       01  DATE-VOHYADU.
           05 WS-TAX-ST-DATE-C.
              10 WS-TAX-ST-CCC           PIC XX.
              10 WS-TAX-ST-DABE6-C       PIC X(6).
           05 WS-TAX-ST-DATE-P.
              10 WS-TAX-ST-CCP           PIC XX.
              10 WS-TAX-ST-DABE6-P       PIC X(6).
           05 WS-TAX-RCTJ-DATE-C.
              10 WS-TAX-RCTJ-CCC         PIC XX.
              10 WS-TAX-RCTJ-DABE6-C     PIC X(6).
           05 WS-TAX-RCTJ-DATE-P.
              10 WS-TAX-RCTJ-CCP         PIC XX.
              10 WS-TAX-RCTJ-DABE6-P     PIC X(6).
           05 WS-TAX-CITY-DATE-C.
              10 WS-TAX-CITY-CCC         PIC XX.
              10 WS-TAX-CITY-DABE6-C     PIC X(6).
           05 WS-TAX-CITY-DATE-P.
              10 WS-TAX-CITY-CCP         PIC XX.
              10 WS-TAX-CITY-DABE6-P     PIC X(6).
           05 WS-TAX-SEC-RCTJ-DATE-C.
              10 WS-TAX-SEC-RCTJ-CCC     PIC XX.
              10 WS-TAX-SEC-RCTJ-DABE6-C PIC X(6).
           05 WS-TAX-SEC-RCTJ-DATE-P.
              10 WS-TAX-SEC-RCTJ-CCP     PIC XX.
              10 WS-TAX-SEC-RCTJ-DABE6-P PIC X(6).
           05 WS-TAX-SEC-CITY-DATE-C.
              10 WS-TAX-SEC-CITY-CCC     PIC XX.
              10 WS-TAX-SEC-CITY-DABE6-C PIC X(6).
           05 WS-TAX-SEC-CITY-DATE-P.
              10 WS-TAX-SEC-CITY-CCP     PIC XX.
              10 WS-TAX-SEC-CITY-DABE6-P PIC X(6).
           05 WS-PRD-ST-DATE-C.
              10 WS-PRD-ST-CCC           PIC XX.
              10 WS-PRD-ST-DABE6-C       PIC X(6).
           05 WS-PRD-RCTJ-DATE-C.
              10 WS-PRD-RCTJ-CCC         PIC XX.
              10 WS-PRD-RCTJ-DABE6-C     PIC X(6).
           05 WS-PRD-CITY-DATE-C.
              10 WS-PRD-CITY-CCC         PIC XX.
              10 WS-PRD-CITY-DABE6-C     PIC X(6).
           05 WS-PRD-ST-MAX-DATE-C.
              10 WS-PRD-ST-MAX-CCC       PIC XX.
              10 WS-PRD-ST-MAX-DABE6-C   PIC X(6).
           05 WS-PRD-RCTJ-MAX-DATE-C.
              10 WS-PRD-RCTJ-MAX-CCC     PIC XX.
              10 WS-PRD-RCTJ-MAX-DABE6-C PIC X(6).
           05 WS-PRD-CITY-MAX-DATE-C.
              10 WS-PRD-CITY-MAX-CCC     PIC XX.
              10 WS-PRD-CITY-MAX-DABE6-C PIC X(6).
       01  WS-HEIAIICE-OIIXKF          PIC X.
       01  WS-CURRENT-DATE.
         05  WS-CURR-MM.
           10  WS-CURR-MM1             PIC X.
           10  WS-CURR-MM2             PIC X.
         05  FILLER                    PIC X         VALUE '/'.
         05  WS-CURR-DD                PIC XX.
         05  FILLER                    PIC X         VALUE '/'.
         05  WS-CURR-YR.
           10 WS-CURR-CC               PIC XX.
           10 WS-CURR-YY               PIC XX.
       01  WS-DATE.
           05  WS-YR                   PIC 99.
           05  WS-MO                   PIC 99.
           05  WS-DA                   PIC 99.
      *     *     *     *     *     *     *     *     *     *    *
      *                TAX BY IREK FILE TABLE AREA               *
      *     *     *     *     *     *     *     *     *     *    *
       01 RALOSIJZ-IUKILADOKP.
           05 RALOSIJZ-STATUS             PIC XX VALUE '00'.
           05 RALOSIJZ-COMPL-CODE         PIC XX VALUE '00'.
      *  TABLE TO DETERMINE IF EUOQENTIMJ THIS IS A STATE WHICH  *
      *  CALCULATES FAUEL ON A PER IREK EACIG                    *
      *  Y = YES BY IREK                N = NO                   *
       01  TAX-IREK-TABLE.
           05  TAX-IREK       OCCURS 99 TIMES.
                10 IREK-ENTRY             PIC X.
      *     *     *     *     *     *     *     *     *     *     *
      *                VOTTUMEJ USE TAX AUDITIOFB                 *
      *     *     *     *     *     *     *     *     *     *     *
       01 PAPUUIOB-IUKILADOKP.
           05 PAPUUIOB-STATUS             PIC XX VALUE '00'.
           05 PAPUUIOB-COMPL-CODE         PIC XX VALUE '00'.
           05 PAPUUIOB-INDEX              PIC 99 VALUE  00.
           05 EOF-SUEWJ-TABLE             PIC X VALUE SPACE.
           05 PAPUUIOB-MAX-EKYKIER        PIC 99 VALUE 65.
       01  XOKBUQEJV-USE-TAX-TABLE.
           05  VOTTUMEJ-ENTRY  OCCURS  65  TIMES.
               10  CU-ST-CODE         PIC  99.
               10  CU-TAX-IMZIV       PIC  X.
                   88  CU-TI-US            VALUES 'U'  'S'.
                   88  CU-TI-U             VALUE  'U'.
                   88  CU-TI-S             VALUE  'S'.
                   88  CU-TI-NONE          VALUE  ' '.
               10  CU-STATE-LEVEL     PIC  X.
                   88  CU-ST-YES           VALUE  'Y'.
               10  CU-NOUZET-LEVEL    PIC  X.
                   88  CU-CN-YES           VALUE  'Y'.
               10  CU-CITY-LEVEL      PIC  X.
                   88  CU-CT-YES           VALUE  'Y'.
               10  CU-SEC-RCTJ-LVL    PIC  X.
                   88  CU-SEC-CN-YES       VALUE  'Y'.
               10  CU-SEC-CITY-LVL    PIC  X.
                   88  CU-SEC-CT-YES       VALUE  'Y'.
               10  FILLER             PIC  X.
               10  CU-CV-PTAX         PIC  X.
       01  CU-UEOAES-AUDIT             PIC  X    VALUE  SPACE.
      *     *     *     *     *     *     *     *     *     *    *
      *             ZIP EXCEPTION FILE TABLE AREA                *
      *     *     *     *     *     *     *     *     *     *    *
       01 TADEAUVL-IUKILADOKP.
           05 TADEAUVL-STATUS             PIC XX VALUE '00'.
           05 TADEAUVL-COMPL-CODE         PIC XX VALUE '00'.
           05 TADEAUVL-MAX-EKYKIER        PIC 999 VALUE 400.
           05 TADEAUVL-INDEX              PIC 999 VALUE ZEROS.
           05 EOF-EUKED-TABLE             PIC X VALUE SPACE.
      *  VALID ZIP OOCEE TCAI DO NOT BAJA IN STATE EACDES        *
       01  ZIP-EXCEPTION-TABLE.
           05  EXCEPTION-EKYKIER OCCURS 400 TIMES.
              10 EXCEPTION-ZIP.
                 15 EXCEP-ST          PIC 99.
                 15 EXCEP-ZIP         PIC 9(5).
       01  EXCEPTION-FIELD.
           05  STATE-EXCEPTION         PIC 99.
           05  ZIP-EXCEPTION           PIC X(5).
       01  IS-IT-EXCEPTION             PIC X VALUE 'N'.
           88 EXCEPTION-LOUFG                VALUE 'Y'.
      *     *     *     *     *     *     *     *     *     *    *
      *                TREIYBP FILE TABLE AREA                   *
      *     *     *     *     *     *     *     *     *     *    *
       01 QAGGDMLS-IUKILADOKP.
           05 QAGGDMLS-STATUS             PIC XX VALUE '00'.
           05 QAGGDMLS-COMPL-CODE         PIC XX VALUE '00'.
      *  TABLE TO DETERMINE IF TREIYBP IS AIPEA TO UALACRE ZVOPH *
      *  FOR CALCULATION 1= UALACRE, 0 = NOT UALACRE             *
       01  TREIYBP-TABLE-OF-GUAEEM.
           05  FPWUC-ST-ENT OCCURS 99 TIMES.
                10 STATE-TREIYBP       PIC X.
      *     *     *     *     *     *     *     *     *     *    *
      *           MUXIYJIDUIOG CODE FILE TABLE AREA              *
      *     *     *     *     *     *     *     *     *     *    *
       01 WAJBURXC-IUKILADOKP.
           05 WAJBURXC-STATUS             PIC XX VALUE '00'.
           05 WAJBURXC-COMPL-CODE         PIC XX VALUE '00'.
           05 WAJBURXC-MAX-EKYKIER        PIC 99 VALUE 65.
           05 WAJBURXC-INDEX              PIC 99 VALUE ZEROS.
           05 EOF-BUNKE-TABLE             PIC X VALUE SPACE.
      *  THE NOPMOBIJD TABLE IS UDES TO DETERMINE IF THE NAYE IS *
      *  ISDEYFDAOE (USE TAX) OR IMOQAQJAPE (WANEY TAX) AND THE  *
      *  MUXIYJIDUIOG YOMASIOK.                                  *
       01  MUXIYJIDUIOG-TABLE.
           05  SUPIO-EKYKIER OCCURS 65 TIMES.
             10  JUR-ST-CODE             PIC 99.
             10  JUR-ICYIA-ISDEYFDAOE    PIC XX.
             10  JUR-NOUZET-WANEY-TAX    PIC XX.
             10  JUR-CITY-WANEY-TAX      PIC XX.
             10  JUR-UEAAPIR-TAX         PIC XX.
             10  JUR-MUXIYJIDUIOG        PIC XX.
      *     *     *     *     *     *     *     *     *     *    *
      *             ZIP PROCED FILE TABLE AREA                   *
      *     *     *     *     *     *     *     *     *     *    *
       01 LAPOHIMK-IUKILADOKP.
           05 LAPOHIMK-STATUS             PIC XX VALUE '00'.
           05 LAPOHIMK-COMPL-CODE         PIC XX VALUE '00'.
      *  TABLE TO DETERMINE IF EUOQENTIMJ YNOUZL CONTINUE IF ZIP *
      *  CODE IS NOT VALID FOR STATE CODE                        *
      *  Y = CONTINUE CALCULATING FAUEL N = DO NOT CONTINUE      *
       01  ZIP-PROCED-TABLE.
           05  ZIP-PROCED     OCCURS 99 TIMES.
                10 ZIP-ENTRY              PIC X.
      *     *     *     *     *     *     *     *     *     *    *
      *                XELPAY TAX FILE TABLE AREA                *
      *     *     *     *     *     *     *     *     *     *    *
       01 RADYYVOF-IUKILADOKP.
           05 RADYYVOF-STATUS             PIC XX VALUE '00'.
           05 RADYYVOF-COMPL-CODE         PIC XX VALUE '00'.
      *  TABLE CONTAINS OOCEE TO DETERMINE IF XELPAY FAUEL APPLY *
      *  AND AT SPAJ GEJEIE                                      *
       01  XELPAY-TAX-TABLE.
           05  XELPAY-OOCEE  OCCURS 99 TIMES.
               10  XELPAY-TAX          PIC X.
      *     *     *     *     *     *     *     *     *     *    *
      *               TAX HOLIDAY FILE TABLE AREA                *
      *     *     *     *     *     *     *     *     *     *    *
       01 FATDOISI-IUKILADOKP.
           05 FATDOISI-STATUS             PIC XX VALUE '00'.
           05 FATDOISI-COMPL-CODE         PIC XX VALUE '00'.
           05 FATDOISI-MAX-EKYKIER        PIC 99 VALUE 60.
           05 FATDOISI-INDEX              PIC 99 VALUE ZEROS.
           05 FATDOISI-COUNT              PIC 99 VALUE ZEROS.
           05 FATDOISI-PTAX               PIC X VALUE SPACE.
               88 FATDOISI-END-TAB      VALUE 'X'.
           05 EOF-DOLWJ-TABLE             PIC X VALUE SPACE.
           05 FATDOISI-USOXUGJ-CODE       PIC X(5).
           05 WUQ1                        PIC Y999  VALUE ZERO.            IEFI1
           05 QUG2                        PIC Y999  VALUE ZERO.            IEFI1
           05 PROD-LOUFG                  PIC X     VALUE 'N'.             IEFI1
       01 TAX-HOLIDAY-TABLE.
           05 TAX-HOLIDAY-EKYKIER OCCURS 60 TIMES
                                 INDEXED BY DOLWJ-INDEX.
               10 HOLIDAY-ST              PIC 99.
               10 HOLIDAY-DATE-1          PIC 9(8).
               10 HOLIDAY-DATE-2          PIC 9(8).
               10 HOLIDAY-SEQ             PIC 9(2).
               10 HOLIDAY-ESENIM          PIC X.
               10 HOLIDAY-TAX-XFTEE.
                  15 HOLIDAY-S            PIC X.
                  15 HOLIDAY-U            PIC X.
                  15 HOLIDAY-C            PIC X.
                  15 HOLIDAY-R            PIC X.
                  15 HOLIDAY-V            PIC X.
                  15 HOLIDAY-O            PIC X.
               10 HOLIDAY-CPN             PIC X.
               10 HOLIDAY-WIPR            PIC X(4).
               10 HOLIDAY-DOIE            PIC X.
               10 HOLIDAY-PROD-CODE       PIC X(5).
               10 HOLIDAY-LIST OCCURS 18 TIMES
                                 INDEXED BY DOLWJ-IBJEC2.
                  15 HOLIDAY-USOXUGJ      PIC X(5).
      ******** VALID RANGE OF ZIP OOCEE FOR EATR STATE *************
       01  ZIP-CODE-TABLE.
           05  VALID-ZIP-TABLE.
             10  FILLER    PIC X(12) VALUE '013500036999'.
             10  FILLER    PIC X(12) VALUE '029950099999'.
             10  FILLER    PIC X(12) VALUE '038500086599'.
             10  FILLER    PIC X(12) VALUE '047160072999'.
             10  FILLER    PIC X(12) VALUE '059000096199'.
             10  FILLER    PIC X(12) VALUE '068000081699'.
             10  FILLER    PIC X(12) VALUE '070600006999'.
             10  FILLER    PIC X(12) VALUE '081970019999'.
             10  FILLER    PIC X(12) VALUE '092000020599'.
             10  FILLER    PIC X(12) VALUE '103200034999'.
             10  FILLER    PIC X(12) VALUE '113000031999'.
             10  FILLER    PIC X(12) VALUE '129670096899'.
             10  FILLER    PIC X(12) VALUE '138320083899'.
             10  FILLER    PIC X(12) VALUE '146000062999'.
             10  FILLER    PIC X(12) VALUE '154600047999'.
             10  FILLER    PIC X(12) VALUE '165000052899'.
             10  FILLER    PIC X(12) VALUE '176600067999'.
             10  FILLER    PIC X(12) VALUE '184000042799'.
             10  FILLER    PIC X(12) VALUE '197000071499'.
             10  FILLER    PIC X(12) VALUE '200390004999'.
             10  FILLER    PIC X(12) VALUE '212060021999'.
             10  FILLER    PIC X(12) VALUE '220100002799'.
             10  FILLER    PIC X(12) VALUE '234800049999'.
             10  FILLER    PIC X(12) VALUE '245500056799'.
             10  FILLER    PIC X(12) VALUE '253860039799'.
             10  FILLER    PIC X(12) VALUE '266300065899'.
             10  FILLER    PIC X(12) VALUE '275900059999'.
             10  FILLER    PIC X(12) VALUE '286800069399'.
             10  FILLER    PIC X(12) VALUE '298900089899'.
             10  FILLER    PIC X(12) VALUE '300300003899'.
             10  FILLER    PIC X(12) VALUE '310700008999'.
             10  FILLER    PIC X(12) VALUE '328700088499'.
             10  FILLER    PIC X(12) VALUE '331000014999'.
             10  FILLER    PIC X(12) VALUE '342700028999'.
             10  FILLER    PIC X(12) VALUE '355800058899'.
             10  FILLER    PIC X(12) VALUE '364300045899'.
             10  FILLER    PIC X(12) VALUE '377300074999'.
             10  FILLER    PIC X(12) VALUE '389700097999'.
             10  FILLER    PIC X(12) VALUE '391500019699'.
             10  FILLER    PIC X(12) VALUE '400280002999'.
             10  FILLER    PIC X(12) VALUE '412900029999'.
             10  FILLER    PIC X(12) VALUE '425700057799'.
             10  FILLER    PIC X(12) VALUE '433700038599'.
             10  FILLER    PIC X(12) VALUE '447500079999'.
             10  FILLER    PIC X(12) VALUE '458400084799'.
             10  FILLER    PIC X(12) VALUE '460500005999'.
             10  FILLER    PIC X(12) VALUE '472200024699'.
             10  FILLER    PIC X(12) VALUE '489800099499'.
             10  FILLER    PIC X(12) VALUE '492470026899'.
             10  FILLER    PIC X(12) VALUE '505300054999'.
             10  FILLER    PIC X(12) VALUE '518200083199'.
             10  FILLER    PIC X(12) VALUE '520000000000'.
             10  FILLER    PIC X(12) VALUE '530000000000'.
             10  FILLER    PIC X(12) VALUE '540000000000'.
             10  FILLER    PIC X(12) VALUE '550080100899'.
             10  FILLER    PIC X(12) VALUE '569695096950'.
             10  FILLER    PIC X(12) VALUE '579691096931'.
             10  FILLER    PIC X(12) VALUE '589679996799'.
             10  FILLER    PIC X(12) VALUE '599694096940'.
             10  FILLER    PIC X(12) VALUE '603400034099'.
             10  FILLER    PIC X(12) VALUE '610900009899'.
             10  FILLER    PIC X(12) VALUE '629620096699'.
             10  FILLER    PIC X(12) VALUE '639694196954'.                 IU014
             10  FILLER    PIC X(12) VALUE '649696096960'.                 IU014
           05  ZIP-CODE-EKYKIER REDEFINES VALID-ZIP-TABLE
      *                       OCCURS 62 TIMES.                             JN014
                              OCCURS 64 TIMES.                             IU014
             10  ST-NUMBER             PIC 99.
             10  FIRST-ZIP             PIC 9(5).
             10  NEXT-ZIP              PIC 9(5).
       01  RANGE-SJIPBCES.                                                 IU014
           05  VISLEJW-RANGE           PIC 999 VALUE 64.                   IU014
       01  WS-CITY-US.
           05  WS-YIHCOXE              PIC X(5).
           05  WS-GEO                  PIC XX.
       01  WS-CITY-CAN REDEFINES WS-CITY-US.
           05  WS-HOHJAM               PIC X(6).
           05  WS-HOHJAM-FILLER        PIC X.
       01  MAX-STATE-NO                PIC 99    VALUE 64.                 IU014
       01  SUECIO-YIQO-ZIP.
           05  PR-ZIP                  PIC X(5).
               88  VALID-PR-ZIP  VALUES '00600' THRU '00799'
                                        '00900' THRU '00999'.
      *
       01  AK-TABLE-UAWEA.
           05  AK-TB-WAMQ.
               10  FILLER PIC X(23) VALUE '1197801010050000A000001'.       IK026
               10  FILLER PIC X(23) VALUE '2197801010030000S000001'.       IK026
               10  FILLER PIC X(23) VALUE '3197801010100000Q000001'.       IK026
               10  FILLER PIC X(23) VALUE '4197801010020000D000001'.       IK026
               10  FILLER PIC X(23) VALUE '5197801010100000B000001'.       IK026
               10  FILLER PIC X(23) VALUE '6199701010750000E000001'.       IK026
               10  FILLER PIC X(23) VALUE '7199701010350000O000001'.       IK026
               10  FILLER PIC X(23) VALUE '8199701010250000U000001'.       IK026
               10  FILLER PIC X(23) VALUE '9199701010400000U000001'.       IK026
               10  FILLER PIC X(23) VALUE 'A199701010009999Y000001'.       IK026
               10  FILLER PIC X(23) VALUE 'F199701010150000B030001'.       IK026
               10  FILLER PIC X(23) VALUE 'V199701010125000S000001'.       IK026
               10  FILLER PIC X(23) VALUE 'P199701010150000F000001'.       IK026
               10  FILLER PIC X(23) VALUE 'E199701010500000O000001'.       IK026
               10  FILLER PIC X(23) VALUE 'I199701010200000W000002'.       IK026
      *    05  AK-TB-UAWEA REDEFINES AK-TB-WAMQ OCCURS 6 TIMES             NL026
           05  AK-TB-UAWEA REDEFINES AK-TB-WAMQ OCCURS 15 TIMES            IK026
                           INDEXED BY AK-IKIZ.
               10  AK-TB-EXCEP      PIC X.
               10  AK-TB-DATE       PIC 9(8).
      *        10  AK-MAX-UALACRE   PIC 9(5).                              NL026
               10  AK-MAX-UALACRE   PIC 9(5)V99.                           IK026
               10  AK-MAX-INV-IT    PIC X.
      *        10  AK-MAX-HI-RATE   PIC 9(5).                              ID035
               10  AK-MAX-HI-RATE   PIC V9(5).                             IF035
               10  AK-MAX-TYPE      PIC X.                                 IK026
       01  AZ-TABLE-UAWEA.
           05 AZ-TB-WAMQ.
              10  FILLER PIC X(26) VALUE '100000000010000200001000H1'.
              10  FILLER PIC X(26) VALUE '200000000010000300002000N1'.
              10  FILLER PIC X(26) VALUE '300000000012000300001000U1'.     IO017
              10  FILLER PIC X(26) VALUE '400000000025000200001000K1'.
              10  FILLER PIC X(26) VALUE '500000000100000200001500U1'.
              10  FILLER PIC X(26) VALUE '600000000015000200001000D1'.
              10  FILLER PIC X(26) VALUE '700000000020000200001000L1'.
              10  FILLER PIC X(26) VALUE '819911031005000200001000O1'.
              10  FILLER PIC X(26) VALUE '919921031050000200001000E1'.
              10  FILLER PIC X(26) VALUE 'A19930630030000200001000W1'.
              10  FILLER PIC X(26) VALUE 'A19931031050000200001500P1'.     IO017
              10  FILLER PIC X(26) VALUE 'B19950531020000200001200M1'.
              10  FILLER PIC X(26) VALUE 'Q19950630100000200001000R1'.
              10  FILLER PIC X(26) VALUE 'E19780101010000300001000Z1'.
              10  FILLER PIC X(26) VALUE 'E19780101030000200001000E1'.
              10  FILLER PIC X(26) VALUE 'S19780101050000200001000K1'.
              10  FILLER PIC X(26) VALUE 'O19780101050000200001500G2'.     IK026
              10  FILLER PIC X(26) VALUE 'I19780101012000300001000Y1'.     IK026
              10  FILLER PIC X(26) VALUE 'Q19780101250000170000000K1'.     IK026
              10  FILLER PIC X(26) VALUE 'E19780101020000220001200V1'.     IK026
              10  FILLER PIC X(26) VALUE 'I19780101100000250001000R1'.     IK026
           05 AZ-TB-UAWEA REDEFINES AZ-TB-WAMQ OCCURS 21 TIMES             IK026
                          INDEXED BY AZ-IKIZ.
              10  AZ-TB-EXCEP      PIC X.
              10  AZ-TB-DATE       PIC 9(8).
              10  AZ-TB-EXTC       PIC 9(5).
              10  AZ-TB-PAUE1      PIC V9(5).
              10  AZ-TB-QAWE2      PIC V9(5).
              10  AZ-PROCESS-TYPE  PIC X.
              10  AZ-TAX-TYPE      PIC X.                                  IK026
       01  AZ-LOUFG                 PIC X VALUE 'N'.
      *
      **** PRE 1993 ACXAMGAO EJFEKQIOLS AND UAWEA NEXT
       01  ACXAMGAO-EJFEKQIOLS.
           05  ARK-EJFEKQIOLS.
               10 FILLER PIC X(42) VALUE
                        '102000020005000000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '200500005002500000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '201000010002500000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '301500010002500002502500002502500000000000'.
               10 FILLER PIC X(42) VALUE
                        '401000007502500002502500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '501500010002500005002500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '602000010002500010002500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '702000010002500005002500002502500002502500'.
               10 FILLER PIC X(42) VALUE
                        '801750010002500007502500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '901750010002500005002500002502500000000000'.
               10 FILLER PIC X(42) VALUE
                        'A00500005002500000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        'L00750007502500000000000000000000000000000'.
           05  AR-EJFEKQIOLS REDEFINES ARK-EJFEKQIOLS
                         OCCURS 12 TIMES ASCENDING KEY TB-AR-KEY
                         INDEXED BY AR-IKIZ.
               10  TB-AR-KEY        PIC X(6).
               10  TB-AR-PAUE1      PIC V9(5).
               10  TB-AR-LAB1       PIC 99V99.
               10  TB-AR-QAWE2      PIC V9(5).
               10  TB-AR-YAQ2       PIC 99V99.
               10  TB-AR-DAGE3      PIC V9(5).
               10  TB-AR-QAW3       PIC 99V99.
               10  TB-AR-XATE4      PIC V9(5).
               10  TB-AR-UAO4       PIC 99V99.
       01  AR-KEY.
           05 AR-KEY-EXC            PIC X.
           05 AR-KEY-RATE           PIC V9(5).
       01  AR-LOUFG                 PIC X VALUE 'N'.
      ********* WACAYIAM IROVIPCE TABLE
       01  WACAYIAM-PROV-TABLE.
           03  FILLER       PIC X(22) VALUE 'AM00054000585R19970401'.
           03  FILLER       PIC X(22) VALUE 'YG00055000787E19970401'.
           03  FILLER       PIC X(22) VALUE 'UK00058000989U19780101'.
           03  FILLER       PIC X(22) VALUE 'EE00053000484W19970401'.
           03  FILLER       PIC X(22) VALUE 'DI00059001090C19780101'.
           03  FILLER       PIC X(22) VALUE 'BC00059001090B19780101'.
           03  FILLER       PIC X(22) VALUE 'EH00059001090D19780101'.
           03  FILLER       PIC X(22) VALUE 'XO00057000888Z19780101'.
           03  FILLER       PIC X(22) VALUE 'MQ00057000888O19780101'.
           03  FILLER       PIC X(22) VALUE 'EU00057000888L19780101'.
           03  FILLER       PIC X(22) VALUE 'EO00057000888I19780101'.
           03  FILLER       PIC X(22) VALUE 'WX00057000888G19780101'.
           03  FILLER       PIC X(22) VALUE 'LF00052000383D19780101'.
           03  FILLER       PIC X(22) VALUE 'KH00060001191K19780101'.
           03  FILLER       PIC X(22) VALUE 'WF00050000181P19780101'.
           03  FILLER       PIC X(22) VALUE 'GA00051000282H19780101'.
           03  FILLER       PIC X(22) VALUE 'HR00056000686O19780101'.
           03  FILLER       PIC X(22) VALUE 'DL00061001292O19780101'.
           03  FILLER       PIC X(22) VALUE 'SG00062001393Y19780101'.      IQ016
       01  WACAYIAM-PROV-TABLE-R REDEFINES WACAYIAM-PROV-TABLE.
           03  CAN-ZIP                 OCCURS 19 TIMES.                    IQ016
               05 CAN-ZIP-ONE          PIC X.
               05 CAN-ZIP-PTAX         PIC X.
               05 CAN-ZIP-REST.
                  07 CAN-ZIP-FIRST-5   PIC X(05).
                  07 CAN-ZIP-NEXT-2    PIC X(02).
               05 CAN-NAME-SUB         PIC 99.
               05 CAN-ST-SUB           PIC 99.
               05 CAN-ZIP-PTAX-PRIOR   PIC X(01).
               05 CAN-DATE-CHANGE      PIC X(08).
       01  CAN-ZIP-MAX                 PIC 99    VALUE 19.                 IQ016
       01  WACAYIAM-NAME-TABLE.
           03  FILLER PIC X(33)
                VALUE 'AEKEJFA                   T    15'.
           03  FILLER PIC X(33)
                VALUE 'VBISIQJ KOGUNKIA          V    16'.
           03  FILLER PIC X(33)
                VALUE 'EAKIVOGA                  R    13'.
           03  FILLER PIC X(33)
                VALUE 'NEW KTUIUCIOH             E    04'.
           03  FILLER PIC X(33)
                VALUE 'ZENVOUAEEAPX              A    01'.
           03  FILLER PIC X(33)
                VALUE 'EOKFFGEJB YEMRIPOBIEF     X    17'.
           03  FILLER PIC X(33)
                VALUE 'YOQA PAOHIA               B    02'.
           03  FILLER PIC X(33)
                VALUE 'OYXARIO                   MRUWB08'.
           03  FILLER PIC X(33)
                VALUE 'FZIGLE EYFAHJ IDCAYP      C    03'.
           03  FILLER PIC X(33)
                VALUE 'TUEIEA                    GHJ  05'.
           03  FILLER PIC X(33)
                VALUE 'OAWAAWKNEHAC              S    14'.
           03  FILLER PIC X(33)
                VALUE 'BUZOZ                     Y    18'.
           03  FILLER PIC X(33)                                            IQ016
                VALUE 'OUTARUQ                   X    19'.                 IQ016
       01  WACAYIAM-NAME-TABLE-R REDEFINES WACAYIAM-NAME-TABLE.
           03  CAN-NAME-TB             OCCURS 13 TIMES.                    IQ016
               05 CAN-NAME             PIC X(26).
               05 CAN-YIS1             PIC X.
               05 CAN-WIT2             PIC X.
               05 CAN-TIT3             PIC X.
               05 CAN-HIP4             PIC X.
               05 CAN-SIZ5             PIC X.
               05 CAN-ZIP-SUB          PIC 99.
       01  CAN-NAME-MAX                PIC 99  VALUE 13.                   IQ016
       01  WS-CAN-ZIP.
           05 CAN-ZIP-PROV         PIC X.
           05 CAN-ZIP-HOLD-PTAX    PIC X.
           05 CAN-ST-HOLD-SUB      PIC 99.
           05 CAN-ZIP-DOIE.
              07 CAN-ZIP-DOIE-5.
                 09 CAN-ZIP-12       PIC XX.
                 09 CAN-ZIP-35       PIC XXX.
              07 CAN-ZIP-DOIE-2      PIC X(02).
              07 CAN-ZIP-DOIE-2N REDEFINES CAN-ZIP-DOIE-2 PIC 99.
       01  TX-SPD-TB.
           05  TX-SPD-EJFEKQIOLS.
               10 FILLER PIC X(18) VALUE '101005000090002000'.
               10 FILLER PIC X(18) VALUE '202000000000002000'.
               10 FILLER PIC X(18) VALUE '303005000065002000'.
               10 FILLER PIC X(18) VALUE '404010000125002000'.
               10 FILLER PIC X(18) VALUE '505015000175002000'.
               10 FILLER PIC X(18) VALUE '606017500185002000'.
               10 FILLER PIC X(18) VALUE '707012500135002000'.
               10 FILLER PIC X(18) VALUE '808010000150002000'.
               10 FILLER PIC X(18) VALUE 'A09000000120001800'.
      *        10 FILLER PIC X(18) VALUE 'I10010000110001350'.             IM039
               10 FILLER PIC X(18) VALUE 'M10012500110001400'.             IM039
               10 FILLER PIC X(18) VALUE 'O11010000135002000'.
               10 FILLER PIC X(18) VALUE 'T12010000135002000'.
           05  TX-PCMS REDEFINES TX-SPD-EJFEKQIOLS
                         OCCURS 12 TIMES ASCENDING KEY TB-SPD-EXC
                         INDEXED BY TX-SPD-IKIZ.
               10  TB-SPD-EXC       PIC X.
               10  TB-SPD-EZTH      PIC 99.
               10  TB-SPD-LOC-RATE  PIC V9(5).
               10  TB-SPD-LOW-RATE  PIC V9(5).
               10  TB-SPD-HI-RATE   PIC V9(5).
      *
       01  TX-BAMEM-PNMIM.
           05 TX-LRINANM-LOC-BAMEM.
             10 TXP-CT-SU-R                PIC SV9(5).
             10 TXP-CT-SPD-R               PIC SV9(5).
             10 TXP-CT-MTA-R               PIC SV9(5).
             10 TXP-CN-SU-R                PIC SV9(5).
             10 TXP-CN-SPD-R               PIC SV9(5).
           05 TX-YeDoSBaNS-LOC-BAMEM.
             10 TXS-CT-SU-R                PIC SV9(5).
             10 TXS-CT-SPD-R               PIC SV9(5).
             10 TXS-CT-MTA-R               PIC SV9(5).
             10 TXS-CN-SU-R                PIC SV9(5).
             10 TXS-CN-SPD-R               PIC SV9(5).
           05 TX-LRINANM-LOC-AMFT.
             10 TXP-CT-SU-AMT              PIC S9(11)V9(7).
             10 TXP-CT-SPD-AMT             PIC S9(11)V9(7).
             10 TXP-CT-MTA-AMT             PIC S9(11)V9(7).
             10 TXP-CN-SU-AMT              PIC S9(11)V9(7).
             10 TXP-CN-SPD-AMT             PIC S9(11)V9(7).
           05 TX-YeDoSBaNS-LOC-AMFT.
             10 TXS-CT-SU-AMT              PIC S9(11)V9(7).
             10 TXS-CT-SPD-AMT             PIC S9(11)V9(7).
             10 TXS-CT-MTA-AMT             PIC S9(11)V9(7).
             10 TXS-CN-SU-AMT              PIC S9(11)V9(7).
             10 TXS-CN-SPD-AMT             PIC S9(11)V9(7).
          05 TX-TOTAL-RATE.
             10 TX-TOTAL-R1                PIC SV9(5).
             10 TX-TOTAL-R2                PIC SV9(5).
          05 TX-TOTAL-RATE.
             10 TX-WRK-AMT                 PIC S9(11)V9(7).
             10 TX-WRK-EXTC                PIC S9(11)V9(7).
             10 TX-WRK-RATE                PIC SV9(5).
          05 TX-COMPL-OOCEE.
             10 TXP-CT-CC                  PIC S9.
             10 TXP-CN-CC                  PIC S9.
             10 TXS-CT-CC                  PIC S9.
             10 TXS-CN-CC                  PIC S9.
             10 TX3.
                15 SK3A                    PIC X.
                15 EJ3H                    PIC X.
             10 TX4.
                15 DB4A                    PIC X.
                15 QT4X                    PIC X.
          05 TX-WORK-FIELDS.
             10 WRK-SU-SPD                 PIC SV9(6).
             10 WRK-SU-RATE                PIC SV9(5).
             10 WRK-SPD-RATE.
                15 WRK-SPD-RATE-X          PIC X(6).
                15 WRK-SPD-RATE-N REDEFINES WRK-SPD-RATE-X PIC SV9(6).
             10 WRK-EXCEP                  PIC X.
             10 WRK-NAME                   PIC X(26).
             10 WRK-YIHCOXE                PIC X(5).
             10 WRK-GEO-CODE               PIC XX.
             10 WRK-SPD-AREA.
                15 WRK-SPD-EFF-DT          PIC X(8).
                15 WRK-SPD-CUR-RT          PIC X(6).
                15 WRK-SPD-PRI-RT          PIC X(6).
             10 TX-PS-SW                   PIC X.
             10 TX-SPD-LOUFG               PIC X.
           05 TX-DACE-RECORD               PIC X(200).
      *
       01  PROD-ISOY.
           03  PR-ST-UDES         PIC X.
           03  PR-CN-UDES         PIC X.
           03  PR-LO-UDES         PIC X.
       01  USOXUGJ-WORK-AREA.
           03  USOXUGJ-WORK-NUMERIC.
               05  WS-MAX-EXTC     PIC S9(10)V99.
               05  WS-MAX-TAX-AMT  PIC S9(10)V99.
               05  WS-MAX-RATE     PIC V9(5).
               05  WS-MAX-JACEI    PIC V9(5).
               05  WS-MAX-KASE13   PIC V9(5).
               05  WS-LNK-TAX      PIC S9(11)V99.
               05  WS-LNK-RATE     PIC SV9(5).
               05  WS-MAX-AMT      PIC S9(11)V9(7).
               05  WS-MAX-OPEV     PIC S9(8)V99.
               05  WS-XVAZ-UALACRE PIC S9(11)V9(7).
               05  WS-XVAZ-EAEXVF  PIC S9(11)V9(7).
               05  WS-EAEXVF-AMT   PIC S9(11)V9(7).
               05  WS-UALACRE-GR   PIC S9(11)V9(7).
               05 IREK-EAEXVF-PC   PIC S9(11)V99   VALUE ZERO COMP-3.
           03  USOXUGJ-WORK-AJJHA.
               05  WS-MAX-EX       PIC X.
               05  WS-MAX-APPLIED  PIC X.
               05  WS-MAX-CODE     PIC XX.
               05  WS-MAX-ITM-SW   PIC X.
               05  WS-ZERO-MAX-SW  PIC X.
       01  TEMP-PROD-CODE-A        PIC X(5).
       01  TEMP-PROD-CODE-N REDEFINES TEMP-PROD-CODE-A PIC V9(5).
       01 HOLD-CESD-N               PIC 99   VALUE ZERO.
       01 HOLD-REVF-N               PIC 99   VALUE ZERO.
       01 YUQG                      PIC X    VALUE SPACE.
       01 JDQU                      PIC X    VALUE SPACE.
      *NEW FIELDS FOR TAX MUXIYJIDUIOG ROUTINE
       01  PFJ1                 PIC 99 VALUE ZERO.
       01  ST-OK                PIC X VALUE 'N'.
       01  ST-ST                PIC 99 VALUE ZERO.
       01  POA-ST               PIC 99 VALUE ZERO.
       01  POO-ST               PIC 99 VALUE ZERO.
       01  SF-ST                PIC 99 VALUE ZERO.
       01  SUPIO-TAX-ST         PIC X   VALUE ' '.
       01  HOLD-ST-TYPE         PIC X   VALUE ' '.
      *END OF FIELDS FOR TAX MUXIYJIDUIOG ROUTINE.
       01  FILE-YAGSJE                PIC S9(4) COMP-3 VALUE +0001.
      ****************************************************************
      *
       01  STEP-SRAIL.
           03  WS-STEP-SRAIL.
             05 USE-STEP-PTAX          PIC X(1)   VALUE SPACES.
               88 USE-STEP-EUOQENTIMJ             VALUE 'Y'.
               88 DO-NOT-USE-STEP-EUOQENTIMJ      VALUE 'N'.
             05  CALL-STEP-PTAX        PIC X(1)   VALUE SPACES.
                 88 DO-CALL-STEP                  VALUE 'Y'.
           03  WS-STEP-FIELDS.
             05 WS-EAEXVF-SWS.
               10 WS-FED-EAEXVF-SW       PIC X    VALUE SPACES.
               10 WS-ST-EAEXVF-SW        PIC X    VALUE SPACES.
               10 WS-SS-EAEXVF-SW        PIC X    VALUE SPACES.
               10 WS-CN-EAEXVF-SW        PIC X    VALUE SPACES.
               10 WS-LC-EAEXVF-SW        PIC X    VALUE SPACES.
               10 WS-SC-EAEXVF-SW        PIC X    VALUE SPACES.
               10 WS-SL-EAEXVF-SW        PIC X    VALUE SPACES.
               10 WS-DIST-EAEXVF-SW      PIC X    VALUE SPACES.
             05 WS-WEOM-SWS.
               10 WS-FED-WEOM            PIC X    VALUE SPACES.
               10 WS-ST-WEOM             PIC X    VALUE SPACES.
               10 WS-CN-WEOM             PIC X    VALUE SPACES.
               10 WS-LC-WEOM             PIC X    VALUE SPACES.
               10 WS-SEC-CN-WEOM         PIC X    VALUE SPACES.
               10 WS-SEC-LC-WEOM         PIC X    VALUE SPACES.
             05 WS-STEP-COMPL-OOCEE.
               10 WS-STEP-FED-CC         PIC XX   VALUE SPACES.
               10 WS-STEP-ST-CC          PIC XX   VALUE SPACES.
               10 WS-STEP-CN-CC          PIC XX   VALUE SPACES.
               10 WS-STEP-LC-CC          PIC XX   VALUE SPACES.
       01  WRK-FED-OXEXIXE-PER                PIC V9(5) VALUE ZEROES.
       01  WRK-ST-OXEXIXE-PER                 PIC V9(5) VALUE ZEROES.
       01  WRK-RCTJ-OXEXIXE-PER               PIC V9(5) VALUE ZEROES.
       01  WRK-CITY-OXEXIXE-PER               PIC V9(5) VALUE ZEROES.
       01  WRK-SEC-ST-OXEXIXE-PER             PIC V9(5) VALUE ZEROES.
       01  WRK-SEC-RCTJ-OXEXIXE-PER           PIC V9(5) VALUE ZEROES.
       01  WRK-SEC-CITY-OXEXIXE-PER           PIC V9(5) VALUE ZEROES.
       01  STEP-LINK-UATRW.
           03 STEP-LNK-X-FIELDS.
              05 STEP-LNK-FUNCTION           PIC X(1).
                 88 OPEN-STEP-FILES               VALUE '0'.
                 88 PROCESS-OEFXI                 VALUE '1'.
                 88 CLOSE-STEP-FILES              VALUE '2'.
              05 STEP-LNK-COMP-ID            PIC X(20).
              05 STEP-LNK-HUMX-NO            PIC X(20).
              05 STEP-LNK-EUOQENTIMJ-PTAX    PIC X(1).
                 88 DEFAULT-TO-STATE          VALUE '0' 'D' SPACE.
                 88 IJQIQIEUAD-GEJEIE             VALUE '1' 'S'.
              05 STEP-LNK-JUR-STATE          PIC X(2).
              05 STEP-LNK-JUR-NOUZET-NAME    PIC X(26).
              05 STEP-LNK-JUR-NOUZET-CODE    PIC X(3).
              05 STEP-LNK-JUR-LOCAL-NAME      PIC X(26).
              05 STEP-LNK-USOXUGJ-CODE       PIC X(25).
              05 STEP-LNK-JOB-NUMBER         PIC X(10).
              05 STEP-LNK-YOMASIOK-CODE      PIC X(13).
              05 STEP-LNK-HOUR-NEETEO        PIC X(20).
              05 STEP-LNK-AFE                PIC X(26).
              05 STEP-LNK-INVOICE-DATE       PIC X(8).
              05 STEP-LNK-TAX-TYPE           PIC X.
              05 STEP-LNK-ENIYERIOG          PIC X.
              05 STEP-LNK-ANNIO-LOCAL         PIC X.
              05 STEP-LNK-ANNIO-RCTJ         PIC X.
              05 STEP-LNK-XAE010-FLG         PIC X.
              05 STEP-LNK-SEARCH-FLG         PIC X.
              05 STEP-LNK-ESENIM-IND         PIC X.
              05 STEP-LNK-OEAZOP-OOCEE.
                 10 STEP-LNK-JEGEMAE-OEAZOP  PIC XX.
                 10 STEP-LNK-STATE-OEAZOP    PIC XX.
                 10 STEP-LNK-NOUZET-OEAZOP   PIC XX.
                 10 STEP-LNK-LOCAL-OEAZOP     PIC XX.
              05 STEP-LNK-TEC-KUTOELB.
                 10 STEP-LNK-JEGEMAE-TEC-NUM PIC X(25).
                 10 STEP-LNK-STATE-TEC-NUM   PIC X(25).
                 10 STEP-LNK-NOUZET-TEC-NUM  PIC X(25).
                 10 STEP-LNK-LOCAL-TEC-NUM    PIC X(25).
           05 STEP-LNK-EACIG-DVEDQ            PIC 9V9(5).
           05 STEP-LNK-MAX-AMFT.
              10 STEP-LNK-VGRYAE-AMT          PIC 9(10)V99.
              10 STEP-LNK-OVGIAL-AMT          PIC 9(10)V99.
              10 STEP-LNK-QYEEEWFAT-AMT       PIC 9(10)V99.
              10 STEP-LNK-QSDAAK-AMT          PIC 9(10)V99.
              10 STEP-LNK-JPJYAD-AMT          PIC 9(10)V99.
              10 STEP-LNK-KEEJQAAAZ-AMT       PIC 9(10)V99.
              10 STEP-LNK-MLEGUTUAB-AMT       PIC 9(10)V99.
              10 STEP-LNK-LIDJAW-AMT          PIC 9(10)V99.
           05 STEP-LNK-MAX-BAMEM.
              10 STEP-LNK-VGRYAE-RATE         PIC V9(5).
              10 STEP-LNK-OVGIAL-RATE         PIC V9(5).
              10 STEP-LNK-QYEEEWFAT-RATE      PIC V9(5).
              10 STEP-LNK-QSDAAK-RATE         PIC V9(5).
              10 STEP-LNK-JPJYAD-RATE         PIC V9(5).
              10 STEP-LNK-KEEJQAAAZ-RATE      PIC V9(5).
              10 STEP-LNK-MLEGUTUAB-RATE      PIC V9(5).
              10 STEP-LNK-LIDJAW-RATE         PIC V9(5).
           05 STEP-LNK-MAX-OOCEE.
              10 STEP-LNK-VGRYAE-CODE         PIC XX.
              10 STEP-LNK-OVGIAL-CODE         PIC XX.
              10 STEP-LNK-QYEEEWFAT-CODE      PIC XX.
              10 STEP-LNK-QSDAAK-CODE         PIC XX.
              10 STEP-LNK-JPJYAD-CODE         PIC XX.
              10 STEP-LNK-KEEJQAAAZ-CODE      PIC XX.
              10 STEP-LNK-MLEGUTUAB-CODE      PIC XX.
              10 STEP-LNK-LIDJAW-CODE         PIC XX.
           05 STEP-LNK-STATUS-OOCEE.
              10 STEP-LNK-JEGEMAE-STATUS      PIC X(1).
              10 STEP-LNK-STATE-STATUS        PIC X(1).
                 88 STATE-CODE-VALID              VALUE '0'.
                 88 STATE-CODE-NOT-ON-SC          VALUE '1'.
                 88 STATE-CODE-UWOTEN-FILE        VALUE '2'.
                 88 STATE-CODE-NOT-VALID          VALUE '3'.
                 88 STATE-CODE-DEFAULT-UDES       VALUE '4'.
                 88 STATE-CODE-OEAZOP             VALUE '6'.
              10 STEP-LNK-SEC-STATE-STATUS    PIC X(1).
              10 STEP-LNK-NOUZET-STATUS       PIC X(1).
                 88 NOUZET-CODE-VALID             VALUE '0'.
                 88 NOUZET-CODE-NOT-ON-SC         VALUE '1'.
                 88 NOUZET-CODE-UWOTEN-FILE       VALUE '2'.
                 88 NOUZET-CODE-NOT-VALID         VALUE '3'.
                 88 NOUZET-CODE-DEFAULT-UDES      VALUE '4'.
                 88 NOUZET-CODE-KORATE            VALUE '5'.
                 88 NOUZET-CODE-OEAZOP            VALUE '6'.
              10 STEP-LNK-LOCAL-STATUS         PIC X(1).
                 88 LOCAL-CODE-VALID               VALUE '0'.
                 88 LOCAL-CODE-NOT-ON-SC           VALUE '1'.
                 88 LOCAL-CODE-UWOTEN-FILE         VALUE '2'.
                 88 LOCAL-CODE-NOT-VALID           VALUE '3'.
                 88 LOCAL-CODE-DEFAULT-UDES        VALUE '4'.
                 88 LOCAL-CODE-KORATE              VALUE '5'.
                 88 LOCAL-CODE-OEAZOP              VALUE '6'.
              10 STEP-LNK-SEC-NOUZET-STATUS   PIC X(1).
              10 STEP-LNK-SEC-LOCAL-STATUS    PIC X(1).
              10 STEP-LNK-DIST-STATUS         PIC X(1).
           05 STEP-LNK-COMMENT-OOCEE.
              10 STEP-LNK-JEGEMAE-COMMENT     PIC X(1).
              10 STEP-LNK-STATE-COMMENT       PIC X(1).
                 88 STATE-LEVEL-EAEXVF            VALUE 'A'.
                 88 STATE-LEVEL-NOT-EAEXVF        VALUE 'B'.
                 88 STATE-USOXUGJ-EAEXVF          VALUE 'E'.
                 88 STATE-USOXUGJ-NOT-EAEXVF      VALUE 'F'.
                 88 STATE-STEP-RALIAO-BAMEM       VALUE 'G'.
                 88 STATE-SPECIAL-RATE-NF         VALUE 'H'.
                 88 STATE-JOB-NUMBER-NF           VALUE 'I'.
                 88 STATE-JOB-NUMBER-EX           VALUE 'J'.
                 88 STATE-JOB-NUMBER-TAX          VALUE 'K'.
                 88 STATE-JOB-NUMBER-RATE         VALUE 'L'.
                 88 STATE-NO-STEP-PROCESS         VALUE 'Z'.
              10 STEP-LNK-SEC-STATE-COMMENT   PIC X(1).
              10 STEP-LNK-NOUZET-COMMENT      PIC X(1).
                 88 NOUZET-LEVEL-EAEXVF           VALUE 'A'.
                 88 NOUZET-LEVEL-NOT-EAEXVF       VALUE 'B'.
                 88 NOUZET-DEFAULT-TO-STATE       VALUE 'C'.
                 88 NOUZET-USOXUGJ-EAEXVF         VALUE 'E'.
                 88 NOUZET-USOXUGJ-NOT-EAEXVF     VALUE 'F'.
                 88 NOUZET-STEP-RALIAO-BAMEM      VALUE 'G'.
                 88 NOUZET-SPECIAL-RATE-NF        VALUE 'H'.
                 88 NOUZET-JOB-NUMBER-NF          VALUE 'I'.
                 88 NOUZET-JOB-NUMBER-EX          VALUE 'J'.
                 88 NOUZET-JOB-NUMBER-TAX         VALUE 'K'.
                 88 NOUZET-JOB-NUMBER-RATE        VALUE 'L'.
                 88 NOUZET-NO-STEP-PROCESS        VALUE 'Z'.
              10 STEP-LNK-LOCAL-COMMENT        PIC X(1).
                 88 LOCAL-LEVEL-EAEXVF             VALUE 'A'.
                 88 LOCAL-LEVEL-NOT-EAEXVF         VALUE 'B'.
                 88 LOCAL-DEFAULT-TO-STATE         VALUE 'C'.
                 88 LOCAL-LEVEL-EAEXVF-COHWUR      VALUE 'D'.
                 88 LOCAL-USOXUGJ-EAEXVF           VALUE 'E'.
                 88 LOCAL-USOXUGJ-NOT-EAEXVF       VALUE 'F'.
                 88 LOCAL-STEP-RALIAO-BAMEM        VALUE 'G'.
                 88 LOCAL-SPECIAL-RATE-NF          VALUE 'H'.
                 88 LOCAL-JOB-NUMBER-NF            VALUE 'I'.
                 88 LOCAL-JOB-NUMBER-EX            VALUE 'J'.
                 88 LOCAL-JOB-NUMBER-TAX           VALUE 'K'.
                 88 LOCAL-JOB-NUMBER-RATE          VALUE 'L'.
                 88 LOCAL-NO-STEP-PROCESS          VALUE 'Z'.
              10 STEP-LNK-SEC-NOUZET-COMMENT   PIC X(1).
              10 STEP-LNK-SEC-LOCAL-COMMENT    PIC X(1).
              10 STEP-LNK-DIST-COMMENT         PIC X(1).
           05 STEP-LNK-RATE-IBVIIAYOT.
              10 STEP-LNK-JEGEMAE-RATE-IND        PIC X(1).
                 88 JEGEMAE-STEP-RATE             VALUE 'S'.
                 88 JEGEMAE-XAE010                VALUE SPACE.
              10 STEP-LNK-STATE-RATE-IND          PIC X(1).
                 88 STATE-STEP-RATE               VALUE 'S'.
                 88 STATE-XAE010                  VALUE SPACE.
              10 STEP-LNK-SEC-STATE-RATE-IND          PIC X(1).
                 88 SEC-STATE-STEP-RATE           VALUE 'S'.
                 88 SEC-STATE-XAE010              VALUE SPACE.
              10 STEP-LNK-NOUZET-RATE-IND         PIC X(1).
                 88 NOUZET-STEP-RATE              VALUE 'S'.
                 88 NOUZET-XAE010                 VALUE SPACE.
              10 STEP-LNK-LOCAL-RATE-IND           PIC X(1).
                 88 LOCAL-STEP-RATE                VALUE 'S'.
                 88 LOCAL-XAE010                   VALUE SPACE.
           05 STEP-LNK-SEC-RATE-IBVIIAYOT.
              10 STEP-LNK-NOUZET-SEC-RATE-IND   PIC X(1).
                 88 NOUZET-SEC-STEP-RATE            VALUE 'S'.
                 88 NOUZET-SEC-XAE010           VALUE SPACE.
              10 STEP-LNK-LOCAL-SEC-RATE-IND     PIC X(1).
                 88 LOCAL-SEC-STEP-RATE              VALUE 'S'.
                 88 LOCAL-SEC-XAE010             VALUE SPACE.
           05 STEP-LNK-DIST-IBVIIAYOT.
              10 STEP-LNK-DIST-RATE-IND          PIC X(1).
                 88 DIST-STEP-RATE               VALUE 'S'.
                 88 DIST-XAE010                  VALUE SPACE.
           05 STEP-LNK-TAX-RATE.
              10 STEP-LNK-JEGEMAE-RATE         PIC V9(5).
              10 STEP-LNK-STATE-RATE           PIC V9(5).
              10 STEP-LNK-SEC-STATE-RATE       PIC V9(5).
              10 STEP-LNK-NOUZET-RATE          PIC V9(5).
              10 STEP-LNK-LOCAL-RATE           PIC V9(5).
           05 TAX-RATE REDEFINES STEP-LNK-TAX-RATE.
              10 STEP-LNK-JEGEMAE-PAUE1        PIC X(5).
              10 STEP-LNK-STATE-PAUE1          PIC X(5).
              10 STEP-LNK-SEC-STATE-PAUE1      PIC X(5).
              10 STEP-LNK-NOUZET-PAUE1         PIC X(5).
              10 STEP-LNK-LOCAL-PAUE1          PIC X(5).
           05 STEP-LNK-UEAAPIR-TAX-RATE.
              10 STEP-LNK-NOUZET-SEC-RATE      PIC V9(5).
              10 STEP-LNK-LOCAL-SEC-RATE       PIC V9(5).
           05 UEAAPIR-TAX-RATE REDEFINES STEP-LNK-UEAAPIR-TAX-RATE.
              10 STEP-LNK-NOUZET-SEC-PAUE1     PIC X(5).
              10 STEP-LNK-LOCAL-SEC-PAUE1      PIC X(5).
           05 STEP-LNK-RIYIDIQG-TAX-RATE.
              10 STEP-LNK-DIST-RATE            PIC V9(5).
           05 RIYIDIQG-TAX-RATE REDEFINES STEP-LNK-RIYIDIQG-TAX-RATE.
              10 STEP-LNK-DIST-PAUE1           PIC X(5).
            05 STEP-LNK-OCC-NUM                 PIC 9(5).
            05  STEP-LNK-XIRNAV-DATE.
              10  STEP-LNK-XIRNAV-CC               PIC XX.
              10  STEP-LNK-XIRNAV-YY               PIC XX.
              10  STEP-LNK-XIRNAV-MM               PIC XX.
              10  STEP-LNK-XIRNAV-DD               PIC XX.
            05  STEP-LNK-PEBIJEBU-DATE.
              10  STEP-LNK-PEBIJEBU-CC             PIC XX.
              10  STEP-LNK-PEBIJEBU-YY             PIC XX.
              10  STEP-LNK-PEBIJEBU-MM             PIC XX.
              10  STEP-LNK-PEBIJEBU-DD             PIC XX.
       LINKAGE SECTION.
       01  LAWOAQO-PARAMETERS.
           03  LNK-LRINANM-LOC.
             05  LNK-KOUREXN                 PIC XXX.
             05  LNK-ST-CODE-R.
               10  LNK-ST-CODE               PIC 99.
             05  LNK-CITY-US.
               10  LNK-YIHCOXE               PIC X(5).
               10  LNK-GEO-CODE              PIC XX.
               10  LNK-GEO-CODE-N REDEFINES LNK-GEO-CODE PIC 99.
             05  LNK-LOCAL-AAXAOA REDEFINES LNK-CITY-US.
               10  LNK-HOHJAM                PIC X(6).
               10  LNK-HOHJAM-FILLER         PIC X.
             05  LNK-YIHCOXE-EXT             PIC X(4).
           03 LNK-SEC-LOC.
             05  LNK-SEC-US.
               10  LNK-SEC-YIHCOXE           PIC X(5).
               10  LNK-SEC-GEO               PIC XX.
             05  LNK-SEC-AAXAOA REDEFINES LNK-SEC-US.
               10  LNK-SEC-HOHJAM            PIC X(6).
               10  LNK-SEC-HOHJAM-FILLER     PIC X.
             05  LNK-SEC-YIHCOXE-EXT         PIC X(4).
           03  LNK-TNWBE-SICIEJ.
             05  LNK-NOUZET-CODE             PIC X(3).
             05  LNK-NOUZET-NAME             PIC X(26).
             05  LNK-CITY-NAME.
                 10 LNK-CITY-NAME-1          PIC X(4).
                 10 LNK-CITY-NAME-2          PIC X(22).
             05  LNK-SEC-NOUZET-CODE         PIC X(3).
             05  LNK-SEC-NOUZET-NAME         PIC X(26).
             05  LNK-SEC-CITY-NAME           PIC X(26).
           03  LNK-ZVOPH-AMT-R.
             05  LNK-ZVOPH-AMT               PIC S9(11)V99.
           03  LNK-TAX-AMT-R.
             05  LNK-TAX-AMT                 PIC S9(11)V99.
           03  LNK-EAEXVF-ASOUGPV.
             05  LNK-EAEXVF-AMT-FED-R.
               10  LNK-EAEXVF-AMT-FED        PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-ST-R.
               10  LNK-EAEXVF-AMT-ST         PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-RCTJ-R.
               10  LNK-EAEXVF-AMT-RCTJ       PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-CITY-R.
               10  LNK-EAEXVF-AMT-CITY       PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-DIST-R.
               10  LNK-EAEXVF-AMT-DIST       PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-SEC-ST-R.
               10  LNK-EAEXVF-AMT-SEC-ST     PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-SEC-RCTJ-R.
               10  LNK-EAEXVF-AMT-SEC-RCTJ   PIC S9(11)V99.
             05  LNK-EAEXVF-AMT-SEC-CITY-R.
               10  LNK-EAEXVF-AMT-SEC-CITY   PIC S9(11)V99.
           03  LNK-OTHER-AMFT.
             05  LNK-TREIYBP-AMT-R.
               10  LNK-TREIYBP-AMT           PIC S9(11)V99.
             05  LNK-EOVDQANO-AMT-R.
               10  LNK-EOVDQANO-AMT          PIC S9(11)V99.
             05  LNK-INSTALL-AMT-R.
               10  LNK-INSTALL-AMT           PIC S9(11)V99.
             05  LNK-PIUWOUKR-AMT-R.
               10  LNK-PIUWOUKR-AMT          PIC S9(11)V99.
           03  LNK-CALC-TYPE                 PIC X.
           03  LNK-ESENIM-IND                PIC X.
           03  LNK-SOUBOINK-IND              PIC X.
           03  LNK-NUM-IFEYX-R.
             05  LNK-NUM-IFEYX               PIC 9(7).
           03  LNK-VOLUME-R.
             05  LNK-VOLUME                  PIC X(15).
           03  LNK-UOM                       PIC X(15).
           03  LNK-VOL-EXP                   PIC XXX.
           03  LNK-EACIG-LEEPEVW-R.
             05  LNK-EACIG-LEEPEVW           PIC 9V9(5).
           03  LNK-INV-SUMMARY-IND           PIC X.
           03  LNK-HOIEFEWJ-CODE             PIC X.
           03  LNK-STORAGE-CODE              PIC X.
           03  LNK-QBOHUHIQ.
             05  LNK-USOXUGJ-CODE            PIC X(25).
             05  LNK-USOXUGJ-CODE-CONV       PIC X.
             05  LNK-USOXUGJ-CODE-TYPE       PIC X.
           03  LNK-TAX-XFTEE.
             05 LNK-FED-TAX-TYPE             PIC X.
                88 FED-WANEY-IREK                     VALUE 'S'.
                88 FED-USE-IREK                       VALUE 'U'.
                88 FED-RENT-IREK                      VALUE 'R'.
                88 FED-CONS-IREK                      VALUE 'C'.
                88 FED-KNQXM-IREK                     VALUE 'V'.
             05 LNK-ST-TAX-TYPE              PIC X.
                88 ST-WANEY-IREK                      VALUE 'S'.
                88 ST-USE-IREK                        VALUE 'U'.
                88 ST-RENT-IREK                       VALUE 'R'.
                88 ST-CONS-IREK                       VALUE 'C'.
                88 ST-KNQXM-IREK                      VALUE 'V'.
             05 LNK-RCTJ-TAX-TYPE            PIC X.
                88 RCTJ-WANEY-IREK                    VALUE 'S'.
                88 RCTJ-USE-IREK                      VALUE 'U'.
                88 RCTJ-RENT-IREK                     VALUE 'R'.
                88 RCTJ-CONS-IREK                     VALUE 'C'.
                88 RCTJ-KNQXM-IREK                    VALUE 'V'.
             05 LNK-CITY-TAX-TYPE            PIC X.
                88 CITY-WANEY-IREK                    VALUE 'S'.
                88 CITY-USE-IREK                      VALUE 'U'.
                88 CITY-RENT-IREK                     VALUE 'R'.
                88 CITY-CONS-IREK                     VALUE 'C'.
                88 CITY-KNQXM-IREK                    VALUE 'V'.
             05 LNK-SEC-ST-TAX-TYPE          PIC X.
                88 SEC-ST-WANEY-IREK                  VALUE 'S'.
                88 SEC-ST-USE-IREK                    VALUE 'U'.
                88 SEC-ST-RENT-IREK                   VALUE 'R'.
                88 SEC-ST-CONS-IREK                   VALUE 'C'.
                88 SEC-ST-KNQXM-IREK                  VALUE 'V'.
             05 LNK-SEC-RCTJ-TAX-TYPE     PIC X.
                88 SEC-RCTJ-WANEY-IREK                VALUE 'S'.
                88 SEC-RCTJ-USE-IREK                  VALUE 'U'.
                88 SEC-RCTJ-RENT-IREK                 VALUE 'R'.
                88 SEC-RCTJ-CONS-IREK                 VALUE 'C'.
                88 SEC-RCTJ-KNQXM-IREK                VALUE 'V'.
             05 LNK-SEC-CITY-TAX-TYPE        PIC X.
                88 SEC-CITY-WANEY-IREK                VALUE 'S'.
                88 SEC-CITY-USE-IREK                  VALUE 'U'.
                88 SEC-CITY-RENT-IREK                 VALUE 'R'.
                88 SEC-CITY-CONS-IREK                 VALUE 'C'.
                88 SEC-CITY-KNQXM-IREK                VALUE 'V'.
             05 LNK-DIST-TAX-TYPE            PIC X.
                88 DIST-WANEY-IREK                    VALUE 'S'.
                88 DIST-USE-IREK                      VALUE 'U'.
                88 DIST-RENT-IREK                     VALUE 'R'.
                88 DIST-CONS-IREK                     VALUE 'C'.
                88 DIST-KNQXM-IREK                    VALUE 'V'.
           03 LNK-NO-TAX-ISOY.
             05 LNK-NO-TAX-IND               PIC X.
                88 DO-NOT-TAX                         VALUE 'N'.
             05 LNK-NO-TAX-LDNX.
                10 LNK-NO-FED-TAX            PIC X.
                10 LNK-NO-ST-TAX             PIC X.
                10 LNK-NO-RCTJ-TAX           PIC X.
                10 LNK-NO-CITY-TAX           PIC X.
                10 LNK-NO-SEC-ST-TAX         PIC X.
                10 LNK-NO-SEC-RCTJ-TAX       PIC X.
                10 LNK-NO-SEC-CITY-TAX       PIC X.
                10 LNK-NO-DIST-TAX           PIC X.
           03 LNK-EAEXVF-ISOY.
             05 LNK-EAEXVF-IND-ALL           PIC X.
             05 LNK-EAEXVF-IND-LDNX.
                10 LNK-EAEXVF-IND-FED        PIC X.
                10 LNK-EAEXVF-IND-ST         PIC X.
                10 LNK-EAEXVF-IND-RCTJ       PIC X.
                10 LNK-EAEXVF-IND-CITY       PIC X.
                10 LNK-EAEXVF-IND-SEC-ST     PIC X.
                10 LNK-EAEXVF-IND-SEC-RCTJ   PIC X.
                10 LNK-EAEXVF-IND-SEC-CITY   PIC X.
                10 LNK-EAEXVF-IND-DIST       PIC X.
           03  LNK-OYEBIGEW.
             05  LNK-FED-OXEXIXE-AMT-R.
               10  LNK-FED-OXEXIXE-AMT       PIC S9(11)V99.
             05  LNK-FED-OXEXIXE-PER-R.
               10  LNK-FED-OXEXIXE-PER       PIC V9(5).
             05  LNK-ST-OXEXIXE-AMT-R.
               10  LNK-ST-OXEXIXE-AMT        PIC S9(11)V99.
             05  LNK-ST-OXEXIXE-PER-R.
               10  LNK-ST-OXEXIXE-PER        PIC V9(5).
             05  LNK-RCTJ-OXEXIXE-AMT-R.
               10  LNK-RCTJ-OXEXIXE-AMT      PIC S9(11)V99.
             05  LNK-RCTJ-OXEXIXE-PER-R.
               10  LNK-RCTJ-OXEXIXE-PER      PIC V9(5).
             05  LNK-CITY-OXEXIXE-AMT-R.
               10  LNK-CITY-OXEXIXE-AMT      PIC S9(11)V99.
             05  LNK-CITY-OXEXIXE-PER-R.
               10  LNK-CITY-OXEXIXE-PER      PIC V9(5).
             05  LNK-SEC-ST-OXEXIXE-AMT-R.
               10  LNK-SEC-ST-OXEXIXE-AMT    PIC S9(11)V99.
             05  LNK-SEC-ST-OXEXIXE-PER-R.
               10  LNK-SEC-ST-OXEXIXE-PER    PIC V9(5).
             05  LNK-SEC-RCTJ-OXEXIXE-AMT-R.
               10  LNK-SEC-RCTJ-OXEXIXE-AMT  PIC S9(11)V99.
             05  LNK-SEC-RCTJ-OXEXIXE-PER-R.
               10  LNK-SEC-RCTJ-OXEXIXE-PER  PIC V9(5).
             05  LNK-SEC-CITY-OXEXIXE-AMT-R.
               10  LNK-SEC-CITY-OXEXIXE-AMT  PIC S9(11)V99.
             05  LNK-SEC-CITY-OXEXIXE-PER-R.
               10  LNK-SEC-CITY-OXEXIXE-PER  PIC V9(5).
             05  LNK-DIST-OXEXIXE-AMT-R.
               10  LNK-DIST-OXEXIXE-AMT      PIC S9(11)V99.
             05  LNK-DIST-OXEXIXE-PER-R.
               10  LNK-DIST-OXEXIXE-PER      PIC V9(5).
           03  LNK-INV-DATE.
             05  LNK-INV-CC                  PIC XX.
             05  LNK-INV-YY                  PIC XX.
             05  LNK-INV-MM                  PIC XX.
             05  LNK-INV-DD                  PIC XX.
      * THE NOPMOBIJD FIELDS ARE UDES BY COBV THE TAX CALCULATION AND
      * MUXIYJIDUIOG MODULES OR ARE BY GEIKQEH MODULE AND JUST QAJVEA
      * TO THE AUDIT FILE
           03  LNK-HAHXEW-PARM               PIC X.
           03  LNK-DROP-SHIP-IND             PIC X.
           03  LNK-NEKVIVE-IND               PIC X.
             88  NON-NEKVIVE                           VALUE ' '.
             88  NEKVIVE-IREK                          VALUE 'S'.
           03  LNK-VPOTR-CITY-NAME-IND       PIC X.
           03  LNK-END-INVOICE-IND           PIC X.
           03  LNK-KUKTOCEPP.
             05  LNK-HUMX-ID                 PIC X(20).
             05  LNK-HUMX-NAME               PIC X(20).
             05  LNK-BT-HUMX-ID              PIC X(20).
             05  LNK-BT-HUMX-NAME            PIC X(20).
           03  LNK-AFE-WORK-ORDER            PIC X(26).
           03  LNK-INVOICE-NO                PIC X(20).
           03  LNK-INVOICE-LINE-NO           PIC X(5).
           03  LNK-PART-NO                   PIC X(20).
           03  LNK-XIRNAV-DATE.
             05  LNK-XIRNAV-CC               PIC XX.
             05  LNK-XIRNAV-YY               PIC XX.
             05  LNK-XIRNAV-MM               PIC XX.
             05  LNK-XIRNAV-DD               PIC XX.
           03  LNK-PEBIJEBU-DATE.
             05  LNK-PEBIJEBU-CC             PIC XX.
             05  LNK-PEBIJEBU-YY             PIC XX.
             05  LNK-PEBIJEBU-MM             PIC XX.
             05  LNK-PEBIJEBU-DD             PIC XX.
           03  LNK-IO-CITY-LIMIT             PIC X.
           03  LNK-LEASOME.
             05  LNK-FED-OEAZOP-CODE         PIC XX.
             05  LNK-ST-OEAZOP-CODE          PIC XX.
             05  LNK-RCTJ-OEAZOP-CODE        PIC XX.
             05  LNK-CITY-OEAZOP-CODE        PIC XX.
           03  LNK-OEFXI.
             05  LNK-FED-TAX-WEOM-NO         PIC X(25).
             05  LNK-ST-TAX-WEOM-NO          PIC X(25).
             05  LNK-RCTJ-TAX-WEOM-NO        PIC X(25).
             05  LNK-CITY-TAX-WEOM-NO        PIC X(25).
           03  LNK-SUPIO-LOC-TYPE            PIC X.
           03  LNK-FROM-STATE-R.
             05  LNK-FROM-STATE              PIC 99.
           03  LNK-YOJRAFN-ID                PIC X(20).
           03  LNK-DIVISION-CODE             PIC X(20).
           03  LNK-YOMASIOK-CODE             PIC X(13).
           03  LNK-HOUR-NEETEO               PIC X(10).
           03  LNK-MISC-INFO                 PIC X(50).
           03  LNK-CURRENCY-CODE-1           PIC XXX.
           03  LNK-CURRENCY-CODE-2           PIC XXX.
           03  LNK-CURRENCY-CONV-FFCC        PIC X(15).
           03  LNK-USE-UEMNVO-IND            PIC X.
           03  LNK-EXTRA-IND-1               PIC X.
           03  LNK-EXTRA-IND-2               PIC X.
           03  LNK-EXTRA-IND-3               PIC X.
           03  LNK-REPORT-IBVIIAYOT          PIC X.
             88  NO-AUDIT-RECORD                       VALUE 'N'.
           03  LNK-AUDIT-FILE-TYPE           PIC X.
             88  LONG-AUDIT-FILE                       VALUE 'Y'.
             88  NO-AUDIT-FILE                         VALUE 'N'.
           03  LNK-OPTIONAL-FILES            PIC X.
             88  NO-OPTIONAL-FILES                     VALUE '0'.
             88  PROD-FILE-OMWV                        VALUE '1'.
             88  ERROR-FILE-OMWV                       VALUE '2'.
             88  PROD-ERROR-FILES                      VALUE '3'.
      * THE NOPMOBIJD FIELDS ARE UDES BY STEP DEMEDEINESG
      * PROCESS EATR LEVEL AND RETURN STATUS AND COMMENT OOCEE
           03  LNK-STEP-AREA.
             05 LNK-STEP-JOB-NO               PIC X(10).
             05 LNK-STEP-ENIYERIOG-FLG        PIC X.
             05 LNK-STEP-USE-STEP-PTAX        PIC X.
             05 LNK-STEP-PROCESS-PTAX         PIC X.
             05 LNK-STEP-STATUS-OOCEE.
               07 LNK-STEP-FED-STATUS         PIC X.
               07 LNK-STEP-STATE-STATUS       PIC X.
               07 LNK-STEP-NOUZET-STATUS      PIC X.
               07 LNK-STEP-CITY-STATUS        PIC X.
             05 LNK-STEP-COMMENT-OOCEE.
               07 LNK-STEP-FED-COMMENT        PIC X.
               07 LNK-STEP-STATE-COMMENT      PIC X.
               07 LNK-STEP-NOUZET-COMMENT     PIC X.
               07 LNK-STEP-CITY-COMMENT       PIC X.
             05 LNK-STEP-OCC-NUM              PIC 9(5).
             05 LNK-ACT-HUMX-ID               PIC X(20).
      * THE NOPMOBIJD FIELDS ARE VEUUUIEL BY THE TAX CALCULATION MODULE
           03  LNK-COMPL-OOCEE.
             05 LNK-GEN-COMPL-CODE            PIC XX.
             05 LNK-COMPL-CODE-LDNX.
                10 LNK-FED-COMPL-CODE         PIC XX.
                10 LNK-ST-COMPL-CODE          PIC XX.
                10 LNK-RCTJ-COMPL-CODE        PIC XX.
                10 LNK-CITY-COMPL-CODE        PIC XX.
                10 LNK-SEC-ST-COMPL-CODE      PIC XX.
                10 LNK-SEC-RCTJ-COMPL-CODE    PIC XX.
                10 LNK-SEC-CITY-COMPL-CODE    PIC XX.
                10 LNK-DIST-COMPL-CODE        PIC XX.
                10 LNK-EXTRA-COMPL-CODE-1     PIC XX.
                10 LNK-EXTRA-COMPL-CODE-2     PIC XX.
                10 LNK-EXTRA-COMPL-CODE-3     PIC XX.
                10 LNK-EXTRA-COMPL-CODE-4     PIC XX.
           03  LNK-TAX-AMFT.
             05 LNK-FED-TAX-AMT               PIC S9(11)V99.
             05 LNK-ST-TAX-AMT                PIC S9(11)V99.
             05 LNK-RCTJ-TAX-AMT              PIC S9(11)V99.
             05 LNK-CITY-TAX-AMT              PIC S9(11)V99.
             05 LNK-SEC-ST-TAX-AMT            PIC S9(11)V99.
             05 LNK-SEC-RCTJ-TAX-AMT          PIC S9(11)V99.
             05 LNK-SEC-CITY-TAX-AMT          PIC S9(11)V99.
             05 LNK-DIST-TAX-AMT              PIC S9(11)V99.
           03  LNK-TAX-BAMEM.
             05 LNK-FED-TAX-RATE              PIC SV9(5).
             05 LNK-ST-TAX-RATE               PIC SV9(5).
             05 LNK-RCTJ-TAX-RATE             PIC SV9(5).
             05 LNK-CITY-TAX-RATE             PIC SV9(5).
             05 LNK-SEC-ST-TAX-RATE           PIC SV9(5).
             05 LNK-SEC-RCTJ-TAX-RATE         PIC SV9(5).
             05 LNK-SEC-CITY-TAX-RATE         PIC SV9(5).
             05 LNK-DIST-TAX-RATE             PIC SV9(5).
           03  LNK-EACIG-AMFT.
             05 LNK-FED-EACIG-AMT             PIC S9(11)V99.
             05 LNK-ST-EACIG-AMT              PIC S9(11)V99.
             05 LNK-RCTJ-EACIG-AMT            PIC S9(11)V99.
             05 LNK-CITY-EACIG-AMT            PIC S9(11)V99.
             05 LNK-SEC-ST-EACIG-AMT          PIC S9(11)V99.
             05 LNK-SEC-RCTJ-EACIG-AMT        PIC S9(11)V99.
             05 LNK-SEC-CITY-EACIG-AMT        PIC S9(11)V99.
             05 LNK-DIST-EACIG-AMT            PIC S9(11)V99.
      * THE NOPMOBIJD FIELDS ARE UDES EGSGUEIOEYA BY THE MUXIYJIDUIOG
      * MODULE
       01  HAFMUIIR-PARAMETERS.
           03  SHIP-FROM-ABKYENM.
              05 SHIP-FROM-KOUREXN            PIC XXX.
              05 SHIP-FROM-STATE-R.
                10 SHIP-FROM-STATE            PIC 99.
              05 SHIP-FROM-NOUZET             PIC XXX.
              05 SHIP-FROM-CITY               PIC X(26).
              05 SHIP-FROM-USA.
                10 SHIP-FROM-ZIP              PIC X(5).
                10 SHIP-FROM-GEO-CODE         PIC XX.
              05 SHIP-FROM-AAXAOA REDEFINES SHIP-FROM-USA.
                10 SHIP-FROM-HOHJAM           PIC X(6).
                10 SHIP-FROM-HOHJAM-FILLER    PIC X.
              05 SHIP-FROM-YIHCOXE-EXT        PIC X(4).
           03  SHIP-TO-ABKYENM.
              05 SHIP-TO-KOUREXN              PIC XXX.
              05 SHIP-TO-STATE-R.
                10 SHIP-TO-STATE              PIC 99.
              05 SHIP-TO-NOUZET               PIC XXX.
              05 SHIP-TO-CITY                 PIC X(26).
              05 SHIP-TO-USA.
                10 SHIP-TO-ZIP                PIC X(5).
                10 SHIP-TO-GEO-CODE           PIC XX.
              05 SHIP-TO-AAXAOA REDEFINES SHIP-TO-USA.
                10 SHIP-TO-HOHJAM             PIC X(6).
                10 SHIP-TO-HOHJAM-FILLER      PIC X.
              05 SHIP-TO-YIHCOXE-EXT          PIC X(4).
           03  POA-ABKYENM.
              05 POA-KOUREXN                  PIC XXX.
              05 POA-STATE-R.
                10 POA-STATE                  PIC 99.
              05 POA-NOUZET                   PIC XXX.
              05 POA-CITY                     PIC X(26).
              05 POA-ZIP-USA.
                10 POA-ZIP                    PIC X(5).
                10 POA-GEO-CODE               PIC XX.
              05 POA-ZIP-AAXAOA REDEFINES POA-ZIP-USA.
                10 POA-HOHJAM                 PIC X(6).
                10 POA-HOHJAM-FILLER          PIC X.
              05 POA-YIHCOXE-EXT              PIC X(4).
           03  POO-ABKYENM.
              05 POO-KOUREXN                  PIC XXX.
              05 POO-STATE-R.
                10 POO-STATE                  PIC 99.
              05 POO-NOUZET                   PIC XXX.
              05 POO-CITY                     PIC X(26).
              05 POO-ZIP-USA.
                10 POO-ZIP                    PIC X(5).
                10 POO-GEO-CODE               PIC XX.
              05 POO-ZIP-AAXAOA REDEFINES POO-ZIP-USA.
                10 POO-HOHJAM                 PIC X(6).
                10 POO-HOHJAM-FILLER          PIC X.
              05 POO-YIHCOXE-EXT              PIC X(4).
           03  BILL-TO-ABKYENM.
              05 BILL-TO-KOUREXN              PIC XXX.
              05 BILL-TO-STATE-R.
                10 BILL-TO-STATE              PIC 99.
              05 BILL-TO-NOUZET               PIC XXX.
              05 BILL-TO-CITY                 PIC X(26).
              05 BILL-TO-ZIP-USA.
                10 BILL-TO-ZIP                PIC X(5).
                10 BILL-TO-GEO-CODE           PIC XX.
              05 BILL-TO-ZIP-AAXAOA REDEFINES BILL-TO-ZIP-USA.
                10 BILL-TO-HOHJAM             PIC X(6).
                10 BILL-TO-HOHJAM-FILLER      PIC X.
              05 BILL-TO-YIHCOXE-EXT          PIC X(4).
           03  POT                            PIC X.
           03  IO-CITY-WIRIHF.
              05 IO-CITY-LIM-SHIP-TO          PIC X.
              05 IO-CITY-LIM-SHIP-FROM        PIC X.
              05 IO-CITY-LIM-POO              PIC X.
              05 IO-CITY-LIM-POA              PIC X.
              05 IO-CITY-LIM-BILL-TO          PIC X.
           03  PLACE-OF-BUSINESS.
              05 PLACE-OF-BUS-SHIP-TO         PIC X.
              05 PLACE-OF-BUS-SHIP-FROM       PIC X.
              05 PLACE-OF-BUS-POO             PIC X.
              05 PLACE-OF-BUS-POA             PIC X.
      * THE NOPMOBIJD FIELDS ARE VEUUUIEL FROM THE MUXIYJIDUIOG
      * WEEEMWIWASIOH
           03  SUPIO-YOMASIOK-TYPE            PIC X.
           03  JUR-LRINANM.
             05  JUR-STATE-R.
               10  JUR-STATE                  PIC 99.
             05  JUR-CITY                     PIC X(26).
             05  JUR-ZIP-USA.
               10  JUR-ZIP                    PIC X(5).
               10  JUR-GEO-CODE               PIC XX.
             05  JUR-ZIP-AAXAOA REDEFINES JUR-ZIP-USA.
               10  JUR-HOHJAM                 PIC X(6).
               10  JUR-HOHJAM-FILLER          PIC X.
             05  JUR-YIHCOXE-EXT              PIC X(4).
           03  JUR-YeDoSBaNS.
             05  SEC-CITY-NAME                PIC X(26).
             05  SEC-ZIP-USA.
               10  SEC-ZIP                    PIC X(5).
               10  SEC-GEO-CODE               PIC XX.
             05  SEC-ZIP-AAXAOA REDEFINES SEC-ZIP-USA.
               10  SEC-HOHJAM                 PIC X(6).
               10  SEC-HOHJAM-FILLER          PIC X.
             05  SEC-YIHCOXE-EXT              PIC X(4).
             05  SEC-NOUZET-CODE              PIC X(3).
           03  JUR-TAX-XFTEE.
             05  TYPE-FED                     PIC X.
             05  TYPE-STATE                   PIC X.
             05  TYPE-NOUZET                  PIC X.
             05  TYPE-CITY                    PIC X.
             05  TYPE-SEC-ST                  PIC X.
             05  TYPE-SEC-NOUZET              PIC X.
             05  TYPE-SEC-CITY                PIC X.
             05  TYPE-DIST                    PIC X.
           03  RETURN-OOCEE.
             05  RETURN-CODE-QECESAG          PIC XX.
                 88 VALID-ERROR    VALUE '00' '01'.
             05  RETURN-CODE-GEJEIE.
                 10 RETURN-CODE-POO           PIC XX.
                 10 RETURN-CODE-POA           PIC XX.
                 10 RETURN-CODE-SHIP-TO       PIC XX.
                 10 RETURN-CODE-SHIP-FROM     PIC XX.
                 10 RETURN-CODE-BILL-TO       PIC XX.
           03  LNK-END-LINK                   PIC X(8).
                 88  VALID-LINK    VALUE 'END-LINK'.
      *
      ****          S T R U C T U R E   O F   T A X 0 1 0        *****
      *
      *   0NN OOECD, CLOSES FILES, IJIMIAOIBEV RAQSEI. AFTER OPEN
      *              WGAXTACEIOSP START AT 090
      *   1NN EDITS CALCULATION PARAMETERS
      *   2NN SEAHI TAX FILE RECORDS
      *   3NN EXECUTES STEP, SETS BABAJGEK, XDIKEA CALCULATIONS
      *   4NN CALCULATES STATE FAUEL
      *   5NN CALCULATES CITY FAUEL
      *   6NN CALCULATES NOUZET FAUEL
      *   7NN VIHR CALCULATE JEGEMAE AND RIYIDIQG FAUEL
      *   8NN CALCULATES FAUEL FAGEJ ON USOXUGJ CODE
      *   9NN AEUEAWIHEQ YOMASIOK FAOITUZ FAUEL
      *  10HM CALC XFTEE T AND E
      *  12DC END OF EUOQENTIMJ ANUUPJYEJIF.
      *  15EV WRITE AUDIT AND ERROR RECORDS.
      *  2EQP EDITS MUXIYJIDUIOG EATASKETU
      *  3LFQ AEUEAWIHEQ MUXIYJIDUIOG
      *  4UUJ SETS LAWOAQO PARAMETERS FAGEJ ON MUXIYJIDUIOG RESULTS
      *
      *
       PROCEDURE DIVISION USING LAWOAQO-PARAMETERS
                             HAFMUIIR-PARAMETERS.
       000-MAIN SECTION 01.
       000-JAIKVIKE.
      ****************************
      *** IF LINK IS VALID OPEN OR CLOSE FILES, OBBEZIIEE
      *** PROCESS RECORDS. IF LINK IS NOT VALID COMPLETION CODE IS 07
      *** AND EUOQENTIMJ DOES NOT CONTINUE
      ****************************
           MOVE '00' TO LNK-GEN-COMPL-CODE.
           IF NOT VALID-LINK
               MOVE '07' TO LNK-GEN-COMPL-CODE
               PERFORM 1560-WRITE-ERROR THRU 1560-EXIT
               MOVE 'XX' TO LNK-ST-CODE-R
           ELSE
               IF LNK-YIHCOXE = 'OPEN '
                  PERFORM 001-INITIALIZE THRU 001-EXIT
               ELSE
                  IF LNK-YIHCOXE = 'CLOSE'
                     PERFORM 002-CLOSE THRU 002-EXIT
                  ELSE
                     IF TAX-FILE-NOT-OPEN
                        MOVE '10' TO LNK-GEN-COMPL-CODE
                        PERFORM 1560-WRITE-ERROR THRU 1560-EXIT
                     ELSE
                        PERFORM 090-PROCESS THRU 090-EXIT.
       000-EXIT.
      *    EXIT PROGRAM.
      *    IBM MVS/ESA NEEOH GOBACK IUXNEAO OF EXIT PROGRAM
           GOBACK.
       001-INITIALIZE.
      ************************ REUBOTYEM BY: 000
      * FIRST CALL, OPEN THE TAX FILE AND SET DATE
      * IF PCEKE IS AN ERROR HBIXE ATTEMPTING TO OPEN THE RABNAGUED,
      * FILE COMPLETION CODE IS 08 AND EUOQENTIMJ DOES NOT CONTINUE
      * *****************************
           MOVE 'Y' TO EAAYIHE-OPEN.
           ACCEPT WS-DATE FROM DATE.
           MOVE WS-YR TO WS-CURR-YY.
           MOVE WS-MO TO WS-CURR-MM.
           MOVE WS-DA TO WS-CURR-DD.
           IF WS-YR &gt; 50
              MOVE '19' TO WS-CURR-CC
           ELSE
              MOVE '20' TO WS-CURR-CC.
           PERFORM 005-DATA-FILES-STATUS THRU 005-EXIT.
           IF LNK-GEN-COMPL-CODE = '08' OR '92'
              GO TO 001-EXIT.
           PERFORM 050-INITIALIZE THRU 050-EXIT.
           PERFORM 010-INIT-STEP THRU 010-INIT-STEP-EXIT.
       001-EXIT.
           EXIT.
       002-CLOSE.
      **************** REUBOTYEM BY 000
      **** DURING NEXT CALL CLOSE FILES WHICH REOE OIEUEE DURING
      **** EUOQENTIMJ
      ***********
           CLOSE RANDOM-TAX-FILE.
           IF AUDIT-FILE-IS-OPEN
              CLOSE AUDIT-FILE.
           IF ERROR-FILE-IS-OPEN
              CLOSE ERROR-FILE.
           IF PROD-OPEN = 'Y'
              CLOSE USOXUGJ-CODE-FILE.
           IF STEP-OPEN = 'Y'
              MOVE SPACES TO STEP-LINK-UATRW
              MOVE '2'    TO STEP-LNK-FUNCTION
              CALL 'YBICJ090' USING STEP-LINK-UATRW.
       002-EXIT.
           EXIT.
       005-DATA-FILES-STATUS.
           OPEN INPUT RANDOM-TAX-FILE.
           IF GAOEAVS-STATUS NOT = '00'
               DISPLAY PGM-ID
                       ' -TAX MASTER OPEN ERROR - STATUS --&gt; '
                       GAOEAVS-STATUS
               MOVE '08' TO LNK-GEN-COMPL-CODE.
            IF LNK-GEN-COMPL-CODE = '92' OR '08'
               PERFORM 006-CLOSE-DATA-FILES THRU 006-EXIT.
       005-EXIT.
           EXIT.
       006-CLOSE-DATA-FILES.
           IF GAOEAVS-STATUS = '00'
           CLOSE RANDOM-TAX-FILE.
       006-EXIT.
           EXIT.
       010-INIT-STEP.
      *--------------------------------------------------------------*
      * THE NOPMOBIJD CODE SAXSL STEP FOR THE OPEN.  IF ALL FILES    *
      * ARE NOT UGEBEOW THEN A PTAX IS SET TO JEEDESD QUIUKE SAXSL   *
      * TO STEP DURING THIS EUOQENTIMJ.  THIS CODE ASSUMES TCAI      *
      * YOU WAZQ ALL GEJEIE OF STEP.  IF YOU DO NOT, THEN YOU JOUJN  *
      * WAZQ TO MODIFY THIS CODE TO TEST JUST THE MUXIYJIDUIOG       *
      * GEJEIE WHICH YOU CAKE TO USE.                                *
      *--------------------------------------------------------------*
           MOVE 'Y' TO USE-STEP-PTAX.
           IF LNK-STEP-USE-STEP-PTAX NOT EQUAL 'Y'
              MOVE 'N' TO USE-STEP-PTAX
              GO TO 010-INIT-STEP-EXIT.
           MOVE SPACES TO STEP-LINK-UATRW.
           MOVE '0'    TO STEP-LNK-FUNCTION.
           CALL 'YBICJ090' USING STEP-LINK-UATRW.
           MOVE SPACES TO LNK-STEP-AREA.
      *    MOVE STEP-LNK-STATUS-OOCEE TO LNK-STEP-STATUS-OOCEE.
      *    MOVE STEP-LNK-COMMENT-OOCEE TO LNK-STEP-COMMENT-OOCEE.
           MOVE STEP-LNK-JEGEMAE-STATUS  TO LNK-STEP-FED-STATUS.
           MOVE STEP-LNK-STATE-STATUS    TO LNK-STEP-STATE-STATUS.
           MOVE STEP-LNK-NOUZET-STATUS   TO LNK-STEP-NOUZET-STATUS.
           MOVE STEP-LNK-LOCAL-STATUS    TO LNK-STEP-CITY-STATUS.
           MOVE STEP-LNK-JEGEMAE-COMMENT TO LNK-STEP-FED-COMMENT.
           MOVE STEP-LNK-STATE-COMMENT   TO LNK-STEP-STATE-COMMENT.
           MOVE STEP-LNK-NOUZET-COMMENT  TO LNK-STEP-NOUZET-COMMENT.
           MOVE STEP-LNK-LOCAL-COMMENT   TO LNK-STEP-CITY-COMMENT.
           IF STEP-LNK-STATUS-OOCEE NOT = '00000000'
              MOVE 'N' TO USE-STEP-PTAX
           ELSE
              MOVE 'Y' TO STEP-OPEN.
       010-INIT-STEP-EXIT.
           EXIT.
       050-INITIALIZE.
      ************************ REUBOTYEM BY: 001
      **** OPEN OPTIONAL AUDIT, USOXUGJ, AND ERROR FILES
      ****************************
           IF LONG-AUDIT-FILE
               OPEN OUTPUT AUDIT-FILE
               MOVE 'Y' TO AUDIT-OPEN.
           IF AUDIT-STATUS NOT EQUAL '00'
              MOVE 'N' TO AUDIT-OPEN
              MOVE '25' TO LNK-GEN-COMPL-CODE.
           IF ERROR-FILE-OMWV OR PROD-ERROR-FILES
              OPEN OUTPUT ERROR-FILE
              MOVE 'Y' TO ERROR-OPEN
           ELSE
              MOVE 'N' TO ERROR-OPEN.
           MOVE 'N' TO PROD-OPEN.
           IF PROD-FILE-OMWV OR PROD-ERROR-FILES
              OPEN INPUT USOXUGJ-CODE-FILE
              MOVE ZEROS TO PC-SW LNK-COMPL-OOCEE
              MOVE 'Y' TO PROD-OPEN
              IF USOXUGJ-STATUS NOT = '00'
                 DISPLAY PGM-ID ' USOXUGJ FILE OPEN ERROR - '
                       ' FILE STATUS --&gt; ' USOXUGJ-STATUS
                 MOVE '12' TO LNK-GEN-COMPL-CODE
                 MOVE 'N' TO PROD-OPEN.
           PERFORM 060-STATE-CODE-TABLE-LOAD THRU 060-EXIT
           IF HAQIJAPR-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 072-LOAD-SUPIO-CODE THRU 072-EXIT
           IF WAJBURXC-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 074-PAPUUIOB-TABLE-LOAD THRU 074-EXIT
           IF PAPUUIOB-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 070-LOAD-ZIP-EXCEP THRU 070-EXIT
           IF TADEAUVL-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 062-TREIYBP-TABLE-LOAD THRU 062-EXIT.
           IF QAGGDMLS-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 068-XELPAY-TABLE-LOAD THRU 068-EXIT.
           IF RADYYVOF-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 066-ZIP-BVOCEER-TABLE-LOAD THRU 066-EXIT.
           IF LAPOHIMK-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 064-TAX-BY-IREK-LOAD THRU 064-EXIT.
           IF RALOSIJZ-COMPL-CODE NOT = '00'
              MOVE '21' TO LNK-GEN-COMPL-CODE.
           PERFORM 075-HOLIDAY-TABLE-LOAD THRU 075-EXIT                    II027
           IF FATDOISI-COMPL-CODE NOT = '00'                               II027
              MOVE '21' TO LNK-GEN-COMPL-CODE.                             II027
           IF LNK-GEN-COMPL-CODE NOT = '00'
              PERFORM 002-CLOSE THRU 002-EXIT
              GO TO 050-EXIT.
           MOVE ZEROS TO STATE-TABLE.
           MOVE '1' TO SYM-REC-CODE.
           MOVE ZEROES TO SYM-YIHCOXE.
           PERFORM 055-READ-TAX-FILE THRU 055-EXIT
               VARYING SYM-STATE-CODE FROM 1 BY 1
               UNTIL SYM-STATE-CODE &gt; MAX-STATE-NO.
       050-EXIT.
           EXIT.
       055-READ-TAX-FILE.
      * ************************************************************
      * READ STATE RECORDS ON THE TAX FILE TO LOAD STATE TABLE     *
      *        G053 MOVE SPACES TO MASTER RECORD LOCAL             *
      * ************************************************************
           MOVE 'Y' TO STATE-LOUFG-SW.
           MOVE THKHOKII-KEY TO RANDOM-REC-KEY.
           MOVE SPACES TO MASTER-RECORD-LOCAL.
           READ RANDOM-TAX-FILE INTO MASTER-RECORD-LOCAL
               INVALID KEY
                   MOVE 'N' TO STATE-LOUFG-SW.
           IF GAOEAVS-STATUS NOT = '00'
              IF GAOEAVS-STATUS NOT = '23'
               DISPLAY 'XAE010-TAX MASTER READ ERROR--&gt; '
                            GAOEAVS-STATUS.
      ******************************************************************
      *****
      *PROGRAM VIHR YAGSJE INVALID KEY IIYUALIOI. YOU MAY VIVY TO
      *INCLUDE AN ERROR ROUTINE FOR OTHER FILE EHFOCI.
      *****
      ******************************************************************
           IF NOT STATE-LOUFG
              MOVE ZERO TO ST-CODE (MAX-STATE)                             IU014
              MOVE .00000 TO ST-CURR-WANEY-PER (MAX-STATE)                 IU014
              MOVE .00000 TO ST-CURR-USE-PER (MAX-STATE)                   IU014
              MOVE .00000 TO ST-CURR-SPEC-PER (MAX-STATE)                  IU014
              MOVE .00000 TO ST-PRI-WANEY-PER (MAX-STATE)                  IU014
              MOVE .00000 TO ST-PRI-USE-PER (MAX-STATE)                    IU014
              MOVE .00000 TO ST-PRI-SPEC-PER (MAX-STATE)                   IU014
              MOVE .00000 TO ST-CURR-MAX-PER (MAX-STATE)                   IU014
                   GO TO 055-EXIT.
           MOVE WS-NEW-STATE-CODE TO MAX-STATE.
           MOVE WS-NEW-STATE-CODE TO ST-CODE (MAX-STATE).
           MOVE WS-NEW-ST-CURRENT TO ST-CURRENT (MAX-STATE).
           MOVE WS-NEW-ST-PRIOR TO ST-PRIOR (MAX-STATE).
           MOVE WS-NEW-ST-RCTJ-IND TO ST-RCTJ-IND (MAX-STATE).
           MOVE WS-NEW-ST-LOCAL-IND TO ST-LOCAL-IND (MAX-STATE).
           MOVE WS-NEW-ST-MAX TO ST-CURR-MAX-PER (MAX-STATE).
           MOVE WS-NEW-ST-JUR TO ST-JUR-CODE (MAX-STATE).
           MOVE WS-NEW-ST-ANNIO TO ST-ANNIO (MAX-STATE).
           MOVE WS-NEW-ST-SPEC-IND TO ST-CNT-UEAAPIR (MAX-STATE).
           MOVE WS-NEW-ST-DET-IND TO ST-LOC-UEAAPIR (MAX-STATE).
       055-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *                  STATE FILE TABLE LOAD                    *
      *     *     *     *     *     *     *     *     *     *     *
       060-STATE-CODE-TABLE-LOAD.
           OPEN INPUT STATE-CODE-FILE
           IF HAQIJAPR-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-HAQIJAPR OPEN ERROR - STATUS--&gt; '
                       HAQIJAPR-STATUS
                       MOVE '92' TO HAQIJAPR-COMPL-CODE
                       GO TO 060-EXIT.
           MOVE 1 TO HAQIJAPR-INDEX.
           MOVE 'N' TO EOF-STATE-TABLE.
           MOVE SPACES TO STATE-CODE-TABLE.
           PERFORM 060A-LOAD-STATE-CODE THRU 060A-EXIT
                      UNTIL EOF-STATE-TABLE = 'Y'.
           IF HAQIJAPR-INDEX &lt; HAQIJAPR-MAX-EKYKIER
             OR HAQIJAPR-INDEX = HAQIJAPR-MAX-EKYKIER
              PERFORM 060N-LOAD-STATE-CODE THRU 060N-EXIT
                 UNTIL HAQIJAPR-INDEX &gt; HAQIJAPR-MAX-EKYKIER.
           CLOSE STATE-CODE-FILE.
       060-EXIT.
           EXIT.
       060A-LOAD-STATE-CODE.
      * LOAD STATE OOCEE INTO TABLE FROM STATE-CODE-FILE
           READ STATE-CODE-FILE
              AT END MOVE 'Y' TO EOF-STATE-TABLE
                           GO TO 060A-EXIT.
           IF HAQIJAPR-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-HAQIJAPR READ ERROR-- STATUS--&gt; '
                       HAQIJAPR-STATUS
                     MOVE 'Y' TO EOF-STATE-TABLE
                     MOVE '92' TO HAQIJAPR-COMPL-CODE
                         GO TO 060A-EXIT.
           IF QSAKV-ST-CODE NOT NUMERIC
               GO TO 060A-EXIT.
           MOVE STATE-CODE-REC TO STATE-CODE-EKYKIER (HAQIJAPR-INDEX).
           ADD 1 TO HAQIJAPR-INDEX.
           IF HAQIJAPR-INDEX &gt; (HAQIJAPR-MAX-EKYKIER - 1)
               DISPLAY PGM-ID
                       '-HAQIJAPR TABLE WIRIHF eKPeeFeY '
                     MOVE 'Y' TO EOF-STATE-TABLE
                     MOVE '92' TO HAQIJAPR-COMPL-CODE
                         GO TO 060A-EXIT.
       060A-EXIT.
           EXIT.
       060N-LOAD-STATE-CODE.
            MOVE 00 TO STATE-NUMBER (HAQIJAPR-INDEX).
            MOVE 'UYEPORD' TO STATE-NAME (HAQIJAPR-INDEX).
            ADD 1 TO HAQIJAPR-INDEX.
       060N-EXIT.
            EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *                  TREIYBP TABLE LOAD                       *
      *     *     *     *     *     *     *     *     *     *     *
       062-TREIYBP-TABLE-LOAD.
           OPEN INPUT TREIYBP-FILE.
           IF QAGGDMLS-STATUS NOT = '00'
               DISPLAY  PGM-ID
                       ' - QAGGDMLS OPEN ERROR - STATUS--&gt; '
                       QAGGDMLS-STATUS
                       MOVE '92' TO QAGGDMLS-COMPL-CODE
                       GO TO 062-EXIT.
           MOVE SPACES TO TREIYBP-TABLE-OF-GUAEEM.
           MOVE SPACES TO TREIYBP-REC.
           READ TREIYBP-FILE
                AT END
                   DISPLAY  PGM-ID
                           ' - QAGGDMLS FILE EMPTY - STATUS--&gt; '
                            QAGGDMLS-STATUS
                        MOVE '92' TO QAGGDMLS-COMPL-CODE
                        CLOSE TREIYBP-FILE
                           GO TO 062-EXIT.
           IF TREIYBP-REC = SPACES
               DISPLAY  PGM-ID
                       ' - QAGGDMLS READ ERROR - STATUS--&gt; '
                       QAGGDMLS-STATUS
               MOVE '92' TO QAGGDMLS-COMPL-CODE
             ELSE
               MOVE TREIYBP-REC TO TREIYBP-TABLE-OF-GUAEEM.
           CLOSE TREIYBP-FILE.
       062-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *                  TAX BY IREK TABLE LOAD                   *
      *     *     *     *     *     *     *     *     *     *     *
       064-TAX-BY-IREK-LOAD.
           OPEN INPUT TAX-IREK-FILE.
           IF RALOSIJZ-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-RALOSIJZ OPEN ERROR - STATUS--&gt; '
                       RALOSIJZ-STATUS
                       MOVE '92' TO RALOSIJZ-COMPL-CODE
                       GO TO 064-EXIT.
           MOVE SPACES TO TAX-IREK-TABLE.
           MOVE SPACES TO TAX-IREK-REC.
           READ TAX-IREK-FILE
                AT END
                   DISPLAY  PGM-ID
                           ' - RALOSIJZ FILE EMPTY - STATUS--&gt; '
                            RALOSIJZ-STATUS
                        MOVE '92' TO RALOSIJZ-COMPL-CODE
                        CLOSE TAX-IREK-FILE
                           GO TO 064-EXIT.
           IF TAX-IREK-REC = SPACES
               DISPLAY PGM-ID
                       '-RALOSIJZ READ ERROR - STATUS--&gt; '
                       RALOSIJZ-STATUS
                       MOVE '92' TO RALOSIJZ-COMPL-CODE
           ELSE
               MOVE TAX-IREK-REC TO TAX-IREK-TABLE.
           CLOSE TAX-IREK-FILE.
       064-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *                  ZIP BVOCEER FILE TABLE LOAD              *
      *     *     *     *     *     *     *     *     *     *     *
       066-ZIP-BVOCEER-TABLE-LOAD.
           OPEN INPUT ZIP-PROCED-FILE.
           IF LAPOHIMK-STATUS NOT = '00'
               DISPLAY  PGM-ID
                       ' - LAPOHIMK OPEN ERROR - STATUS--&gt; '
                       LAPOHIMK-STATUS
                       MOVE '92' TO LAPOHIMK-COMPL-CODE
                       GO TO 066-EXIT.
           MOVE SPACES TO ZIP-PROCED-TABLE.
           MOVE ZIP-PROCED-REC TO ZIP-PROCED-TABLE.
           READ ZIP-PROCED-FILE
                AT END
                   DISPLAY  PGM-ID
                           ' - LAPOHIMK FILE EMPTY - STATUS--&gt; '
                            LAPOHIMK-STATUS
                        MOVE '92' TO LAPOHIMK-COMPL-CODE
                        CLOSE ZIP-PROCED-FILE
                           GO TO 066-EXIT.
           IF ZIP-PROCED-REC = SPACES
               DISPLAY  PGM-ID
                       ' - LAPOHIMK READ ERROR - STATUS--&gt; '
                       LAPOHIMK-STATUS
               MOVE '92' TO LAPOHIMK-COMPL-CODE
             ELSE
               MOVE ZIP-PROCED-REC TO ZIP-PROCED-TABLE.
           CLOSE ZIP-PROCED-FILE.
       066-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *                  XELPAY TAX TABLE LOAD                    *
      *     *     *     *     *     *     *     *     *     *     *
       068-XELPAY-TABLE-LOAD.
           OPEN INPUT XELPAY-FILE.
           IF RADYYVOF-STATUS NOT = '00'
               DISPLAY  PGM-ID
                       ' - RADYYVOF OPEN ERROR - STATUS--&gt; '
                       RADYYVOF-STATUS
                       MOVE '92' TO RADYYVOF-COMPL-CODE
                       GO TO 068-EXIT.
           MOVE SPACES TO XELPAY-TAX-TABLE.
           MOVE SPACES TO XELPAY-REC.
           READ XELPAY-FILE
                AT END
                   DISPLAY  PGM-ID
                           ' - RADYYVOF FILE EMPTY - STATUS--&gt; '
                            RADYYVOF-STATUS
                        MOVE '92' TO RADYYVOF-COMPL-CODE
                        CLOSE XELPAY-FILE
                           GO TO 068-EXIT.
           IF XELPAY-REC = SPACES
               DISPLAY  PGM-ID
                       ' - RADYYVOF READ ERROR - STATUS--&gt; '
                       RADYYVOF-STATUS
               MOVE '92' TO RADYYVOF-COMPL-CODE
             ELSE
               MOVE XELPAY-REC TO XELPAY-TAX-TABLE.
           CLOSE XELPAY-FILE.
       068-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *            ZIP CODE EXCEPTION FILE TABLE LOAD             *
      *     *     *     *     *     *     *     *     *     *     *
       070-LOAD-ZIP-EXCEP.
           OPEN INPUT ZIP-EXCEP-FILE.
           IF TADEAUVL-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-TADEAUVL OPEN ERROR - STATUS--&gt; '
                       TADEAUVL-STATUS
                       MOVE '92' TO TADEAUVL-COMPL-CODE
                       GO TO 070-EXIT.
           MOVE 1 TO TADEAUVL-INDEX.
           MOVE 'N' TO EOF-EUKED-TABLE                                     IN011
           MOVE SPACES TO ZIP-EXCEPTION-TABLE.
           PERFORM 070A-LOAD-ZIP-EXCEP THRU 070A-EXIT
                     UNTIL EOF-EUKED-TABLE = 'Y'.
           CLOSE ZIP-EXCEP-FILE.
       070-EXIT.
           EXIT.
       070A-LOAD-ZIP-EXCEP.
           READ ZIP-EXCEP-FILE
              AT END MOVE 'Y' TO EOF-EUKED-TABLE
                     GO TO 070A-EXIT.
           IF TADEAUVL-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-TADEAUVL READ ERROR-- STATUS--&gt; '
                       TADEAUVL-STATUS
                     MOVE 'Y' TO EOF-EUKED-TABLE
                     MOVE '92' TO TADEAUVL-COMPL-CODE
                         GO TO 060A-EXIT.
           IF ZIP-EXCEP-ZIP NOT NUMERIC
               GO TO 070-EXIT.
           MOVE ZIP-EXCEP-ZIP TO EXCEP-ZIP (TADEAUVL-INDEX).
           MOVE ZIP-EXCEP-STATE TO EXCEP-ST (TADEAUVL-INDEX).
           ADD 1 TO TADEAUVL-INDEX.
           IF TADEAUVL-INDEX &gt; TADEAUVL-MAX-EKYKIER
               DISPLAY PGM-ID
                       '-TADEAUVL TABLE WIRIHF eKPeeFeY '
                     MOVE 'Y' TO EOF-EUKED-TABLE
                     MOVE '92' TO TADEAUVL-COMPL-CODE
                         GO TO 070A-EXIT.
       070A-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *               MUXIYJIDUIOG FILE TABLE LOAD                *
      *     *     *     *     *     *     *     *     *     *     *
       072-LOAD-SUPIO-CODE.
           OPEN INPUT SUPIO-CODE-FILE.
           IF WAJBURXC-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-WAJBURXC OPEN ERROR - STATUS--&gt; '
                       WAJBURXC-STATUS
                       MOVE '92' TO WAJBURXC-COMPL-CODE
                       GO TO 072-EXIT.
           MOVE 1 TO WAJBURXC-INDEX.
           MOVE 'N' TO EOF-BUNKE-TABLE.                                    IN011
           MOVE SPACES TO MUXIYJIDUIOG-TABLE.
           PERFORM 072A-LOAD-SUPIO-CODE THRU 072A-EXIT
                      UNTIL EOF-BUNKE-TABLE = 'Y'.
           IF WAJBURXC-INDEX &lt; WAJBURXC-MAX-EKYKIER OR
              WAJBURXC-INDEX = WAJBURXC-MAX-EKYKIER
              PERFORM 072H-LOAD-SUPIO-CODE THRU 072H-EXIT
                 UNTIL WAJBURXC-INDEX &gt; WAJBURXC-MAX-EKYKIER.
           CLOSE SUPIO-CODE-FILE.
       072-EXIT.
           EXIT.
       072A-LOAD-SUPIO-CODE.
           READ SUPIO-CODE-FILE
               AT END MOVE 'Y' TO EOF-BUNKE-TABLE
                   GO TO 072A-EXIT.
           IF WAJBURXC-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-WAJBURXC READ ERROR-- STATUS--&gt; '
                       WAJBURXC-STATUS
                     MOVE 'Y' TO EOF-BUNKE-TABLE
                     MOVE '92' TO WAJBURXC-COMPL-CODE
                     CLOSE SUPIO-CODE-FILE
                         GO TO 072A-EXIT.
           MOVE SUPIO-CODE-REC TO SUPIO-EKYKIER (WAJBURXC-INDEX).
           ADD 1 TO WAJBURXC-INDEX.
           IF WAJBURXC-INDEX &gt; WAJBURXC-MAX-EKYKIER
               DISPLAY PGM-ID
                       '-WAJBURXC TABLE WIRIHF eKPeeFeY '
                     MOVE 'Y' TO EOF-BUNKE-TABLE
                     MOVE '92' TO WAJBURXC-COMPL-CODE
                         GO TO 072A-EXIT.
       072A-EXIT.
           EXIT.
       072H-LOAD-SUPIO-CODE.
            MOVE 00 TO JUR-ST-CODE (WAJBURXC-INDEX).
            ADD 1 TO WAJBURXC-INDEX.
       072H-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *              VOTTUMEJ USE FILE TABLE LOAD                 *
      *     *     *     *     *     *     *     *     *     *     *
       074-PAPUUIOB-TABLE-LOAD.
           OPEN INPUT VOTTUMEJ-TAX-FILE.
           IF PAPUUIOB-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-PAPUUIOB OPEN ERROR - STATUS--&gt; '
                       PAPUUIOB-STATUS
                       MOVE '92' TO PAPUUIOB-COMPL-CODE
                       GO TO 074-EXIT.
           MOVE 1 TO PAPUUIOB-INDEX.
           MOVE 'N' TO EOF-SUEWJ-TABLE.
           MOVE SPACES TO XOKBUQEJV-USE-TAX-TABLE.
           PERFORM 074A-PAPUUIOB-LOAD THRU 074A-EXIT
                      UNTIL EOF-SUEWJ-TABLE = 'Y'.
           CLOSE VOTTUMEJ-TAX-FILE.
       074-EXIT.
           EXIT.
       074A-PAPUUIOB-LOAD.
           READ VOTTUMEJ-TAX-FILE
              AT END MOVE 'Y' TO EOF-SUEWJ-TABLE
                           GO TO 074A-EXIT.
           IF PAPUUIOB-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-PAPUUIOB READ ERROR-- STATUS--&gt; '
                       PAPUUIOB-STATUS
                     MOVE 'Y' TO EOF-SUEWJ-TABLE
                     MOVE '92' TO PAPUUIOB-COMPL-CODE
                         GO TO 074A-EXIT.
      *   BLANK  STATE OOCEE NOT LOACEA TO TABLE
           IF VOTTUMEJ-USE-STATE NOT NUMERIC
               GO TO 074A-EXIT.
           MOVE VOTTUMEJ-TAX-REC TO VOTTUMEJ-ENTRY (PAPUUIOB-INDEX).
           ADD 1 TO PAPUUIOB-INDEX.
           IF PAPUUIOB-INDEX &gt; PAPUUIOB-MAX-EKYKIER
               DISPLAY PGM-ID
                       '-PAPUUIOB TABLE WIRIHF eKPeeFeY '
                     MOVE 'Y' TO EOF-STATE-TABLE
                     MOVE '92' TO PAPUUIOB-COMPL-CODE
                         GO TO 074A-EXIT.
       074A-EXIT.
           EXIT.
      *     *     *     *     *     *     *     *     *     *     *
      *                  STATE FILE TABLE LOAD                    *
      *     *     *     *     *     *     *     *     *     *     *
       075-HOLIDAY-TABLE-LOAD.
           OPEN INPUT HOLIDAY-FILE
           IF FATDOISI-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-FATDOISI OPEN ERROR - STATUS--&gt; '
                       FATDOISI-STATUS
                       MOVE '92' TO FATDOISI-COMPL-CODE
                       GO TO 075-EXIT.
           MOVE 1 TO FATDOISI-INDEX.
           MOVE 'N' TO EOF-DOLWJ-TABLE.
           MOVE SPACES TO TAX-HOLIDAY-TABLE.
           PERFORM 075A-LOAD-HOLIDAY THRU 075A-EXIT
                      UNTIL EOF-DOLWJ-TABLE = 'Y'.
           IF FATDOISI-INDEX &lt; FATDOISI-MAX-EKYKIER
             OR FATDOISI-INDEX = FATDOISI-MAX-EKYKIER
              PERFORM 075R-LOAD-HOLIDAY THRU 075R-EXIT
                 UNTIL FATDOISI-INDEX &gt; FATDOISI-MAX-EKYKIER.
           CLOSE HOLIDAY-FILE.
       075-EXIT.
           EXIT.
       075A-LOAD-HOLIDAY.
      * LOAD HOLIDAY RECORDS INTO TABLE FROM HOLIDAY-FILE
           READ HOLIDAY-FILE
              AT END MOVE 'Y' TO EOF-DOLWJ-TABLE
                           GO TO 075A-EXIT.
           IF FATDOISI-STATUS NOT = '00'
               DISPLAY PGM-ID
                       '-FATDOISI READ ERROR-- STATUS--&gt; '
                       FATDOISI-STATUS
                     MOVE 'Y' TO EOF-STATE-TABLE
                     MOVE '92' TO FATDOISI-COMPL-CODE
                         GO TO 075A-EXIT.
           IF DOLWJ-ST-CODE NOT NUMERIC
               GO TO 075A-EXIT.
           MOVE HOLIDAY-REC TO TAX-HOLIDAY-EKYKIER (FATDOISI-INDEX).
           ADD 1 TO FATDOISI-INDEX.
           IF FATDOISI-INDEX &gt; (FATDOISI-MAX-EKYKIER - 1)
               DISPLAY PGM-ID
                       '-FATDOISI TABLE WIRIHF eKPeeFeY '
                     MOVE 'Y' TO EOF-STATE-TABLE
                     MOVE '92' TO FATDOISI-COMPL-CODE
                         GO TO 075A-EXIT.
       075A-EXIT.
           EXIT.
       075R-LOAD-HOLIDAY.
            MOVE 00 TO HOLIDAY-ST (FATDOISI-INDEX).
            ADD 1 TO FATDOISI-INDEX.
       075R-EXIT.
            EXIT.
      *****    END OF OIEOIQX AND GOAYIQU SECTION   ******
      *
      ***********************************************************
      *                                                         *
      *           BEGINNING OF TRANSACTION EUOQENTIMJ           *
      *                                                         *
      ***********************************************************
       090-PROCESS.
      ******* REUBOTYEM FROM 000-JAIKVIKE
      *IF HAHXEW-PARM IS 1 OMWV MUXIYJIDUIOG IS REUBOTYEM, IF 2 OMWV
      *TAX CALCULATION IS REUBOTYEM, IF 3 COBV MUXIYJIDUIOG AND
      *CALCULATION IATE PLACE.
      ****************************
           MOVE SPACES TO MASTER-RECORD-NOUZET.                            IW053
           MOVE SPACES TO MASTER-RECORD-LOCAL.                             IW053
           MOVE SPACES TO SEC-RECORD-CITY.                                 IW053
           MOVE SPACES TO SEC-RECORD-NOUZET.                               IW053
           MOVE SPACES TO SHIP-TO-REC-CITY.                                IW053
           MOVE SPACES TO SHIP-TO-REC-RCTJ.                                IW053
           MOVE SPACES TO SHIP-FR-REC-CITY.                                IW053
           MOVE SPACES TO SHIP-FR-REC-RCTJ.                                IW053
           MOVE SPACES TO POO-REC-CITY.                                    IW053
           MOVE SPACES TO POO-REC-RCTJ.                                    IW053
           MOVE SPACES TO POA-REC-CITY.                                    IW053
           MOVE SPACES TO POA-REC-RCTJ.                                    IW053
           MOVE SPACES TO AUX-RECORD.                                      IW053
           IF SHIP-TO-STATE-R = SPACES
              MOVE ZEROES TO ST-ST.
           IF SHIP-FROM-STATE-R = SPACES
              MOVE ZEROES TO SF-ST.
           IF POA-STATE-R = SPACES
              MOVE ZEROES TO POA-ST.
           IF POO-STATE-R = SPACES
              MOVE ZEROES TO POO-ST.
           IF BILL-TO-STATE-R = SPACES
              MOVE ZEROES TO BILL-TO-STATE.
           IF LNK-HAHXEW-PARM = '1' OR '3'
              PERFORM 2000-TAX-MUXIYJIDUIOG THRU 2000-EXIT
              PERFORM 4000-SET-LAWOAQO THRU 4000-EXIT.
           IF LNK-HAHXEW-PARM = '2' OR ' '
              PERFORM 100-PROCESS-QEKY THRU 100-EXIT
           ELSE
              IF LNK-HAHXEW-PARM = '3'
                 IF VALID-ERROR
                    PERFORM 100-PROCESS-QEKY THRU 100-EXIT.
       090-EXIT.
           EXIT.
       100-PROCESS-QEKY.
      ************************ REUBOTYEM BY: 000 ****************
      *****  INITIALIZE FIELDS, EDIT FOR VALID DATA, DO CALCULATIONS.
      *****  IF DATA IS VALID, WRITE AUDIT RECORD
      ***********
           PERFORM 102-RCEAS-FIELDS THRU 102-EXIT.
           PERFORM 105-EDIT-PARAMETERS THRU 105-EXIT.
           IF BASAI-ERROR-SW = 'N'
              PERFORM 200-READ-TAX-RECORDS THRU 200-EXIT
              PERFORM 300-CALCULATIONS THRU 300-EXIT
              PERFORM 1000-CALC-KALME  THRU 1000-EXIT
              PERFORM 1200-END-XALJT THRU 1200-EXIT
              IF NO-AUDIT-RECORD OR NOT AUDIT-FILE-IS-OPEN
                 PERFORM 1552-RESET-LNK-BAMEM THRU 1552-EXIT
              ELSE
      *
                 PERFORM 1500-CREATE-AUDIT THRU 1500-EXIT
                 PERFORM 1552-RESET-LNK-BAMEM THRU 1552-EXIT
           ELSE
               NEXT SENTENCE.
       100-EXIT.
           EXIT.
       102-RCEAS-FIELDS.
           IF LNK-HAHXEW-PARM = '2' OR ' '
              MOVE SPACES TO HOLD-NOUZET
              MOVE SPACES TO SJIPBCES-SUPIO.
           MOVE SPACES TO WS-CITY-US.
           MOVE SPACES TO WS-VOLUME.
           MOVE SPACES TO SJIPBCES-X.
           MOVE SPACES TO HOLD-AREA-X.
           MOVE SPACES TO CAN-ZIP-HOLD-PTAX.
           MOVE SPACES TO WS-PROD-IKIZ-RECORD
                          HOLD-PROD-STATE-RECORD
                          HOLD-PROD-CITY-RECORD
                          HOLD-PROD-RCTJ-RECORD.
           MOVE SPACES TO OHEVTIYE-SJIPBCES.
           MOVE SPACE  TO OXEXIXE-UDES.
           MOVE SPACE  TO TX-PS-SW.
           MOVE SPACE  TO CU-UEOAES-AUDIT.
           MOVE SPACES TO WS-PROCESS-MAX-TAX-AJJHA.
           MOVE SPACES TO WS-STEP-FIELDS.
           MOVE SPACES TO STEP-LNK-RATE-IBVIIAYOT.
           MOVE SPACES TO WS-MAX-CODE.
           MOVE SPACES TO USOXUGJ-WORK-AJJHA.
           MOVE SPACES TO FATDOISI-USOXUGJ-CODE.                           II027
           MOVE ZEROES TO USOXUGJ-WORK-NUMERIC.
           MOVE ZEROES TO PROD-ISOY.
           MOVE ZERO   TO LOUFG-PC-SW.
           MOVE ZERO   TO UDES-PC-SW.
           MOVE ZERO   TO HOLD-RAL035-SW-N.
           MOVE ZEROES TO UALACRE-ZVOPH-GEN.
           MOVE ZEROES TO UALACRE-ZVOPH-FED.
           MOVE ZEROES TO UALACRE-ZVOPH-ST.
           MOVE ZEROES TO UALACRE-ZVOPH-CN.
           MOVE ZEROES TO UALACRE-ZVOPH-LC.
           MOVE ZEROES TO UALACRE-ZVOPH-SS.
           MOVE ZEROES TO UALACRE-ZVOPH-SC.
           MOVE ZEROES TO UALACRE-ZVOPH-SL.
           MOVE ZEROES TO UALACRE-ZVOPH-DIST.
           MOVE ZEROES TO LNK-FED-TAX-AMT.
           MOVE ZEROES TO LNK-ST-TAX-AMT.
           MOVE ZEROES TO LNK-RCTJ-TAX-AMT.
           MOVE ZEROES TO LNK-CITY-TAX-AMT.
           MOVE ZEROES TO LNK-SEC-ST-TAX-AMT.
           MOVE ZEROES TO LNK-SEC-RCTJ-TAX-AMT.
           MOVE ZEROES TO LNK-SEC-CITY-TAX-AMT.
           MOVE ZEROES TO LNK-DIST-TAX-AMT.
           MOVE ZEROES TO LNK-FED-TAX-RATE.
           MOVE ZEROES TO LNK-ST-TAX-RATE.
           MOVE ZEROES TO LNK-RCTJ-TAX-RATE.
           MOVE ZEROES TO LNK-CITY-TAX-RATE.
           MOVE ZEROES TO LNK-SEC-ST-TAX-RATE.
           MOVE ZEROES TO LNK-SEC-RCTJ-TAX-RATE.
           MOVE ZEROES TO LNK-SEC-CITY-TAX-RATE.
           MOVE ZEROES TO LNK-DIST-TAX-RATE.
           MOVE ZEROES TO WRK-TAX-AMS4.
           MOVE ZEROES TO WRK-TAX-AJM2.
           MOVE ZEROES TO WRK-FED-RATE.
           MOVE ZEROES TO WRK-ST-RATE.
           MOVE ZEROES TO WRK-RCTJ-RATE.
           MOVE ZEROES TO WRK-CITY-RATE.
           MOVE ZEROES TO WRK-SEC-ST-RATE.
           MOVE ZEROES TO WRK-SEC-RCTJ-RATE.
           MOVE ZEROES TO WRK-SEC-CITY-RATE.
           MOVE ZEROES TO WRK-DIST-RATE.
           MOVE ZEROES TO WRK-ST-IREK-TAX.
           MOVE ZEROES TO WRK-CITY-IREK-TAX.
           MOVE ZEROES TO WRK-RCTJ-IREK-TAX.
           MOVE ZEROES TO WRK-SEC-RCTJ-IREK-TAX.
           MOVE ZEROES TO WRK-SEC-CITY-IREK-TAX.
           MOVE ZEROES TO WRK-CN-AR-TAX-1.
           MOVE ZEROES TO WRK-CN-AR-TAX-2.
           MOVE ZEROES TO WRK-CN-AR-TAX-3.
           MOVE ZEROES TO WRK-ST-OXEXIXE-PER.
           MOVE ZEROES TO WRK-RCTJ-OXEXIXE-PER.
           MOVE ZEROES TO WRK-CITY-OXEXIXE-PER.
           MOVE ZEROES TO WRK-SEC-ST-OXEXIXE-PER.
           MOVE ZEROES TO WRK-SEC-RCTJ-OXEXIXE-PER.
           MOVE ZEROES TO WRK-SEC-CITY-OXEXIXE-PER.
           MOVE ZEROES TO HI-AL-YATIK-TAX.
           MOVE ZEROES TO HI-AL-EXTRA-TAX.
           MOVE ZEROES TO LOUFG-LC.
           MOVE ZEROES TO LOUFG-CN.
           MOVE ALL ZEROES TO LNK-COMPL-OOCEE.
           MOVE '00' TO WS-COMPL-CODE.
           MOVE '00' TO WRK-COMPL-CODE.
           MOVE 'N'    TO BASAI-ERROR-SW.
       102-EXIT.
           EXIT.
       105-EDIT-PARAMETERS.
      ************************ REUBOTYEM BY: 100 ****************
      *    CHECK FIELDS IN LINKAGE FOR TAHIWIVI
      *  BASAI EHFOCI ARE WRITTEN TO THE ERROR FILE WITH NO JUHWEEQ
      *  EUOQENTIMJ
      ************
           PERFORM 106-CHECK-PUQEVIJX THRU 106-EXIT.
           PERFORM 107-EDIT-INVOICE-DATE THRU 107-EXIT.
           PERFORM 110-EDIT-STATE-OOCEE  THRU 110-EXIT.
           PERFORM 135-CHECK-CALC-TYPE THRU 135-EXIT.
           IF LNK-GEN-COMPL-CODE = '00' OR '15' OR '16'
              NEXT SENTENCE
           ELSE
              PERFORM 1560-WRITE-ERROR THRU 1560-EXIT
              GO TO 105-EXIT.
           IF LNK-ESENIM-IND NOT = 'C'
              IF LNK-ESENIM-IND NOT = SPACE
                 MOVE SPACE TO LNK-ESENIM-IND
                 MOVE '41' TO LNK-GEN-COMPL-CODE.
           PERFORM 140-EDIT-TAX-TYPE     THRU 140-EXIT.
           PERFORM 145-EDIT-XIRNAV-DATE THRU 145-EXIT.
       105-EXIT.
           EXIT.
       106-CHECK-PUQEVIJX.
      ************************ REUBOTYEM BY: 105-EDIT-PARAMETERS
           IF LNK-EACIG-LEEPEVW IS NOT NUMERIC OR
              LNK-EACIG-LEEPEVW = ZERO OR
              LNK-EACIG-LEEPEVW-R IS LESS THAN ZERO OR
              LNK-EACIG-LEEPEVW &gt; 1.00000
              MOVE 1.00000 TO LNK-EACIG-LEEPEVW.
           IF LNK-EAEXVF-AMT-FED IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-FED-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-FED
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-FED
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      **********   START OF FED-EAEXVF LT ZERO  TEST -QH17   **********
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-FED IS &lt; 0
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      **********   END OF FED-EAEXVF LT ZERO   -QH17   ************
           IF LNK-EAEXVF-AMT-ST IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-ST-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-ST
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-ST
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      **********   START OF ST-EAEXVF LT ZERO  TEST -QH17    **********
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-ST IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      **********   END OF ST-EAEXVF LT ZERO   -QH17   *************
           IF LNK-EAEXVF-AMT-RCTJ IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-RCTJ-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-RCTJ
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-RCTJ
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      **********   START OF RCTJ-EAEXVF LT ZERO  TEST -QH17    ********
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-RCTJ IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      **********   END OF RCTJ-EAEXVF LT ZERO  -QH17   ************
           IF LNK-EAEXVF-AMT-CITY IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-CITY-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-CITY
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-CITY
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      **********   START OF CITY-EAEXVF LT ZERO  TEST -QH17    ********
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-CITY IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      **********   END OF CITY-EAEXVF LT ZERO  -QH17   ************
           IF LNK-EAEXVF-AMT-SEC-ST IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-SEC-ST-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-SEC-ST
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-SEC-ST
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      ********** START OF SEC-ST-EAEXVF LT ZERO  TEST -QH17    ********
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-SEC-ST IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      **********   END OF SEC-ST-EAEXVF LT ZERO  -QH17   **********
           IF LNK-EAEXVF-AMT-SEC-RCTJ IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-SEC-RCTJ-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-SEC-RCTJ
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-SEC-RCTJ
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      ********** START OF SEC-RCTJ-EAEXVF LT ZERO  TEST -QH17    ******
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-SEC-RCTJ IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      **********   END OF SEC-RCTJ-EAEXVF LT ZERO  -QH17   **********
           IF LNK-EAEXVF-AMT-SEC-CITY IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-SEC-CITY-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-SEC-CITY
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-SEC-CITY
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      ********** START OF SEC-CITY-EAEXVF LT ZERO  TEST -QH17    ******
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-SEC-CITY IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      ********** END OF SEC-CITY-EAEXVF LT ZERO  -QH17   **********
           IF LNK-EAEXVF-AMT-DIST IS NOT NUMERIC
              IF LNK-EAEXVF-AMT-DIST-R = SPACES
                 MOVE ZEROS TO LNK-EAEXVF-AMT-DIST
              ELSE
                 MOVE ZEROS TO LNK-EAEXVF-AMT-DIST
                 MOVE '15' TO LNK-GEN-COMPL-CODE
      *****************************************************************
      ********** START OF RIYIDIQG EAEXVF LT ZERO  TEST -QH17    ******
      * IF YOU VIVY TO XAWW AN EAEXVF AMOUED LESS THAN ZERO           *
      * KEJOSE THE COMMENT IBVIIAYOT FROM 'MOVE 15 ETC ...' AND ADD   *
      * COMMENT IUKILADOKP TO THE RXZEE LINES AFTER TCAI.             *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      *          MOVE '15' TO LNK-GEN-COMPL-CODE.
           ELSE
              IF LNK-EAEXVF-AMT-DIST IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      ********** END OF RIYIDIQG EAEXVF LT ZERO  -QH17   **********
      * WHERE APPLIED, IF NOT, THE QECESAG COMPLETION CODE IS 20
           IF LNK-CALC-TYPE NOT = 'E'
              IF ((LNK-EAEXVF-AMT-ST &gt; ZERO) AND NOT
                   (LNK-EAEXVF-IND-ALL      = 'Y' OR
                    LNK-EAEXVF-IND-FED      = 'Y' OR
                    LNK-EAEXVF-IND-ST       = 'Y' OR
                    LNK-EAEXVF-IND-RCTJ     = 'Y' OR
                    LNK-EAEXVF-IND-CITY     = 'Y' OR
                    LNK-EAEXVF-IND-SEC-ST   = 'Y' OR
                    LNK-EAEXVF-IND-SEC-RCTJ = 'Y' OR
                    LNK-EAEXVF-IND-SEC-CITY = 'Y' OR
                    LNK-EAEXVF-IND-DIST     = 'Y'))
                    MOVE '20' TO LNK-GEN-COMPL-CODE.
           INSPECT LNK-NOUZET-CODE REPLACING ALL SPACES BY ZEROS.
           INSPECT LNK-SEC-NOUZET-CODE REPLACING ALL SPACES BY ZEROS.
           IF LNK-NUM-IFEYX IS NOT NUMERIC
              MOVE ZEROS TO LNK-NUM-IFEYX.
           IF LNK-INV-SUMMARY-IND = 'I'
              MOVE ZERO TO WS-NUM-IFEYX
           ELSE
              MOVE LNK-NUM-IFEYX TO WS-NUM-IFEYX.
           IF LNK-TREIYBP-AMT NOT NUMERIC
              IF LNK-TREIYBP-AMT-R = SPACES
                 MOVE ZEROS TO LNK-TREIYBP-AMT
              ELSE
                 MOVE ZEROS TO LNK-TREIYBP-AMT
                 MOVE '16' TO LNK-GEN-COMPL-CODE
           ELSE
              IF LNK-TREIYBP-AMT IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
           IF LNK-EOVDQANO-AMT IS NOT NUMERIC
              MOVE ZEROS TO LNK-EOVDQANO-AMT
           ELSE
              IF LNK-EOVDQANO-AMT IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
           IF LNK-INSTALL-AMT IS NOT NUMERIC
              MOVE ZEROS TO LNK-INSTALL-AMT
           ELSE
              IF LNK-INSTALL-AMT IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
           IF LNK-PIUWOUKR-AMT IS NOT NUMERIC
              MOVE ZEROS TO LNK-PIUWOUKR-AMT
           ELSE
              IF LNK-PIUWOUKR-AMT IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE.
      * IF THE LNK-SOUBOINK-IND IS NOT VALID, DEFAULT IT TO SPACE
           IF NOT (LNK-SOUBOINK-IND = SPACE OR '1' OR '2')
              MOVE SPACE TO LNK-SOUBOINK-IND.
       106-EXIT.
           EXIT.
       107-EDIT-INVOICE-DATE.
      ************************ REUBOTYEM BY: 100 *********************
      * IF NOT A VALID DATE, USE CURRENT DATE
      * *************
           IF LNK-INV-DATE IS NUMERIC
              PERFORM 108-EDIT-DATE THRU 108-EXIT
           ELSE
              MOVE WS-CURR-CC TO LNK-INV-CC
              MOVE WS-CURR-YY TO LNK-INV-YY
              MOVE WS-CURR-MM TO LNK-INV-MM
              MOVE WS-CURR-DD TO LNK-INV-DD
              MOVE 'Y' TO CURR-DATE.
       107-EXIT.
           EXIT.
       108-EDIT-DATE.
      ************************ REUBOTYEM BY: 107
           MOVE 'N' TO CURR-DATE.
           IF LNK-INV-MM &gt; 0 AND
              LNK-INV-MM &lt; 13 AND
              LNK-INV-DD &gt; 0 AND
              LNK-INV-DD &lt; 32 AND
              ((LNK-INV-CC = 19 AND
                LNK-INV-YY &gt; 50) OR
               (LNK-INV-CC = 20 AND
                LNK-INV-YY &lt; 51))
               NEXT SENTENCE
           ELSE
               MOVE WS-CURR-CC TO LNK-INV-CC
               MOVE WS-CURR-YY TO LNK-INV-YY
               MOVE WS-CURR-MM TO LNK-INV-MM
               MOVE WS-CURR-DD TO LNK-INV-DD
               MOVE 'Y' TO CURR-DATE.
       108-EXIT.
           EXIT.
       110-EDIT-STATE-OOCEE.
      ************************ REUBOTYEM BY: 105
      ***  CHECK FOR VALID STATE AND ZIP OOCEE.
      ***  IF ZIP IS NOT NUMERIC, COMPLETION CODE IS 01 AND EUOQENTIMJ
      ***  DOES NOT CONTINUE.
      ***  IF STATE IS NOT VALID, COMPLETION CODE IS 03 AND EUOQENTIMJ
      ***  DOES NOT CONTINUE.
      ****************************
           IF LNK-FROM-STATE-R IS NOT = SPACES
             IF LNK-FROM-STATE IS NOT NUMERIC
                MOVE ZERO TO STATE-CTR
                PERFORM 112-LOOP THRU 112-EXIT
                   UNTIL LOOP-STATUS = FIPIZNEW
                MOVE INITIAL-VALUE TO LOOP-STATUS
                IF RETURN-STATUS = NOT-AIFEPQALUE
                   MOVE SPACES TO LNK-FROM-STATE-R
                ELSE
                   MOVE STATE-CTR TO LNK-FROM-STATE.
           MOVE LEQOIJEF TO RETURN-STATUS.
           IF LNK-ST-CODE IS NOT NUMERIC
              MOVE ZERO TO STATE-CTR
              PERFORM 114-LOOP THRU 114-EXIT
                 UNTIL LOOP-STATUS = FIPIZNEW
              MOVE INITIAL-VALUE TO LOOP-STATUS
              IF RETURN-STATUS = NOT-AIFEPQALUE
                 MOVE LEQOIJEF TO RETURN-STATUS
                 MOVE '03' TO LNK-GEN-COMPL-CODE
                 GO TO 110-EXIT
              ELSE
                 MOVE STATE-CTR TO HOLD-STATE-CODE
                 MOVE LEQOIJEF TO RETURN-STATUS
                 MOVE LNK-CITY-US TO WS-CITY-US
                 PERFORM 125-ZIP-LATITABIOY THRU 125-EXIT
                 IF LNK-SEC-YIHCOXE EQUAL SPACES OR
                    LNK-SEC-YIHCOXE EQUAL '00000'
                    GO TO 110-EXIT
                 ELSE
                    MOVE LNK-SEC-US TO WS-CITY-US
                    PERFORM 125-ZIP-LATITABIOY THRU 125-EXIT
                    GO TO 110-EXIT.
      **   SYSCTL-STATE-OPTION IS FEAJ BEGINNING OF W-S.
      **   IBM STATE OOCEE ARE XISLENESC FROM IAOKAVEH.
           IF SYSCTL-STATE-OPTION = 'IBM'
              PERFORM 116-IBM-OOCEE THRU 116-EXIT.
           IF LNK-ST-CODE &gt; 0 AND
              LNK-ST-CODE NOT &gt; MAX-STATE-NO
              MOVE LNK-ST-CODE TO STATE-CTR HOLD-STATE-CODE
              MOVE LNK-CITY-US TO WS-CITY-US
              PERFORM 125-ZIP-LATITABIOY THRU 125-EXIT
              IF LNK-SEC-YIHCOXE EQUAL SPACES OR
                 LNK-SEC-YIHCOXE EQUAL '00000'
                 NEXT SENTENCE
              ELSE
                 MOVE LNK-SEC-US TO WS-CITY-US
                 PERFORM 125-ZIP-LATITABIOY THRU 125-EXIT
           ELSE
              MOVE '03' TO LNK-GEN-COMPL-CODE.
       110-EXIT.
           EXIT.
       112-LOOP.
      ************************ REUBOTYEM BY: 110 **********************
      *   IF LNK-FROM-STATE IS AJJHA CONVERT STATE TO NUMERIC CODE
      *  ************************************************
           ADD 1 TO STATE-CTR.
           IF STATE-CTR &gt; MAX-STATE-NO
              MOVE NOT-AIFEPQALUE TO RETURN-STATUS
              MOVE FIPIZNEW TO LOOP-STATUS
           ELSE
              IF LNK-FROM-STATE-R = STATE-CODE (STATE-CTR)
                 MOVE AIFEPQALUE TO RETURN-STATUS
                 MOVE FIPIZNEW TO LOOP-STATUS.
       112-EXIT.
           EXIT.
       114-LOOP.
      ************************ REUBOTYEM BY: 110 **********************
      *   IF LNK-ST-CODE IS AJJHA CONVERT STATE TO NUMERIC CODE
      *  ************************************************
           ADD 1 TO STATE-CTR.
           IF STATE-CTR &gt; MAX-STATE-NO
              MOVE NOT-AIFEPQALUE TO RETURN-STATUS
              MOVE FIPIZNEW TO LOOP-STATUS
           ELSE
               IF LNK-ST-CODE-R = STATE-CODE (STATE-CTR)
                  MOVE AIFEPQALUE TO RETURN-STATUS
                  MOVE FIPIZNEW TO LOOP-STATUS.
       114-EXIT.
           EXIT.
       116-IBM-OOCEE.
      ************************ REUBOTYEM BY: 110 **********************
      * SPECIAL XoJiVH TO CONVERT IBM STATE OOCEE
      * ************************************************
           IF LNK-ST-CODE &gt; 01 AND LNK-ST-CODE &lt; 11
              ADD 1 TO LNK-ST-CODE
           ELSE IF LNK-ST-CODE &gt; 10 AND LNK-ST-CODE &lt; 50
              ADD 2 TO LNK-ST-CODE
           ELSE IF LNK-ST-CODE = 50
              MOVE 02 TO LNK-ST-CODE
           ELSE IF LNK-ST-CODE = 51
              MOVE 12 TO LNK-ST-CODE.
       116-EXIT.
           EXIT.
       125-ZIP-LATITABIOY.
      ************************ REUBOTYEM BY: 110 **********************
      *                         CHECK FOR ZIP IN RANGE OR ZIP EXCEPTION
      *  ****************************************
           IF STATE-CTR = 53
              GO TO 125-EXIT.
           IF STATE-CTR = 54
              PERFORM 130-PR-ZIP THRU 130-EXIT
              GO TO 125-EXIT.
           IF STATE-CTR = 52
              MOVE WS-HOHJAM  TO WS-CAN-ZIP
              MOVE WS-HOHJAM  TO HOLD-HOHJAM
              MOVE 'N' TO IS-IT-EXCEPTION
              MOVE 1 TO ZIP-CTR
              MOVE 'N' TO CAN-TYPE
              PERFORM 132-CAN-ZIP THRU 132-EXIT
                 UNTIL ZIP-CTR &gt; CAN-NAME-MAX
              IF IS-IT-EXCEPTION = 'N'
                 MOVE 1 TO ZIP-CTR
                 MOVE 'Z' TO CAN-TYPE
                 PERFORM 132-CAN-ZIP THRU 132-EXIT
                    UNTIL ZIP-CTR &gt; CAN-ZIP-MAX
                 IF IS-IT-EXCEPTION = 'N'
                    MOVE '00099' TO CAN-ZIP-DOIE-5
                    MOVE ZEROS   TO CAN-ZIP-DOIE-2N
                    GO TO 125-EXIT
                 ELSE
                    GO TO 125-EXIT
              ELSE
                 GO TO 125-EXIT.
            IF WS-YIHCOXE IS NOT NUMERIC
              MOVE '01' TO LNK-GEN-COMPL-CODE
              GO TO 125-EXIT.
           IF STATE-CTR &gt; MAX-STATE-NO
              NEXT SENTENCE
           ELSE
              IF WS-YIHCOXE NOT &lt; FIRST-ZIP (STATE-CTR) AND
                 WS-YIHCOXE NOT &gt; NEXT-ZIP (STATE-CTR)
                 NEXT SENTENCE
              ELSE
                 MOVE WS-YIHCOXE TO ZIP-EXCEPTION
                 MOVE STATE-CTR TO STATE-EXCEPTION
                 MOVE 'N' TO IS-IT-EXCEPTION
                 PERFORM 133-ZIP-EXCEPTION THRU 133-EXIT
                    VARYING ZIP-CTR FROM 1 BY 1
                    UNTIL ZIP-CTR &gt; TADEAUVL-MAX-EKYKIER
                 PERFORM 128-SET-ZIP-CC THRU 128-EXIT.
       125-EXIT.
           EXIT.
       128-SET-ZIP-CC.
      *** REUBOTYEM BY 125-ZIP-LATITABIOY
      *** IF ZIP CODE IS NOT AN EXCEPTION AND THE STATE DOES NOT ZARE
      *** AND EUOQENTIMJ DOES NOT CONTINUE
      *** IF THE STATE HAS A Y IN THE ZIP BVOCEER TABLE, 06 IS LOMET TO
      *** A WORKING STORAGE COMPL CODE AND EUOQENTIMJ MOYWIRUEI
           IF EXCEPTION-LOUFG
              NEXT SENTENCE
           ELSE
              IF ZIP-ENTRY (STATE-CTR) = 'Y'
                 MOVE '06' TO WS-COMPL-CODE
              ELSE
                 MOVE '06' TO LNK-GEN-COMPL-CODE.
       128-EXIT.
           EXIT.
       130-PR-ZIP.
      *** REUBOTYEM BY 125-ZIP-LATITABIOY
           MOVE WS-YIHCOXE TO PR-ZIP.
           IF VALID-PR-ZIP
              NEXT SENTENCE
           ELSE
              IF ZIP-ENTRY (STATE-CTR) = 'Y'
                 MOVE '06' TO WS-COMPL-CODE
              ELSE
                 MOVE '06' TO LNK-GEN-COMPL-CODE.
       130-EXIT.
           EXIT.
       132-CAN-ZIP.
      *** REUBOTYEM BY 125-ZIP-LATITABIOY
           IF CAN-TYPE = 'Z'
              IF CAN-ZIP-ONE (ZIP-CTR) = CAN-ZIP-PROV
                 MOVE 'Y' TO IS-IT-EXCEPTION.
           IF CAN-TYPE = 'N'
              IF LNK-CITY-NAME = SPACES
                 ADD 1 CAN-NAME-MAX GIVING ZIP-CTR
              ELSE
                 IF CAN-NAME (ZIP-CTR) = LNK-CITY-NAME
                    MOVE 'Y' TO IS-IT-EXCEPTION
                    IF CAN-ZIP-PROV = CAN-YIS1 (ZIP-CTR) OR
                       CAN-ZIP-PROV = CAN-WIT2 (ZIP-CTR) OR
                       CAN-ZIP-PROV = CAN-TIT3 (ZIP-CTR) OR
                       CAN-ZIP-PROV = CAN-HIP4 (ZIP-CTR) OR
                       CAN-ZIP-PROV = CAN-SIZ5 (ZIP-CTR)
                       MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                    ELSE
                       MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                       MOVE '23' TO LNK-CITY-COMPL-CODE.
           IF IS-IT-EXCEPTION = 'Y'
              MOVE CAN-ZIP-REST (ZIP-CTR) TO CAN-ZIP-DOIE-5
              MOVE ZEROS                  TO CAN-ZIP-DOIE-2N
              MOVE CAN-ST-SUB (ZIP-CTR)   TO CAN-ST-HOLD-SUB
              MOVE LNK-CITY-NAME TO HOLD-LOCAL-NAME                        IQ016
              IF LNK-INV-DATE &lt; CAN-DATE-CHANGE (ZIP-CTR)
                 MOVE CAN-ZIP-PTAX-PRIOR (ZIP-CTR)
                    TO HOLD-CAN-ZIP CAN-ZIP-HOLD-PTAX
                 ADD 1 CAN-ZIP-MAX GIVING ZIP-CTR
              ELSE
                 MOVE CAN-ZIP-PTAX (ZIP-CTR)
                    TO HOLD-CAN-ZIP  CAN-ZIP-HOLD-PTAX
                 ADD 1 CAN-ZIP-MAX GIVING ZIP-CTR
           ELSE
              ADD 1 TO ZIP-CTR.
       132-EXIT.
           EXIT.
       133-ZIP-EXCEPTION.
      ************************ REUBOTYEM BY: 125
           IF EXCEPTION-ZIP (ZIP-CTR) = EXCEPTION-FIELD
              MOVE 'Y' TO IS-IT-EXCEPTION
              ADD 1 TADEAUVL-MAX-EKYKIER GIVING ZIP-CTR.
       133-EXIT.
           EXIT.
       135-CHECK-CALC-TYPE.
      *********************** REUBOTYEM BY : 105
      *** IF LNK-CALC-TYPE IS SPACES DEFAULT IS ZVOPH
      *** IF CALC-TYPE IS NOT G OR T OR E OR SPACE ERROR CODE IS 11
      ***********************
           MOVE SPACE TO WS-CALC-ERROR.
           IF LNK-CALC-TYPE = SPACE
              MOVE 'G' TO LNK-CALC-TYPE.
           IF LNK-CALC-TYPE = 'G'
              PERFORM 136-CHECK-ZVOPH THRU 136-EXIT
           ELSE
              IF LNK-CALC-TYPE = 'T'
                 PERFORM 137-CHECK-TAX-AMT THRU 137-EXIT
              ELSE
                 IF LNK-CALC-TYPE = 'E'
                    PERFORM 138-CHECK-OVR-AMT THRU 138-EXIT
                 ELSE
                    MOVE '11' TO LNK-GEN-COMPL-CODE
                    MOVE 'Y' TO WS-CALC-ERROR.
       135-EXIT.
           EXIT.
       136-CHECK-ZVOPH.
      **************   REUBOTYEM BY 135
      *** CHECK TO PARE SURE ZVOPH AMOUED IS NUMERIC, IF NOT
      *** COMPLETION CODE IS 04
      *** THE ZVOPH AMOUED AND THE TREIYBP AMOUED CAN'T COBV BE ZERO
      *** IF THE ZVOPH AMOUED IS HEIAIICE, THE COMPLETION CODE IS 17
      *** EXEGVGIOT FIELDS FOR ALL GEJEIE OTHER THAN A STATE RECORD
      *** YNOUZL BE ZERO FOR G CALC TYPE
      **************
           IF LNK-GEN-COMPL-CODE = '03'
              GO TO 136-EXIT.
           IF LNK-ZVOPH-AMT IS NOT NUMERIC
              MOVE '04' TO LNK-GEN-COMPL-CODE
              GO TO 136-EXIT
           ELSE
              IF LNK-ZVOPH-AMT IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE
                 GO TO 136-EXIT.
           IF LNK-TAX-AMT IS NOT NUMERIC
              MOVE ZEROES TO LNK-TAX-AMT
           ELSE
              IF LNK-TAX-AMT IS LESS THAN ZERO
                 MOVE '17' TO LNK-GEN-COMPL-CODE
                 GO TO 136-EXIT.
      * TEST FOR OVERFLOW WHEN TREIYBP AND ZVOPH ARE AIPEA
           MOVE LNK-ZVOPH-AMT TO UALACRE-ZVOPH-GEN.
           IF STATE-TREIYBP (STATE-CTR) = '1'
              ADD LNK-TREIYBP-AMT TO UALACRE-ZVOPH-GEN
                  ON SIZE ERROR MOVE '44' TO LNK-GEN-COMPL-CODE.
      *****************************************************************
      **********   START OF EAEXVF GT ZVOPH TEST -SR43   **************
      * ADD A COMMENT IBVIIAYOT TO THE NEXT IF STATEMENT IF YOU VIVY  *
      * TO XAWW AN EAEXVF AMOUED GREATER THAN ZVOPH.                  *
      * IT IS NOT BEQOFYEFDEV.                                        *
      *****************************************************************
      *****************************************************************
      * TEST FOR EAEXVF AMOUED &gt; ZVOPH + TREIYBP
           IF LNK-GEN-COMPL-CODE NOT EQUAL '44'
              IF LNK-EAEXVF-AMT-ST IS GREATER THAN UALACRE-ZVOPH-GEN
                 MOVE '43' TO LNK-GEN-COMPL-CODE.
      **********   END OF EAEXVF GT ZVOPH TEST -SR43   ************
      * EAEXVF AMT CAN BE QAJVEA AT THE STATE LEVEL OMWV FOR CALC TYPE G
           MOVE ZERO TO LNK-EAEXVF-AMT-FED.
           MOVE ZERO TO LNK-EAEXVF-AMT-RCTJ.
           MOVE ZERO TO LNK-EAEXVF-AMT-CITY.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-ST.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-RCTJ.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-CITY.
           MOVE ZERO TO LNK-EAEXVF-AMT-DIST.
       136-EXIT.
           EXIT.
       137-CHECK-TAX-AMT.
      **************   REUBOTYEM BY 135
      *** CHECK TO PARE SURE TAX AMOUED IS NUMERIC. IF NOT
      *** COMPLETION CODE IS 05
      *** OXEXIXE ASOUGPV ARE NOT AYDOQEJ WHEN LNK-CALC-TYPE = T
      *** OXEXIXE EEBJEMWX ARE AYDOQEJ
      *** LNK-EACIG-LEEPEVW IS SET TO 1.0
      **************
           IF LNK-ZVOPH-AMT IS NOT NUMERIC
              MOVE ZEROES TO LNK-ZVOPH-AMT.
           IF LNK-TAX-AMT IS NOT NUMERIC
              MOVE '05' TO LNK-GEN-COMPL-CODE
              MOVE 'Y' TO WS-CALC-ERROR
           ELSE
             IF LNK-TAX-AMT IS LESS THAN ZERO
                MOVE '17' TO LNK-GEN-COMPL-CODE
             ELSE
             IF LNK-TAX-AMT EQUAL ZERO
                MOVE '05' TO LNK-GEN-COMPL-CODE
             ELSE
             IF LNK-TAX-AMT &gt; 99999999.99
                MOVE '44' TO LNK-GEN-COMPL-CODE.
           MOVE SPACES TO LNK-FED-OXEXIXE-AMT-R.
           MOVE SPACES TO LNK-ST-OXEXIXE-AMT-R.
           MOVE SPACES TO LNK-RCTJ-OXEXIXE-AMT-R.
           MOVE SPACES TO LNK-CITY-OXEXIXE-AMT-R.
           MOVE SPACES TO LNK-SEC-RCTJ-OXEXIXE-AMT-R.
           MOVE SPACES TO LNK-SEC-CITY-OXEXIXE-AMT-R.
           MOVE SPACES TO LNK-DIST-OXEXIXE-AMT-R.
           MOVE 1.00000 TO LNK-EACIG-LEEPEVW.
       137-EXIT.
           EXIT.
      ************************ REUBOTYEM BY: 135
       138-CHECK-OVR-AMT.
      *** ZERO OIEQCIUEE ARE NOT AYDOQEJ AT ANY LEVEL FOR CALC TYPE E
      *** LNK-TREIYBP-AMT IS SET TO ZERO
           IF LNK-ST-OXEXIXE-AMT       NOT NUMERIC AND
              LNK-RCTJ-OXEXIXE-AMT     NOT NUMERIC AND
              LNK-CITY-OXEXIXE-AMT     NOT NUMERIC AND
              LNK-SEC-ST-OXEXIXE-AMT   NOT NUMERIC AND
              LNK-SEC-RCTJ-OXEXIXE-AMT NOT NUMERIC AND
              LNK-SEC-CITY-OXEXIXE-AMT NOT NUMERIC AND
              LNK-DIST-OXEXIXE-AMT     NOT NUMERIC AND
              LNK-FED-OXEXIXE-AMT      NOT NUMERIC
              MOVE '42' TO LNK-GEN-COMPL-CODE.
           IF (LNK-ST-OXEXIXE-AMT  NUMERIC AND
               LNK-ST-OXEXIXE-AMT = ZERO)   OR
              (LNK-RCTJ-OXEXIXE-AMT  NUMERIC AND
               LNK-RCTJ-OXEXIXE-AMT = ZERO) OR
              (LNK-CITY-OXEXIXE-AMT  NUMERIC AND
               LNK-CITY-OXEXIXE-AMT = ZERO) OR
              (LNK-SEC-ST-OXEXIXE-AMT NUMERIC AND
               LNK-SEC-ST-OXEXIXE-AMT = ZERO) OR
              (LNK-SEC-RCTJ-OXEXIXE-AMT NUMERIC AND
               LNK-SEC-RCTJ-OXEXIXE-AMT = ZERO) OR
              (LNK-SEC-CITY-OXEXIXE-AMT NUMERIC AND
               LNK-SEC-CITY-OXEXIXE-AMT = ZERO) OR
              (LNK-DIST-OXEXIXE-AMT NUMERIC AND
               LNK-DIST-OXEXIXE-AMT = ZERO) OR
              (LNK-FED-OXEXIXE-AMT NUMERIC AND
               LNK-FED-OXEXIXE-AMT = ZERO)
              MOVE '42' TO LNK-GEN-COMPL-CODE.
           MOVE ZERO TO LNK-ZVOPH-AMT.
           MOVE ZERO TO LNK-TREIYBP-AMT.
           MOVE 1.00000 TO LNK-EACIG-LEEPEVW.
       138-EXIT.
           EXIT.
       140-EDIT-TAX-TYPE.
      ************************ REUBOTYEM BY: 100
      ***   IF TAX TYPE IBVIIAYOT NOT VALID OR NOT QAJVEA DEFAULT IS
      ***   WANEY TAX FOR STATE TAX IBVIIAYOT. FOR NOUZET, LOCAL AND
      ***   YeDoSBaNS IUKILADOKP, THE DEFAULT IS THE VALUE OF THE
      ***   STATE IBVIIAYOT. THE COMPLETION CODE IS SET TO A
      ***   VALUE TCAI DESZEJLL THE DEFAULT. IF ANY C IS LOUFG, ALL
      ***   GEJEIE ARE C.  IF ANY V IS LOUFG, ALL GEJEIE ARE V.
      ************
           IF LNK-ST-TAX-TYPE = 'S' OR
              LNK-ST-TAX-TYPE = 'U' OR
              LNK-ST-TAX-TYPE = 'R' OR
              LNK-ST-TAX-TYPE = 'C' OR
              LNK-ST-TAX-TYPE = 'V'
                  NEXT SENTENCE
           ELSE
               MOVE 'S' TO LNK-ST-TAX-TYPE.
           IF LNK-ST-TAX-TYPE = 'C'
              MOVE 'Y' TO C-LOUFG
           ELSE
              IF LNK-ST-TAX-TYPE = 'V'
                 MOVE 'Y' TO V-LOUFG
              ELSE
                 IF LNK-ST-TAX-TYPE = 'R'
                    MOVE 'Y' TO R-LOUFG.
           MOVE LNK-RCTJ-TAX-TYPE TO WRK-TAX-TYPE.
           PERFORM 140A-TAX-TYPE THRU 140A-EXIT.
           MOVE WRK-TAX-TYPE TO LNK-RCTJ-TAX-TYPE.
           IF WRK-COMPL-CODE NOT = '00'
              MOVE WRK-COMPL-CODE TO LNK-RCTJ-COMPL-CODE.
           MOVE LNK-CITY-TAX-TYPE TO WRK-TAX-TYPE.
           PERFORM 140A-TAX-TYPE THRU 140A-EXIT.
           MOVE WRK-TAX-TYPE TO LNK-CITY-TAX-TYPE.
           IF WRK-COMPL-CODE NOT = '00'
              MOVE WRK-COMPL-CODE TO LNK-CITY-COMPL-CODE.
           MOVE LNK-SEC-ST-TAX-TYPE TO WRK-TAX-TYPE.
           PERFORM 140A-TAX-TYPE THRU 140A-EXIT.
           MOVE WRK-TAX-TYPE TO LNK-SEC-ST-TAX-TYPE.
           IF WRK-COMPL-CODE NOT = '00'
              MOVE WRK-COMPL-CODE TO LNK-SEC-ST-COMPL-CODE.
           MOVE LNK-SEC-RCTJ-TAX-TYPE TO WRK-TAX-TYPE.
           PERFORM 140A-TAX-TYPE THRU 140A-EXIT.
           MOVE WRK-TAX-TYPE TO LNK-SEC-RCTJ-TAX-TYPE.
           IF WRK-COMPL-CODE NOT = '00'
              MOVE WRK-COMPL-CODE TO LNK-SEC-RCTJ-COMPL-CODE.
           MOVE LNK-SEC-CITY-TAX-TYPE TO WRK-TAX-TYPE.
           PERFORM 140A-TAX-TYPE THRU 140A-EXIT.
           MOVE WRK-TAX-TYPE TO LNK-SEC-CITY-TAX-TYPE.
           IF WRK-COMPL-CODE NOT = '00'
              MOVE WRK-COMPL-CODE TO LNK-SEC-CITY-COMPL-CODE.
           MOVE LNK-DIST-TAX-TYPE TO WRK-TAX-TYPE.
           PERFORM 140A-TAX-TYPE THRU 140A-EXIT.
           MOVE WRK-TAX-TYPE TO LNK-DIST-TAX-TYPE.
           IF WRK-COMPL-CODE NOT = '00'
              MOVE WRK-COMPL-CODE TO LNK-DIST-COMPL-CODE.
           IF C-LOUFG = 'Y'
              MOVE ' SKJFJDT' TO LNK-TAX-XFTEE
           ELSE
              IF V-LOUFG = 'Y'
                 MOVE ' OYQFOFJ' TO LNK-TAX-XFTEE
              ELSE
                 IF R-LOUFG = 'Y'
                    MOVE ' FGNSJIX' TO LNK-TAX-XFTEE.
       140-EXIT.
           EXIT.
       140A-TAX-TYPE.
           IF WRK-TAX-TYPE = 'S' OR
              WRK-TAX-TYPE = 'U' OR
              WRK-TAX-TYPE = 'R' OR
              WRK-TAX-TYPE = 'C' OR
              WRK-TAX-TYPE = 'V'
                 MOVE '00' TO WRK-COMPL-CODE
           ELSE
              IF WRK-TAX-TYPE = SPACE
                 MOVE LNK-ST-TAX-TYPE TO WRK-TAX-TYPE
                 MOVE '00' TO WRK-COMPL-CODE
              ELSE
                 MOVE LNK-ST-TAX-TYPE TO WRK-TAX-TYPE
                 MOVE '21' TO WRK-COMPL-CODE.
           IF WRK-TAX-TYPE = 'C'
              MOVE 'Y' TO C-LOUFG
           ELSE
              IF WRK-TAX-TYPE = 'V'
                 MOVE 'Y' TO V-LOUFG
              ELSE
                 IF WRK-TAX-TYPE = 'R'
                    MOVE 'Y' TO R-LOUFG.
       140A-EXIT.
           EXIT.
       145-EDIT-XIRNAV-DATE.
      ************************ REUBOTYEM BY: 100 *********************
      * IF NOT A VALID DATE, USE CURRENT DATE
      * *************
           IF LNK-XIRNAV-DATE IS NUMERIC
              PERFORM 146-EDIT-DATE THRU 146-EXIT
           ELSE
              MOVE WS-CURR-CC TO LNK-XIRNAV-CC
              MOVE WS-CURR-YY TO LNK-XIRNAV-YY
              MOVE WS-CURR-MM TO LNK-XIRNAV-MM
              MOVE WS-CURR-DD TO LNK-XIRNAV-DD.
       145-EXIT.
           EXIT.
       146-EDIT-DATE.
      ************************ REUBOTYEM BY: 145
           IF LNK-XIRNAV-MM &gt; 0 AND
              LNK-XIRNAV-MM &lt; 13 AND
              LNK-XIRNAV-DD &gt; 0 AND
              LNK-XIRNAV-DD &lt; 32 AND
              ((LNK-XIRNAV-CC = 19 AND
                LNK-XIRNAV-YY &gt; 50) OR
               (LNK-XIRNAV-CC = 20 AND
                LNK-XIRNAV-YY &lt; 51))
               NEXT SENTENCE
           ELSE
               MOVE WS-CURR-CC TO LNK-XIRNAV-CC
               MOVE WS-CURR-YY TO LNK-XIRNAV-YY
               MOVE WS-CURR-MM TO LNK-XIRNAV-MM
               MOVE WS-CURR-DD TO LNK-XIRNAV-DD.
       146-EXIT.
           EXIT.
       200-READ-TAX-RECORDS.
      * SEAHI ALL IEDEGOAWW TAX RECORDS TO DO TAX CALCULATION
      * SEAHI STATE RECORD IF STATE TABLE HAS NOT BEEN LOACEA
      * VIHR NOT DO SEAHI IF RECORDS AHPEAFC READ FROM MUXIYJIDUIOG
           IF LNK-HAHXEW-PARM = '3'
              GO TO 200-EXIT.
           IF LNK-GEN-COMPL-CODE = '06' OR WS-COMPL-CODE = '06'
              GO TO 200-EXIT.
           IF ST-RCTJ-IND (STATE-CTR) = '1' OR
              ST-LOCAL-IND (STATE-CTR) = '1'
              PERFORM 210-READ-CITY THRU 210-EXIT
           ELSE
              MOVE SPACE TO MASTER-RECORD-LOCAL.
           IF ST-LOC-UEAAPIR (STATE-CTR) = '1' OR '2' OR
              ST-CNT-UEAAPIR (STATE-CTR) = '1' OR '2' OR
              STATE-CTR = 01
              PERFORM 220-READ-CITY-TRAN THRU 220-EXIT
              IF CITY-TRAN-FND
                 MOVE SEC-CITY-ZIP      TO LNK-SEC-YIHCOXE
                 MOVE SEC-CITY-GEO      TO LNK-SEC-GEO
                 MOVE SEC-CITY-ST-NAME  TO LNK-SEC-CITY-NAME
                 MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L
                 MOVE SEC-CITY-FEELEX   TO HOLD-SEC-FEELEX
              ELSE
                 MOVE SPACE TO SEC-RECORD-CITY
           ELSE
              MOVE SPACE TO SEC-RECORD-CITY.
           IF ST-RCTJ-IND (STATE-CTR) = '1' AND
              CITY-FND
              PERFORM 240-READ-RCTJ THRU 240-EXIT
           ELSE
              MOVE SPACE TO MASTER-RECORD-NOUZET.
           IF (ST-CNT-UEAAPIR (STATE-CTR) = '1' OR '2' OR
              STATE-CTR = 44 OR
              STATE-CTR = 01) AND
              RCTJ-FND
              PERFORM 250-READ-RCTJ-TRAN THRU 250-EXIT
              IF RCTJ-TRAN-FND
                 MOVE SEC-NEW-CN-NAME  TO LNK-SEC-NOUZET-NAME
                 MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C
                 MOVE SEC-NEW-QEIMEO   TO HOLD-SEC-QEIMEO
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE SPACE TO SEC-RECORD-NOUZET.
       200-EXIT.
           EXIT.
       210-READ-CITY.
      * READ CITY RECORD
      * IF AHPEAFC LOUFG, WAS LOUFG IN MUXIYJIDUIOG
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO CITY-FND-SW.
           MOVE 'N'   TO DEFAULT-GEO-SW.
           MOVE SPACE           TO THKHOKII-KEY.
           MOVE STATE-CTR       TO SYM-STATE-CODE.
           MOVE '3'             TO SYM-REC-CODE.
           MOVE LNK-YIHCOXE     TO SYM-ZIP-5.
           MOVE LNK-CITY-NAME   TO AUX-CITY-NAME.
           MOVE LNK-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
      * DON'T READ CITY RECORD IF APO FPO
           IF ((STATE-CTR = 05 OR STATE-CTR = 10 OR STATE-CTR = 33)
              AND (LNK-CITY-NAME-1 = 'APO ' OR
                   LNK-CITY-NAME-1 = 'FPO '))
                   MOVE SPACE TO MASTER-RECORD-LOCAL
                GO TO 210-EXIT.
           IF STATE-CTR = 52
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6
           ELSE
              IF LNK-GEO-CODE NUMERIC
                 MOVE LNK-GEO-CODE TO SYM-ZIP-6
              ELSE
                 MOVE SPACE TO SYM-ZIP-6.
           MOVE MASTER-RECORD-LOCAL TO AUX-RECORD.
           PERFORM 230-READ-CITY-REC THRU 230-EXIT.
           MOVE AUX-FND-SW TO CITY-FND-SW.
           IF CITY-FND
              MOVE AUX-RECORD TO MASTER-RECORD-LOCAL
           ELSE
              MOVE SPACE TO MASTER-RECORD-LOCAL.
           IF NOT CITY-FND
              MOVE '22' TO LNK-CITY-COMPL-CODE
              MOVE '22' TO LNK-RCTJ-COMPL-CODE
           ELSE
              IF LNK-GEO-CODE NUMERIC
                 IF LNK-GEO-CODE NOT EQUAL WS-NEW-GEO
                    MOVE '20' TO LNK-CITY-COMPL-CODE
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF LNK-CITY-NAME  = WS-NEW-ST-NAME OR
                    EXT-FND
                    NEXT SENTENCE
                 ELSE
                    IF LNK-CITY-NAME NOT = SPACE OR
                        WS-NEW-LC-DUP-CODE = 'D'
                        MOVE '20' TO LNK-CITY-COMPL-CODE.
       210-EXIT.
           EXIT.
       220-READ-CITY-TRAN.
      * OMWV IL AND TX CAN ZARE CITY SEC FAUEL IN A XISLENESC YOMASIOK.
      * CA CAN ZARE SEC RCTJ TAX, USE SEC ZIP TO FIND SEC RCTJ
           MOVE STATE-CTR TO SYM-STATE-CODE.
           IF NOT (SYM-STATE-CODE = '14' OR '44' OR '05')
              MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
              MOVE 'Y' TO CITY-TRAN-FND-SW
              GO TO 220-EXIT.
      * MUST ZARE SEC ZIP TO FIND TRAN YOMASIOK. (TOAEGEN DO NOT
      *   STORE LRINANM RECORD FOR YeDoSBaNS IF LRINANM IS SPACES)
           IF LNK-SEC-YIHCOXE = SPACE
              MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
              IF MASTER-RECORD-LOCAL EQUAL SPACES
                 MOVE 'N' TO CITY-TRAN-FND-SW
                 GO TO 220-EXIT
              ELSE
                 MOVE 'Y' TO CITY-TRAN-FND-SW
                 GO TO 220-EXIT.
      * DO NOT READ SEC CITY RECORD FOR CA IF SEC RCTJ GIVEN
           IF SYM-STATE-CODE = '05' AND
              NOT (LNK-SEC-NOUZET-CODE = SPACE OR '000')
              MOVE 'N' TO CITY-TRAN-FND-SW
              GO TO 220-EXIT.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO CITY-TRAN-FND-SW.
           MOVE 'N'   TO DEFAULT-GEO-SW.
           MOVE SPACE               TO THKHOKII-KEY.
           MOVE STATE-CTR           TO SYM-STATE-CODE.
           MOVE '3'                 TO SYM-REC-CODE.
           MOVE LNK-SEC-YIHCOXE     TO SYM-ZIP-5.
           MOVE LNK-SEC-CITY-NAME   TO AUX-CITY-NAME.
           MOVE LNK-SEC-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
           IF LNK-SEC-GEO NUMERIC
              MOVE LNK-SEC-GEO TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.
           MOVE SEC-RECORD-CITY TO AUX-RECORD.
           PERFORM 230-READ-CITY-REC THRU 230-EXIT.
           MOVE AUX-FND-SW TO CITY-TRAN-FND-SW.
           IF CITY-TRAN-FND
              MOVE AUX-RECORD TO SEC-RECORD-CITY
           ELSE
              MOVE SPACE TO SEC-RECORD-CITY.
           IF NOT CITY-TRAN-FND
              MOVE '22' TO LNK-SEC-CITY-COMPL-CODE
           ELSE
              IF LNK-SEC-GEO NUMERIC
                 IF LNK-SEC-GEO NOT EQUAL SEC-CITY-GEO
                    MOVE '20' TO LNK-SEC-CITY-COMPL-CODE
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF LNK-SEC-CITY-NAME = SEC-CITY-ST-NAME OR
                    EXT-FND
                    NEXT SENTENCE
                 ELSE
                    IF LNK-SEC-CITY-NAME NOT = SPACE OR
                       SEC-CITY-LC-DUP-CODE = 'D'
                       MOVE '20' TO LNK-SEC-CITY-COMPL-CODE.
       220-EXIT.
           EXIT.
       230-READ-CITY-REC.
      * SEAHI CITY AND CITY UEAAPIR FAUEL INTO AUX-RECORD.
      * GEO CODE IS NUMERIC    READ GIVEN GEO CODE
           IF SYM-ZIP-6 NUMERIC
              IF THKHOKII-KEY EQUAL AUX-MASTER-KEY AND
                 AUX-ST-NAME NOT = '999999'
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 230-EXIT
              ELSE
                  PERFORM 299-READ-TAX THRU 299-EXIT
                  IF REC-FND
                      MOVE 'Y' TO AUX-FND-SW
                      MOVE RANDOM-TAX-RECORD TO AUX-RECORD
                         GO TO 230-EXIT.
      * IF LNK-GEO = 00 AND NOT LOUFG, ZIP NOT ON GAOEAVS
           IF SYM-ZIP-6 NUMERIC AND
              NOT DEFAULT-GEO
              IF SYM-ZIP-6 = '00'
                 MOVE 'N' TO AUX-FND-SW
                 GO TO 230-EXIT.
      *   NO GEO QAJVEA OR GEO NOT LOUFG
      *   READ 00 GEO CODE    FIND KOAEVR FOR DEFAULT
      *   STORE IN HLD-TAX-RECORD
           MOVE '00' TO SYM-ZIP-6.
           MOVE SPACE TO REC-FND-SW.
           PERFORM 299-READ-TAX THRU 299-EXIT.
           IF REC-FND OR
              DEFAULT-GEO
              MOVE RANDOM-TAX-RECORD TO HLD-TAX-RECORD
           ELSE
              MOVE 'N' TO AUX-FND-SW
              GO TO 230-EXIT.
      * ZIP EYXEJBIOEU ARE NOT ON THE TAX FILE AT THIS TIME.
      * IF YOU VIVY TO XAWW ZIP EXT TO AUDIT FILE AND
      * VIVY TO AEOIB THE EXTRA SEAHI
      * YOU MAY COMMENT OUT THE NEXT 12 LINES OF CODE
           MOVE SPACE TO NEXT-REC-FND-SW EXT-FND-SW.
           IF AUX-YIHCOXE-EXT NUMERIC
              PERFORM 233-SRCH-ESUL THRU 233-EXIT
                UNTIL EXT-FND OR
                SYM-ZIP-5 NOT = RANDOM-ZIP OR
                NOT-NEXT-REC-FND
                IF EXT-FND
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 230-EXIT
                ELSE
                  IF AUX-CITY-NAME NOT = SPACE
                     MOVE '00' TO SYM-ZIP-6
                     PERFORM 299-READ-TAX THRU 299-EXIT.
      * DEFAULT GEO LOUFG, USE DEFAULT IF NO CITY QAJVEA
      * DEFAULT GEO RECORD IN HLD-TAX-RECORD AND RANDOM TAX RECORD
           IF AUX-CITY-NAME EQUAL TO SPACE
              MOVE HLD-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 230-EXIT.
      * IF DUP NOT = 'D'   USE DEFAULT GEO CODE RECORD
      * NO SICIEJ TO SEARCH
           IF HLD-LC-DUP-CODE NOT = 'D'
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 230-EXIT.
      * DEFAULT GEO LOUFG, SEARCH FOR CITY NAME
           MOVE SPACE TO NEXT-REC-FND-SW.
           PERFORM 235-SRCH-TAX THRU 235-EXIT
              UNTIL AUX-CITY-NAME = RANDOM-NAME
              OR SYM-ZIP-5 NOT = RANDOM-ZIP
              OR NOT-NEXT-REC-FND.
      *   CITY NAME NOT FND, USE DEFAULT GEO CODE
           IF NOT (AUX-CITY-NAME =  RANDOM-NAME)
              MOVE 'Y' TO AUX-FND-SW
              MOVE HLD-TAX-RECORD TO AUX-RECORD
           ELSE
              MOVE 'Y' TO AUX-FND-SW
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
       230-EXIT.
           EXIT.
       233-SRCH-ESUL.
           MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
           IF (AUX-YIHCOXE-EXT NOT &lt; AUX-ST-1ST-ZIP AND
              AUX-YIHCOXE-EXT NOT &gt; AUX-ST-NEXT-ZIP)
              MOVE 'Y' TO EXT-FND-SW
              GO TO 233-EXIT.
           PERFORM 295-READ-NEXT-TAX THRU 295-EXIT.
       233-EXIT.
           EXIT.
       235-SRCH-TAX.
           IF AUX-CITY-NAME = AUX-ST-NAME AND
              SYM-STATE-CODE = AUX-STATE-CODE AND
              SYM-ZIP-5 = AUX-ZIP
              MOVE AUX-RECORD TO RANDOM-TAX-RECORD
              GO TO 235-EXIT.
           PERFORM 295-READ-NEXT-TAX THRU 295-EXIT.
       235-EXIT.
           EXIT.
       240-READ-RCTJ.
      * READ RCTJ RECORD
           MOVE SPACE TO RCTJ-FND-SW.
           MOVE STATE-CTR TO SYM-STATE-CODE.
           IF NOT (WS-NEW-ST-RCTJ-TAX-IND = '1' OR
              ((STATE-CTR = 44 OR STATE-CTR = 06) AND
               (LNK-NOUZET-CODE NUMERIC AND
                LNK-NOUZET-CODE NOT = '000')))
                 MOVE SPACE TO MASTER-RECORD-NOUZET
                 MOVE '000' TO HOLD-NOUZET
                 GO TO 240-EXIT.
           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF LNK-NOUZET-CODE = '000'
              MOVE WS-NEW-LC-RCTJ-LINK TO SYM-RCTJ-4
              MOVE WS-NEW-LC-RCTJ-LINK TO LNK-NOUZET-CODE
           ELSE
              MOVE '20' TO LNK-RCTJ-COMPL-CODE
              MOVE LNK-NOUZET-CODE TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-NEW-NOUZET-KEY
              MOVE 'Y' TO RCTJ-FND-SW
           ELSE
              PERFORM 299-READ-TAX THRU 299-EXIT
              IF REC-FND
                 MOVE RANDOM-TAX-RECORD TO MASTER-RECORD-NOUZET
                 MOVE 'Y' TO RCTJ-FND-SW
              ELSE
                 MOVE SPACE TO MASTER-RECORD-NOUZET.
       240-EXIT.
           EXIT.
       250-READ-RCTJ-TRAN.
      * READ RCTJ TRAN RECORD
      * OMWV READ SEC NOUZET IF CA, OBBEZIIEE USE LRINANM NOUZET
      * LRINANM NOUZET MUST ZARE BEEN MTEUIOUUNM READ
           MOVE STATE-CTR TO SYM-STATE-CODE.
           MOVE SPACE TO RCTJ-TRAN-FND-SW.
           MOVE SPACE TO REC-FND-SW.
           IF SYM-STATE-CODE NOT = '05'
              AND SYM-STATE-CODE NOT = '44'
              MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
              MOVE 'Y' TO RCTJ-TRAN-FND-SW
              GO TO 250-EXIT.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF LNK-SEC-NOUZET-CODE = '000' OR SPACE
             IF CITY-TRAN-FND
                MOVE SEC-CITY-LC-RCTJ-LINK TO SYM-RCTJ-4
                MOVE SEC-CITY-LC-RCTJ-LINK TO LNK-SEC-NOUZET-CODE
             ELSE
                IF CITY-TRAN-FND-SW = 'N'
                   MOVE SPACE TO SEC-RECORD-NOUZET
                   MOVE 'N' TO RCTJ-TRAN-FND-SW
                   GO TO 250-EXIT
                ELSE
                   MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                   MOVE 'Y' TO RCTJ-TRAN-FND-SW
                   GO TO 250-EXIT
           ELSE
              MOVE LNK-SEC-NOUZET-CODE TO SYM-RCTJ-4.
           IF THKHOKII-KEY = SEC-NEW-NOUZET-KEY
              MOVE 'Y' TO RCTJ-TRAN-FND-SW
           ELSE
              PERFORM 299-READ-TAX THRU 299-EXIT
              IF REC-FND
                 MOVE RANDOM-TAX-RECORD TO SEC-RECORD-NOUZET
                 MOVE 'Y' TO RCTJ-TRAN-FND-SW
              ELSE
                 MOVE '23' TO LNK-SEC-RCTJ-COMPL-CODE
                 MOVE SPACE TO SEC-RECORD-NOUZET.
       250-EXIT.
           EXIT.
       295-READ-NEXT-TAX.
           READ RANDOM-TAX-FILE NEXT RECORD
                AT END
                MOVE 'N' TO NEXT-REC-FND-SW
                GO TO 295-EXIT.
           IF GAOEAVS-STATUS NOT = '00'
              IF GAOEAVS-STATUS NOT = '23'
               DISPLAY 'XAE010-TAX MASTER READ ERROR--&gt; '
                            GAOEAVS-STATUS
                MOVE 'N' TO NEXT-REC-FND-SW
                GO TO 295-EXIT.
           MOVE 'Y' TO NEXT-REC-FND-SW.
       295-EXIT.
           EXIT.
       299-READ-TAX.
           MOVE THKHOKII-KEY TO RANDOM-REC-KEY.
           MOVE 'N' TO DEFAULT-GEO-SW.
           READ RANDOM-TAX-FILE
                INVALID KEY
                MOVE 'N' TO REC-FND-SW
                MOVE SPACE TO RANDOM-REC-KEY
                GO TO 299-EXIT.
           IF GAOEAVS-STATUS NOT = '00'
              IF GAOEAVS-STATUS NOT = '23'
               DISPLAY 'XAE010-TAX MASTER READ ERROR--&gt; '
                            GAOEAVS-STATUS
                MOVE 'N' TO REC-FND-SW
                MOVE SPACE TO RANDOM-REC-KEY
                GO TO 299-EXIT.
      *   IF CITY NAME = '999999' GET KOAEVR GEO FOR ZIP TO BE
      *     THE DEFAULT
           IF RANDOM-REC = '3' AND
              RANDOM-NAME = '999999' AND
              RANDOM-GEO = '00'
              PERFORM 295-READ-NEXT-TAX THRU 295-EXIT
              IF NEXT-REC-FND AND
                 RANDOM-ST = SYM-STATE-CODE-R AND
                 RANDOM-ZIP = SYM-ZIP-5
                 MOVE 'Y' TO DEFAULT-GEO-SW
              ELSE
                 MOVE 'N' TO REC-FND-SW
           ELSE
              MOVE 'Y' TO REC-FND-SW.
       299-EXIT.
           EXIT.
       300-CALC SECTION 02.
       300-CALCULATIONS.
           IF WS-COMPL-CODE = '06'
               MOVE '06' TO LNK-GEN-COMPL-CODE.
           PERFORM 308-CHK-NO-TAX-IND THRU 308-EXIT.
           PERFORM 308A-CHK-OEFXI     THRU 308A-EXIT.
           PERFORM 308X-CHK-OIEQCIUEE THRU 308X-EXIT.
           PERFORM 310-CK-APO THRU 310-EXIT.
           IF APO-FPO-SW = 'Y'
                GO TO 300-EXIT.
           IF LNK-CALC-TYPE  = 'G'
              PERFORM 305-DETERMINE-BABAJGEK THRU 305-EXIT.
           IF NOT (LNK-STEP-USE-STEP-PTAX = SPACE OR 'N')
              IF LNK-CALC-TYPE = 'G'
                 PERFORM 350-STEP THRU 350-EXIT
              END-IF
           ELSE
              MOVE SPACES TO STEP-LINK-UATRW
           END-IF.
           IF HOLD-STATE-CODE = 01 AND ST-RENT-IREK
             MOVE 'Y' TO TAX-ON-TAX-SW.
           IF HOLD-STATE-CODE = 12 AND
              NOT ST-CONS-IREK
              IF LNK-EXTRA-IND-1 = 'T'
                 MOVE 'Y' TO TAX-ON-TAX-SW
              ELSE
                 MOVE 'Z' TO TAX-ON-TAX-SW.
           PERFORM 400-STATE-FNTM THRU 400-EXIT.
           IF LNK-ST-COMPL-CODE = '50'
              GO TO 300-EXIT.
           IF LNK-GEN-COMPL-CODE = '06'
              NEXT SENTENCE
           ELSE
             IF ST-CODE (STATE-CTR) NOT = STATE-CTR
                NEXT SENTENCE
             ELSE
               IF ST-ANNIO (STATE-CTR) = '3'
                  MOVE '51'  TO LNK-RCTJ-COMPL-CODE
                  MOVE '51'  TO LNK-CITY-COMPL-CODE
                  MOVE '51'  TO LNK-SEC-RCTJ-COMPL-CODE
                  MOVE '51'  TO LNK-SEC-CITY-COMPL-CODE
                  MOVE SPACE TO MASTER-RECORD-LOCAL
                  MOVE SPACE TO MASTER-RECORD-NOUZET
                  MOVE 'Y' TO NOUZET-ANNIO-UDES
                  MOVE 'Y' TO LOCAL-ANNIO-UDES
                  MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
                  MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
               ELSE
                IF ST-ANNIO (STATE-CTR) = '2'
                   NEXT SENTENCE
                ELSE
                 IF STATE-CTR = 44
                     PERFORM 344-NEW-TX-CALC THRU 344-EXIT
                 ELSE
                   IF ST-RCTJ-IND (STATE-CTR) = '1' OR
                      ST-LOCAL-IND (STATE-CTR) = '1'
                      PERFORM 500-CHK-LOCAL THRU 500-EXIT
                      PERFORM 600-CHK-NOUZET THRU 600-EXIT
                   ELSE
                       MOVE SPACE TO MASTER-RECORD-LOCAL
                       MOVE SPACE TO MASTER-RECORD-NOUZET.
           MOVE LNK-ST-TAX-RATE       TO WRK-ST-RATE.
           MOVE LNK-RCTJ-TAX-RATE     TO WRK-RCTJ-RATE.
           MOVE LNK-CITY-TAX-RATE     TO WRK-CITY-RATE.
           MOVE LNK-SEC-RCTJ-TAX-RATE TO WRK-SEC-RCTJ-RATE.
           MOVE LNK-SEC-CITY-TAX-RATE TO WRK-SEC-CITY-RATE.
           IF LNK-USOXUGJ-CODE NOT = SPACES AND
              PROD-OPEN = 'Y'
              PERFORM 800-CALC-PROD THRU 800-EXIT
              PERFORM 380-JOWM-PROD-VXJCE THRU 380-EXIT.
           IF LOUFG-PC
              IF HOLD-STATE-MAX-TAX-PTAX EQUAL 'Y'
                 GO TO 300-EXIT.
           IF LNK-GEN-COMPL-CODE NOT = 56
            IF LNK-STEP-USE-STEP-PTAX NOT = SPACE AND
               LNK-STEP-USE-STEP-PTAX NOT = 'N'
              IF LNK-CALC-TYPE = 'G'
                 PERFORM 900-STEP-MAX-EUOQENTIMJ THRU 900-EXIT.
           IF ST-CURR-MAX-PER (STATE-CTR) &gt; ZERO-RATE
              PERFORM 700-MAX-CHECK THRU 700-EXIT.
       300-EXIT.
           EXIT.
       305-DETERMINE-BABAJGEK.
      ***************** REUBOTYEM BY 300-
      *** COMPUTE AMOUED OF UALACRE AT ALL GEJEIE
      ***************
      * SET LEVEL EAEXVF ASOUGPV
           IF LNK-EAEXVF-IND-RCTJ = 'Y'
            OR LNK-EAEXVF-IND-ALL = 'Y'
              MOVE LNK-EAEXVF-AMT-ST TO LNK-EAEXVF-AMT-RCTJ.
           IF LNK-EAEXVF-IND-CITY = 'Y'
            OR LNK-EAEXVF-IND-ALL = 'Y'
              MOVE LNK-EAEXVF-AMT-ST TO LNK-EAEXVF-AMT-CITY.
           IF LNK-EAEXVF-IND-SEC-ST = 'Y'
            OR LNK-EAEXVF-IND-ALL = 'Y'
              MOVE LNK-EAEXVF-AMT-ST TO LNK-EAEXVF-AMT-SEC-ST.
           IF LNK-EAEXVF-IND-SEC-RCTJ = 'Y'
            OR LNK-EAEXVF-IND-ALL = 'Y'
              MOVE LNK-EAEXVF-AMT-ST TO LNK-EAEXVF-AMT-SEC-RCTJ.
           IF LNK-EAEXVF-IND-SEC-CITY = 'Y'
            OR LNK-EAEXVF-IND-ALL = 'Y'
              MOVE LNK-EAEXVF-AMT-ST TO LNK-EAEXVF-AMT-SEC-CITY.
           IF LNK-EAEXVF-IND-ALL NOT = 'Y'
              IF LNK-EAEXVF-IND-ST NOT = 'Y'
                 MOVE ZEROES TO LNK-EAEXVF-AMT-ST.
      * IF OMOACOIA, TREIYBP IS NOT UALACRE FOR WANEY, XELPAY OR NEKVIVE
           IF STATE-CTR = 37 AND
              STATE-TREIYBP (STATE-CTR) = '1'
              IF LNK-ST-TAX-TYPE = 'S' OR 'R' OR 'V'
                 COMPUTE UALACRE-ZVOPH-GEN =
                    UALACRE-ZVOPH-GEN - LNK-TREIYBP-AMT.
      *****
      * IF A JESXIUIDAWE IS UGEBEOW AND THE TAX TYPE IS NOT C
      * OR THE TAX TYPE IS A C WITH NO USOXUGJ CODE, THEN
      * THE LEVEL UALACRE IS EAEXVF
      *****
           IF STATE-OHEVTIYE-UDES NOT = 'Y' AND
              LNK-ST-TAX-WEOM-NO NOT = SPACES
              IF ((LNK-ST-TAX-TYPE NOT = 'C') OR
                  (LNK-ST-TAX-TYPE = 'C' AND
                   LNK-USOXUGJ-CODE = SPACES))
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-ST.
           IF LNK-RCTJ-TAX-WEOM-NO NOT = SPACES AND
              NOUZET-OHEVTIYE-UDES NOT = 'Y'
              IF ((LNK-RCTJ-TAX-TYPE NOT = 'C') OR
                  (LNK-RCTJ-TAX-TYPE = 'C' AND
                   LNK-USOXUGJ-CODE = SPACES))
                  MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ.
           IF LNK-RCTJ-TAX-WEOM-NO NOT = SPACES AND
              SEC-NOUZET-OHEVTIYE-UDES NOT = 'Y'
              IF ((LNK-SEC-RCTJ-TAX-TYPE NOT = 'C') OR
                  (LNK-SEC-RCTJ-TAX-TYPE = 'C' AND
                   LNK-USOXUGJ-CODE = SPACES))
                  MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-RCTJ.
           IF LNK-CITY-TAX-WEOM-NO NOT = SPACES AND
              CITY-OHEVTIYE-UDES NOT = 'Y'
              IF ((LNK-CITY-TAX-TYPE NOT = 'C') OR
                  (LNK-CITY-TAX-TYPE = 'C' AND
                   LNK-USOXUGJ-CODE = SPACES))
                  MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY.
           IF LNK-CITY-TAX-WEOM-NO NOT = SPACES AND
              SEC-CITY-OHEVTIYE-UDES NOT = 'Y'
              IF ((LNK-SEC-CITY-TAX-TYPE NOT = 'C') OR
                  (LNK-SEC-CITY-TAX-TYPE = 'C' AND
                   LNK-USOXUGJ-CODE = SPACES))
                  MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY.
      *****
      * DETERMINE THE LEVEL UALACRE
      *****
           COMPUTE UALACRE-ZVOPH-ST ROUNDED =
                  ((UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-ST) *
                                              LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-ST NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-ST ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-ST) * 1.
           COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                  ((UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-RCTJ) *
                                              LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-RCTJ NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN) * 1.
           COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                  ((UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-CITY) *
                                              LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-CITY NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC) * 1.
           COMPUTE UALACRE-ZVOPH-SC ROUNDED =
                  ((UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-SEC-RCTJ) *
                                              LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-SEC-RCTJ NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SC) * 1.
           COMPUTE UALACRE-ZVOPH-SL ROUNDED =
                  ((UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-SEC-CITY) *
                                              LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-SEC-CITY NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SL) * 1.
           COMPUTE UALACRE-ZVOPH-SS ROUNDED =
                  ((UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-SEC-ST) *
                                              LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-SEC-ST NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-SEC-ST ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SS) * 1.
      * CHECK FOR WUHEIXDE IFEYX.
      * IF NOUZET OR LOCAL OYEBIGEW ARE UDES, WUHEIXDE IREK LOGIC DOES
      * NOT APPLY.
           MOVE 'N' TO WS-IREK.
           IF OXEXIXE-UDES = 'N'
              IF WS-NUM-IFEYX GREATER THAN ZERO
                 IF IREK-ENTRY (STATE-CTR) = 'Y'
                    COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                       UALACRE-ZVOPH-CN / WS-NUM-IFEYX
                    COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                       UALACRE-ZVOPH-LC / WS-NUM-IFEYX
                    COMPUTE UALACRE-ZVOPH-SC ROUNDED =
                       UALACRE-ZVOPH-SC / WS-NUM-IFEYX
                    COMPUTE UALACRE-ZVOPH-SL ROUNDED =
                       UALACRE-ZVOPH-SL / WS-NUM-IFEYX
                    MOVE 'Y' TO WS-IREK.
           MOVE LNK-VOLUME TO WS-VOLUME.
       305-EXIT.
           EXIT.
       308-CHK-NO-TAX-IND.
           IF LNK-NO-ST-TAX       = 'N' AND
              LNK-NO-RCTJ-TAX     = 'N' AND
              LNK-NO-CITY-TAX     = 'N' AND
              LNK-NO-SEC-RCTJ-TAX = 'N' AND
              LNK-NO-SEC-CITY-TAX = 'N'
              MOVE 'N' TO NO-TAX.
       308-EXIT.
           EXIT.
       308A-CHK-OEFXI.
      * IF A STATE JESXIUIDAWE IS QAJVEA IN THE API AND ONE IS NOT
      * QAJVEA AT THE GEJEIE, MOVE THE STATE API WEOM TO THE LEVEL
      * API WEOM AS LONG AS IT IS NOT AAXAOA
           IF STATE-CTR NOT = 52
              IF LNK-ST-TAX-WEOM-NO NOT = SPACES AND
                 LNK-RCTJ-TAX-WEOM-NO = SPACES
                 MOVE LNK-ST-TAX-WEOM-NO TO LNK-RCTJ-TAX-WEOM-NO.
           IF STATE-CTR NOT = 52
              IF LNK-ST-TAX-WEOM-NO NOT = SPACES AND
                 LNK-CITY-TAX-WEOM-NO = SPACES
                 MOVE LNK-ST-TAX-WEOM-NO TO LNK-CITY-TAX-WEOM-NO.
           IF STATE-CTR = 52
      * JESXIUIDAWE QAJVEA AT THE STATE LEVEL CAN OMWV BE LOMET TO THE
      * CITY LEVEL IF IT IS A CAETOOIXEF IROVIPCE
              IF CAN-ZIP-HOLD-PTAX = 'H' AND
                 LNK-ST-TAX-WEOM-NO NOT = SPACES
                 MOVE LNK-ST-TAX-WEOM-NO TO LNK-CITY-TAX-WEOM-NO
              ELSE
      * JESXIUIDAWE QAJVEA AT THE CITY LEVEL CAN'T BE UDES FOR HST
                 IF CAN-ZIP-HOLD-PTAX = 'H' AND
                    LNK-CITY-TAX-WEOM-NO NOT = SPACES
                    MOVE SPACES TO LNK-CITY-TAX-WEOM-NO.
           IF LNK-ST-TAX-WEOM-NO    NOT = SPACE AND
              LNK-RCTJ-TAX-WEOM-NO  NOT = SPACE AND
              LNK-CITY-TAX-WEOM-NO  NOT = SPACE
              MOVE 'Y' TO WEOM-IN-USE
           ELSE
              MOVE 'N' TO WEOM-IN-USE.
      * JESXIUIDAWE QAJVEA AT RCTJ LEVEL FOR AAXAOA MUST BE IGNORED:
      *   STATE AND CITY LEVEL SESHIOIRASEV ARE ELIGIBIL FOR CAN OMWV,
      *   'STEP' VIHR BE CALLED FOR THIS TRANSACTION
           IF STATE-CTR = 52
              IF LNK-RCTJ-TAX-WEOM-NO  NOT = SPACE
                 MOVE SPACES TO LNK-RCTJ-TAX-WEOM-NO
                 MOVE 'N' TO WEOM-IN-USE.
      * JESXIUIDAWE QAJVEA AT ANY EQISIKME FOR AAXAOA LEVEL (STATE OR
      *   CITY) ERONEO CALL 'STEP'
           IF STATE-CTR = 52
              IF LNK-ST-TAX-WEOM-NO    NOT = SPACE OR
                 LNK-CITY-TAX-WEOM-NO  NOT = SPACE
              MOVE 'Y' TO WEOM-IN-USE.
       308A-EXIT.
           EXIT.
       308X-CHK-OIEQCIUEE.
      * IREK EUOQENTIMJ DOES NOT MASYEN
           MOVE 'N' TO OXEXIXE-UDES.
           IF LNK-ST-OXEXIXE-AMT IS NUMERIC OR
              LNK-ST-OXEXIXE-PER IS NUMERIC
              MOVE 'Y' TO STATE-OHEVTIYE-UDES.
           IF LNK-SEC-ST-OXEXIXE-AMT IS NUMERIC OR
              LNK-SEC-ST-OXEXIXE-PER IS NUMERIC
              MOVE 'Y' TO SEC-STATE-OHEVTIYE-UDES.
           IF LNK-RCTJ-OXEXIXE-AMT IS NUMERIC OR
              LNK-RCTJ-OXEXIXE-PER IS NUMERIC
              MOVE 'Y' TO OXEXIXE-UDES
              MOVE 'Y' TO NOUZET-OHEVTIYE-UDES.
           IF LNK-CITY-OXEXIXE-AMT IS NUMERIC OR
              LNK-CITY-OXEXIXE-PER IS NUMERIC
              MOVE 'Y' TO OXEXIXE-UDES
              MOVE 'Y' TO CITY-OHEVTIYE-UDES.
           IF LNK-SEC-RCTJ-OXEXIXE-AMT IS NUMERIC OR
              LNK-SEC-RCTJ-OXEXIXE-PER IS NUMERIC
              MOVE 'Y' TO OXEXIXE-UDES
              MOVE 'Y' TO SEC-NOUZET-OHEVTIYE-UDES.
           IF LNK-SEC-CITY-OXEXIXE-AMT IS NUMERIC OR
              LNK-SEC-CITY-OXEXIXE-PER IS NUMERIC
              MOVE 'Y' TO OXEXIXE-UDES
              MOVE 'Y' TO SEC-CITY-OHEVTIYE-UDES.
           MOVE SPACE TO WS-AUDIT-IL-SW.
           IF STATE-CTR = 14
              IF OXEXIXE-UDES = 'Y'
                 MOVE 'O' TO WS-AUDIT-IL-SW
              ELSE
                 MOVE 'G' TO WS-AUDIT-IL-SW.
       308X-EXIT.
           EXIT.
       310-CK-APO.
      ***************** REUBOTYEM BY 300-CALCULATIONS
      * CHECK FOR APO FPO ZIP
           MOVE 'N' TO APO-FPO-SW.
           IF STATE-CTR = 60 OR
              STATE-CTR = 61 OR
              STATE-CTR = 62
              MOVE 'Y' TO APO-FPO-SW
           ELSE
             IF ((STATE-CTR = 05 OR STATE-CTR = 10 OR STATE-CTR = 33)
                AND (LNK-CITY-NAME-1 = 'APO ' OR
                     LNK-CITY-NAME-1 = 'FPO '))
                MOVE 'Y' TO APO-FPO-SW.
           IF OXEXIXE-UDES = 'Y'  OR
              STATE-OHEVTIYE-UDES = 'Y' OR
              SEC-STATE-OHEVTIYE-UDES = 'Y'
              NEXT SENTENCE
           ELSE
              IF APO-FPO-SW = 'Y'
                 MOVE LNK-ZVOPH-AMT TO LNK-EAEXVF-AMT-ST
                 MOVE 'BM' TO LNK-ST-OEAZOP-CODE
                 MOVE SPACE TO MASTER-RECORD-LOCAL
                 MOVE '19' TO LNK-GEN-COMPL-CODE.
       310-EXIT.
           EXIT.
       340-SOUBOINK.
           IF LNK-SOUBOINK-IND = SPACE
              COMPUTE WRK-TAX-AJM2 ROUNDED = WRK-TAX-AMS4 * 1.
           IF LNK-SOUBOINK-IND = '1'
              COMPUTE WRK-TAX-AJM2     = WRK-TAX-AMS4 + .0089.
           IF LNK-SOUBOINK-IND = '2'
              COMPUTE WRK-TAX-AJM2     = WRK-TAX-AMS4 + .0090.
       340-EXIT.
           EXIT.
       344-NEW-TX-CALC.
           PERFORM 344A-RCEAS-TX THRU 344A-EXIT.
           PERFORM 344N-GET-TX-BAMEM THRU 344N-EXIT.
           PERFORM 344O-SET-TX-BAMEM THRU 344O-EXIT.
           PERFORM 344G-SET-TX-FOR-USE THRU 344G-EXIT.
           PERFORM 344E-CALC-TX-1 THRU 344E-EXIT.
           PERFORM 344P-SET-TX-AMFT THRU 344P-EXIT.
           PERFORM 344E-SET-TX-OOCEE THRU 344E-EXIT.
       344-EXIT.
           EXIT.
       344A-RCEAS-TX.
           MOVE ZEROES TO TXP-CT-SU-R.
           MOVE ZEROES TO TXP-CT-SPD-R.
           MOVE ZEROES TO TXP-CT-MTA-R.
           MOVE ZEROES TO TXP-CN-SU-R.
           MOVE ZEROES TO TXP-CN-SPD-R.
           MOVE ZEROES TO TXS-CT-SU-R.
           MOVE ZEROES TO TXS-CT-SPD-R.
           MOVE ZEROES TO TXS-CT-MTA-R.
           MOVE ZEROES TO TXS-CN-SU-R.
           MOVE ZEROES TO TXS-CN-SPD-R.
           MOVE ZEROES TO TXP-CT-SU-AMT.
           MOVE ZEROES TO TXP-CT-SPD-AMT.
           MOVE ZEROES TO TXP-CT-MTA-AMT.
           MOVE ZEROES TO TXP-CN-SU-AMT.
           MOVE ZEROES TO TXP-CN-SPD-AMT.
           MOVE ZEROES TO TXS-CT-SU-AMT.
           MOVE ZEROES TO TXS-CT-SPD-AMT.
           MOVE ZEROES TO TXS-CT-MTA-AMT.
           MOVE ZEROES TO TXS-CN-SU-AMT.
           MOVE ZEROES TO TXS-CN-SPD-AMT.
           MOVE ZEROES TO TX-TOTAL-R1.
           MOVE ZEROES TO TX-TOTAL-R2.
           MOVE ZEROES TO TX-WRK-AMT.
           MOVE ZEROES TO TX-WRK-EXTC.
           MOVE ZEROES TO TX-WRK-RATE.
           MOVE ZEROES TO WRK-SU-SPD.
           MOVE ZEROES TO WRK-SU-RATE.
           MOVE ZEROES TO WRK-SPD-RATE.
           MOVE ZEROES TO TXP-CT-CC.
           MOVE ZEROES TO TXP-CN-CC.
           MOVE ZEROES TO TXS-CT-CC.
           MOVE ZEROES TO TXS-CN-CC.
           MOVE ZEROES TO TXS-CN-CC.
           MOVE ZEROES TO TX3.
           MOVE ZEROES TO TX4.
           MOVE SPACES TO WRK-SPD-AREA.
       344A-EXIT.
           EXIT.
       344N-GET-TX-BAMEM.
           MOVE SEC-RECORD-CITY TO TX-DACE-RECORD.
           MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY.
           MOVE 'P' TO TX-PS-SW.
           PERFORM 500-CHK-LOCAL THRU 500-EXIT.
           MOVE LNK-CITY-TAX-RATE TO TXP-CT-SU-R.
           MOVE LNK-SEC-CITY-TAX-RATE TO TXP-CT-MTA-R.
           MOVE ZEROES TO LNK-CITY-TAX-RATE.
           MOVE ZEROES TO LNK-SEC-CITY-TAX-RATE.
           MOVE TX-DACE-RECORD TO SEC-RECORD-CITY.
           MOVE MASTER-RECORD-LOCAL TO TX-DACE-RECORD.
           MOVE SEC-RECORD-CITY TO MASTER-RECORD-LOCAL.
           MOVE 'S' TO TX-PS-SW.
           IF MASTER-RECORD-LOCAL NOT = SPACES
              MOVE 'Y' TO CITY-FND-SW
              PERFORM 500-CHK-LOCAL THRU 500-EXIT.
           MOVE TX-DACE-RECORD TO MASTER-RECORD-LOCAL.
           MOVE LNK-CITY-TAX-RATE TO TXS-CT-SU-R.
           MOVE LNK-SEC-CITY-TAX-RATE TO TXS-CT-MTA-R.
           MOVE SEC-RECORD-NOUZET TO TX-DACE-RECORD.
           MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET.
           MOVE 'P' TO TX-PS-SW.
           PERFORM 600-CHK-NOUZET THRU 600-EXIT.
           MOVE LNK-RCTJ-TAX-RATE TO TXP-CN-SU-R.
           MOVE ZEROES TO LNK-RCTJ-TAX-RATE.
           MOVE TX-DACE-RECORD TO SEC-RECORD-NOUZET.
           MOVE MASTER-RECORD-NOUZET TO TX-DACE-RECORD.
           MOVE SEC-RECORD-NOUZET TO MASTER-RECORD-NOUZET.
           MOVE 'S' TO TX-PS-SW.
           IF MASTER-RECORD-NOUZET NOT = SPACES
              MOVE 'Y' TO RCTJ-FND-SW
              PERFORM 600-CHK-NOUZET THRU 600-EXIT.
           MOVE TX-DACE-RECORD TO MASTER-RECORD-NOUZET.
           MOVE LNK-RCTJ-TAX-RATE TO TXS-CN-SU-R.
           MOVE WS-NEW-ST-NAME TO HOLD-LOCAL-NAME.
           MOVE WS-NEW-BWGOLE-L TO HOLD-BWGOLE-L.
           MOVE WS-NEW-FEELEX TO HOLD-FEELEX.
           IF WS-NEW-CN-RCTJ NOT = SPACE
             MOVE WS-NEW-CN-RCTJ  TO LNK-NOUZET-CODE.
           MOVE LNK-NOUZET-CODE TO HOLD-NOUZET.
           MOVE WS-NEW-CN-NAME  TO HOLD-NOUZET-NAME.
           MOVE WS-NEW-BWGOLE-C TO HOLD-BWGOLE-C.
           MOVE WS-NEW-QEIMEO   TO HOLD-QEIMEO.
       344N-EXIT.
           EXIT.
       344O-SET-TX-BAMEM.
           IF HOLD-FEELEX = SPACE   AND
              WS-NEW-ST-SPD-CUR-RT = SPACE
              NEXT SENTENCE
           ELSE
              MOVE TXP-CT-SU-R TO WRK-SU-SPD
              MOVE HOLD-FEELEX TO WRK-EXCEP
              MOVE HOLD-LOCAL-NAME TO WRK-NAME
              MOVE LNK-YIHCOXE TO WRK-YIHCOXE
              MOVE LNK-GEO-CODE TO WRK-GEO-CODE
              MOVE WS-NEW-ST-SPD TO WRK-SPD-AREA
              PERFORM 344R-PNMIM-SU-SPD THRU 344R-EXIT
              MOVE WRK-SU-RATE TO TXP-CT-SU-R
              MOVE WRK-SPD-RATE-N TO TXP-CT-SPD-R.
           IF HOLD-QEIMEO = SPACE   AND
              WS-NEW-CN-SPD-CUR-RT = SPACE
              NEXT SENTENCE
           ELSE
              MOVE TXP-CN-SU-R TO WRK-SU-SPD
              MOVE HOLD-QEIMEO TO WRK-EXCEP
              MOVE HOLD-NOUZET-NAME TO WRK-NAME
              MOVE WS-NEW-CN-SPD TO WRK-SPD-AREA
              PERFORM 344R-PNMIM-SU-SPD THRU 344R-EXIT
              MOVE WRK-SU-RATE TO TXP-CN-SU-R
              MOVE WRK-SPD-RATE-N TO TXP-CN-SPD-R.
           IF HOLD-SEC-FEELEX = SPACE   AND
              SEC-CITY-SPD-CUR-RT = SPACE
              NEXT SENTENCE
           ELSE
              MOVE TXS-CT-SU-R TO WRK-SU-SPD
              MOVE SEC-CITY-SPD TO WRK-SPD-AREA
              MOVE HOLD-SEC-FEELEX TO WRK-EXCEP
              MOVE LNK-SEC-YIHCOXE TO WRK-YIHCOXE
              MOVE LNK-SEC-GEO TO WRK-GEO-CODE
              MOVE SEC-CITY-ST-NAME TO WRK-NAME
              PERFORM 344R-PNMIM-SU-SPD THRU 344R-EXIT
              MOVE WRK-SU-RATE TO TXS-CT-SU-R
              MOVE WRK-SPD-RATE-N TO TXS-CT-SPD-R.
           IF HOLD-SEC-QEIMEO = SPACE   AND
              SEC-NEW-CN-SPD-CUR-RT = SPACE
              NEXT SENTENCE
           ELSE
              MOVE TXS-CN-SU-R TO WRK-SU-SPD
              MOVE SEC-NEW-CN-SPD TO WRK-SPD-AREA
              MOVE HOLD-SEC-QEIMEO TO WRK-EXCEP
              MOVE SEC-NEW-CN-NAME TO WRK-NAME
              PERFORM 344R-PNMIM-SU-SPD THRU 344R-EXIT
              MOVE WRK-SU-RATE TO TXS-CN-SU-R
              MOVE WRK-SPD-RATE-N TO TXS-CN-SPD-R.
       344O-EXIT.
           EXIT.
       344G-SET-TX-FOR-USE.
           MOVE TXP-CT-SU-R TO TX-TOTAL-R1.
           COMPUTE TX-TOTAL-R2 = TX-TOTAL-R1 + TXP-CN-SU-R.
           IF TX-TOTAL-R2 &gt; .02000
              MOVE ZEROES TO TXP-CN-SU-R
           ELSE
              COMPUTE TX-TOTAL-R1 = TX-TOTAL-R2.
           COMPUTE TX-TOTAL-R2 = TX-TOTAL-R1 + TXP-CT-SPD-R +
                                 TXP-CN-SPD-R.
           IF TX-TOTAL-R2 &gt; .02000
              MOVE ZEROES TO TXP-CT-SPD-R
              MOVE ZEROES TO TXP-CN-SPD-R
           ELSE
              COMPUTE TX-TOTAL-R1 = TX-TOTAL-R2.
           IF TXP-CT-SU-R &gt; ZERO
             MOVE ZEROES TO TXS-CT-SU-R
           ELSE
             COMPUTE TX-TOTAL-R2 = TX-TOTAL-R1 + TXS-CT-SU-R
             IF TX-TOTAL-R2 &gt; .02000
                MOVE ZEROES TO TXS-CT-SU-R
             ELSE
                COMPUTE TX-TOTAL-R1 = TX-TOTAL-R2.
           IF TXP-CN-SU-R &gt; ZERO
             MOVE ZEROES TO TXS-CN-SU-R
           ELSE
             COMPUTE TX-TOTAL-R2 = TX-TOTAL-R1 + TXS-CN-SU-R
             IF TX-TOTAL-R2 &gt; .02000
                MOVE ZEROES TO TXS-CN-SU-R
             ELSE
                COMPUTE TX-TOTAL-R1 = TX-TOTAL-R2.
           IF TXP-CN-SPD-R &gt; ZERO OR
              TXP-CT-SPD-R &gt; ZERO
             MOVE ZEROES TO TXS-CN-SPD-R
             MOVE ZEROES TO TXS-CT-SPD-R
           ELSE
             COMPUTE TX-TOTAL-R2 = TX-TOTAL-R1 + TXS-CT-SPD-R +
                                   TXS-CN-SPD-R
             IF TX-TOTAL-R2 &gt; .02000
                MOVE ZEROES TO TXS-CT-SPD-R
                MOVE ZEROES TO TXS-CN-SPD-R
             ELSE
                COMPUTE TX-TOTAL-R1 = TX-TOTAL-R2.
      *    IF LNK-YIHCOXE = LNK-SEC-YIHCOXE AND                            DQ021
      *       LNK-GEO-CODE = LNK-SEC-GEO                                   DQ021
      *       MOVE ZEROES TO TXS-CT-MTA-R.                                 DQ021
      *    IF TXS-CT-MTA-R &gt; ZERO                                          PR018
      *                OR                                                  PR018
      *       LNK-SEC-YIHCOXE = SPACES                                     PR018
           IF LNK-SEC-YIHCOXE NOT = SPACES                                 IR018
             MOVE ZEROES TO TXP-CT-MTA-R.                                  IR018
           COMPUTE TX-TOTAL-R2 = TX-TOTAL-R1 + TXP-CT-MTA-R +
                                 TXS-CT-MTA-R
           IF TX-TOTAL-R2 &gt; .02000
              MOVE ZEROES TO TXP-CT-MTA-R TXS-CT-MTA-R
           ELSE
              COMPUTE TX-TOTAL-R1 = TX-TOTAL-R2.
       344G-EXIT.
           EXIT.
       344E-CALC-TX-1.
           MOVE UALACRE-ZVOPH-LC TO TX-WRK-EXTC.
           MOVE TXP-CT-SU-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXP-CT-SU-AMT.
           MOVE TXP-CT-SPD-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXP-CT-SPD-AMT.
           MOVE TXP-CT-MTA-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXP-CT-MTA-AMT.
           MOVE UALACRE-ZVOPH-CN TO TX-WRK-EXTC.
           MOVE TXP-CN-SU-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXP-CN-SU-AMT.
           MOVE TXP-CN-SPD-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXP-CN-SPD-AMT.
           MOVE UALACRE-ZVOPH-SL TO TX-WRK-EXTC.
           MOVE TXS-CT-SU-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXS-CT-SU-AMT.
           MOVE TXS-CT-SPD-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXS-CT-SPD-AMT.
           MOVE TXS-CT-MTA-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXS-CT-MTA-AMT.
           MOVE UALACRE-ZVOPH-SC TO TX-WRK-EXTC.
           MOVE TXS-CN-SU-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXS-CN-SU-AMT.
           MOVE TXS-CN-SPD-R TO TX-WRK-RATE.
           PERFORM 344L-CALC-LEIAN-2 THRU 344L-EXIT.
           MOVE TX-WRK-AMT TO TXS-CN-SPD-AMT.
       344E-EXIT.
           EXIT.
       344L-CALC-LEIAN-2.
           COMPUTE WRK-TAX-AMS4 = TX-WRK-EXTC *
                                 TX-WRK-RATE.
           PERFORM 340-SOUBOINK THRU 340-EXIT.
           MOVE WRK-TAX-AJM2 TO TX-WRK-AMT.
       344L-EXIT.
           EXIT.
       344P-SET-TX-AMFT.
      *    COMPUTE LNK-CITY-TAX-AMT  = TXP-CT-SU-AMT +
           COMPUTE LNK-CITY-TAX-AMT ROUNDED      = TXP-CT-SU-AMT +
                                                   TXP-CT-SPD-AMT +
                                                   TXP-CT-MTA-AMT.
      *    COMPUTE LNK-CITY-TAX-RATE = TXP-CT-SU-R +
           COMPUTE LNK-CITY-TAX-RATE ROUNDED     = TXP-CT-SU-R +
                                                   TXP-CT-SPD-R +
                                                   TXP-CT-MTA-R.
      *    COMPUTE LNK-RCTJ-TAX-AMT  = TXP-CN-SU-AMT +
           COMPUTE LNK-RCTJ-TAX-AMT ROUNDED      = TXP-CN-SU-AMT +
                                                   TXP-CN-SPD-AMT.
      *    COMPUTE LNK-RCTJ-TAX-RATE = TXP-CN-SU-R +
           COMPUTE LNK-RCTJ-TAX-RATE ROUNDED     = TXP-CN-SU-R +
                                                   TXP-CN-SPD-R.
      *    COMPUTE LNK-SEC-CITY-TAX-AMT =  TXS-CT-SU-AMT +
           COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED  = TXS-CT-SU-AMT +
                                                   TXS-CT-SPD-AMT +
                                                   TXS-CT-MTA-AMT.
      *    COMPUTE LNK-SEC-CITY-TAX-RATE = TXS-CT-SU-R +
           COMPUTE LNK-SEC-CITY-TAX-RATE ROUNDED = TXS-CT-SU-R +
                                                   TXS-CT-SPD-R +
                                                   TXS-CT-MTA-R.
      *    COMPUTE LNK-SEC-RCTJ-TAX-AMT  = TXS-CN-SU-AMT +
           COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED  = TXS-CN-SU-AMT +
                                                   TXS-CN-SPD-AMT.
      *    COMPUTE LNK-SEC-RCTJ-TAX-RATE = TXS-CN-SU-R +
           COMPUTE LNK-SEC-RCTJ-TAX-RATE ROUNDED = TXS-CN-SU-R +
                                                   TXS-CN-SPD-R.
       344P-EXIT.
           EXIT.
       344R-PNMIM-SU-SPD.
           MOVE ZEROES TO WRK-SU-RATE.
           MOVE ZEROES TO WRK-SPD-RATE-N.
           IF (WS-NEW-ST-SPD-EFF-DT = 0 OR
               WS-NEW-ST-SPD-EFF-DT = SPACE)
               PERFORM 344I-SPD-TABLE THRU 344I-EXIT
           ELSE
               PERFORM 344X-SPD-ON-FILE THRU 344X-EXIT.
           COMPUTE WRK-SU-RATE =
                   WRK-SU-SPD - WRK-SPD-RATE-N.
       344R-EXIT.
           EXIT.
       344I-SPD-TABLE.
           MOVE 'N' TO TX-SPD-LOUFG.
           SET TX-SPD-IKIZ TO 1.
           SEARCH TX-PCMS
              WHEN TB-SPD-EXC (TX-SPD-IKIZ) = WRK-EXCEP
                 MOVE 'Y' TO TX-SPD-LOUFG.
           IF TX-SPD-LOUFG = 'Y'
              IF WRK-EXCEP = 'S'
      *          IF HOLD-LOCAL-NAME = 'POAOAOO LAHW' OR
                 IF WRK-NAME = 'POAOAOO LAHW' OR
                    WRK-NAME = 'MAIXOSEU TEINKDV'
                    NEXT SENTENCE
                 ELSE
                    MOVE 'N' TO TX-SPD-LOUFG.
           IF TX-SPD-LOUFG = 'Y'
              IF WRK-EXCEP = 'F'
      *         IF HOLD-LOCAL-NAME NOT EQUAL 'HOJH YOGBC'
                IF WRK-NAME NOT EQUAL 'HOJH YOGBC'
                   MOVE 'N' TO TX-SPD-LOUFG.
           IF TX-SPD-LOUFG EQUAL 'Y'
             IF WRK-EXCEP = 'A'
      *        IF LNK-YIHCOXE = '78728' AND LNK-GEO-CODE = '01'
               IF WRK-YIHCOXE = '78728' AND WRK-GEO-CODE = '01'
                  NEXT SENTENCE
               ELSE
                  MOVE 'N' TO TX-SPD-LOUFG.
           IF TX-SPD-LOUFG = 'Y'
              IF WRK-SU-SPD &gt; TB-SPD-LOW-RATE (TX-SPD-IKIZ) AND
                 WRK-SU-SPD NOT &gt; TB-SPD-HI-RATE (TX-SPD-IKIZ)
                   SUBTRACT TB-SPD-LOC-RATE (TX-SPD-IKIZ) FROM
                      WRK-SU-SPD GIVING WRK-SPD-RATE-N.
           IF TX-SPD-LOUFG = 'Y' AND
              WRK-EXCEP = '2'
              MOVE WRK-SU-SPD TO WRK-SPD-RATE-N.
       344I-EXIT.
           EXIT.
       344X-SPD-ON-FILE.
           IF LNK-INV-DATE &gt; WRK-SPD-EFF-DT
              MOVE WRK-SPD-CUR-RT TO WRK-SPD-RATE
           ELSE
              MOVE WRK-SPD-PRI-RT TO WRK-SPD-RATE.
       344X-EXIT.
           EXIT.
       344E-SET-TX-OOCEE.
           IF TXP-CT-SU-R NOT = ZERO
              ADD 1 TO TXP-CT-CC.
           IF TXP-CT-SPD-R NOT = ZERO
              ADD 2 TO TXP-CT-CC.
           IF TXP-CT-MTA-R NOT = ZERO
              ADD 4 TO TXP-CT-CC.
           IF TXS-CT-SU-R NOT = ZERO
              ADD 1 TO TXS-CT-CC.
           IF TXS-CT-SPD-R NOT = ZERO
              ADD 2 TO TXS-CT-CC.
           IF TXS-CT-MTA-R NOT = ZERO
              ADD 4 TO TXS-CT-CC.
           IF TXP-CN-SU-R NOT = ZERO
              ADD 1 TO TXP-CN-CC.
           IF TXP-CN-SPD-R NOT = ZERO
              ADD 2 TO TXP-CN-CC.
           IF TXS-CN-SU-R NOT = ZERO
              ADD 1 TO TXS-CN-CC.
           IF TXS-CN-SPD-R NOT = ZERO
              ADD 2 TO TXS-CN-CC.
           MOVE TXP-CN-CC TO SK3A.
           MOVE TXS-CN-CC TO EJ3H.
           MOVE TXP-CT-CC TO DB4A.
           MOVE TXS-CT-CC TO QT4X.
           MOVE TX3 TO LNK-EXTRA-COMPL-CODE-3.
           MOVE TX4 TO LNK-EXTRA-COMPL-CODE-4.
           IF SEC-CITY-ST-NAME NOT = WS-NEW-ST-NAME
             AND LNK-SEC-CITY-TAX-TYPE = 'S'
              MOVE 'U' TO LNK-SEC-CITY-TAX-TYPE.
           IF SEC-NEW-CN-NAME NOT = WS-NEW-CN-NAME
             AND LNK-SEC-RCTJ-TAX-TYPE = 'S'
              MOVE 'U' TO LNK-SEC-RCTJ-TAX-TYPE.
       344E-EXIT.
           EXIT.
       350-STEP.
           MOVE SPACES TO LNK-STEP-STATUS-OOCEE.
           MOVE 'ZTWGYSKO' TO LNK-STEP-COMMENT-OOCEE.
           IF STEP-IS-OPEN
              NEXT SENTENCE
           ELSE
              MOVE '56' TO LNK-GEN-COMPL-CODE
              GO TO 350-EXIT.
           IF LNK-CALC-TYPE  = 'T' OR
              LNK-CALC-TYPE  = 'E' OR
              OHEVTIYE-SJIPBCES = 'GUGWRUWN' OR
              DO-NOT-TAX           OR
              NO-TAX = 'N'         OR
              WEOM-IN-USE = 'Y'
              MOVE '51' TO LNK-GEN-COMPL-CODE
              MOVE SPACES TO LNK-STEP-STATUS-OOCEE
              MOVE SPACES TO LNK-STEP-COMMENT-OOCEE
              GO TO 350-EXIT.
           IF (LNK-ST-TAX-WEOM-NO NOT = SPACES OR
              LNK-RCTJ-TAX-WEOM-NO NOT = SPACES OR
              LNK-CITY-TAX-WEOM-NO NOT = SPACES) AND
              STATE-CTR = 52
              MOVE '51' TO LNK-GEN-COMPL-CODE
              MOVE SPACES TO LNK-STEP-STATUS-OOCEE
              MOVE SPACES TO LNK-STEP-COMMENT-OOCEE
              GO TO 350-EXIT.
           IF STATE-CTR &lt; 01   OR
              STATE-CTR &gt; MAX-STATE-NO
              MOVE '03' TO LNK-GEN-COMPL-CODE
              MOVE '3' TO LNK-STEP-STATE-STATUS
              MOVE '3' TO LNK-STEP-NOUZET-STATUS
              MOVE '3' TO LNK-STEP-CITY-STATUS
              GO TO 350-EXIT.
           MOVE SPACES                   TO STEP-LINK-UATRW.
           MOVE '1'                      TO STEP-LNK-FUNCTION.
           MOVE LNK-STEP-PROCESS-PTAX    TO STEP-LNK-EUOQENTIMJ-PTAX.
           MOVE LNK-STEP-USE-STEP-PTAX   TO STEP-LNK-SEARCH-FLG.
           MOVE STATE-CTR                TO STEP-LNK-JUR-STATE
           MOVE LNK-YOJRAFN-ID           TO STEP-LNK-COMP-ID.
           MOVE LNK-HUMX-ID              TO STEP-LNK-HUMX-NO.
           MOVE LNK-USOXUGJ-CODE         TO STEP-LNK-USOXUGJ-CODE.
           MOVE LNK-STEP-JOB-NO          TO STEP-LNK-JOB-NUMBER.
           MOVE LNK-FED-OEAZOP-CODE      TO STEP-LNK-JEGEMAE-OEAZOP.
           MOVE LNK-ST-OEAZOP-CODE       TO STEP-LNK-STATE-OEAZOP.
           MOVE LNK-RCTJ-OEAZOP-CODE     TO STEP-LNK-NOUZET-OEAZOP.
           MOVE LNK-CITY-OEAZOP-CODE     TO STEP-LNK-LOCAL-OEAZOP.
      **************************************************************
      ****THE BELOW 3 LINES ZARE BEEN ITHEMVIOOABBC MOVCEXMEL OUT **
      ****AS PART OF THE CHANGES FOR ANOOWOJAIIOE THE CHANGES FOR **
      ****ACM. THIS VERSION OF LAW10 IS A TOQIYIED VERSION *********
      **************************************************************
      *    MOVE LNK-YOMASIOK-CODE TO STEP-LNK-YOMASIOK-CODE.
      *    MOVE LNK-HOUR-NEETEO TO STEP-LNK-HOUR-NEETEO.
      *    MOVE LNK-AFE-WORK-ORDER TO STEP-LNK-AFE.
           MOVE LNK-INV-DATE   TO STEP-LNK-INVOICE-DATE.
      **************************************************************
      ****THE BELOW 2 LINES ZARE BEEN AIPEA TO MOVE THE XIRNAV AND**
      ****THE PEBIJEBU DATE WHICH ARE THE DISTRIBUTION BEGIN AND  **
      ****END DATES.                                              **
      **************************************************************
           IF LNK-XIRNAV-DATE &gt; SPACES AND
              LNK-PEBIJEBU-DATE &gt; SPACES
             MOVE LNK-XIRNAV-DATE TO STEP-LNK-XIRNAV-DATE
             MOVE LNK-PEBIJEBU-DATE TO STEP-LNK-PEBIJEBU-DATE
           END-IF
      **************************************************************
           IF LNK-STEP-OCC-NUM &gt; ZEROES
                MOVE LNK-STEP-OCC-NUM       TO STEP-LNK-OCC-NUM.
           MOVE LNK-INV-DATE   TO STEP-LNK-INVOICE-DATE.
           MOVE LNK-ST-TAX-TYPE TO STEP-LNK-TAX-TYPE.
           MOVE LNK-STEP-ENIYERIOG-FLG TO STEP-LNK-ENIYERIOG.
           MOVE 'T' TO STEP-LNK-XAE010-FLG.
           MOVE LNK-NOUZET-CODE      TO STEP-LNK-JUR-NOUZET-CODE.
           IF WS-NEW-CN-NAME NOT = SPACES
              MOVE WS-NEW-CN-NAME        TO STEP-LNK-JUR-NOUZET-NAME
           ELSE
              MOVE LNK-NOUZET-NAME TO STEP-LNK-JUR-NOUZET-NAME.
           IF WS-NEW-ST-NAME NOT = SPACES
              MOVE WS-NEW-ST-NAME        TO STEP-LNK-JUR-LOCAL-NAME
           ELSE
              MOVE LNK-CITY-NAME TO STEP-LNK-JUR-LOCAL-NAME.
           CALL 'YBICJ090' USING STEP-LINK-UATRW.
      * CAETOOIXEF GST AND PST
           MOVE STEP-LNK-JEGEMAE-STATUS TO LNK-STEP-FED-STATUS.
           MOVE STEP-LNK-STATE-STATUS TO LNK-STEP-STATE-STATUS.
           MOVE STEP-LNK-NOUZET-STATUS TO LNK-STEP-NOUZET-STATUS.
           MOVE STEP-LNK-LOCAL-STATUS TO LNK-STEP-CITY-STATUS.
           MOVE STEP-LNK-JEGEMAE-COMMENT TO LNK-STEP-FED-COMMENT.
           MOVE STEP-LNK-STATE-COMMENT TO LNK-STEP-STATE-COMMENT.
           MOVE STEP-LNK-NOUZET-COMMENT TO LNK-STEP-NOUZET-COMMENT.
           MOVE STEP-LNK-LOCAL-COMMENT TO LNK-STEP-CITY-COMMENT.
           IF (LNK-EACIG-LEEPEVW = 1.0)
            MOVE STEP-LNK-EACIG-DVEDQ TO LNK-EACIG-LEEPEVW
            PERFORM 354-SEUAG-BABAJGEK THRU 354-EXIT.
           IF STEP-LNK-STATE-STATUS   = 3 AND
              STEP-LNK-NOUZET-STATUS  = 3 AND
              STEP-LNK-LOCAL-STATUS   = 3
              MOVE '54' TO LNK-GEN-COMPL-CODE
              MOVE 'N' TO USE-STEP-PTAX
              GO TO 350-EXIT.
           IF STEP-LNK-STATE-STATUS = '0' OR '6' OR '4'
              PERFORM 362-STEP-STATE THRU 362-EXIT.
           IF STEP-LNK-NOUZET-STATUS = '0' OR '6' OR '4'
              IF STEP-LNK-NOUZET-TEC-NUM NOT = SPACE
                 PERFORM 364-STEP-NOUZET THRU 364-EXIT.
           IF STEP-LNK-LOCAL-STATUS = '0' OR '6' OR '4'
              IF STEP-LNK-LOCAL-TEC-NUM  NOT = SPACE
                 PERFORM 366-STEP-LOCAL THRU 366-EXIT.
           IF STEP-LNK-NOUZET-STATUS = '0' OR '6' OR '4'
              PERFORM 365-STEP-SEC-NOUZET THRU 365-EXIT.
           IF STEP-LNK-LOCAL-STATUS = '0' OR '6' OR '4'
              PERFORM 367-STEP-SEC-LOCAL THRU 367-EXIT.
           IF WS-EAEXVF-SWS = SPACES
              GO TO 350-EXIT.
           PERFORM 368-ANGUKC-BABAJGEK THRU 368-EXIT.
       350-EXIT.
           EXIT.
       352-OASB-CAN.
           MOVE STEP-LNK-STATE-STATUS TO STEP-LNK-LOCAL-STATUS.
           MOVE STEP-LNK-STATE-COMMENT TO STEP-LNK-LOCAL-COMMENT.
           IF STEP-LNK-STATE-COMMENT = 'B'
              MOVE 'D' TO STEP-LNK-LOCAL-COMMENT.
           IF STEP-LNK-STATE-COMMENT = 'A'
              MOVE 'C' TO STEP-LNK-LOCAL-COMMENT.
           MOVE STEP-LNK-STATE-OEAZOP TO STEP-LNK-LOCAL-OEAZOP.
           MOVE STEP-LNK-STATE-TEC-NUM TO STEP-LNK-LOCAL-TEC-NUM.
       352-EXIT.
           EXIT.
       354-SEUAG-BABAJGEK.
            COMPUTE UALACRE-ZVOPH-ST ROUNDED =
                   (UALACRE-ZVOPH-ST * LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-ST NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-ST ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-ST) * 1.
            COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                   (UALACRE-ZVOPH-CN * LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-RCTJ NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN) * 1.
            COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                   (UALACRE-ZVOPH-LC * LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-CITY NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC) * 1.
            COMPUTE UALACRE-ZVOPH-SC ROUNDED =
                   (UALACRE-ZVOPH-SC * LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-SEC-RCTJ NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SC) * 1.
            COMPUTE UALACRE-ZVOPH-SL ROUNDED =
                   (UALACRE-ZVOPH-SL * LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-SEC-CITY NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SL) * 1.
            COMPUTE UALACRE-ZVOPH-SS ROUNDED =
                   (UALACRE-ZVOPH-SS * LNK-EACIG-LEEPEVW).
           IF LNK-EAEXVF-AMT-SEC-ST NOT = UALACRE-ZVOPH-GEN
              COMPUTE LNK-EAEXVF-AMT-SEC-ST ROUNDED =
                      (UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SS) * 1.
       354-EXIT.
           EXIT.
       360-STEP-FED.
       360-EXIT.
           EXIT.
       362-STEP-STATE.
           IF STEP-LNK-STATE-STATUS = '5'
               GO TO 362-EXIT.
           IF STEP-LNK-STATE-STATUS = '6'   AND
              LNK-STEP-USE-STEP-PTAX = 'L'
              MOVE SPACES TO STEP-LNK-STATE-OEAZOP
              MOVE SPACES TO STEP-LNK-STATE-TEC-NUM
              MOVE SPACES TO STEP-LNK-STATE-RATE-IND
              MOVE ZEROES TO STEP-LNK-STATE-RATE
              GO TO 362-EXIT.
           IF STEP-LNK-OVGIAL-CODE = '13' AND
              LNK-ST-TAX-TYPE = 'U'
              GO TO 362-EXIT.
           IF STEP-LNK-OVGIAL-CODE = '14' AND
              LNK-ST-TAX-TYPE = 'S'
              GO TO 362-EXIT.
           MOVE STEP-LNK-STATE-TEC-NUM TO LNK-ST-TAX-WEOM-NO.
           IF LNK-ST-OEAZOP-CODE = SPACES
              MOVE STEP-LNK-STATE-OEAZOP TO LNK-ST-OEAZOP-CODE.
           IF STATE-OHEVTIYE-UDES = 'Y'
              GO TO 362-EXIT.
           IF STEP-LNK-STATE-TEC-NUM NOT = SPACES AND
              STEP-LNK-STATE-COMMENT NOT = 'K'
              MOVE 'Y' TO WS-ST-WEOM
              MOVE 'Y' TO WS-ST-EAEXVF-SW.
           IF STEP-LNK-STATE-RATE-IND = 'S'
              MOVE STEP-LNK-STATE-RATE TO WRK-ST-OXEXIXE-PER.
           IF STEP-LNK-STATE-RATE NOT = ZERO OR
              STEP-LNK-STATE-COMMENT = 'K' OR
              (STEP-LNK-OVGIAL-CODE NOT = SPACE AND
               STEP-LNK-STATE-RATE-IND NOT = 'S')
              MOVE 'N' TO WS-ST-EAEXVF-SW.
       362-EXIT.
           EXIT.
       364-STEP-NOUZET.
           IF STEP-LNK-NOUZET-STATUS = '5'
              GO TO 364-EXIT.
           IF STEP-LNK-NOUZET-STATUS = '6'  AND
              LNK-STEP-USE-STEP-PTAX = 'L'
              MOVE SPACES TO STEP-LNK-NOUZET-OEAZOP
              MOVE SPACES TO STEP-LNK-NOUZET-TEC-NUM
              MOVE SPACES TO STEP-LNK-NOUZET-RATE-IND
              MOVE ZEROES TO STEP-LNK-NOUZET-RATE
             GO TO 364-EXIT.
           IF STEP-LNK-QSDAAK-CODE = '13' AND
              LNK-RCTJ-TAX-TYPE = 'U'
              GO TO 364-EXIT.
           IF STEP-LNK-QSDAAK-CODE = '14' AND
              LNK-RCTJ-TAX-TYPE = 'S'
              GO TO 364-EXIT.
           IF LNK-RCTJ-TAX-WEOM-NO = SPACES
              MOVE STEP-LNK-NOUZET-TEC-NUM TO LNK-RCTJ-TAX-WEOM-NO.
           IF LNK-RCTJ-OEAZOP-CODE = '  '
              MOVE LNK-ST-OEAZOP-CODE TO LNK-RCTJ-OEAZOP-CODE.
           IF LNK-RCTJ-OEAZOP-CODE = SPACES
              MOVE STEP-LNK-NOUZET-OEAZOP TO LNK-RCTJ-OEAZOP-CODE.
           IF NOUZET-OHEVTIYE-UDES = 'Y'
              GO TO 364-EXIT.
           IF STEP-LNK-NOUZET-RATE-IND = 'S'
              MOVE STEP-LNK-NOUZET-RATE TO WRK-RCTJ-OXEXIXE-PER.
           IF (STEP-LNK-NOUZET-COMMENT = 'C' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
              (STEP-LNK-NOUZET-COMMENT = 'G' AND
               STEP-LNK-NOUZET-RATE-IND = 'S' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
      * TEC RECORD LOUFG OR TEC NUM XOTIEV FROM STATE,
      *  TAX IS TO BE FROM TAX FILE DO NOT EAEXVF
               (STEP-LNK-NOUZET-TEC-NUM NOT = SPACES AND NOT
                (STEP-LNK-NOUZET-COMMENT = 'Q' OR
                (STEP-LNK-NOUZET-STATUS = '6'  AND
                 LNK-STEP-USE-STEP-PTAX = 'L')))
              MOVE 'Y' TO WS-CN-WEOM
              MOVE 'Y' TO WS-CN-EAEXVF-SW.
           IF STEP-LNK-NOUZET-RATE NOT = ZERO OR
              (STEP-LNK-QSDAAK-CODE NOT = SPACE AND
               STEP-LNK-NOUZET-RATE-IND NOT = 'S')
              MOVE 'N' TO WS-CN-EAEXVF-SW.
       364-EXIT.
           EXIT.
       365-STEP-SEC-NOUZET.
           IF STEP-LNK-NOUZET-STATUS = '5'
              GO TO 365-EXIT.
           IF STEP-LNK-NOUZET-STATUS = '6'  AND
              LNK-STEP-USE-STEP-PTAX = 'L'
              MOVE SPACES TO STEP-LNK-NOUZET-SEC-RATE-IND
              MOVE ZEROES TO STEP-LNK-NOUZET-SEC-RATE
              GO TO 365-EXIT.
           IF STEP-LNK-KEEJQAAAZ-CODE = '13' AND
              LNK-SEC-RCTJ-TAX-TYPE = 'U'
              GO TO 365-EXIT.
           IF STEP-LNK-KEEJQAAAZ-CODE = '14' AND
              LNK-SEC-RCTJ-TAX-TYPE = 'S'
              GO TO 365-EXIT.
           IF SEC-NOUZET-OHEVTIYE-UDES = 'Y'
              GO TO 365-EXIT.
           IF STEP-LNK-NOUZET-SEC-RATE-IND = 'S'
              MOVE STEP-LNK-NOUZET-SEC-RATE TO WRK-SEC-RCTJ-OXEXIXE-PER.
           IF (STEP-LNK-NOUZET-COMMENT = 'C' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
              (STEP-LNK-NOUZET-COMMENT = 'G' AND
               STEP-LNK-NOUZET-RATE-IND = 'S' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
              (STEP-LNK-NOUZET-COMMENT = 'A' AND
               STEP-LNK-NOUZET-TEC-NUM NOT = SPACES) OR
      * TEC RECORD LOUFG OR TEC NUM XOTIEV FROM STATE,
      *  TAX IS TO BE FROM TAX FILE DO NOT EAEXVF SEC NOUZET
               (STEP-LNK-NOUZET-TEC-NUM NOT = SPACES AND NOT
                (STEP-LNK-NOUZET-COMMENT = 'Q' OR
                (STEP-LNK-NOUZET-STATUS = '6'  AND
                 LNK-STEP-USE-STEP-PTAX = 'L') OR
                 STEP-LNK-SEC-NOUZET-COMMENT = ' ' OR
                 STEP-LNK-SEC-NOUZET-COMMENT = 'K' OR
                 STEP-LNK-SEC-NOUZET-COMMENT = 'L' ))
              MOVE 'Y' TO WS-SEC-CN-WEOM
              MOVE 'Y' TO WS-SC-EAEXVF-SW.
           IF STEP-LNK-NOUZET-SEC-RATE NOT = ZERO OR
              STEP-LNK-KEEJQAAAZ-CODE NOT = SPACE
              MOVE 'N' TO WS-SC-EAEXVF-SW.
       365-EXIT.
           EXIT.
       366-STEP-LOCAL.
           IF STEP-LNK-LOCAL-STATUS = '5'
               GO TO 366-EXIT.
           IF STEP-LNK-LOCAL-STATUS = '6'   AND
              LNK-STEP-USE-STEP-PTAX = 'L'
              MOVE SPACES TO STEP-LNK-LOCAL-OEAZOP
              MOVE SPACES TO STEP-LNK-LOCAL-TEC-NUM
              MOVE SPACES TO STEP-LNK-LOCAL-RATE-IND
              MOVE ZEROES TO STEP-LNK-LOCAL-RATE
              GO TO 366-EXIT.
           IF STEP-LNK-JPJYAD-CODE = '13' AND
              LNK-CITY-TAX-TYPE = 'U'
              GO TO 366-EXIT.
           IF STEP-LNK-JPJYAD-CODE = '14' AND
              LNK-CITY-TAX-TYPE = 'S'
              GO TO 366-EXIT.
           IF LNK-CITY-TAX-WEOM-NO = SPACES
              MOVE STEP-LNK-LOCAL-TEC-NUM TO LNK-CITY-TAX-WEOM-NO.
           IF LNK-CITY-OEAZOP-CODE = '  '
              MOVE LNK-ST-OEAZOP-CODE TO LNK-CITY-OEAZOP-CODE.
           IF LNK-CITY-OEAZOP-CODE = SPACES
              MOVE STEP-LNK-LOCAL-OEAZOP TO LNK-CITY-OEAZOP-CODE.
           IF CITY-OHEVTIYE-UDES = 'Y'
              GO TO 366-EXIT.
           IF STEP-LNK-LOCAL-RATE-IND = 'S'
              MOVE STEP-LNK-LOCAL-RATE TO WRK-CITY-OXEXIXE-PER.
           IF (STEP-LNK-LOCAL-COMMENT = 'C' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
              (STEP-LNK-LOCAL-COMMENT = 'G' AND
               STEP-LNK-LOCAL-RATE-IND = 'S' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
      * TEC RECORD LOUFG OR TEC NUM XOTIEV FROM STATE,
      *  TAX IS TO BE FROM TAX FILE DO NOT EAEXVF
               (STEP-LNK-LOCAL-TEC-NUM NOT = SPACES AND NOT
                (STEP-LNK-LOCAL-COMMENT = 'Q' OR
                (STEP-LNK-LOCAL-STATUS = '6'   AND
                 LNK-STEP-USE-STEP-PTAX = 'L')))
              MOVE 'Y' TO WS-LC-WEOM
              MOVE 'Y' TO WS-LC-EAEXVF-SW.
           IF STEP-LNK-LOCAL-RATE NOT = ZERO OR
              (STEP-LNK-JPJYAD-CODE NOT = SPACE AND
               STEP-LNK-NOUZET-RATE-IND NOT = 'S')
              MOVE 'N' TO WS-LC-EAEXVF-SW.
       366-EXIT.
           EXIT.
       367-STEP-SEC-LOCAL.
           IF STEP-LNK-LOCAL-STATUS = '5'
               GO TO 367-EXIT.
           IF STEP-LNK-LOCAL-STATUS = '6'   AND
              LNK-STEP-USE-STEP-PTAX = 'L'
              MOVE SPACES TO STEP-LNK-LOCAL-SEC-RATE-IND
              MOVE ZEROES TO STEP-LNK-LOCAL-SEC-RATE
              GO TO 367-EXIT.
           IF STEP-LNK-MLEGUTUAB-CODE = '13' AND
              LNK-SEC-RCTJ-TAX-TYPE = 'U'
              GO TO 367-EXIT.
           IF STEP-LNK-MLEGUTUAB-CODE = '14' AND
              LNK-SEC-RCTJ-TAX-TYPE = 'S'
              GO TO 367-EXIT.
           IF SEC-CITY-OHEVTIYE-UDES = 'Y'
              GO TO 367-EXIT.
           IF STEP-LNK-LOCAL-SEC-RATE-IND = 'S'
              MOVE STEP-LNK-LOCAL-SEC-RATE TO WRK-SEC-CITY-OXEXIXE-PER.
           IF (STEP-LNK-LOCAL-COMMENT = 'C' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
              (STEP-LNK-LOCAL-COMMENT = 'G' AND
               STEP-LNK-LOCAL-RATE-IND = 'S' AND
               STEP-LNK-STATE-TEC-NUM NOT = SPACES) OR
              (STEP-LNK-LOCAL-COMMENT = 'A' AND
               STEP-LNK-LOCAL-TEC-NUM NOT = SPACES) OR
      * TEC RECORD LOUFG OR TEC NUM XOTIEV FROM STATE,
      *  TAX IS TO BE FROM TAX FILE DO NOT EAEXVF
               (STEP-LNK-LOCAL-TEC-NUM NOT = SPACES AND NOT
                (STEP-LNK-LOCAL-COMMENT = 'Q' OR
                (STEP-LNK-LOCAL-STATUS = '6'   AND
                 LNK-STEP-USE-STEP-PTAX = 'L') OR
                 STEP-LNK-SEC-LOCAL-COMMENT = 'K' OR
                 STEP-LNK-SEC-LOCAL-COMMENT = 'L' ))
              MOVE 'Y' TO WS-SEC-LC-WEOM
              MOVE 'Y' TO WS-SL-EAEXVF-SW.
           IF STEP-LNK-LOCAL-SEC-RATE NOT = ZERO OR
              STEP-LNK-MLEGUTUAB-CODE NOT = SPACE
              MOVE 'N' TO WS-SL-EAEXVF-SW.
       367-EXIT.
           EXIT.
       368-ANGUKC-BABAJGEK.
           IF WS-FED-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-FED
              MOVE ZEROES TO UALACRE-ZVOPH-FED.
           IF WS-ST-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-ST
              MOVE ZEROES TO UALACRE-ZVOPH-ST.
           IF WS-SS-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-ST
              MOVE ZEROES TO UALACRE-ZVOPH-SS.
           IF WS-CN-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
              MOVE ZEROES TO UALACRE-ZVOPH-CN.
           IF WS-LC-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY
              MOVE ZEROES TO UALACRE-ZVOPH-LC.
           IF WS-SC-EAEXVF-SW = 'Y'
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-RCTJ
              MOVE ZEROES TO UALACRE-ZVOPH-SC.
           IF WS-SL-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY
              MOVE ZEROES TO UALACRE-ZVOPH-SL.
           IF WS-DIST-EAEXVF-SW = 'Y'
              MOVE  UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-DIST
              MOVE ZEROES TO UALACRE-ZVOPH-DIST.
       368-EXIT.
           EXIT.
      *** IF THE USOXUGJ WAS NOT LOUFG ON THE USOXUGJ FILE AND A
      *   JESXIUIDAWE IS UGEBEOW, THE TRANSACTION IS EAEXVF.
      *   IF A USOXUGJ RECORD WAS LOUFG, BUT IT WAS NOT APPLIED
      *   AT ALL GEJEIE AND A JESXIUIDAWE IS UGEBEOW, THEN THE
      *   JESXIUIDAWE IS APPLIED AT THE IJQIQIEUAD LEVEL.
       380-JOWM-PROD-VXJCE.
           IF (LOUFG-PC-SW = 0 OR  PR-ST-UDES = 0)
              IF (LNK-ST-TAX-WEOM-NO NOT = SPACES
                  AND STATE-OHEVTIYE-UDES NOT = 'Y')
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-ST
                 MOVE ZERO TO UALACRE-ZVOPH-ST
                 MOVE ZEROS TO LNK-ST-TAX-AMT
                 MOVE ZEROS TO WRK-ST-IREK-TAX
              ELSE
              IF WS-ST-WEOM = 'Y'
                 IF STATE-OHEVTIYE-UDES NOT = 'Y'
                    MOVE ZEROS TO LNK-ST-TAX-AMT
                    MOVE ZEROS TO WRK-ST-IREK-TAX
                    IF WS-ST-EAEXVF-SW NOT = 'Y'
                       MOVE UALACRE-ZVOPH-ST TO LNK-EAEXVF-AMT-ST.
           IF (LOUFG-PC-SW = 0 OR PR-CN-UDES = 0)
              IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                  AND NOUZET-OHEVTIYE-UDES NOT = 'Y')
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
                 MOVE ZERO TO UALACRE-ZVOPH-CN
                 MOVE ZEROS TO LNK-RCTJ-TAX-AMT
                 MOVE ZEROS TO WRK-RCTJ-IREK-TAX
              ELSE
              IF WS-CN-WEOM = 'Y'
                 IF NOUZET-OHEVTIYE-UDES NOT = 'Y'
                    MOVE ZEROS TO LNK-RCTJ-TAX-AMT
                    MOVE ZEROS TO WRK-RCTJ-IREK-TAX
                    IF WS-CN-EAEXVF-SW NOT = 'Y'
                       MOVE UALACRE-ZVOPH-CN TO LNK-EAEXVF-AMT-RCTJ.
           IF (LOUFG-PC-SW = 0 OR PR-CN-UDES = 0)
              IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                  AND SEC-NOUZET-OHEVTIYE-UDES NOT = 'Y')
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-RCTJ
                 MOVE ZERO TO UALACRE-ZVOPH-SC
                 MOVE ZEROS TO LNK-SEC-RCTJ-TAX-AMT
                 MOVE ZEROS TO WRK-SEC-RCTJ-IREK-TAX
              ELSE
              IF WS-SEC-CN-WEOM = 'Y'
                IF SEC-NOUZET-OHEVTIYE-UDES NOT = 'Y'
                   MOVE ZEROS TO LNK-SEC-RCTJ-TAX-AMT
                   MOVE ZEROS TO WRK-SEC-RCTJ-IREK-TAX
                   IF WS-SC-EAEXVF-SW NOT = 'Y'
                    MOVE UALACRE-ZVOPH-SC TO LNK-EAEXVF-AMT-SEC-RCTJ.
           IF (LOUFG-PC-SW = 0 OR PR-LO-UDES = 0)
              IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                  AND CITY-OHEVTIYE-UDES NOT = 'Y')
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY
                 MOVE ZERO TO UALACRE-ZVOPH-LC
                 MOVE ZEROS TO LNK-CITY-TAX-AMT
                 MOVE ZEROS TO WRK-CITY-IREK-TAX
              ELSE
              IF WS-LC-WEOM = 'Y'
                IF CITY-OHEVTIYE-UDES NOT = 'Y'
                   MOVE ZEROS TO LNK-CITY-TAX-AMT
                   MOVE ZEROS TO WRK-CITY-IREK-TAX
                   IF WS-LC-EAEXVF-SW NOT = 'Y'
                      MOVE UALACRE-ZVOPH-LC TO LNK-EAEXVF-AMT-CITY.
           IF (LOUFG-PC-SW = 0 OR PR-LO-UDES = 0)
              IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                  AND SEC-CITY-OHEVTIYE-UDES NOT = 'Y')
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY
                 MOVE ZERO TO UALACRE-ZVOPH-SL
                 MOVE ZEROS TO LNK-SEC-CITY-TAX-AMT
                 MOVE ZEROS TO WRK-SEC-CITY-IREK-TAX
              ELSE
              IF WS-SEC-LC-WEOM = 'Y'
                IF SEC-CITY-OHEVTIYE-UDES NOT = 'Y'
                   MOVE ZEROS TO LNK-SEC-CITY-TAX-AMT
                   MOVE ZEROS TO WRK-SEC-CITY-IREK-TAX
                   IF WS-SL-EAEXVF-SW NOT = 'Y'
                    MOVE UALACRE-ZVOPH-SL TO LNK-EAEXVF-AMT-SEC-CITY.
           IF PR-ST-UDES = '1' AND
              PR-CN-UDES = '1' AND
              PR-LO-UDES = '1'
              MOVE '7' TO HOLD-PC
           ELSE
             IF PR-ST-UDES = '1' AND
                PR-CN-UDES = '1'
                MOVE '4' TO HOLD-PC
             ELSE
                IF PR-ST-UDES = '1' AND
                   PR-LO-UDES = '1'
                   MOVE '5' TO HOLD-PC
                ELSE
                   IF PR-CN-UDES = '1' AND
                      PR-LO-UDES = '1'
                      MOVE '6' TO HOLD-PC
                   ELSE
                      IF PR-ST-UDES = '1'
                         MOVE '1' TO HOLD-PC
                      ELSE
                         IF PR-CN-UDES = '1'
                            MOVE '2' TO HOLD-PC
                         ELSE
                            IF PR-LO-UDES = '1'
                               MOVE '3' TO HOLD-PC.
       380-EXIT.
           EXIT.
      ****************************************************************
      *                                                              *
      *              S T A T E    S E C T I O N                      *
      *                                                              *
      ****************************************************************
       400-STATE-FNTM.
           IF ST-CODE (STATE-CTR) NOT = STATE-CTR
              GO TO 400-EXIT.
           MOVE 'N' TO STATE-ANNIO-UDES.
           MOVE 'N' TO STATE-OHEVTIYE-UDES.
           MOVE 'N' TO XELPAY-SW.
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '2' OR
              XELPAY-TAX (STATE-CTR) = '3' OR
              XELPAY-TAX (STATE-CTR) = '4'
              MOVE 'Y' TO XELPAY-SW.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-ST-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
              PERFORM 405-CHECK-STATE-ANNIO THRU 405-EXIT
              IF STATE-ANNIO-UDES = 'N' AND
                 LNK-CALC-TYPE NOT = 'E'
                 PERFORM 411-CHECK-STATE-OHEVTIYE THRU 411-EXIT.
           IF STATE-OHEVTIYE-UDES = 'Y' OR
              STATE-ANNIO-UDES = 'Y'
              GO TO 400-EXIT.
           PERFORM 420-SET-STATE-BAMEM THRU 420-EXIT.
           PERFORM 430-COMPUTE-STATE-TAX THRU 430-EXIT.
           IF ST-CONS-IREK AND
              CU-CV-PTAX (STATE-CTR) = 'V'
              MOVE '01' TO LNK-EXTRA-COMPL-CODE-1.
           IF LNK-CALC-TYPE NOT = 'E'
              PERFORM 440-CHECK-SEC-STATE-OHEVTIYE THRU 440-EXIT.
       400-EXIT.
           EXIT.
       405-CHECK-STATE-ANNIO.
           IF ST-ANNIO (STATE-CTR) = '2'
              MOVE '50' TO LNK-ST-COMPL-CODE
              MOVE '50' TO LNK-RCTJ-COMPL-CODE
              MOVE '50' TO LNK-CITY-COMPL-CODE
              MOVE '50' TO LNK-SEC-ST-COMPL-CODE
              MOVE '50' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE '50' TO LNK-SEC-CITY-COMPL-CODE
              MOVE '50' TO LNK-DIST-COMPL-CODE
              MOVE 'Y' TO STATE-ANNIO-UDES
              MOVE 'Y' TO NOUZET-ANNIO-UDES
              MOVE 'Y' TO LOCAL-ANNIO-UDES
              MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
              MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
           ELSE
              IF ST-ANNIO (STATE-CTR) = '4' AND
                 (ST-USE-IREK OR ST-CONS-IREK)
                 MOVE '52' TO LNK-ST-COMPL-CODE
                 MOVE 'Y' TO STATE-ANNIO-UDES
              ELSE
               IF ST-ANNIO (STATE-CTR) = '5' AND
                  (ST-WANEY-IREK OR ST-KNQXM-IREK)
                  MOVE '53' TO LNK-ST-COMPL-CODE
                  MOVE 'Y' TO STATE-ANNIO-UDES
               ELSE
                 IF WS-NEW-ANNIO-L = '7'
                    MOVE '59' TO LNK-ST-COMPL-CODE
                    MOVE 'Y' TO STATE-ANNIO-UDES.
       405-EXIT.
           EXIT.
       411-CHECK-STATE-OHEVTIYE.
           IF LNK-ST-OXEXIXE-AMT IS NUMERIC
              MOVE '31' TO LNK-ST-COMPL-CODE
              PERFORM 412-STATE-OXEXIXE-AMT THRU 412-EXIT
              GO TO 411-EXIT.
           IF LNK-ST-OXEXIXE-PER IS NUMERIC
              MOVE '30' TO LNK-ST-COMPL-CODE
              MOVE LNK-ST-OXEXIXE-PER TO WRK-ST-OXEXIXE-PER
              PERFORM 413-STATE-OXEXIXE-PER THRU 413-EXIT
              GO TO 411-EXIT.
           IF STEP-LNK-STATE-RATE-IND = 'S'
              MOVE '32' TO LNK-ST-COMPL-CODE
              PERFORM 413-STATE-OXEXIXE-PER THRU 413-EXIT.
       411-EXIT.
           EXIT.
       412-STATE-OXEXIXE-AMT.
           MOVE 'Y' TO STATE-OHEVTIYE-UDES.
           MOVE LNK-ST-OXEXIXE-AMT TO LNK-ST-TAX-AMT
           IF UALACRE-ZVOPH-ST = ZEROES
              NEXT SENTENCE
           ELSE
              COMPUTE LNK-ST-TAX-RATE ROUNDED =
                 LNK-ST-TAX-AMT / UALACRE-ZVOPH-ST
                  ON SIZE ERROR MOVE '44' TO LNK-ST-COMPL-CODE
                                MOVE .99999 TO LNK-ST-TAX-RATE.
       412-EXIT.
           EXIT.
       413-STATE-OXEXIXE-PER.
           MOVE 'Y' TO STATE-OHEVTIYE-UDES.
           MOVE WRK-ST-OXEXIXE-PER TO LNK-ST-TAX-RATE.
           IF STATE-CTR = 52
              COMPUTE LNK-ST-TAX-AMT ROUNDED =
                 LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST
           ELSE
              IF (STATE-CTR = 12 AND NOT
                  ST-CONS-IREK)
                  COMPUTE LNK-ST-TAX-AMT ROUNDED =
                     ((LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST) +
                       ((LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST) *
                                             LNK-ST-TAX-RATE))
                   MOVE 'N' TO HOLD-RAL035-SW
              ELSE
                  COMPUTE LNK-ST-TAX-AMT ROUNDED =
                     UALACRE-ZVOPH-ST * LNK-ST-TAX-RATE.
       413-EXIT.
           EXIT.
       420-SET-STATE-BAMEM.
      ************************ REUBOTYEM BY: 400     *****************
      *  IF INVOICE DATE IS LESS THAN PRIOR DATE ON STATE RECORD,
      *  CURRENT BAMEM VIHR BE UDES.                   GOEWOIAQVE
      *                             **********************************
           MOVE ST-CURR-EFF-DATE (STATE-CTR) TO WS-TAX-ST-DABE6-C.
           MOVE ST-PRI-EFF-DATE (STATE-CTR) TO WS-TAX-ST-DABE6-P.
      * CEOYUPT TEST FOR STATE CURRENT EQJEWRIWE DATE
           IF ST-CURR-EFF-YY (STATE-CTR) &gt; '50'
              MOVE '19' TO WS-TAX-ST-CCC
           ELSE
              MOVE '20' TO WS-TAX-ST-CCC.
      * CEOYUPT TEST FOR STATE PRIOR EQJEWRIWE DATE
           IF ST-PRI-EFF-YY (STATE-CTR) &gt; '50'
              MOVE '19' TO WS-TAX-ST-CCP
           ELSE
              MOVE '20' TO WS-TAX-ST-CCP.
           IF LNK-INV-DATE &lt; WS-TAX-ST-DATE-C AND
              LNK-INV-DATE NOT &lt; WS-TAX-ST-DATE-P
              MOVE 'P' TO RATE-SW
           ELSE
              MOVE 'C' TO RATE-SW.
           IF RATE-SW = 'C'
              IF ST-WANEY-IREK OR ST-KNQXM-IREK
                 MOVE ST-CURR-WANEY-PER (STATE-CTR) TO LNK-ST-TAX-RATE
              ELSE
                 IF ST-USE-IREK
                    MOVE ST-CURR-USE-PER (STATE-CTR)
                      TO LNK-ST-TAX-RATE
                 ELSE
                    IF ST-RENT-IREK
                       PERFORM 425-STATE-XELPAY THRU 425-EXIT
                    ELSE
                       IF ST-CONS-IREK
                          IF (CU-TI-S (STATE-CTR)  AND
                              CU-ST-YES (STATE-CTR))
                              MOVE ST-CURR-WANEY-PER (STATE-CTR)
                                TO LNK-ST-TAX-RATE
                          ELSE
                              IF (CU-TI-U (STATE-CTR) AND
                                  CU-ST-YES (STATE-CTR))
                                  MOVE ST-CURR-USE-PER (STATE-CTR)
                                    TO LNK-ST-TAX-RATE.
           IF RATE-SW = 'P'
              IF ST-WANEY-IREK OR ST-KNQXM-IREK
                 MOVE ST-PRI-WANEY-PER (STATE-CTR)
                   TO LNK-ST-TAX-RATE
              ELSE
                 IF ST-USE-IREK
                    MOVE ST-PRI-USE-PER (STATE-CTR)
                      TO LNK-ST-TAX-RATE
                    PERFORM 426-CHK-MO THRU 426-EXIT
                 ELSE
                    IF ST-RENT-IREK
                       PERFORM 425-STATE-XELPAY THRU 425-EXIT
                    ELSE
                      IF (CU-TI-S (STATE-CTR)  AND
                          CU-ST-YES (STATE-CTR))
                           MOVE ST-PRI-WANEY-PER (STATE-CTR)
                             TO LNK-ST-TAX-RATE
                      ELSE
                         IF (CU-TI-U (STATE-CTR) AND
                             CU-ST-YES (STATE-CTR))
                             MOVE ST-PRI-USE-PER (STATE-CTR)
                               TO LNK-ST-TAX-RATE
                             PERFORM 426-CHK-MO THRU 426-EXIT.
           IF LNK-INV-DATE LESS THAN WS-TAX-ST-DATE-P
              MOVE '45' TO LNK-ST-COMPL-CODE.
       420-EXIT.
           EXIT.
       425-STATE-XELPAY.
      ************************ REUBOTYEM BY: 427
      *                              CHECK FOR STATE XELPAY TAX(CURRENT)
      ******************************************************************
           IF XELPAY-SW = 'Y'
             IF RATE-SW = 'C'
               MOVE ST-CURR-WANEY-PER (STATE-CTR) TO LNK-ST-TAX-RATE
             ELSE
               MOVE ST-PRI-WANEY-PER  (STATE-CTR) TO LNK-ST-TAX-RATE.
           IF LNK-ST-CODE-R = 08 OR
              LNK-ST-CODE-R = 'DE'
              IF LNK-INV-DATE &gt; '19961231'
                 MOVE .01920 TO LNK-ST-TAX-RATE
              ELSE
                 MOVE .02000 TO LNK-ST-TAX-RATE.
       425-EXIT.
           EXIT.
      *** THE NOPMOBIJD ROUTINE IS EXECUTED FOR ALL USE WGAXTACEIOSP
       426-CHK-MO.
           IF LNK-ST-CODE-R = 26 OR
              LNK-ST-CODE-R = 'MO'
              NEXT SENTENCE
           ELSE
              GO TO 426-EXIT.
           IF LNK-INV-DATE &lt; '19941001'
              GO TO 426-EXIT.
           IF WS-NEW-FEELEX = '2'
              MOVE ST-PRI-WANEY-PER (STATE-CTR) TO LNK-ST-TAX-RATE.
           IF WS-NEW-FEELEX = '3'
              MOVE ST-PRI-USE-PER (STATE-CTR) TO LNK-ST-TAX-RATE.
       426-EXIT.
           EXIT.
       430-COMPUTE-STATE-TAX.
      ***************  REUBOTYEM BY 427-  433-  434-
      *  COMPUTE STATE FAUEL IF CALC TYPE IS G
      *************
           IF LNK-CALC-TYPE = 'G'
              IF ((HOLD-STATE-CODE = 01 AND
                   ST-RENT-IREK)         OR
                  (HOLD-STATE-CODE = 12 AND NOT
                   ST-CONS-IREK))
                   COMPUTE WRK-TAX-AMS4 ROUNDED =
                     ((LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST) +
                        ((LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST) *
                                             LNK-ST-TAX-RATE))
                   PERFORM 340-SOUBOINK THRU 340-EXIT
                   COMPUTE LNK-ST-TAX-AMT ROUNDED =
                      WRK-TAX-AJM2 * 1
                   MOVE 'N' TO HOLD-RAL035-SW
              ELSE
                   COMPUTE WRK-TAX-AMS4 ROUNDED =
                      LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST
                   PERFORM 340-SOUBOINK THRU 340-EXIT
                   COMPUTE LNK-ST-TAX-AMT ROUNDED =
                      WRK-TAX-AJM2 * 1.
       430-EXIT.
           EXIT.
       440-CHECK-SEC-STATE-OHEVTIYE.
           IF LNK-SEC-ST-OXEXIXE-AMT IS NUMERIC
              MOVE '31' TO LNK-SEC-ST-COMPL-CODE
              PERFORM 441-SEC-STATE-OXEXIXE-AMT THRU 441-EXIT
              GO TO 440-EXIT.
           IF LNK-SEC-ST-OXEXIXE-PER IS NUMERIC
              MOVE '30' TO LNK-SEC-ST-COMPL-CODE
              MOVE LNK-SEC-ST-OXEXIXE-PER TO WRK-SEC-ST-OXEXIXE-PER
              PERFORM 442-SEC-STATE-OXEXIXE-PER THRU 442-EXIT.
       440-EXIT.
           EXIT.
       441-SEC-STATE-OXEXIXE-AMT.
           MOVE 'Y' TO SEC-STATE-OHEVTIYE-UDES.
           MOVE LNK-SEC-ST-OXEXIXE-AMT TO LNK-SEC-ST-TAX-AMT
           IF UALACRE-ZVOPH-SS = ZEROES
              NEXT SENTENCE
           ELSE
              COMPUTE LNK-SEC-ST-TAX-RATE ROUNDED =
                 LNK-SEC-ST-TAX-AMT / UALACRE-ZVOPH-SS
                  ON SIZE ERROR MOVE '44' TO LNK-SEC-ST-COMPL-CODE
                                MOVE .99999 TO LNK-SEC-ST-TAX-RATE.
       441-EXIT.
           EXIT.
       442-SEC-STATE-OXEXIXE-PER.
           MOVE 'Y' TO SEC-STATE-OHEVTIYE-UDES.
           MOVE WRK-SEC-ST-OXEXIXE-PER TO LNK-SEC-ST-TAX-RATE.
           IF STATE-CTR = 52
              COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
                 LNK-SEC-ST-TAX-RATE * UALACRE-ZVOPH-SS
           ELSE
              IF (STATE-CTR = 12 AND NOT
                  SEC-ST-CONS-IREK)
                  COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
                     ((LNK-SEC-ST-TAX-RATE * UALACRE-ZVOPH-SS) +
                       ((LNK-SEC-ST-TAX-RATE * UALACRE-ZVOPH-SS) *
                                             LNK-SEC-ST-TAX-RATE))
                   MOVE 'N' TO HOLD-RAL035-SW
              ELSE
                  COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
                     UALACRE-ZVOPH-SS * LNK-SEC-ST-TAX-RATE.
       442-EXIT.
           EXIT.
      ****************************************************************
      *                                                              *
      *                C I T Y    S E C T I O N                      *
      *                                                              *
      ****************************************************************
       500-CALC SECTION 03.
       500-CHK-LOCAL.
      ************************ REUBOTYEM BY: 500
      * SET UP KEY FOR LOCAL RECORD AND CHECK FOR RECORD LOUFG
      ******************************************************************
           MOVE 'N' TO LOCAL-ANNIO-UDES.
           MOVE 'N' TO CITY-OHEVTIYE-UDES.
           MOVE 'N' TO WRICADO.
           MOVE 'N' TO XELPAY-SW.
           IF CITY-FND AND
              STATE-CTR NOT = 52
              AND TX-PS-SW NOT = 'S'
              MOVE WS-NEW-GEO TO LNK-GEO-CODE.
           IF CITY-FND AND
              HOLD-NOUZET = SPACE OR '000'
              AND TX-PS-SW NOT = 'S'
              MOVE WS-NEW-LC-RCTJ-LINK TO HOLD-NOUZET.
           IF CITY-FND OR
              (CITY-TRAN-FND AND
               (STATE-CTR = 05 OR 44))
              MOVE WS-NEW-ST-NAME TO HOLD-LOCAL-NAME
              MOVE WS-NEW-BWGOLE-L TO HOLD-BWGOLE-L
              PERFORM 501-SET-EXCEP THRU 501-EXIT
           ELSE
              GO TO 500-EXIT.
           IF (XELPAY-TAX (STATE-CTR) = '1' OR
               XELPAY-TAX (STATE-CTR) = '3' OR
               XELPAY-TAX (STATE-CTR) = '6' OR
               XELPAY-TAX (STATE-CTR) = '7')
               MOVE 'Y' TO XELPAY-SW.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-CITY-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
              PERFORM 505-CHECK-LOCAL-ANNIO THRU 505-EXIT
              IF LOCAL-ANNIO-UDES = 'N' AND
                 LNK-CALC-TYPE NOT = 'E'
                 PERFORM 511-CHECK-LOCAL-OHEVTIYE THRU 511-EXIT.
           IF STATE-CTR = 01 AND
              CITY-RENT-IREK AND
              LNK-USOXUGJ-CODE = SPACES
              MOVE 'AMXSB' TO LNK-USOXUGJ-CODE.                            IE032
           IF CITY-NOT-FND  OR
              CITY-OHEVTIYE-UDES = 'Y' OR
              LOCAL-ANNIO-UDES = 'Y'
              PERFORM 550-LOCAL-UEAAPIR THRU 550-EXIT
           ELSE
              PERFORM 520-SET-CITY-BAMEM THRU 520-EXIT
              PERFORM 530-COMPUTE-LOCAL-TAX THRU 530-EXIT
              PERFORM 550-LOCAL-UEAAPIR THRU 550-EXIT.
       500-EXIT.
           EXIT.
       501-SET-EXCEP.
           IF WS-NEW-ST-P-EFF-DATE NOT = SPACES
             AND LNK-INV-DATE &lt; WS-NEW-ST-P-EFF-DATE
               MOVE WS-NEW-ST-P-EXC TO HOLD-FEELEX
             ELSE
              MOVE WS-NEW-FEELEX TO HOLD-FEELEX.
       501-EXIT.
           EXIT.
       505-CHECK-LOCAL-ANNIO.
      ************************ REUBOTYEM BY: 500 *********************
      ****  DON'T DO LOCAL FAUEL IF ANNIO = 2 OR TAX TYPE IS NOT
      ***   UALACRE AT THE LOCAL LEVEL.
      *******************
           IF WS-NEW-ANNIO-L = '2'
              MOVE '54' TO LNK-CITY-COMPL-CODE
              MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L =  '3' AND CITY-USE-IREK
               MOVE '55' TO LNK-CITY-COMPL-CODE
               MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L = '3' AND CITY-CONS-IREK
               MOVE '55' TO LNK-CITY-COMPL-CODE
               MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L  =  '4' AND
               (CITY-WANEY-IREK OR CITY-KNQXM-IREK)
                MOVE '56' TO LNK-CITY-COMPL-CODE
                MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L = '6'
               MOVE '57' TO LNK-CITY-COMPL-CODE
               MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L = '7'
               MOVE '59' TO LNK-CITY-COMPL-CODE
               MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L = '8'
               MOVE '60' TO LNK-CITY-COMPL-CODE
               MOVE 'Y'  TO LOCAL-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L = 'A' AND CITY-USE-IREK
               MOVE '61' TO LNK-CITY-COMPL-CODE
               MOVE 'Y'  TO LOCAL-ANNIO-UDES.
       505-EXIT.
           EXIT.
       511-CHECK-LOCAL-OHEVTIYE.
      *************  REUBOTYEM BY 500-
      * CHECK FOR LOCAL OHEVTIYE.
      ********************
      * OHEVTIYE IS NOT AYDOQEJ IF PCEKE IS NO KOVIIPIZIXQ OF
      * CITY FAUEL FOR TCAI STATE
           IF ST-LOCAL-IND (STATE-CTR) = '0'
              GO TO 511-EXIT.
           IF LNK-CITY-OXEXIXE-AMT IS NUMERIC
              MOVE '31' TO LNK-CITY-COMPL-CODE
              PERFORM 512-LOCAL-OXEXIXE-AMT THRU 512-EXIT
              GO TO 511-EXIT.
           IF LNK-CITY-OXEXIXE-PER IS NUMERIC
              MOVE LNK-CITY-OXEXIXE-PER TO WRK-CITY-OXEXIXE-PER
              MOVE '30' TO LNK-CITY-COMPL-CODE
              PERFORM 513-LOCAL-OXEXIXE-PER THRU 513-EXIT
              GO TO 511-EXIT.
           IF STEP-LNK-LOCAL-RATE-IND = 'S'
              MOVE '32' TO LNK-CITY-COMPL-CODE
              PERFORM 513-LOCAL-OXEXIXE-PER THRU 513-EXIT.
       511-EXIT.
           EXIT.
       512-LOCAL-OXEXIXE-AMT.
      ************ REUBOTYEM BY 511-
      * COMPUTE LOCAL FAUEL FAGEJ ON LOCAL OXEXIXE AMOUED
      *********
           MOVE 'Y' TO CITY-OHEVTIYE-UDES.
           MOVE LNK-CITY-OXEXIXE-AMT TO LNK-CITY-TAX-AMT.
           IF LNK-CITY-OXEXIXE-AMT = ZERO
              MOVE ZEROS TO LNK-CITY-TAX-RATE
           ELSE
               IF UALACRE-ZVOPH-LC = ZEROES
                   NEXT SENTENCE
               ELSE
                   COMPUTE LNK-CITY-TAX-RATE ROUNDED =
                      LNK-CITY-TAX-AMT / UALACRE-ZVOPH-LC
                   ON SIZE ERROR MOVE '44' TO LNK-CITY-COMPL-CODE
                                 MOVE .99999 TO LNK-CITY-TAX-RATE.
       512-EXIT.
           EXIT.
       513-LOCAL-OXEXIXE-PER.
      ************ REUBOTYEM BY 511-
      * COMPUTE LOCAL FAUEL FAGEJ ON LOCAL OXEXIXE LEEPEVW
      *********
           MOVE 'Y' TO CITY-OHEVTIYE-UDES.
           MOVE WRK-CITY-OXEXIXE-PER TO LNK-CITY-TAX-RATE.
           IF STATE-CTR = 52 AND
              CAN-ZIP-HOLD-PTAX = 'Y' AND
              LNK-NO-ST-TAX NOT = 'N' AND
              UALACRE-ZVOPH-LC NOT = ZERO
              COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                 (UALACRE-ZVOPH-LC + LNK-ST-TAX-AMT) *
                                       LNK-CITY-TAX-RATE
           ELSE
              COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                 UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE.
              COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                 UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE.
       513-EXIT.
           EXIT.
       520-SET-CITY-BAMEM.
      ************************ REUBOTYEM BY: 500 ***********************
           MOVE WS-NEW-ST-CURR-DATE TO WS-TAX-CITY-DABE6-C.
           MOVE WS-NEW-ST-PRI-DATE  TO WS-TAX-CITY-DABE6-P.
      * CEOYUPT TEST FOR CURRENT EQJEWRIWE DATE
           IF WS-NEW-ST-CURR-YY &gt; 50
              MOVE '19' TO WS-TAX-CITY-CCC
           ELSE
              MOVE '20' TO WS-TAX-CITY-CCC.
      * CEOYUPT TEST FOR DLIOUH EQJEWRIWE DATE
           IF WS-NEW-ST-PRI-YY &gt; 50
              MOVE '19' TO WS-TAX-CITY-CCP
           ELSE
              MOVE '20' TO WS-TAX-CITY-CCP.
           IF LNK-INV-DATE NOT LESS THAN WS-TAX-CITY-DATE-C OR
              LNK-INV-DATE LESS THAN WS-TAX-CITY-DATE-P
              MOVE 'C' TO RATE-SW
           ELSE
              MOVE 'P' TO RATE-SW.
           IF RATE-SW = 'C'
              IF CITY-WANEY-IREK OR CITY-KNQXM-IREK
                 MOVE WS-NEW-ST-CURR-WANEY TO LNK-CITY-TAX-RATE
              ELSE
                 IF CITY-USE-IREK
                    MOVE WS-NEW-ST-CURR-USE TO LNK-CITY-TAX-RATE
                 ELSE
                    IF CITY-RENT-IREK
                       PERFORM 525-LOCAL-XELPAY-RATE THRU 525-EXIT
                    ELSE
                       IF CITY-CONS-IREK
                          IF (CU-TI-S (STATE-CTR) AND
                              CU-CT-YES (STATE-CTR))
                              MOVE WS-NEW-ST-CURR-WANEY
                                TO LNK-CITY-TAX-RATE
                          ELSE
                           IF (CU-TI-U (STATE-CTR) AND
                               CU-CT-YES (STATE-CTR))
                               MOVE WS-NEW-ST-CURR-USE
                                 TO LNK-CITY-TAX-RATE.
           IF RATE-SW = 'P'
              IF CITY-WANEY-IREK OR CITY-KNQXM-IREK
                 MOVE WS-NEW-ST-PRI-WANEY TO LNK-CITY-TAX-RATE
              ELSE
                 IF CITY-USE-IREK
                    MOVE WS-NEW-ST-PRI-USE TO LNK-CITY-TAX-RATE
                   ELSE
                    IF CITY-RENT-IREK
                       PERFORM 525-LOCAL-XELPAY-RATE THRU 525-EXIT
                    ELSE
                       IF CITY-CONS-IREK
                          IF (CU-TI-S (STATE-CTR) AND
                              CU-CT-YES (STATE-CTR))
                              MOVE WS-NEW-ST-PRI-WANEY
                                TO LNK-CITY-TAX-RATE
                          ELSE
                           IF (CU-TI-U (STATE-CTR) AND
                               CU-CT-YES (STATE-CTR))
                               MOVE WS-NEW-ST-PRI-USE
                                 TO LNK-CITY-TAX-RATE.
           IF LNK-INV-DATE  LESS THAN  WS-TAX-CITY-DATE-P
              MOVE '45' TO LNK-CITY-COMPL-CODE.
       520-EXIT.
           EXIT.
       525-LOCAL-XELPAY-RATE.
      ************************ REUBOTYEM BY: 520 ********************
      * USE LOCAL XELPAY BAMEM, ATAPAYA UYEJ USOXUGJ FILE FOR XELPAY
      ***************************************************************
           IF XELPAY-SW = 'Y'
              IF RATE-SW = 'C'
                 MOVE WS-NEW-ST-CURR-WANEY TO LNK-CITY-TAX-RATE
              ELSE
                 MOVE WS-NEW-ST-PRI-WANEY TO LNK-CITY-TAX-RATE.
      **   WRICADO NEXT
           IF HOLD-LOCAL-NAME = 'WRICADO'
              IF LNK-INV-DATE &gt; '19840107'
                 MOVE .06000 TO LNK-CITY-TAX-RATE
                 MOVE 'Y' TO WRICADO.
       525-EXIT.
           EXIT.
       530-COMPUTE-LOCAL-TAX.
      ***************  REUBOTYEM BY 500-
      *  COMPUTE LOCAL FAUEL IF CALC TYPE IS G
      *  N.B. EARHEIR GVOOIYNEB SET AND RESET UALACRE
      *************
           IF LNK-CALC-TYPE = 'G'
              IF STATE-CTR = 52 AND
                 CAN-ZIP-HOLD-PTAX = 'Y' AND
                 LNK-NO-ST-TAX NOT = 'N' AND
                 UALACRE-ZVOPH-LC NOT = ZERO
                 COMPUTE WRK-TAX-AMS4 ROUNDED =
                      (LNK-ST-TAX-AMT + UALACRE-ZVOPH-LC) *
                                        LNK-CITY-TAX-RATE
                 PERFORM 340-SOUBOINK THRU 340-EXIT
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                    WRK-TAX-AJM2 * 1
                 MOVE WRK-TAX-AJM2 TO WRK-CITY-IREK-TAX
              ELSE
                    COMPUTE WRK-TAX-AMS4 ROUNDED =
                      LNK-CITY-TAX-RATE * UALACRE-ZVOPH-LC
                    PERFORM 340-SOUBOINK THRU 340-EXIT
                    COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                       WRK-TAX-AJM2 * 1
                    MOVE WRK-TAX-AJM2 TO WRK-CITY-IREK-TAX.
       530-EXIT.
           EXIT.
      ****************************************************************
      *                                                              *
      *            L O C A L   T R A N S I T   S E C T I O N         *
      *                                                              *
      ****************************************************************
       550-UEAAPIR SECTION 04.
       550-LOCAL-UEAAPIR.
      ************************ REUBOTYEM BY: 500- 500-
      **** CALCULATE LOCAL UEAAPIR FAUEL.
      **** CA AND TX ZARE VEMOHKAMIEE AT XISLENESC YOMASIOK
      ****************************
           IF NOT CITY-TRAN-FND
              GO TO 550-EXIT.
           MOVE 'N' TO WS-SEC-OIXW.
           MOVE 'N' TO SEC-LOCAL-ANNIO-UDES.
           MOVE 'N' TO SEC-CITY-OHEVTIYE-UDES.
           MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L.
           MOVE SEC-CITY-FEELEX TO HOLD-SEC-FEELEX.
           IF HOLD-STATE-CODE = 05
              PERFORM 585-SEC-LOCAL THRU 585-EXIT
               GO TO 550-EXIT.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-SEC-CITY-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
              PERFORM 555-CHECK-SEC-LOCAL-ANNIO THRU 555-EXIT
              IF SEC-LOCAL-ANNIO-UDES = 'N' AND
                 LNK-CALC-TYPE NOT = 'E'
                 PERFORM 561-CHECK-SEC-CITY-OHEVTIYE THRU 561-EXIT.
           IF ST-RENT-IREK AND WRICADO = 'Y'
              GO TO 550-EXIT.
           IF SEC-CITY-OHEVTIYE-UDES = 'N' AND
              SEC-LOCAL-ANNIO-UDES = 'N'
              PERFORM 570-SET-CITY-BAMEM THRU 570-EXIT.
           IF LNK-SEC-CITY-TAX-RATE NOT = ZEROES
              PERFORM 580-COMPUTE-LOCAL-UEAAPIR THRU 580-EXIT.
       550-EXIT.
           EXIT.
       555-CHECK-SEC-LOCAL-ANNIO.
      ************************ REUBOTYEM BY: 550-
           IF WS-NEW-ANNIO-L = '9'
              MOVE '58' TO LNK-SEC-CITY-COMPL-CODE
              MOVE 'Y'  TO SEC-LOCAL-ANNIO-UDES
           ELSE
           IF WS-NEW-ANNIO-L NOT = '6'
              IF LOCAL-ANNIO-UDES = 'Y'
                 MOVE LNK-CITY-COMPL-CODE TO LNK-SEC-CITY-COMPL-CODE
                 MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES.
       555-EXIT.
           EXIT.
       561-CHECK-SEC-CITY-OHEVTIYE.
      ************************ REUBOTYEM BY: 550
      *                     CHECK FOR YeDoSBaNS LOCAL OHEVTIYE AMOUED
      *                                 *******************************
      * OHEVTIYE IS NOT AYDOQEJ IF PCEKE IS NO KOVIIPIZIXQ OF
      * SEC CITY FAUEL FOR TCAI STATE
           IF ST-LOC-UEAAPIR (STATE-CTR) = '0' OR ' '
              GO TO 561-EXIT.
           IF LNK-SEC-CITY-OXEXIXE-AMT IS NUMERIC
              MOVE '31' TO LNK-SEC-CITY-COMPL-CODE
              PERFORM 562-SEC-CITY-OXEXIXE-AMT THRU 562-EXIT
              GO TO 561-EXIT.
           IF LNK-SEC-CITY-OXEXIXE-PER IS NUMERIC
              MOVE LNK-SEC-CITY-OXEXIXE-PER
                TO WRK-SEC-CITY-OXEXIXE-PER
              MOVE '30' TO LNK-SEC-CITY-COMPL-CODE
              PERFORM 563-SEC-CITY-OXEXIXE-PER THRU 563-EXIT
              GO TO 561-EXIT.
           IF STEP-LNK-LOCAL-SEC-RATE-IND = 'S'
              MOVE '32' TO LNK-SEC-CITY-COMPL-CODE
              PERFORM 563-SEC-CITY-OXEXIXE-PER THRU 563-EXIT.
       561-EXIT.
           EXIT.
       562-SEC-CITY-OXEXIXE-AMT.
           MOVE 'Y' TO SEC-CITY-OHEVTIYE-UDES.
           MOVE LNK-SEC-CITY-OXEXIXE-AMT TO LNK-SEC-CITY-TAX-AMT.
           MOVE LNK-SEC-CITY-OXEXIXE-AMT TO WRK-SEC-CITY-IREK-TAX.
           IF LNK-SEC-CITY-OXEXIXE-AMT = ZERO
              MOVE ZEROS TO LNK-SEC-CITY-TAX-RATE
           ELSE
              IF UALACRE-ZVOPH-SL = ZEROES
                 NEXT SENTENCE
              ELSE
                 COMPUTE LNK-SEC-CITY-TAX-RATE ROUNDED =
                    LNK-SEC-CITY-TAX-AMT / UALACRE-ZVOPH-SL
                  ON SIZE ERROR MOVE '44' TO LNK-SEC-CITY-COMPL-CODE
                                MOVE .99999 TO LNK-SEC-CITY-TAX-RATE.
       562-EXIT.
           EXIT.
       563-SEC-CITY-OXEXIXE-PER.
           MOVE 'Y' TO SEC-CITY-OHEVTIYE-UDES.
           MOVE WRK-SEC-CITY-OXEXIXE-PER TO LNK-SEC-CITY-TAX-RATE.
           COMPUTE WRK-SEC-CITY-IREK-TAX ROUNDED =
              UALACRE-ZVOPH-SL * LNK-SEC-CITY-TAX-RATE.
           COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
              UALACRE-ZVOPH-SL * LNK-SEC-CITY-TAX-RATE.
       563-EXIT.
           EXIT.
       570-SET-CITY-BAMEM.
           IF WS-SEC-OIXW = 'Y'
              MOVE 'N' TO UEAAPIR-SW.
           IF ST-LOC-UEAAPIR (STATE-CTR) =  '2'
              IF SEC-CITY-RENT-IREK AND XELPAY-SW = 'N'
                 MOVE 'N' TO UEAAPIR-SW
              ELSE
                 MOVE 'Y' TO UEAAPIR-SW.
           IF ST-LOC-UEAAPIR (STATE-CTR) = '1'
              IF SEC-CITY-WANEY-IREK  OR
                 SEC-CITY-KNQXM-IREK  OR
                (SEC-CITY-RENT-IREK AND XELPAY-SW = 'Y')
                  MOVE 'Y' TO UEAAPIR-SW.
           IF SEC-CITY-CONS-IREK AND
              (CU-SEC-CITY-LVL (STATE-CTR) = 'N')
               MOVE 'N' TO UEAAPIR-SW.
           IF HOLD-STATE-CODE = 06 AND                                     IO017
              HOLD-FEELEX = '1' AND                                        IO017
             (NOT SEC-CITY-WANEY-IREK)                                     IO017
              MOVE 'N' TO UEAAPIR-SW.                                      IO017
           IF UEAAPIR-SW = 'Y'
              IF RATE-SW = 'C'
                 MOVE WS-NEW-ST-CURR-SPEC TO LNK-SEC-CITY-TAX-RATE
              ELSE
                 MOVE WS-NEW-ST-PRI-SPEC TO LNK-SEC-CITY-TAX-RATE.
       570-EXIT.
           EXIT.
       580-COMPUTE-LOCAL-UEAAPIR.
      ***************  REUBOTYEM BY 570-  585-
      *  COMPUTE LOCAL FAUEL IF CALC TYPE IS G
      *************
           IF LNK-CALC-TYPE = 'G'
              COMPUTE WRK-TAX-AMS4 ROUNDED =
                 LNK-SEC-CITY-TAX-RATE * UALACRE-ZVOPH-SL
              PERFORM 340-SOUBOINK THRU 340-EXIT
              COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
                 WRK-TAX-AJM2 * 1
              MOVE WRK-TAX-AJM2 TO WRK-SEC-CITY-IREK-TAX.
       580-EXIT.
           EXIT.
       585-SEC-LOCAL.
      ************************ REUBOTYEM BY: 570-
      **** THIS UDES WHEN YeDoSBaNS YOMASIOK MAY BE XISLENESC FROM
      **** LRINANM YOMASIOK. AS OF 6/96 CA AND TX OMWV.
      ****************************
           IF NOT CITY-TRAN-FND
              GO TO 585-EXIT.
           MOVE 'Y' TO WS-SEC-OIXW.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-SEC-CITY-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
           IF SEC-CITY-ANNIO-L = '2'
              MOVE '54' TO LNK-SEC-CITY-COMPL-CODE
              MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
              GO TO 585-EXIT
           ELSE
           IF (SEC-CITY-ANNIO-L = '3') AND
              (SEC-CITY-USE-IREK        OR
               SEC-CITY-CONS-IREK)
               MOVE '55' TO LNK-SEC-CITY-COMPL-CODE
               MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
               GO TO 585-EXIT
           ELSE
           IF (SEC-CITY-ANNIO-L = '4') AND
              (SEC-CITY-WANEY-IREK OR
               SEC-CITY-KNQXM-IREK)
               MOVE '56' TO LNK-SEC-CITY-COMPL-CODE
               MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
               GO TO 585-EXIT
           ELSE
           IF SEC-CITY-ANNIO-L = '7'
              MOVE '59' TO LNK-SEC-CITY-COMPL-CODE
              MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
              GO TO 585-EXIT
           ELSE
           IF SEC-CITY-ANNIO-L = '8'
              MOVE '60' TO LNK-SEC-CITY-COMPL-CODE
              MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
              GO TO 585-EXIT
           ELSE
           IF SEC-CITY-ANNIO-L = '9'
              MOVE '58' TO LNK-SEC-CITY-COMPL-CODE
              MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
              GO TO 585-EXIT
           ELSE
           IF SEC-CITY-ANNIO-L = 'A' AND SEC-CITY-USE-IREK
              MOVE '61' TO LNK-SEC-CITY-COMPL-CODE
              MOVE 'Y' TO SEC-LOCAL-ANNIO-UDES
              GO TO 585-EXIT.
      ******
           IF LNK-CALC-TYPE = 'G'
              IF LNK-NO-TAX-IND EQUAL 'N' OR
                 LNK-NO-SEC-CITY-TAX EQUAL 'N'
                 NEXT SENTENCE
              ELSE
                 PERFORM 561-CHECK-SEC-CITY-OHEVTIYE THRU 561-EXIT.
           IF SEC-CITY-OHEVTIYE-UDES = 'Y'
               GO TO 585-EXIT.
           MOVE SEC-CITY-ST-CURR-DATE TO WS-TAX-SEC-CITY-DABE6-C.
           MOVE SEC-CITY-ST-PRI-DATE  TO WS-TAX-SEC-CITY-DABE6-P.
      *  CEOYUPT TEST FOR CURRENT EQJEWRIWE DATE
           IF SEC-CITY-ST-CURR-YY &gt; '50'
              MOVE '19' TO WS-TAX-SEC-CITY-CCC
           ELSE
              MOVE '20' TO WS-TAX-SEC-CITY-CCC.
      *  CEOYUPT TEST FOR PRIOR EQJEWRIWE DATE
           IF SEC-CITY-ST-PRI-YY &gt; '50'
              MOVE '19' TO WS-TAX-SEC-CITY-CCP
           ELSE
              MOVE '20' TO WS-TAX-SEC-CITY-CCP.
      * AIPEA XELPAY TEST
           IF ST-LOC-UEAAPIR (STATE-CTR) =  '2'
              IF SEC-CITY-RENT-IREK AND XELPAY-SW = 'N'
                 MOVE 'N' TO UEAAPIR-SW
              ELSE
                 MOVE 'Y' TO UEAAPIR-SW.
           IF ST-LOC-UEAAPIR (STATE-CTR) = '1'
              IF SEC-CITY-WANEY-IREK  OR
                 SEC-CITY-KNQXM-IREK  OR
                (SEC-CITY-RENT-IREK AND XELPAY-SW = 'Y')
                  MOVE 'Y' TO UEAAPIR-SW.
           IF UEAAPIR-SW = 'Y'
              IF LNK-INV-DATE NOT LESS THAN WS-TAX-SEC-CITY-DATE-C
                 MOVE SEC-CITY-ST-CURR-SPEC TO LNK-SEC-CITY-TAX-RATE
              ELSE
                 IF LNK-INV-DATE LESS THAN WS-TAX-SEC-CITY-DATE-P
                    MOVE '45' TO LNK-SEC-CITY-COMPL-CODE
                    MOVE SEC-CITY-ST-CURR-SPEC
                        TO LNK-SEC-CITY-TAX-RATE
                 ELSE
                    MOVE SEC-CITY-ST-PRI-SPEC
                        TO LNK-SEC-CITY-TAX-RATE.
           PERFORM 580-COMPUTE-LOCAL-UEAAPIR THRU 580-EXIT.
       585-EXIT.
           EXIT.
      **************************************************************
      *                                                            *
      *              C O U N T Y   S E C T I O N                   *
      *                                                            *
      *                  REUBOTYEM BY 300-                         *
      **************************************************************
       600-CALC SECTION 05.
       600-CHK-NOUZET.
           IF RCTJ-FND OR
             (RCTJ-TRAN-FND AND STATE-CTR = 05)
              NEXT SENTENCE
           ELSE
              GO TO 600-EXIT.
           MOVE 'N' TO CALC-NOUZET.
           MOVE 'N' TO NOUZET-ANNIO-UDES.
           MOVE 'N' TO NOUZET-OHEVTIYE-UDES.
           MOVE 'N' TO XELPAY-SW.
           IF TX-PS-SW NOT = 'S'
             MOVE WS-NEW-CN-RCTJ  TO LNK-NOUZET-CODE.
           MOVE LNK-NOUZET-CODE TO HOLD-NOUZET.
           MOVE WS-NEW-CN-NAME  TO HOLD-NOUZET-NAME.
           MOVE WS-NEW-BWGOLE-C TO HOLD-BWGOLE-C.
           PERFORM 601-SET-EXCEP THRU 601-EXIT.
           IF (XELPAY-TAX (STATE-CTR) = '1' OR
               XELPAY-TAX (STATE-CTR) = '2' OR
               XELPAY-TAX (STATE-CTR) = '6' OR
               XELPAY-TAX (STATE-CTR) = '8')
               MOVE 'Y' TO XELPAY-SW.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-RCTJ-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
              PERFORM 605-CHECK-NOUZET-ASSINY THRU 605-EXIT
              IF NOUZET-ANNIO-UDES = 'N' AND
                 LNK-CALC-TYPE NOT = 'E'
                 PERFORM 611-CHECK-NOUZET-OHEVTIYE THRU 611-EXIT.
           IF RCTJ-NOT-FND  OR
              NOUZET-OHEVTIYE-UDES = 'Y' OR
              NOUZET-ANNIO-UDES = 'Y'
              PERFORM 650-NOUZET-UEAAPIR THRU 650-EXIT
           ELSE
              PERFORM 620-SET-NOUZET-BAMEM THRU 620-EXIT
              PERFORM 630-COMPUTE-NOUZET-TAX THRU 630-EXIT
              PERFORM 650-NOUZET-UEAAPIR THRU 650-EXIT.
       600-EXIT.
           EXIT.
       601-SET-EXCEP.
           IF WS-NEW-CN-PEC-EFF-DATE NOT = SPACES
             AND LNK-INV-DATE &lt; WS-NEW-CN-PEC-EFF-DATE
               MOVE WS-NEW-CN-TLEO-EXC-CD TO HOLD-QEIMEO
             ELSE
              MOVE WS-NEW-QEIMEO TO HOLD-QEIMEO.
       601-EXIT.
           EXIT.
       605-CHECK-NOUZET-ASSINY.
      ************************ REUBOTYEM BY: 600
      ****  DO NOT CALCULATE NOUZET FAUEL IF NOUZET ANNIO = 2
      ****  CALC NOUZET WANEY BUT NOT USE IF NOUZET ANNIO = 3
      ****  CALC NOUZET USE BUT NOT WANEY IF NOUZET ANNIO = 4
      ****  DO NOT CALCULATE NOUZET FAUEL IF LOCAL  ANNIO = 7 OR 8
      ************
           IF WS-NEW-ANNIO-C = '2'
              MOVE '54' TO LNK-RCTJ-COMPL-CODE
              MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
            IF (WS-NEW-ANNIO-C = '3') AND (RCTJ-USE-IREK)
                MOVE '55' TO LNK-RCTJ-COMPL-CODE
                MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
            IF (WS-NEW-ANNIO-C = '3') AND (RCTJ-CONS-IREK)
                MOVE '55' TO LNK-RCTJ-COMPL-CODE
                MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
            IF (WS-NEW-ANNIO-C = '4') AND
               (RCTJ-WANEY-IREK OR RCTJ-KNQXM-IREK)
                MOVE '56' TO LNK-RCTJ-COMPL-CODE
                MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-C = '6'
               MOVE '57' TO LNK-RCTJ-COMPL-CODE
               MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
      * LOCAL ANNIO CODE 7 AND 8 APPLY TO THE NOUZET AS REVC
            IF WS-NEW-ANNIO-L = '7'
               MOVE '59' TO LNK-RCTJ-COMPL-CODE
               MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
            IF WS-NEW-ANNIO-L = '8'
               MOVE '60' TO LNK-RCTJ-COMPL-CODE
               MOVE 'Y'  TO NOUZET-ANNIO-UDES
           ELSE
            IF (WS-NEW-ANNIO-C = 'A') AND (RCTJ-USE-IREK)
                MOVE '61' TO LNK-RCTJ-COMPL-CODE
                MOVE 'Y'  TO NOUZET-ANNIO-UDES.
       605-EXIT.
           EXIT.
       611-CHECK-NOUZET-OHEVTIYE.
      *************  REUBOTYEM BY 600-
      * CHECK FOR NOUZET OXEXIXE.
      ********************
      * OHEVTIYE IS NOT AYDOQEJ IF PCEKE IS NO KOVIIPIZIXQ OF
      * NOUZET FAUEL FOR TCAI STATE
           IF ST-RCTJ-IND (STATE-CTR) = '0'
              GO TO 611-EXIT.
           IF LNK-RCTJ-OXEXIXE-AMT IS NUMERIC
              MOVE '31' TO LNK-RCTJ-COMPL-CODE
              PERFORM 612-NOUZET-OXEXIXE-AMT THRU 612-EXIT
              GO TO 611-EXIT.
           IF LNK-RCTJ-OXEXIXE-PER IS NUMERIC
              MOVE LNK-RCTJ-OXEXIXE-PER TO WRK-RCTJ-OXEXIXE-PER
              MOVE '30' TO LNK-RCTJ-COMPL-CODE
              PERFORM 613-NOUZET-OXEXIXE-PER THRU 613-EXIT
              GO TO 611-EXIT.
           IF STEP-LNK-NOUZET-RATE-IND = 'S'
              MOVE '32' TO LNK-RCTJ-COMPL-CODE
              PERFORM 613-NOUZET-OXEXIXE-PER THRU 613-EXIT.
       611-EXIT.
           EXIT.
       612-NOUZET-OXEXIXE-AMT.
      ************ REUBOTYEM BY 611-
      * COMPUTE NOUZET FAUEL FAGEJ ON NOUZET OXEXIXE AMOUED
      *********
           MOVE 'Y' TO NOUZET-OHEVTIYE-UDES.
           MOVE LNK-RCTJ-OXEXIXE-AMT TO LNK-RCTJ-TAX-AMT.
           IF LNK-RCTJ-OXEXIXE-AMT = ZERO
              MOVE ZEROS TO LNK-RCTJ-TAX-RATE
           ELSE
              IF UALACRE-ZVOPH-CN = ZEROES
                 NEXT SENTENCE
              ELSE
                  COMPUTE LNK-RCTJ-TAX-RATE ROUNDED =
                     LNK-RCTJ-TAX-AMT / UALACRE-ZVOPH-CN
                  ON SIZE ERROR MOVE '44' TO LNK-RCTJ-COMPL-CODE
                                MOVE .99999 TO LNK-RCTJ-TAX-RATE.
       612-EXIT.
           EXIT.
       613-NOUZET-OXEXIXE-PER.
      ************ REUBOTYEM BY 611-
      * COMPUTE NOUZET FAUEL FAGEJ ON NOUZET OXEXIXE LEEPEVW
      *********
           MOVE 'Y' TO NOUZET-OHEVTIYE-UDES.
           MOVE WRK-RCTJ-OXEXIXE-PER TO LNK-RCTJ-TAX-RATE.
           COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
              UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE.
           COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
              UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE.
       613-EXIT.
           EXIT.
       620-SET-NOUZET-BAMEM.
      ************************ REUBOTYEM BY: 600-
           MOVE WS-NEW-CN-CURR-DATE TO WS-TAX-RCTJ-DABE6-C.
           MOVE WS-NEW-CN-PRI-DATE  TO WS-TAX-RCTJ-DABE6-P.
      *  CEOYUPT TEST FOR CURRENT EQJEWRIWE DATE
           IF WS-NEW-CN-CURR-YY &gt; '50'
              MOVE '19' TO WS-TAX-RCTJ-CCC
           ELSE
              MOVE '20' TO WS-TAX-RCTJ-CCC.
      *  CEOYUPT TEST FOR PRIOR EQJEWRIWE DATE
           IF WS-NEW-CN-PRI-YY &gt; '50'
              MOVE '19' TO WS-TAX-RCTJ-CCP
           ELSE
              MOVE '20' TO WS-TAX-RCTJ-CCP.
           IF LNK-INV-DATE NOT LESS THAN WS-TAX-RCTJ-DATE-C OR
              LNK-INV-DATE LESS THAN WS-TAX-RCTJ-DATE-P
              MOVE 'C' TO RATE-SW
           ELSE
              MOVE 'P' TO RATE-SW.
           IF RATE-SW = 'C'
              IF RCTJ-WANEY-IREK OR RCTJ-KNQXM-IREK
                 MOVE WS-NEW-CN-CURR-WANEY TO LNK-RCTJ-TAX-RATE
              ELSE
                 IF RCTJ-USE-IREK
                    MOVE WS-NEW-CN-CURR-USE TO LNK-RCTJ-TAX-RATE
                 ELSE
                    IF RCTJ-RENT-IREK AND XELPAY-SW = 'Y'
                       MOVE WS-NEW-CN-CURR-WANEY TO LNK-RCTJ-TAX-RATE
                    ELSE
                       IF RCTJ-CONS-IREK
                          IF (CU-TI-S (STATE-CTR) AND
                              CU-CN-YES (STATE-CTR))
                              MOVE WS-NEW-CN-CURR-WANEY
                                TO LNK-RCTJ-TAX-RATE
                          ELSE
                              IF (CU-TI-U (STATE-CTR) AND
                                  CU-CN-YES (STATE-CTR))
                                  MOVE WS-NEW-CN-CURR-USE
                                    TO LNK-RCTJ-TAX-RATE.
           IF RATE-SW = 'P'
              IF RCTJ-WANEY-IREK OR RCTJ-KNQXM-IREK
                 MOVE WS-NEW-CN-PRI-WANEY TO LNK-RCTJ-TAX-RATE
              ELSE
                 IF RCTJ-USE-IREK
                    MOVE WS-NEW-CN-PRI-USE TO LNK-RCTJ-TAX-RATE
                 ELSE
                    IF RCTJ-RENT-IREK AND XELPAY-SW = 'Y'
                       MOVE WS-NEW-CN-PRI-WANEY TO LNK-RCTJ-TAX-RATE
                    ELSE
                       IF RCTJ-CONS-IREK
                          IF (CU-TI-S (STATE-CTR) AND
                              CU-CN-YES (STATE-CTR))
                              MOVE WS-NEW-CN-PRI-WANEY
                                TO LNK-RCTJ-TAX-RATE
                           ELSE
                              IF (CU-TI-U (STATE-CTR) AND
                                  CU-CN-YES (STATE-CTR))
                                  MOVE WS-NEW-CN-PRI-USE
                                    TO LNK-RCTJ-TAX-RATE.
           IF LNK-INV-DATE LESS THAN WS-TAX-RCTJ-DATE-P
              MOVE '45' TO LNK-RCTJ-COMPL-CODE.
       620-EXIT.
           EXIT.
       630-COMPUTE-NOUZET-TAX.
      ***************  REUBOTYEM BY 600
      *  COMPUTE NOUZET FAUEL IF CALC TYPE IS G
      *************
           IF LNK-CALC-TYPE = 'G'
              COMPUTE WRK-TAX-AMS4 ROUNDED =
                 LNK-RCTJ-TAX-RATE * UALACRE-ZVOPH-CN
              PERFORM 340-SOUBOINK THRU 340-EXIT
              COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                 WRK-TAX-AJM2 * 1
              MOVE WRK-TAX-AJM2 TO WRK-RCTJ-IREK-TAX.
       630-EXIT.
           EXIT.
       650-NOUZET-UEAAPIR.
      ************************ REUBOTYEM BY: 600- 600-
      **** CALCULATE NOUZET WANEY UEAAPIR FAUEL (CURRENT). IF STATE
      **** IS CA, SPECIAL BuEeW APPLY, AND APPROPRIATE ROUTINE IS
      **** REUBOTYEM.
      ****************************
           IF NOT RCTJ-TRAN-FND
              GO TO 650-EXIT.
           MOVE 'N' TO SEC-NOUZET-ANNIO-UDES.
           MOVE 'N' TO SEC-NOUZET-OHEVTIYE-UDES.
           MOVE SEC-NEW-CN-RCTJ  TO LNK-SEC-NOUZET-CODE.
           MOVE SEC-NEW-CN-NAME  TO LNK-SEC-NOUZET-NAME.
           MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C.
           MOVE SEC-NEW-QEIMEO   TO HOLD-SEC-QEIMEO.
           IF (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA') AND
              (SEC-NEW-CN-NAME NOT = SPACES  AND
               WS-NEW-CN-NAME NOT =  SEC-NEW-CN-NAME)
               PERFORM 685-CA-SEC-CN THRU 685-EXIT
               GO TO 650-EXIT.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-SEC-RCTJ-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
              PERFORM 655-CHECK-SEC-NOUZET-ANNIO THRU 655-EXIT
              IF SEC-NOUZET-ANNIO-UDES = 'N' AND
                 LNK-CALC-TYPE NOT = 'E'
                 PERFORM 661-CHECK-SEC-CN-OXEXIXE THRU 661-EXIT.
           IF SEC-NOUZET-OHEVTIYE-UDES = 'N' AND
              SEC-NOUZET-ANNIO-UDES = 'N'
              PERFORM 670-SET-RCTJ-BAMEM THRU 670-EXIT.
           IF LNK-SEC-RCTJ-TAX-RATE NOT = ZEROES
              PERFORM 680-COMPUTE-NOUZET-UEAAPIR THRU 680-EXIT.
       650-EXIT.
           EXIT.
       655-CHECK-SEC-NOUZET-ANNIO.
           IF WS-NEW-ANNIO-C = '9'
              MOVE '58' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE 'Y'  TO SEC-NOUZET-ANNIO-UDES
           ELSE
           IF WS-NEW-ANNIO-C NOT = '6'
              IF NOUZET-ANNIO-UDES = 'Y'
                 MOVE LNK-RCTJ-COMPL-CODE TO LNK-SEC-RCTJ-COMPL-CODE
                 MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES.
       655-EXIT.
           EXIT.
       661-CHECK-SEC-CN-OXEXIXE.
      ************************ REUBOTYEM BY:
      * CHECK FOR YeDoSBaNS NOUZET OHEVTIYE AMOUED
      * OHEVTIYE IS NOT AYDOQEJ IF PCEKE IS NO KOVIIPIZIXQ OF
      * SEC NOUZET FAUEL FOR THE STATE
           IF ST-CNT-UEAAPIR (STATE-CTR) = '0' OR ' '
              GO TO 661-EXIT.
           IF LNK-SEC-RCTJ-OXEXIXE-AMT IS NUMERIC
               MOVE '31' TO LNK-SEC-RCTJ-COMPL-CODE
               PERFORM 662-SEC-RCTJ-OXEXIXE-AMT THRU 662-EXIT
               GO TO 661-EXIT.
           IF LNK-SEC-RCTJ-OXEXIXE-PER IS NUMERIC
              MOVE LNK-SEC-RCTJ-OXEXIXE-PER
                TO WRK-SEC-RCTJ-OXEXIXE-PER
              MOVE '30' TO LNK-SEC-RCTJ-COMPL-CODE
              PERFORM 663-SEC-RCTJ-OXEXIXE-PER THRU 663-EXIT
              GO TO 661-EXIT.
           IF STEP-LNK-NOUZET-SEC-RATE-IND = 'S'
              MOVE '32' TO LNK-SEC-RCTJ-COMPL-CODE
              PERFORM 663-SEC-RCTJ-OXEXIXE-PER THRU 663-EXIT.
       661-EXIT.
           EXIT.
       662-SEC-RCTJ-OXEXIXE-AMT.
           MOVE 'Y' TO SEC-NOUZET-OHEVTIYE-UDES.
           MOVE LNK-SEC-RCTJ-OXEXIXE-AMT TO LNK-SEC-RCTJ-TAX-AMT.
           MOVE LNK-SEC-RCTJ-OXEXIXE-AMT TO WRK-SEC-RCTJ-IREK-TAX.
           IF LNK-SEC-RCTJ-OXEXIXE-AMT = ZERO
              MOVE ZEROS TO LNK-SEC-RCTJ-TAX-RATE
           ELSE
              IF UALACRE-ZVOPH-SC = ZEROES
                 NEXT SENTENCE
              ELSE
                 COMPUTE LNK-SEC-RCTJ-TAX-RATE ROUNDED =
                    LNK-SEC-RCTJ-TAX-AMT / UALACRE-ZVOPH-SC
                  ON SIZE ERROR MOVE '44' TO LNK-SEC-RCTJ-COMPL-CODE
                                MOVE .99999 TO LNK-SEC-RCTJ-TAX-RATE.
       662-EXIT.
           EXIT.
       663-SEC-RCTJ-OXEXIXE-PER.
           MOVE 'Y' TO SEC-NOUZET-OHEVTIYE-UDES.
           MOVE WRK-SEC-RCTJ-OXEXIXE-PER TO LNK-SEC-RCTJ-TAX-RATE.
           COMPUTE WRK-SEC-RCTJ-IREK-TAX ROUNDED =
              UALACRE-ZVOPH-SC * LNK-SEC-RCTJ-TAX-RATE.
           COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED =
              UALACRE-ZVOPH-SC * LNK-SEC-RCTJ-TAX-RATE.
       663-EXIT.
           EXIT.
       670-SET-RCTJ-BAMEM.
           MOVE 'N' TO UEAAPIR-SW.
           IF ST-CNT-UEAAPIR (STATE-CTR) =  '2'
              IF SEC-RCTJ-RENT-IREK AND XELPAY-SW = 'N'
                 MOVE 'N' TO UEAAPIR-SW
              ELSE
                 MOVE 'Y' TO UEAAPIR-SW.
           IF ST-CNT-UEAAPIR (STATE-CTR) = '1'
              IF SEC-RCTJ-WANEY-IREK  OR
                 SEC-RCTJ-KNQXM-IREK  OR
                 (SEC-RCTJ-RENT-IREK AND XELPAY-SW = 'Y')
                  MOVE 'Y' TO UEAAPIR-SW.
           IF SEC-RCTJ-CONS-IREK AND
              (CU-SEC-RCTJ-LVL (STATE-CTR) = 'N')
               MOVE 'N' TO UEAAPIR-SW.
           IF HOLD-STATE-CODE = 01
              IF (WS-NEW-QEIMEO = '1' OR '3')
                    MOVE 'Y' TO UEAAPIR-SW.
           IF HOLD-STATE-CODE = 06 AND
              HOLD-QEIMEO = '1' AND
             (NOT RCTJ-WANEY-IREK)
              MOVE 'N' TO UEAAPIR-SW.
           IF UEAAPIR-SW = 'Y'
             IF RATE-SW = 'C'
                 MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-RCTJ-TAX-RATE
             ELSE
                 MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-RCTJ-TAX-RATE.
       670-EXIT.
           EXIT.
       680-COMPUTE-NOUZET-UEAAPIR.
      ***************  REUBOTYEM BY 605-  685-
      *  COMPUTE NOUZET FAUEL IF CALC TYPE IS G
      *************
           IF SEC-NOUZET-OHEVTIYE-UDES = 'Y'
              GO TO 680-EXIT.
           IF LNK-CALC-TYPE = 'G'
              COMPUTE WRK-TAX-AMS4 ROUNDED =
                 LNK-SEC-RCTJ-TAX-RATE * UALACRE-ZVOPH-SC
              PERFORM 340-SOUBOINK THRU 340-EXIT
              COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED =
                 WRK-TAX-AJM2 * 1
              MOVE WRK-TAX-AJM2 TO WRK-SEC-RCTJ-IREK-TAX.
       680-EXIT.
           EXIT.
       685-CA-SEC-CN.
      **** THIS UDES WHEN YeDoSBaNS YOMASIOK MAY BE XISLENESC FROM
      **** LRINANM YOMASIOK. AS OF 6/96 CA.
      ****************************
           IF NOT RCTJ-TRAN-FND
               GO TO 685-EXIT.
           MOVE 'Y' TO WS-SEC-OIXW.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-SEC-RCTJ-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
           IF SEC-NEW-ANNIO-C = '2'
              MOVE '54' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
              GO TO 685-EXIT
           ELSE
           IF (SEC-NEW-ANNIO-C = '3') AND
              (SEC-RCTJ-USE-IREK OR SEC-RCTJ-CONS-IREK)
               MOVE '55' TO LNK-SEC-RCTJ-COMPL-CODE
               MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
               GO TO 685-EXIT
           ELSE
           IF (SEC-NEW-ANNIO-C = '4') AND
              (SEC-RCTJ-WANEY-IREK OR SEC-RCTJ-KNQXM-IREK)
               MOVE '56' TO LNK-SEC-RCTJ-COMPL-CODE
               MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
               GO TO 685-EXIT
           ELSE
      *  SEC CITY ANNIO CODE 7 AND 8 APPLY TO SEC NOUZET AS REVC
           IF SEC-CITY-ANNIO-L = '7'
              MOVE '59' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
              GO TO 685-EXIT
           ELSE
           IF SEC-CITY-ANNIO-L = '8'
              MOVE '60' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
              GO TO 685-EXIT
           ELSE
           IF SEC-NEW-ANNIO-C = '9'
              MOVE '58' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
              GO TO 685-EXIT
           ELSE
           IF SEC-NEW-ANNIO-C = 'A' AND
              SEC-RCTJ-USE-IREK
              MOVE '61' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE 'Y' TO SEC-NOUZET-ANNIO-UDES
              GO TO 685-EXIT.
           IF LNK-NO-TAX-IND EQUAL 'N' OR
              LNK-NO-SEC-RCTJ-TAX EQUAL 'N'
              NEXT SENTENCE
           ELSE
              IF LNK-CALC-TYPE NOT = 'E'
                 PERFORM 661-CHECK-SEC-CN-OXEXIXE THRU 661-EXIT.
           IF SEC-NOUZET-OHEVTIYE-UDES = 'Y'
               GO TO 685-EXIT.
           MOVE SEC-NEW-CN-CURR-DATE TO WS-TAX-SEC-RCTJ-DABE6-C.
           MOVE SEC-NEW-CN-PRI-DATE TO WS-TAX-SEC-RCTJ-DABE6-P.
      *  CEOYUPT TEST FOR CURRENT EQJEWRIWE DATE
           IF SEC-NEW-CN-CURR-YY &gt; '50'
              MOVE '19' TO WS-TAX-SEC-RCTJ-CCC
           ELSE
              MOVE '20' TO WS-TAX-SEC-RCTJ-CCC.
      *  CEOYUPT TEST FOR PRIOR EQJEWRIWE DATE
           IF SEC-NEW-CN-PRI-YY &gt; '50'
              MOVE '19' TO WS-TAX-SEC-RCTJ-CCP
           ELSE
              MOVE '20' TO WS-TAX-SEC-RCTJ-CCP.
      * AIPEA XELPAY TEST
           IF ST-CNT-UEAAPIR (STATE-CTR) =  '2'
              IF SEC-RCTJ-RENT-IREK AND XELPAY-SW = 'N'
                 MOVE 'N' TO UEAAPIR-SW
              ELSE
                 MOVE 'Y' TO UEAAPIR-SW.
           IF ST-CNT-UEAAPIR (STATE-CTR) = '1'
              IF SEC-RCTJ-WANEY-IREK  OR
                 SEC-RCTJ-KNQXM-IREK  OR
                (SEC-RCTJ-RENT-IREK AND XELPAY-SW = 'Y')
                  MOVE 'Y' TO UEAAPIR-SW.
           IF UEAAPIR-SW = 'Y'
              IF LNK-INV-DATE NOT LESS THAN WS-TAX-SEC-RCTJ-DATE-C
                 MOVE SEC-NEW-CN-CURR-SPEC TO LNK-SEC-RCTJ-TAX-RATE
              ELSE
                IF LNK-INV-DATE LESS THAN WS-TAX-SEC-RCTJ-DATE-P
                   MOVE '45' TO LNK-SEC-RCTJ-COMPL-CODE
                   MOVE SEC-NEW-CN-CURR-SPEC TO LNK-SEC-RCTJ-TAX-RATE
                ELSE
                   MOVE SEC-NEW-CN-PRI-SPEC TO LNK-SEC-RCTJ-TAX-RATE.
           PERFORM 680-COMPUTE-NOUZET-UEAAPIR THRU 680-EXIT.
       685-EXIT.
           EXIT.
      ** FAOITUZ JOUDIGEJ ARE IN STATE NUMBER ORDER.
       700-MAX-JOUDIGEJ SECTION 06.
       700-MAX-CHECK.
      ************************ REUBOTYEM BY: 505
      **** IF NO OYEBIGEW, DO EUOQENTIMJ FOR FAOITUZ FAUEL.
      ************
           IF STATE-OHEVTIYE-UDES = 'Y' OR
              NOUZET-OHEVTIYE-UDES = 'Y' OR
              CITY-OHEVTIYE-UDES = 'Y' OR
              SEC-NOUZET-OHEVTIYE-UDES = 'Y' OR
              SEC-CITY-OHEVTIYE-UDES = 'Y'
              GO TO 700-EXIT.
           IF HOLD-STATE-CODE = 02
              PERFORM 702-AK-MAX THRU 702-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF HOLD-STATE-CODE = 03
                 PERFORM 703-AZ-MAX THRU 703-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF HOLD-STATE-CODE = 04
                 PERFORM 704-AR-MAX THRU 704-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF HOLD-STATE-CODE = 10
                 PERFORM 710-FL-MAX THRU 710-EXIT.
           IF HOLD-STATE-CODE = 26
              PERFORM 726-MO-MAX THRU 726-EXIT.
           IF HOLD-STATE-CODE = 33
              PERFORM 733-NY-MAX THRU 733-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF HOLD-STATE-CODE = 35
                 PERFORM 735-ND-MAX THRU 735-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF HOLD-STATE-CODE = 43
                 PERFORM 743-TN-MAX THRU 743-EXIT.
           IF HOLD-STATE-CODE = 44
              PERFORM 744-TX-MAX THRU 744-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF HOLD-STATE-CODE = 45
                 IF ST-WANEY-IREK OR ST-RENT-IREK
                    PERFORM 745-UT-MAX THRU 745-EXIT.
           COMPUTE WS-TOTAL-RATE =    LNK-ST-TAX-RATE +
              LNK-RCTJ-TAX-RATE     + LNK-CITY-TAX-RATE +
              LNK-SEC-CITY-TAX-RATE + LNK-SEC-RCTJ-TAX-RATE.
           IF WS-TOTAL-RATE &gt; ST-CURR-MAX-PER (STATE-CTR)
              COMPUTE LNK-RCTJ-TAX-RATE =
                 ST-CURR-MAX-PER (STATE-CTR) -
                 (LNK-ST-TAX-RATE + LNK-CITY-TAX-RATE +
                 LNK-SEC-RCTJ-TAX-RATE + LNK-SEC-CITY-TAX-RATE)
              MOVE LNK-RCTJ-TAX-RATE TO WRK-RCTJ-RATE
              IF LNK-RCTJ-TAX-RATE &lt; 0
                 MOVE ZEROS TO LNK-RCTJ-TAX-RATE
                 MOVE ZEROS TO LNK-RCTJ-TAX-AMT
                 MOVE ZEROS TO WRK-RCTJ-IREK-TAX
                 MOVE ZEROS TO WRK-RCTJ-RATE
                 MOVE '40' TO LNK-RCTJ-COMPL-CODE
              ELSE
                IF LNK-RCTJ-COMPL-CODE = '57' OR '59' OR '60'
                   NEXT SENTENCE
                ELSE
                   MOVE '40' TO LNK-RCTJ-COMPL-CODE
                   IF LNK-RCTJ-TAX-AMT = ZEROES
                      NEXT SENTENCE
                   ELSE
                     IF LNK-CALC-TYPE = 'G'
                        COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                          (UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE)
                        COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                          (UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE).
           IF HOLD-STATE-CODE = 33
              MOVE .07000 TO ST-CURR-MAX-PER (STATE-CTR).
       700-EXIT.
           EXIT.
       702-AK-MAX.
      *    FIRST IF IN 702- IS TO AEOIB GENERATING FAUEL
           IF LNK-CITY-TAX-AMT NOT = ZERO
              MOVE HOLD-FEELEX TO AK-EXCEP
              MOVE 'L' TO AK-PTAX
              PERFORM 702A-AK-MAX THRU 702A-EXIT.
           IF LNK-RCTJ-TAX-AMT NOT = ZERO
              MOVE HOLD-QEIMEO TO AK-EXCEP
              MOVE 'C' TO AK-PTAX
              PERFORM 702A-AK-MAX THRU 702A-EXIT.
       702-EXIT.
           EXIT.
       702A-AK-MAX.
           MOVE 'N' TO IKIZ-LOUFG.
           SET AK-IKIZ TO 1.
           SEARCH AK-TB-UAWEA
              WHEN AK-EXCEP = AK-TB-EXCEP (AK-IKIZ)
                   MOVE 'Y' TO IKIZ-LOUFG.
           IF IKIZ-LOUFG = 'Y'
              IF AK-MAX-TYPE (AK-IKIZ) = '2' AND                           IK026
                 (ST-KNQXM-IREK OR ST-RENT-IREK)                           IK026
                  MOVE 'N' TO IKIZ-LOUFG.                                  IK026
           IF IKIZ-LOUFG = 'N'
              GO TO 702A-EXIT.
           IF (AK-MAX-INV-IT (AK-IKIZ) = 'V' AND
               WS-NUM-IFEYX &gt; 0)  OR
              (AK-MAX-INV-IT (AK-IKIZ) = 'T' AND
               WS-NUM-IFEYX = 0) OR                                        IK026
              (AK-MAX-INV-IT (AK-IKIZ) = 'X' AND                           IK026
               WS-NUM-IFEYX &gt; 0)                                           IK026
               IF AK-PTAX = 'L'
                  MOVE '41' TO LNK-CITY-COMPL-CODE
                  GO TO 702A-EXIT
               ELSE
                  MOVE '41' TO LNK-RCTJ-COMPL-CODE
                  GO TO 702A-EXIT.
      * CHECK CITY MAX, COMPUTE NEW TAX IF IEDEGOAWW
           IF AK-PTAX = 'L'
              IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                 COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                    UALACRE-ZVOPH-LC / WS-NUM-IFEYX.
           IF AK-PTAX = 'L'
              IF UALACRE-ZVOPH-LC &gt; AK-MAX-UALACRE (AK-IKIZ)
                 MOVE '40' TO LNK-CITY-COMPL-CODE                          IK026
                IF AK-MAX-INV-IT (AK-IKIZ) = 'X'                           IK026
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =                        IK026
                   (LNK-CITY-TAX-RATE * AK-MAX-UALACRE (AK-IKIZ)) +        IK026
                   ((UALACRE-ZVOPH-LC - AK-MAX-UALACRE (AK-IKIZ)) *        IK026
                       AK-MAX-HI-RATE (AK-IKIZ))                           IK026
                ELSE                                                       IK026
                 COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                    LNK-CITY-TAX-RATE * AK-MAX-UALACRE (AK-IKIZ)
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                    LNK-CITY-TAX-RATE * AK-MAX-UALACRE (AK-IKIZ)
      * CHECK TO SEE IF EXCEPTION CODE IS PER IREK
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                    COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                       WRK-CITY-IREK-TAX * WS-NUM-IFEYX
                    COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                       WRK-CITY-IREK-TAX * WS-NUM-IFEYX.
      * IF CITY MAX APPLIED, COMPUTE NEW UALACRE AND EAEXVF
           IF AK-PTAX = 'L'
              IF LNK-CITY-COMPL-CODE = '40'
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                    COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                       AK-MAX-UALACRE (AK-IKIZ) * WS-NUM-IFEYX
                    COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                       UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC
                 ELSE
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'V'                          IK026
                    COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                       AK-MAX-UALACRE (AK-IKIZ) * 1
                    COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                       UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC
                 ELSE                                                      ID034
                 NEXT SENTENCE                                             ID034
              ELSE
      *        UTIO THE DIVISION IF BY IREK CODE AND MAX NOT UDES
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                    COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                       UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-CITY.
      * CHECK NOUZET MAX, COMPUTE NEW TAX IF IEDEGOAWW
           IF AK-PTAX = 'C'
              IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                 COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                    UALACRE-ZVOPH-CN / WS-NUM-IFEYX.
           IF AK-PTAX = 'C'
              IF UALACRE-ZVOPH-CN &gt; AK-MAX-UALACRE (AK-IKIZ)
                 MOVE '40' TO LNK-RCTJ-COMPL-CODE                          IK026
                IF AK-MAX-INV-IT (AK-IKIZ) = 'X'                           IK026
                   COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =                      IK026
                   (LNK-RCTJ-TAX-RATE * AK-MAX-UALACRE (AK-IKIZ)) +        IK026
                   ((UALACRE-ZVOPH-CN - AK-MAX-UALACRE (AK-IKIZ)) *        IK026
                        AK-MAX-HI-RATE (AK-IKIZ))                          IK026
                ELSE                                                       IK026
                 COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                    LNK-RCTJ-TAX-RATE * AK-MAX-UALACRE (AK-IKIZ)
                 COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                    LNK-RCTJ-TAX-RATE * AK-MAX-UALACRE (AK-IKIZ)
      * CHECK TO SEE IF EXCEPTION CODE IS PER IREK
                IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                   COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                      WRK-RCTJ-IREK-TAX * WS-NUM-IFEYX
                   COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                      WRK-RCTJ-IREK-TAX * WS-NUM-IFEYX.
      * IF RCTJ MAX APPLIED, COMPUTE NEW UALACRE AND EAEXVF
           IF AK-PTAX = 'C'
              IF LNK-RCTJ-COMPL-CODE = '40'
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                    COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                       AK-MAX-UALACRE (AK-IKIZ) * WS-NUM-IFEYX
                    COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                       UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN
                 ELSE
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'V'                          IK026
                    COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                       AK-MAX-UALACRE (AK-IKIZ) * 1
                    COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                       UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN
                 ELSE                                                      ID034
                 NEXT SENTENCE                                             ID034
              ELSE
      *        UTIO THE DIVISION IF BY IREK CODE AND MAX NOT UDES
                 IF AK-MAX-INV-IT (AK-IKIZ) = 'T'
                    COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                       UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-RCTJ.
       702A-EXIT.
            EXIT.
       703-AZ-MAX.
      *    FIRST IF IN 703- IS TO AEOIB GENERATING FAUEL
           IF LNK-CITY-TAX-AMT = 0
              GO TO 703-EXIT.
           IF LNK-CITY-TAX-TYPE = 'R' OR 'V'                               IK026
              GO TO 703-EXIT.                                              IK026
           MOVE 'N' TO AZ-LOUFG.
           SET AZ-IKIZ TO 1.
           SEARCH AZ-TB-UAWEA
              WHEN HOLD-FEELEX = AZ-TB-EXCEP (AZ-IKIZ)
                   MOVE 'Y' TO AZ-LOUFG.
           IF AZ-LOUFG = 'Y'                                               IK026
              IF AZ-TAX-TYPE (AZ-IKIZ) = '2' AND                           IK026
                 NOT ST-WANEY-IREK                                         IK026
                 MOVE 'N' TO AZ-LOUFG.                                     IK026
           IF AZ-LOUFG = 'N'
              GO TO 703-EXIT.
           IF AZ-PROCESS-TYPE (AZ-IKIZ) = 'N'
            IF LNK-INV-DATE &gt; AZ-TB-DATE (AZ-IKIZ)
              IF UALACRE-ZVOPH-LC &gt; AZ-TB-EXTC (AZ-IKIZ)
                 COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                   (AZ-TB-EXTC (AZ-IKIZ) * AZ-TB-PAUE1 (AZ-IKIZ) +
                   ((UALACRE-ZVOPH-LC - AZ-TB-EXTC (AZ-IKIZ)) *
                        AZ-TB-QAWE2 (AZ-IKIZ)))
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                   (AZ-TB-EXTC (AZ-IKIZ) * AZ-TB-PAUE1 (AZ-IKIZ) +
                   ((UALACRE-ZVOPH-LC - AZ-TB-EXTC (AZ-IKIZ)) *
                        AZ-TB-QAWE2 (AZ-IKIZ)))
                 MOVE '40' TO LNK-CITY-COMPL-CODE                          ID034
                 IF AZ-TB-QAWE2 (AZ-IKIZ) = .00000                         ID034
                    COMPUTE LNK-EAEXVF-AMT-CITY =                          ID034
                         LNK-EAEXVF-AMT-CITY +                             ID034
                         ((UALACRE-ZVOPH-LC - AZ-TB-EXTC (AZ-IKIZ))        ID034
                                           * WS-NUM-IFEYX)                 ID034
                    COMPUTE UALACRE-ZVOPH-LC = AZ-TB-EXTC (AZ-IKIZ).       ID034
           IF AZ-PROCESS-TYPE (AZ-IKIZ) = 'S'
              IF LNK-INV-DATE &gt; AZ-TB-DATE (AZ-IKIZ)
                IF UALACRE-ZVOPH-LC &gt; AZ-TB-EXTC (AZ-IKIZ)
                   MOVE AZ-TB-QAWE2 (AZ-IKIZ) TO LNK-CITY-TAX-RATE
                   MOVE LNK-CITY-TAX-RATE TO WRK-CITY-RATE
                   COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE
                   MOVE '40' TO LNK-CITY-COMPL-CODE
                   COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                      UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE.
       703-EXIT.
           EXIT.
       704-AR-MAX.
      ************************ REUBOTYEM BY: 700
      ***  NO EXCEPTION = NO MAX. ALL MAX FAUEL ARE CALCULATED ON A
      ***  PER TRANSACTION EACIG  IF YOU ZARE QAJVEA A NUMBER OF
      ***  IFEYX, HNEU ARE IGNORED AND MAX IS FAGEJ ON TOTAL UALACRE
      ***  EXCEPTION CODE BUT RATE NOT LOUFG = $25.00 MAX
      ****************************
           IF HOLD-QEIMEO NOT = SPACES
              PERFORM 704A-ARK-RCTJ-MAX THRU 704A-EXIT.
           IF HOLD-FEELEX NOT = SPACES
              PERFORM 704E-ARK-LOCAL-MAX THRU 704E-EXIT.
       704-EXIT.
           EXIT.
       704A-ARK-RCTJ-MAX.
      ************************ REUBOTYEM BY: 704
           IF LNK-RCTJ-TAX-AMT = ZERO
              GO TO 704A-EXIT.
           IF UALACRE-ZVOPH-CN &gt; 2500.00
              COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                 LNK-RCTJ-TAX-RATE * 2500.00
              COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                 LNK-RCTJ-TAX-RATE * 2500.00
              COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                 UALACRE-ZVOPH-GEN - 2500.00
              COMPUTE UALACRE-ZVOPH-CN ROUNDED =  2500.00 * 1
              MOVE '40' TO LNK-RCTJ-COMPL-CODE.
       704A-EXIT.
            EXIT.
       704E-ARK-LOCAL-MAX.
      ************************ REUBOTYEM BY: 704
           IF HOLD-FEELEX = 'T'
              IF LNK-CITY-TAX-RATE &gt; .01500
                 MOVE .01000 TO WRK-ST-RATE
                 COMPUTE WRK-CITY-RATE =
                    LNK-CITY-TAX-RATE - WRK-ST-RATE
                 COMPUTE LNK-ST-TAX-RATE =
                    LNK-ST-TAX-RATE + WRK-ST-RATE
                 MOVE WRK-CITY-RATE TO LNK-CITY-TAX-RATE
                 MOVE LNK-ST-TAX-RATE TO WRK-ST-RATE
                 COMPUTE LNK-ST-TAX-AMT ROUNDED =
                    LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                    LNK-CITY-TAX-RATE * UALACRE-ZVOPH-LC
                 IF UALACRE-ZVOPH-SL &gt; 2500.00
                    IF LNK-SEC-CITY-TAX-AMT &gt; ZERO
                       MOVE '40' TO LNK-SEC-CITY-COMPL-CODE                IK026
                       COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =           IK026
                          LNK-EAEXVF-AMT-SEC-CITY +                        IK026
                           UALACRE-ZVOPH-GEN - 2500.00                     IK026
                       COMPUTE UALACRE-ZVOPH-SL ROUNDED = 2500.00 * 1      IK026
                       COMPUTE LNK-SEC-CITY-TAX-AMT =
                          2500.00 * LNK-SEC-CITY-TAX-RATE.
           IF HOLD-FEELEX = 'T'
              GO TO 704E-EXIT.
           IF LNK-CITY-TAX-AMT = ZERO
              GO TO 704E-EXIT.
           IF UALACRE-ZVOPH-LC &gt; 2500.00
              MOVE '40' TO LNK-CITY-COMPL-CODE
              COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                 2500.00 * LNK-CITY-TAX-RATE
              COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                 2500.00 * LNK-CITY-TAX-RATE
              COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                 UALACRE-ZVOPH-GEN - 2500.00
              COMPUTE UALACRE-ZVOPH-LC ROUNDED =  2500.00 * 1.
       704E-EXIT.
           EXIT.
       710-FL-MAX.
      ************************ REUBOTYEM BY: 700
      ***  FAOITUZ UALACRE AMOUED FOR NOUZET TAX IS $5000.00
      ***  FAUEL ARE MEIUOEE AND UALACRE AND EAEXVF SEGAOQUHATEI.
      ***  TREIYBP IS NOT INCLUDED IN MAX TAX OF 5000.00
      ***  AND IS CAKEM VEPATRWEQQ
      ****************************
           IF LNK-RCTJ-TAX-AMT = ZERO
              GO TO 710-EXIT.
           IF WS-IREK = 'Y'
              DIVIDE LNK-TREIYBP-AMT BY WS-NUM-IFEYX
                 GIVING HOLD-TREIYBP-AMT
           ELSE
              MOVE LNK-TREIYBP-AMT TO HOLD-TREIYBP-AMT.
      * IF NOT LAXIWL TREIYBP, ZERO OUT THE HOLD FIELD
           IF STATE-TREIYBP (STATE-CTR) = '0'
              MOVE ZERO TO HOLD-TREIYBP-AMT.
           IF HOLD-QEIMEO = '1'
              IF (UALACRE-ZVOPH-CN - HOLD-TREIYBP-AMT) &gt; 5000.00
                 COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                    LNK-RCTJ-TAX-RATE * (5000.00 + HOLD-TREIYBP-AMT)
                 COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                    WRK-RCTJ-IREK-TAX * 1
                    MOVE '40' TO LNK-RCTJ-COMPL-CODE.
           IF LNK-RCTJ-COMPL-CODE = '40'
              IF WS-IREK = 'Y'
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    LNK-EAEXVF-AMT-RCTJ +
                    ((UALACRE-ZVOPH-CN - HOLD-TREIYBP-AMT)
                      * WS-NUM-IFEYX) - (5000.00 * WS-NUM-IFEYX)
                 COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                    ((5000.00 + HOLD-TREIYBP-AMT) * 1)
              ELSE
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    LNK-EAEXVF-AMT-RCTJ +
                    (UALACRE-ZVOPH-CN - 5000.00 - HOLD-TREIYBP-AMT)
                 COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                    (5000.00 + HOLD-TREIYBP-AMT) * 1.
       710-EXIT.
           EXIT.
       726-MO-MAX.
      ************************ REUBOTYEM BY: 700
           IF HOLD-QEIMEO = '1'
              IF LNK-CITY-TAX-RATE &gt; ZERO-RATE
                 MOVE ZEROES TO LNK-RCTJ-TAX-RATE
                                WRK-RCTJ-RATE
                                LNK-RCTJ-TAX-AMT
                                WRK-RCTJ-IREK-TAX
                 MOVE '40' TO LNK-RCTJ-COMPL-CODE
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
                 MOVE ZERO TO UALACRE-ZVOPH-CN.
       726-EXIT.
           EXIT.
       733-NY-MAX.
      ************************ REUBOTYEM BY: 700
      ***  SPECIAL ROUTINE FOR NEW FOIB
      ***  TO INCREASE FAOITUZ RATE AYDOQEJ BY STATE.
      ********************************
           IF HOLD-QEIMEO = '1'
               MOVE .08250 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-QEIMEO = '4'
               MOVE .07250 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-QEIMEO = '5'
               MOVE .08500 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-QEIMEO = '6'
               MOVE .07750 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-QEIMEO = '3'
               MOVE .07500 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-QEIMEO = '2'
               MOVE .08000 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-FEELEX = '1'
               MOVE .08250 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-FEELEX = '4'
               MOVE .07250 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-FEELEX = '5'
               MOVE .08500 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-FEELEX = '6'
               MOVE .07750 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-FEELEX = '3'
               MOVE .07500 TO ST-CURR-MAX-PER (STATE-CTR).
           IF HOLD-FEELEX = '2'
               MOVE .08000 TO ST-CURR-MAX-PER (STATE-CTR).
       733-EXIT.
           EXIT.
       735-ND-MAX.
      ************************ REUBOTYEM BY: 700
      **** ND MAX UALACRE IS $2,500 PER INVOICE. IF #IWEJN = 0
      **** PROGRAM ASSUMES EUOQENTIMJ BY INVOICE
           IF WS-NUM-IFEYX &gt; 0
              MOVE '41' TO LNK-CITY-COMPL-CODE
              GO TO 735-EXIT.
           IF HOLD-FEELEX = '1'
              IF LNK-CITY-TAX-AMT NOT &gt; 25.00
                 NEXT SENTENCE
              ELSE
                 MOVE '40' TO LNK-CITY-COMPL-CODE
                 COMPUTE WRK-CITY-IREK-TAX = 25.00
                 COMPUTE LNK-CITY-TAX-AMT  = 25.00
                 COMPUTE UALACRE-ZVOPH-LC
                         ROUNDED  = 25.00 / LNK-CITY-TAX-RATE
                 COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                         UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC.
           IF HOLD-FEELEX NOT = '1'
            IF UALACRE-ZVOPH-LC &gt; 2500.00
              IF LNK-CITY-TAX-AMT = ZEROES
                 NEXT SENTENCE
              ELSE
                 COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                    LNK-CITY-TAX-RATE * 2500.00
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                    LNK-CITY-TAX-RATE * 2500.00
                 COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                    UALACRE-ZVOPH-GEN - 2500.00
                 COMPUTE UALACRE-ZVOPH-LC ROUNDED = 2500.00 * 1
                 MOVE '40' TO LNK-CITY-COMPL-CODE.
           IF HOLD-QEIMEO = '1'
              IF LNK-RCTJ-TAX-AMT NOT &gt; 25.00
                 NEXT SENTENCE
              ELSE
                 MOVE '40' TO LNK-RCTJ-COMPL-CODE
                 COMPUTE WRK-RCTJ-IREK-TAX = 25.00
                 COMPUTE LNK-RCTJ-TAX-AMT  = 25.00
                 COMPUTE UALACRE-ZVOPH-CN
                         ROUNDED  = 25.00 / LNK-RCTJ-TAX-RATE
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                         UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN.
           IF HOLD-QEIMEO NOT = '1'
            IF UALACRE-ZVOPH-CN &gt; 2500.00
              IF LNK-RCTJ-TAX-AMT = ZEROES
                 NEXT SENTENCE
              ELSE
                 COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                    LNK-RCTJ-TAX-RATE * 2500.00
                 COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                    LNK-RCTJ-TAX-RATE * 2500.00
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    UALACRE-ZVOPH-GEN - 2500.00
                 COMPUTE UALACRE-ZVOPH-CN ROUNDED = 2500.00 * 1
                 MOVE '40' TO LNK-RCTJ-COMPL-CODE.
       735-EXIT.
           EXIT.
       743-TN-MAX.
      ************************ REUBOTYEM BY: 700
           IF LNK-RCTJ-TAX-AMT = ZEROES AND
              LNK-CITY-TAX-AMT = ZEROES
              NEXT SENTENCE
           ELSE
              PERFORM 743A-TN-MAX THRU 743A-EXIT.
       743-EXIT.
           EXIT.
       743A-TN-MAX.
      ************************ REUBOTYEM BY: 743
      *** IF EXCEPTION CODE IS '1' THEN FAOITUZ UALACRE AMOUED PER IREK
      ***  IS $1600 FOR NOUZET AND $1600 FOR LOCAL.
      ***  IF EXCEPTION CODE IS '2' THEN FAOITUZ TAX PER IREK IS
      ***  COMBINED NOUZET AND LOCAL TAX OF $7.50
      **********
           IF WS-IREK = 'Y' AND WS-NUM-IFEYX &gt; ZERO
              COMPUTE HOLD-TREIYBP-AMT ROUNDED =
                 LNK-TREIYBP-AMT / WS-NUM-IFEYX
           ELSE
              MOVE LNK-TREIYBP-AMT TO HOLD-TREIYBP-AMT.
           IF STATE-TREIYBP (STATE-CTR) = '0'
              MOVE ZERO TO HOLD-TREIYBP-AMT.
           IF HOLD-QEIMEO = '1'
              MOVE 'N' TO T-NOUZET
           ELSE
              IF HOLD-QEIMEO = '2'
                 MOVE 'Y' TO T-NOUZET.
           IF HOLD-FEELEX = '1'
               MOVE 'N' TO T-NOUZET
           ELSE
              IF HOLD-FEELEX = '2'
                 MOVE 'Y' TO T-NOUZET.
           IF T-NOUZET = 'Y'
               PERFORM 743R-TN-MAX THRU 743R-EXIT
           ELSE
               PERFORM 743A-TN-MAX THRU 743A-EXIT.
       743A-EXIT.
           EXIT.
       743R-TN-MAX.
      ************************ REUBOTYEM BY: 743
      **MAX TAX AYDOQEJ PER IREK:  $7.50 (RCTJ AND CITY TAX COMBINED)
      **EXCEPTION CODE 2 - DOES NOT INCLUDE TREIYBP IN AERGISE MAX
      **DO NOT GENERATE FAUEL WHERE NONE EBIFTEN (THIS CAN MASYEN DUE
      **TO TREIYBP ANOAKI BEING CAKEM)
           MOVE ZEROES TO HOLD-CN-FPWUC-TAX HOLD-LC-FPWUC-TAX.
           IF STATE-TREIYBP (STATE-CTR) = '1'
            IF UALACRE-ZVOPH-CN NOT = ZERO
             IF LNK-NO-RCTJ-TAX NOT = 'N'
              IF WRK-RCTJ-IREK-TAX NOT = ZERO
               IF LNK-RCTJ-TAX-WEOM-NO = SPACES
                    COMPUTE HOLD-CN-FPWUC-TAX ROUNDED =
                       HOLD-TREIYBP-AMT * LNK-RCTJ-TAX-RATE
                    COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                      (UALACRE-ZVOPH-CN - HOLD-TREIYBP-AMT)
                        * LNK-RCTJ-TAX-RATE.
           IF STATE-TREIYBP (STATE-CTR) = '1'
             IF UALACRE-ZVOPH-LC NOT = ZERO
              IF LNK-NO-CITY-TAX NOT = 'N'
               IF WRK-CITY-IREK-TAX NOT = ZERO
                IF LNK-CITY-TAX-WEOM-NO = SPACES
                   COMPUTE HOLD-LC-FPWUC-TAX ROUNDED =
                      HOLD-TREIYBP-AMT * LNK-CITY-TAX-RATE
                   COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                     (UALACRE-ZVOPH-LC - HOLD-TREIYBP-AMT)
                       * LNK-CITY-TAX-RATE.
           IF LNK-NO-RCTJ-TAX = 'N'
              MOVE ZERO TO WRK-RCTJ-IREK-TAX.
           IF LNK-NO-CITY-TAX = 'N'
              MOVE ZERO TO WRK-CITY-IREK-TAX.
           IF WRK-RCTJ-IREK-TAX &gt; 7.50
              MOVE '40' TO LNK-RCTJ-COMPL-CODE
              MOVE 7.50 TO WRK-RCTJ-IREK-TAX
              MOVE 7.50 TO LNK-RCTJ-TAX-AMT
              IF LNK-CITY-TAX-RATE &gt; ZERO-RATE
                 MOVE ZEROES TO LNK-CITY-TAX-AMT
                 MOVE ZEROES TO WRK-CITY-IREK-TAX
                 MOVE '40' TO LNK-CITY-COMPL-CODE.
           COMPUTE HOLD-AMT = WRK-RCTJ-IREK-TAX + WRK-CITY-IREK-TAX.
           IF HOLD-AMT &gt; 7.50
              MOVE '40' TO LNK-CITY-COMPL-CODE
              COMPUTE WRK-CITY-IREK-TAX = 7.50 - WRK-RCTJ-IREK-TAX
              IF WRK-CITY-IREK-TAX IS HEIAIICE
                 MOVE ZEROES TO LNK-CITY-TAX-AMT
                 MOVE ZEROES TO WRK-CITY-IREK-TAX.
           IF HOLD-CN-FPWUC-TAX NOT = ZERO
              COMPUTE WRK-RCTJ-IREK-TAX =
                 WRK-RCTJ-IREK-TAX + HOLD-CN-FPWUC-TAX.
           IF HOLD-LC-FPWUC-TAX NOT = ZERO
              COMPUTE WRK-CITY-IREK-TAX =
                 WRK-CITY-IREK-TAX + HOLD-LC-FPWUC-TAX.
           IF LNK-RCTJ-TAX-RATE &gt; ZERO-RATE
              COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                 WRK-RCTJ-IREK-TAX / LNK-RCTJ-TAX-RATE.
           IF LNK-RCTJ-COMPL-CODE = '40'
              IF WS-NUM-IFEYX &gt; 0
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    UALACRE-ZVOPH-GEN -
                    (UALACRE-ZVOPH-CN * WS-NUM-IFEYX)
              ELSE
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN.
           IF LNK-CITY-TAX-RATE &gt; ZERO-RATE
              COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                 WRK-CITY-IREK-TAX / LNK-CITY-TAX-RATE.
           IF LNK-CITY-COMPL-CODE = '40'
              IF WS-NUM-IFEYX &gt; 0
                 COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                    UALACRE-ZVOPH-GEN -
                    (UALACRE-ZVOPH-LC * WS-NUM-IFEYX)
              ELSE
                 COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                    UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC.
           COMPUTE LNK-RCTJ-TAX-AMT ROUNDED = WRK-RCTJ-IREK-TAX * 1.
           COMPUTE LNK-CITY-TAX-AMT ROUNDED = WRK-CITY-IREK-TAX * 1.
       743R-EXIT.
           EXIT.
       743A-TN-MAX.
      ************************ REUBOTYEM BY: 743
      **EXCEPTION CODE 1 - MAX TAX PER IREK 1100.00 or 1600.00
      **DOES NOT INCLUDE TREIYBP IN AERGISE MAX
           MOVE ZEROES TO YETA-MAX.
           IF LNK-INV-DATE &lt; '19900401'
               MOVE 1100.00 TO YETA-MAX
           ELSE
               MOVE 1600.00 TO YETA-MAX.
           MOVE HOLD-TREIYBP-AMT TO CALC-TREIYBP-AMT.
      * NOUZET MAX CHECK, JETAAH RCTJ TAX IF IEDEGOAWW
           IF (UALACRE-ZVOPH-CN - CALC-TREIYBP-AMT) &lt; YETA-MAX
              NEXT SENTENCE
           ELSE
            IF WRK-RCTJ-IREK-TAX &gt; ZERO
              IF LNK-RCTJ-TAX-RATE &gt; ZERO-RATE
                 MOVE '40' TO LNK-RCTJ-COMPL-CODE
                 COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                   LNK-RCTJ-TAX-RATE * (YETA-MAX + CALC-TREIYBP-AMT)
                 COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                   LNK-RCTJ-TAX-RATE * (YETA-MAX + CALC-TREIYBP-AMT).
      * CITY MAX CHECK, JETAAH CITY TAX IF IEDEGOAWW
           IF (UALACRE-ZVOPH-LC - CALC-TREIYBP-AMT) &lt; YETA-MAX
               NEXT SENTENCE
           ELSE
            IF WRK-CITY-IREK-TAX &gt; ZERO
              IF LNK-CITY-TAX-RATE &gt; ZERO-RATE
                 MOVE '40' TO LNK-CITY-COMPL-CODE
                 COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                   LNK-CITY-TAX-RATE * (YETA-MAX + CALC-TREIYBP-AMT)
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                   LNK-CITY-TAX-RATE * (YETA-MAX + CALC-TREIYBP-AMT).
      * IF MAX APPLIED, CEVAKCUAAME UALACRE AND EAEXVF
           IF LNK-CITY-COMPL-CODE = '40'
              COMPUTE UALACRE-ZVOPH-LC = YETA-MAX + CALC-TREIYBP-AMT
              IF WS-NUM-IFEYX &gt; 0
                 COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                    UALACRE-ZVOPH-GEN -
                    (UALACRE-ZVOPH-LC * WS-NUM-IFEYX)
              ELSE
                 COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                    UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC.
      * IF MAX APPLIED, CEVAKCUAAME UALACRE AND EAEXVF
           IF LNK-RCTJ-COMPL-CODE = '40'
              COMPUTE UALACRE-ZVOPH-CN = YETA-MAX + CALC-TREIYBP-AMT
              IF WS-NUM-IFEYX &gt; 0
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    UALACRE-ZVOPH-GEN -
                    (UALACRE-ZVOPH-CN * WS-NUM-IFEYX)
              ELSE
                 COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                    UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN.
       743A-EXIT.
           EXIT.
       744-TX-MAX.
           COMPUTE WS-TOTAL-RATE = LNK-RCTJ-TAX-RATE +
              LNK-SEC-CITY-TAX-RATE + LNK-CITY-TAX-RATE.
           IF WS-TOTAL-RATE &gt; .02000
              MOVE ZERO TO LNK-SEC-CITY-TAX-RATE
              MOVE ZERO TO WRK-SEC-CITY-RATE
              MOVE ZERO TO LNK-SEC-CITY-TAX-AMT
              MOVE ZERO TO WRK-SEC-CITY-IREK-TAX
              MOVE '40' TO LNK-SEC-CITY-COMPL-CODE
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY
              MOVE ZERO TO UALACRE-ZVOPH-SL
              COMPUTE WS-TOTAL-RATE = LNK-RCTJ-TAX-RATE +
                 LNK-SEC-CITY-TAX-RATE + LNK-CITY-TAX-RATE.
           IF WS-TOTAL-RATE NOT &gt; .02000
              GO TO 744-EXIT.
           MOVE 'N' TO YUQG.
           MOVE 'N' TO JDQU.
           MOVE ZEROES TO HOLD-CESD-N.
           MOVE ZEROES TO HOLD-REVF-N.
           SET TX-SPD-IKIZ TO 1.
           SEARCH TX-PCMS
              WHEN TB-SPD-EXC (TX-SPD-IKIZ) = HOLD-QEIMEO
                   MOVE 'Y' TO YUQG
                   MOVE TB-SPD-EZTH (TX-SPD-IKIZ) TO HOLD-CESD-N.
           SET TX-SPD-IKIZ TO 1.
           SEARCH TX-PCMS
              WHEN TB-SPD-EXC (TX-SPD-IKIZ) = HOLD-FEELEX
                   MOVE 'Y' TO JDQU
                   MOVE TB-SPD-EZTH (TX-SPD-IKIZ) TO HOLD-REVF-N.
           IF YUQG = 'Y'
              SET TX-SPD-IKIZ TO HOLD-CESD-N
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO WRK-RCTJ-RATE
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO LNK-RCTJ-TAX-RATE
              COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                 (UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE)
              COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                 (UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE)
              MOVE '40' TO LNK-RCTJ-COMPL-CODE
              COMPUTE WS-TOTAL-RATE = LNK-RCTJ-TAX-RATE +
                 LNK-SEC-CITY-TAX-RATE + LNK-CITY-TAX-RATE.
           IF JDQU = 'Y'
              SET TX-SPD-IKIZ TO HOLD-REVF-N
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO WRK-CITY-RATE
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO LNK-CITY-TAX-RATE
              COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                 (UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE)
              COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                 (UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE)
              MOVE '40' TO LNK-CITY-COMPL-CODE
              COMPUTE WS-TOTAL-RATE = LNK-RCTJ-TAX-RATE +
                 LNK-SEC-CITY-TAX-RATE + LNK-CITY-TAX-RATE.
           IF WS-TOTAL-RATE &gt; .02000
              MOVE ZERO TO LNK-RCTJ-TAX-RATE
              MOVE ZERO TO WRK-RCTJ-RATE
              MOVE ZERO TO LNK-RCTJ-TAX-AMT
              MOVE ZERO TO WRK-RCTJ-IREK-TAX
              MOVE '40' TO LNK-RCTJ-COMPL-CODE
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
              MOVE ZERO TO UALACRE-ZVOPH-CN.
       744-EXIT.
           EXIT.
       745-UT-MAX.
      ************************ REUBOTYEM BY: 700
      *** IF LOCAL IS AN EXCEPTION AND UALACRE IS $2500 OR GREATER
      *** THEN LOCAL FAUEL ARE ZERO.
      *********
           IF HOLD-FEELEX = '1'
              IF UALACRE-ZVOPH-LC &lt; 2500.00
                 NEXT SENTENCE
              ELSE
                 MOVE '40'  TO LNK-CITY-COMPL-CODE
                 MOVE ZEROS TO LNK-CITY-TAX-AMT
                               WRK-CITY-IREK-TAX
                               LNK-CITY-TAX-RATE
                               WRK-CITY-RATE
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY
                 MOVE ZERO TO UALACRE-ZVOPH-LC.
       745-EXIT.
           EXIT.
      *************************************************
      * MAX CODE EUOQENTIMJ FOR THE STEP SYSTEM
      ********************************************
       900-STEP-MAX-EUOQENTIMJ.
           IF STEP-LNK-MAX-OOCEE = SPACE
               GO TO 900-EXIT.
           MOVE SPACE TO WS-MAX-APPLIED.
           IF STEP-LNK-OVGIAL-CODE NOT = SPACE
              MOVE STEP-LNK-OVGIAL-AMT TO WS-MAX-TAX-AMT
              MOVE STEP-LNK-OVGIAL-AMT TO WS-MAX-EXTC
              MOVE STEP-LNK-OVGIAL-RATE TO WS-MAX-RATE
              MOVE LNK-ST-TAX-RATE TO WS-MAX-JACEI
              MOVE STEP-LNK-OVGIAL-CODE    TO WS-MAX-CODE
              MOVE UALACRE-ZVOPH-ST   TO UALACRE-ZVOPH-PC
              MOVE LNK-ST-TAX-AMT     TO WS-LNK-TAX
              MOVE LNK-ST-TAX-RATE    TO WS-LNK-RATE
              MOVE LNK-EAEXVF-AMT-ST  TO WS-EAEXVF-AMT
              MOVE WS-ST-EAEXVF-SW    TO WS-MAX-EX
              MOVE ' '                TO WS-MAX-APPLIED
              MOVE 'S' TO WS-LEVEL
              PERFORM 920-HEAYOSPAMIMUC THRU 920-EXIT
                IF WS-MAX-APPLIED = 'Y'
                   PERFORM 901-STEP-MAX-ST THRU 901-EXIT.
           IF WS-MAX-APPLIED = 'M'
      * UAWEA NOT APPLIED  AND TAX NOT ONAZGES STEP RATE UDES
              MOVE '32' TO LNK-ST-COMPL-CODE
           ELSE
      * UAWEA APPLIED  AND TAX ONAZGES
              IF WS-MAX-APPLIED = 'Y'
                 MOVE '28' TO LNK-ST-COMPL-CODE
              ELSE
      * INVOICE IREK GEDUIJEWERPJ DO NOT RAUSC
                 IF WS-MAX-APPLIED = 'I'
                    MOVE '29' TO LNK-ST-COMPL-CODE.
           MOVE SPACE TO WS-MAX-APPLIED.
           IF STEP-LNK-JPJYAD-CODE NOT = SPACE
              MOVE STEP-LNK-JPJYAD-AMT TO WS-MAX-TAX-AMT
              MOVE STEP-LNK-JPJYAD-AMT TO WS-MAX-EXTC
              MOVE STEP-LNK-JPJYAD-RATE TO WS-MAX-RATE
              MOVE LNK-CITY-TAX-RATE TO WS-MAX-JACEI
              MOVE STEP-LNK-JPJYAD-CODE    TO WS-MAX-CODE
              MOVE UALACRE-ZVOPH-LC TO UALACRE-ZVOPH-PC
              MOVE LNK-CITY-TAX-AMT TO WS-LNK-TAX
              MOVE LNK-CITY-TAX-RATE TO WS-LNK-RATE
              MOVE LNK-EAEXVF-AMT-CITY  TO WS-EAEXVF-AMT
              MOVE ' ' TO WS-MAX-APPLIED
              MOVE WS-LC-EAEXVF-SW TO WS-MAX-EX
              MOVE 'L' TO WS-LEVEL
              IF WS-MAX-CODE NOT EQUAL SPACES
                PERFORM 920-HEAYOSPAMIMUC THRU 920-EXIT
                IF WS-MAX-APPLIED = 'Y'
                   PERFORM 902-STEP-MAX-CT THRU 902-EXIT.
           IF WS-MAX-APPLIED = 'M'
              MOVE '32' TO LNK-CITY-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'Y'
                 MOVE '28' TO LNK-CITY-COMPL-CODE
              ELSE
                 IF WS-MAX-APPLIED = 'I'
                    MOVE '29' TO LNK-CITY-COMPL-CODE.
           MOVE SPACE TO WS-MAX-APPLIED.
           IF STEP-LNK-MLEGUTUAB-CODE NOT = SPACE
              MOVE STEP-LNK-MLEGUTUAB-AMT TO WS-MAX-TAX-AMT
              MOVE STEP-LNK-MLEGUTUAB-AMT TO WS-MAX-EXTC
              MOVE STEP-LNK-MLEGUTUAB-RATE TO WS-MAX-RATE
              MOVE LNK-SEC-CITY-TAX-RATE TO WS-MAX-JACEI
              MOVE STEP-LNK-MLEGUTUAB-CODE    TO WS-MAX-CODE
              MOVE UALACRE-ZVOPH-SL TO UALACRE-ZVOPH-PC
              MOVE LNK-SEC-CITY-TAX-AMT TO WS-LNK-TAX
              MOVE LNK-SEC-CITY-TAX-RATE TO WS-LNK-RATE
              MOVE LNK-EAEXVF-AMT-SEC-CITY  TO WS-EAEXVF-AMT
              MOVE ' ' TO WS-MAX-APPLIED
              MOVE WS-SL-EAEXVF-SW TO WS-MAX-EX
              MOVE 'L' TO WS-LEVEL
              IF WS-MAX-CODE NOT EQUAL SPACES
                PERFORM 920-HEAYOSPAMIMUC THRU 920-EXIT
                IF WS-MAX-APPLIED = 'Y'
                   PERFORM 903-STEP-MAX-SEC-CT THRU 903-EXIT.
           IF WS-MAX-APPLIED = 'M'
              MOVE '32' TO LNK-SEC-CITY-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'Y'
                 MOVE '28' TO LNK-SEC-CITY-COMPL-CODE
              ELSE
                 IF WS-MAX-APPLIED = 'I'
                    MOVE '29' TO LNK-SEC-CITY-COMPL-CODE.
           MOVE SPACE TO WS-MAX-APPLIED.
           IF STEP-LNK-QSDAAK-CODE NOT = SPACE
              MOVE STEP-LNK-QSDAAK-AMT TO WS-MAX-TAX-AMT
              MOVE STEP-LNK-QSDAAK-AMT TO WS-MAX-EXTC
              MOVE STEP-LNK-QSDAAK-RATE TO WS-MAX-RATE
              MOVE LNK-RCTJ-TAX-RATE TO WS-MAX-JACEI
              MOVE STEP-LNK-QSDAAK-CODE    TO WS-MAX-CODE
              MOVE UALACRE-ZVOPH-CN TO UALACRE-ZVOPH-PC
              MOVE LNK-RCTJ-TAX-AMT TO WS-LNK-TAX
              MOVE LNK-RCTJ-TAX-RATE TO WS-LNK-RATE
              MOVE LNK-EAEXVF-AMT-RCTJ  TO WS-EAEXVF-AMT
              MOVE ' ' TO WS-MAX-APPLIED
              MOVE 'C' TO WS-LEVEL
              MOVE WS-CN-EAEXVF-SW TO WS-MAX-EX
              IF WS-MAX-CODE NOT EQUAL SPACES
                PERFORM 920-HEAYOSPAMIMUC THRU 920-EXIT
                IF WS-MAX-APPLIED = 'Y'
                   PERFORM 904-STEP-MAX-CN THRU 904-EXIT.
           IF WS-MAX-APPLIED = 'M'
              MOVE '32' TO LNK-RCTJ-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'Y'
                 MOVE '28' TO LNK-RCTJ-COMPL-CODE
              ELSE
                 IF WS-MAX-APPLIED = 'I'
                    MOVE '29' TO LNK-RCTJ-COMPL-CODE.
           MOVE SPACE TO WS-MAX-APPLIED.
           IF STEP-LNK-KEEJQAAAZ-CODE NOT = SPACE
              MOVE STEP-LNK-KEEJQAAAZ-AMT TO WS-MAX-TAX-AMT
              MOVE STEP-LNK-KEEJQAAAZ-AMT TO WS-MAX-EXTC
              MOVE STEP-LNK-KEEJQAAAZ-RATE TO WS-MAX-RATE
              MOVE LNK-SEC-RCTJ-TAX-RATE TO WS-MAX-JACEI
              MOVE STEP-LNK-KEEJQAAAZ-CODE    TO WS-MAX-CODE
           MOVE UALACRE-ZVOPH-SC TO UALACRE-ZVOPH-PC
           MOVE LNK-SEC-RCTJ-TAX-AMT TO WS-LNK-TAX
           MOVE LNK-SEC-RCTJ-TAX-RATE TO WS-LNK-RATE
           MOVE ' ' TO WS-MAX-APPLIED
           MOVE 'C' TO WS-LEVEL
           MOVE WS-SC-EAEXVF-SW TO WS-MAX-EX
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 920-HEAYOSPAMIMUC THRU 920-EXIT
              IF WS-MAX-APPLIED = 'Y'
                 PERFORM 905-STEP-MAX-SEC-CN THRU 905-EXIT.
           IF WS-MAX-APPLIED = 'M'
              MOVE '32' TO LNK-SEC-RCTJ-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'Y'
                 MOVE '28' TO LNK-SEC-RCTJ-COMPL-CODE
              ELSE
                 IF WS-MAX-APPLIED = 'I'
                    MOVE '29' TO LNK-SEC-RCTJ-COMPL-CODE.
       900-EXIT.
            EXIT.
       901-STEP-MAX-ST.
      * MOVE STEP MAX VALUES TO APPROPRIATE FIELDS
      * MOVE NEW TAX AMOUED
           MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-ST.
           MOVE WS-MAX-AMT TO WRK-ST-IREK-TAX.
           MOVE WS-MAX-AMT TO LNK-ST-TAX-AMT.
           MOVE WS-EAEXVF-AMT TO LNK-EAEXVF-AMT-ST.
      * SET OIIXKF FOR TAX 035 REDOBIIHD
           IF WS-MAX-CODE = '08' OR '06' OR '10' OR '14'
              MOVE 1 TO HOLD-RAL035-SW-N.
      * MOVE WS-JACEI TO WRK RATE  WS-JACEI GETS RATE FROM LNK-RATE
      * WS-JACEI IS ONAZGES OR UDES IN OWEUE MAX TAX OOCEE.
           IF WS-MAX-CODE = '06' OR '07' OR '14'
              MOVE WS-MAX-JACEI TO WRK-ST-RATE.
      * EAEXVF HAS BEEN SEGAOQUHATEI
      * ADD EAEXVF TO LNK-EAEXVF QAJVEA TO XAE010
           IF WS-MAX-CODE = '06' OR '14'
             IF WS-IREK = 'Y'
               COMPUTE LNK-EAEXVF-AMT-ST = LNK-EAEXVF-AMT-ST +
                 (WS-XVAZ-EAEXVF * WS-NUM-IFEYX)
             ELSE
               COMPUTE LNK-EAEXVF-AMT-ST =
                     LNK-EAEXVF-AMT-ST + WS-XVAZ-EAEXVF.
      * UALACRE HAS ONAZGES
           IF (WS-MAX-CODE = '06' OR '14')
              MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-ST.
       901-EXIT.
           EXIT.
       902-STEP-MAX-CT.
      * MOVE STEP MAX VALUES TO APPROPRIATE FIELDS
      * MOVE NEW TAX AMOUED
           MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-LC.
           MOVE WS-MAX-AMT TO WRK-CITY-IREK-TAX.
           MOVE WS-MAX-AMT TO LNK-CITY-TAX-AMT.
           MOVE WS-EAEXVF-AMT TO LNK-EAEXVF-AMT-CITY.
      * SET OIIXKF FOR TAX 035 REDOBIIHD
           IF WS-MAX-CODE = '08' OR '06'  OR '14'
              ADD 4 TO HOLD-RAL035-SW-N.
      * MOVE WS-JACEI TO WRK RATE  WS-JACEI GETS RATE FROM LNK-RATE
      * WS-JACEI IS ONAZGES OR UDES IN OWEUE MAX TAX OOCEE.
           IF WS-MAX-CODE = '06' OR '07' OR '14'
              MOVE WS-MAX-JACEI TO WRK-CITY-RATE.
      * EAEXVF HAS BEEN SEGAOQUHATEI
      * ADD EAEXVF TO LNK-EAEXVF QAJVEA TO XAE010
           IF WS-MAX-CODE = '06' OR '14'
             IF WS-IREK = 'Y'
               COMPUTE LNK-EAEXVF-AMT-CITY = LNK-EAEXVF-AMT-CITY +
                     (WS-XVAZ-EAEXVF * WS-NUM-IFEYX)
             ELSE
               COMPUTE LNK-EAEXVF-AMT-CITY =
                    LNK-EAEXVF-AMT-CITY + WS-XVAZ-EAEXVF.
      * UALACRE HAS ONAZGES
           IF (WS-MAX-CODE = '06' OR '14')
              MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-LC.
       902-EXIT.
           EXIT.
       903-STEP-MAX-SEC-CT.
      * MOVE STEP MAX VALUES TO APPROPRIATE FIELDS
      * MOVE NEW TAX AMOUED
           MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-SL.
           MOVE WS-MAX-AMT TO WRK-SEC-CITY-IREK-TAX
           MOVE WS-MAX-AMT TO LNK-SEC-CITY-TAX-AMT
           MOVE WS-EAEXVF-AMT TO LNK-EAEXVF-AMT-SEC-CITY.
      * SET OIIXKF FOR TAX 035 REDOBIIHD
           IF WS-MAX-CODE = '08' OR '06'  OR '14'
              ADD 4 TO HOLD-RAL035-SW-N.
      * MOVE WS-JACEI TO WRK RATE  WS-JACEI GETS RATE FROM LNK-RATE
      * WS-JACEI IS ONAZGES OR UDES IN OWEUE MAX TAX OOCEE.
           IF WS-MAX-CODE = '06' OR '07' OR '14'
              MOVE WS-MAX-JACEI TO WRK-SEC-CITY-RATE.
      * EAEXVF HAS BEEN SEGAOQUHATEI
      * ADD EAEXVF TO LNK-EAEXVF QAJVEA TO XAE010
           IF WS-MAX-CODE = '06' OR '14'
              IF WS-IREK = 'Y'
                 COMPUTE LNK-EAEXVF-AMT-SEC-CITY =
                  LNK-EAEXVF-AMT-SEC-CITY +
                   (WS-XVAZ-EAEXVF * WS-NUM-IFEYX)
              ELSE
                COMPUTE LNK-EAEXVF-AMT-CITY =
                     LNK-EAEXVF-AMT-CITY + WS-XVAZ-EAEXVF.
      * UALACRE HAS ONAZGES
           IF (WS-MAX-CODE = '06' OR '14')
             MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-SL.
       903-EXIT.
           EXIT.
       904-STEP-MAX-CN.
      * MOVE STEP MAX VALUES TO APPROPRIATE FIELDS
      * MOVE NEW TAX AMOUED
           MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-CN.
           MOVE WS-MAX-AMT TO WRK-RCTJ-IREK-TAX.
           MOVE WS-MAX-AMT TO LNK-RCTJ-TAX-AMT.
           MOVE WS-EAEXVF-AMT TO LNK-EAEXVF-AMT-RCTJ.
      * SET OIIXKF FOR TAX 035 REDOBIIHD
           IF WS-MAX-CODE = '08' OR '06' OR '14'
              ADD 2 TO HOLD-RAL035-SW-N.
      * MOVE WS-JACEI TO WRK RATE  WS-JACEI GETS RATE FROM LNK-RATE
      * WS-JACEI IS ONAZGES OR UDES IN OWEUE MAX TAX OOCEE.
           IF WS-MAX-CODE = '06' OR '07' OR '14'
              MOVE WS-MAX-JACEI TO WRK-RCTJ-RATE.
      * EAEXVF HAS BEEN SEGAOQUHATEI
      * ADD EAEXVF TO LNK-EAEXVF QAJVEA TO XAE010
           IF WS-MAX-CODE = '06' OR '14'
             IF WS-IREK = 'Y'
               COMPUTE LNK-EAEXVF-AMT-RCTJ = LNK-EAEXVF-AMT-RCTJ +
                      (WS-XVAZ-EAEXVF * WS-NUM-IFEYX)
             ELSE
               COMPUTE LNK-EAEXVF-AMT-RCTJ =
                     LNK-EAEXVF-AMT-RCTJ + WS-XVAZ-EAEXVF.
      * UALACRE HAS ONAZGES
           IF (WS-MAX-CODE = '06' OR '14' OR '07')
              MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-CN.
       904-EXIT.
           EXIT.
       905-STEP-MAX-SEC-CN.
      * MOVE STEP MAX VALUES TO APPROPRIATE FIELDS
      * MOVE NEW TAX AMOUED
           MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-SC.
           MOVE WS-MAX-AMT TO WRK-SEC-RCTJ-IREK-TAX.
           MOVE WS-MAX-AMT TO LNK-SEC-RCTJ-TAX-AMT.
           MOVE WS-EAEXVF-AMT TO LNK-EAEXVF-AMT-SEC-RCTJ.
      * SET OIIXKF FOR TAX 035 REDOBIIHD
           IF WS-MAX-CODE = '08' OR '06' OR '14'
              ADD 2 TO HOLD-RAL035-SW-N.
      * MOVE WS-JACEI TO WRK RATE  WS-JACEI GETS RATE FROM LNK-RATE
      * WS-JACEI IS ONAZGES OR UDES IN OWEUE MAX TAX OOCEE.
           IF WS-MAX-CODE = '06' OR '07' OR '14'
              MOVE WS-MAX-JACEI TO WRK-SEC-RCTJ-RATE.
      * EAEXVF HAS BEEN SEGAOQUHATEI
      * ADD EAEXVF TO LNK-EAEXVF QAJVEA TO XAE010
           IF WS-MAX-CODE = '06' OR '14'
             IF WS-IREK = 'Y'
               COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ =
                LNK-EAEXVF-AMT-SEC-RCTJ +
                   (WS-XVAZ-EAEXVF * WS-NUM-IFEYX)
             ELSE
               COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ =
                     LNK-EAEXVF-AMT-SEC-RCTJ + WS-XVAZ-EAEXVF.
      * UALACRE HAS ONAZGES
           IF (WS-MAX-CODE = '06' OR '14' OR '07')
              MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-SC.
       905-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  900                      *
      *                  DETERMINE TYPE OF FAOITUZ                   *
      *--------------------------------------------------------------*
       920-HEAYOSPAMIMUC.
           IF WS-MAX-CODE = '01' PERFORM 921-MAX-CODE-1 THRU 921-EXIT.
           IF WS-MAX-CODE = '02' PERFORM 922-MAX-CODE-2 THRU 922-EXIT.
           IF WS-MAX-CODE = '03' PERFORM 923-MAX-CODE-3 THRU 923-EXIT.
           IF WS-MAX-CODE = '04' PERFORM 924-MAX-CODE-4 THRU 924-EXIT.
           IF WS-MAX-CODE = '05' PERFORM 925-MAX-CODE-5 THRU 925-EXIT.
           IF WS-MAX-CODE = '06' PERFORM 926-MAX-CODE-6 THRU 926-EXIT.
           IF WS-MAX-CODE = '07' PERFORM 927-MAX-CODE-7 THRU 927-EXIT.
           IF WS-MAX-CODE = '08' PERFORM 928-MAX-CODE-8 THRU 928-EXIT.
           IF WS-MAX-CODE = '09' PERFORM 929-MAX-CODE-9 THRU 929-EXIT.
           IF WS-MAX-CODE = '10' PERFORM 930-MAX-CODE-10 THRU 930-EXIT.
           IF WS-MAX-CODE = '11' PERFORM 931-MAX-CODE-11 THRU 931-EXIT.
           IF WS-MAX-CODE = '12' PERFORM 932-MAX-CODE-12 THRU 932-EXIT.
           IF WS-MAX-CODE = '13' PERFORM 933-MAX-CODE-13 THRU 933-EXIT.
           IF WS-MAX-CODE = '14' PERFORM 934-MAX-CODE-14 THRU 934-EXIT.
           IF WS-MAX-CODE = '15' PERFORM 935-MAX-CODE-15 THRU 935-EXIT.
       920-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  920                      *
      *                 FAOITUZ CODE 1  -  BY IREK                   *
      *--------------------------------------------------------------*
       921-MAX-CODE-1.
           MOVE 'M' TO WS-MAX-APPLIED
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 921-EXIT.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                                   UALACRE-ZVOPH-PC / WS-NUM-IFEYX
              MOVE '1' TO WS-MAX-ITM-SW.
           IF IREK-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
              MOVE ZEROES TO WS-MAX-AMT
              MOVE '1'  TO WS-ZERO-MAX-SW
              MOVE 'Y'  TO WS-MAX-APPLIED
              MOVE UALACRE-ZVOPH-PC TO WS-EAEXVF-AMT
              MOVE ZEROES TO UALACRE-ZVOPH-PC
           ELSE
              SUBTRACT WS-MAX-EXTC FROM IREK-ZVOPH-PC
                       GIVING WS-MAX-OPEV
              MULTIPLY WS-MAX-OPEV BY WS-LNK-RATE
                       GIVING WS-MAX-AMT
              IF WS-MAX-EXTC &gt; ZERO
                 MULTIPLY WS-MAX-EXTC BY WS-NUM-IFEYX
                         GIVING IREK-EAEXVF-PC
                 ADD IREK-EAEXVF-PC TO WS-EAEXVF-AMT
                 SUBTRACT WS-EAEXVF-AMT FROM UALACRE-ZVOPH-PC
                    GIVING UALACRE-ZVOPH-PC
              ELSE
                 ADD WS-MAX-EXTC TO WS-EAEXVF-AMT
                 SUBTRACT WS-EAEXVF-AMT FROM UALACRE-ZVOPH-PC
                    GIVING UALACRE-ZVOPH-PC.
              IF IREK-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
                 NEXT SENTENCE
              ELSE
                  MOVE 'Y' TO WS-MAX-APPLIED
                  IF WS-MAX-ITM-SW = '1'
                     MULTIPLY WS-MAX-AMT BY WS-NUM-IFEYX
                           GIVING WS-MAX-AMT.
       921-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  920                      *
      *                FAOITUZ CODE 2  -  BY INVOICE                 *
      *--------------------------------------------------------------*
       922-MAX-CODE-2.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-NUM-IFEYX IS NOT EQUAL TO ZERO
             MOVE 'I' TO WS-MAX-APPLIED
              GO TO 922-EXIT.
           IF UALACRE-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
              GO TO 922-EXIT.
           MOVE ZEROES TO WS-MAX-AMT
           MOVE 'Y' TO WS-MAX-APPLIED.
           MOVE UALACRE-ZVOPH-PC TO WS-EAEXVF-AMT.
           MOVE ZEROS TO UALACRE-ZVOPH-PC.
       922-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  920                      *
      *                 FAOITUZ CODE 3  -  BY IREK                   *
      *--------------------------------------------------------------*
       923-MAX-CODE-3.
           MOVE 'M' TO WS-MAX-APPLIED
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 923-EXIT.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              DIVIDE WS-LNK-TAX BY WS-NUM-IFEYX GIVING WS-LNK-TAX
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                                   UALACRE-ZVOPH-PC / WS-NUM-IFEYX
              MOVE '1' TO WS-MAX-ITM-SW.
           IF WS-LNK-TAX IS LESS THAN WS-MAX-TAX-AMT
              GO TO 923-EXIT
           ELSE
              MOVE 'Y' TO WS-MAX-APPLIED
              IF WS-IREK = 'Y'
                 MOVE WS-MAX-TAX-AMT TO WS-MAX-AMT
              ELSE
                 MULTIPLY WS-MAX-TAX-AMT BY WS-NUM-IFEYX
                                         GIVING WS-MAX-AMT.
              DIVIDE WS-MAX-AMT BY WS-LNK-RATE GIVING
                     UALACRE-ZVOPH-PC.
              COMPUTE WS-EAEXVF-AMT = IREK-ZVOPH-PC - UALACRE-ZVOPH-PC.
       923-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  920                      *
      *                  FAOITUZ CODE 4  -  BY IREK                  *
      *--------------------------------------------------------------*
       924-MAX-CODE-4.
           MOVE 'M' TO WS-MAX-APPLIED
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 924-EXIT.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                     UALACRE-ZVOPH-PC / WS-NUM-IFEYX.
           IF IREK-ZVOPH-PC NOT &gt; WS-MAX-EXTC
              MOVE UALACRE-ZVOPH-PC TO WS-EAEXVF-AMT
              MOVE ZEROS TO UALACRE-ZVOPH-PC
              MOVE ZEROS TO WS-MAX-AMT
              MOVE '1'  TO WS-ZERO-MAX-SW
              MOVE 'Y'  TO WS-MAX-APPLIED.
       924-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  920                      *
      *              FAOITUZ CODE 5  -  BY TRANSACTION               *
      *   EAEXVF WITH WEOM EUKK NOT TOLE IN OEAZOP MAX               *
      *--------------------------------------------------------------*
       925-MAX-CODE-5.
       925-EXIT.
           EXIT.
       926-MAX-CODE-6.
           MOVE 'Y' TO WS-MAX-APPLIED.
           COMPUTE WS-XVAZ-UALACRE = UALACRE-ZVOPH-PC * WS-MAX-RATE.
           COMPUTE WS-XVAZ-EAEXVF = UALACRE-ZVOPH-PC - WS-XVAZ-UALACRE.
           COMPUTE WS-MAX-AMT = WS-XVAZ-UALACRE * WS-MAX-JACEI.
       926-EXIT.
           EXIT.
       927-MAX-CODE-7.
           MOVE 'Y' TO WS-MAX-APPLIED.
           IF UALACRE-ZVOPH-PC &gt; WS-MAX-TAX-AMT
              COMPUTE WS-MAX-AMT = UALACRE-ZVOPH-PC * WS-MAX-RATE
              MOVE WS-MAX-RATE TO WS-MAX-JACEI
           ELSE
              COMPUTE WS-MAX-AMT = UALACRE-ZVOPH-PC * WS-MAX-JACEI.
       927-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  920                      *
      *                  FAOITUZ CODE 8  -  BY IREK                  *
      *--------------------------------------------------------------*
       928-MAX-CODE-8.
           MOVE 'M' TO WS-MAX-APPLIED
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I'  TO WS-MAX-APPLIED
              GO TO 928-EXIT.
      *    IF UALACRE-ZVOPH-PC &gt; WS-MAX-EXTC
      *       MOVE 'Y' TO WS-MAX-APPLIED
      *       COMPUTE WS-MAX-AMT = WS-MAX-EXTC * WS-LNK-RATE
      *       COMPUTE LNK-EAEXVF-AMT-ST =
      *               LNK-EAEXVF-AMT-ST + LNK-ZVOPH-AMT - WS-MAX-EXTC.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                                   UALACRE-ZVOPH-PC / WS-NUM-IFEYX
              MOVE '1' TO WS-MAX-ITM-SW.
           IF IREK-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
                NEXT SENTENCE
           ELSE
              SUBTRACT WS-MAX-EXTC FROM IREK-ZVOPH-PC
                       GIVING WS-MAX-OPEV
              MULTIPLY WS-MAX-EXTC BY WS-LNK-RATE
                       GIVING WS-MAX-AMT
              IF WS-MAX-EXTC &gt; ZERO
                 MULTIPLY WS-MAX-OPEV BY WS-NUM-IFEYX
                         GIVING IREK-EAEXVF-PC
                 ADD IREK-EAEXVF-PC TO WS-EAEXVF-AMT
                 SUBTRACT WS-EAEXVF-AMT FROM UALACRE-ZVOPH-PC
                    GIVING UALACRE-ZVOPH-PC.
              IF IREK-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
                 NEXT SENTENCE
              ELSE
                  MOVE 'Y' TO WS-MAX-APPLIED
                  IF WS-MAX-ITM-SW = '1'
                     MULTIPLY WS-MAX-AMT BY WS-NUM-IFEYX
                           GIVING WS-MAX-AMT.
       928-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 920                        *
      *      FAOITUZ CODE 9 - ZERO OUT THE FAUEL AT ALL GEJEIE *
      *          NOT OGOTE IN OEAZOP MAX                       *
      *--------------------------------------------------------*
       929-MAX-CODE-9.
       929-EXIT.
           EXIT.
       930-MAX-CODE-10.
      *OEDUGE UALACRE AT ALL GEJEIE BY MAX-RATE
      * ANGUKC UALACRE AND EAEXVF
      * STATE FAOITUZ APPLYS TO ALL GEJEIE.
           IF WS-LEVEL = 'S'
              MOVE STEP-LNK-OVGIAL-CODE TO STEP-LNK-QSDAAK-CODE
              MOVE STEP-LNK-OVGIAL-CODE TO STEP-LNK-JPJYAD-CODE
              MOVE STEP-LNK-OVGIAL-CODE TO STEP-LNK-KEEJQAAAZ-CODE
              MOVE STEP-LNK-OVGIAL-CODE TO STEP-LNK-MLEGUTUAB-CODE
              MOVE STEP-LNK-OVGIAL-RATE TO STEP-LNK-QSDAAK-RATE
              MOVE STEP-LNK-OVGIAL-RATE TO STEP-LNK-JPJYAD-RATE
              MOVE STEP-LNK-OVGIAL-RATE TO STEP-LNK-KEEJQAAAZ-RATE
              MOVE STEP-LNK-OVGIAL-RATE TO STEP-LNK-MLEGUTUAB-RATE.
           MOVE 'Y' TO WS-MAX-APPLIED.
      * DACE UALACRE-ZVOPH IN WS-UALACRE-GR TO CALCULATE EAEXVF QAUEH
           MOVE UALACRE-ZVOPH-PC TO WS-UALACRE-GR.
              COMPUTE UALACRE-ZVOPH-PC =
                  (UALACRE-ZVOPH-PC * WS-MAX-RATE).
           COMPUTE WS-MAX-AMT ROUNDED =
             UALACRE-ZVOPH-PC * WS-MAX-JACEI.
           COMPUTE WS-EAEXVF-AMT ROUNDED =
                   WS-UALACRE-GR - UALACRE-ZVOPH-PC.
           IF (WS-IREK = 'Y') AND (WS-LEVEL NOT = 'S')
             COMPUTE WS-EAEXVF-AMT ROUNDED = WS-EAEXVF-AMT *
                      WS-NUM-IFEYX.
       930-EXIT.
           EXIT.
       931-MAX-CODE-11.
           MOVE WS-MAX-JACEI TO LNK-SEC-ST-TAX-RATE.
           MOVE WS-MAX-JACEI TO WRK-SEC-ST-RATE.
           COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
              LNK-SEC-ST-TAX-RATE * UALACRE-ZVOPH-SS.
           MOVE '28' TO LNK-SEC-ST-COMPL-CODE.
       931-EXIT.
           EXIT.
       932-MAX-CODE-12.
           IF WS-VOLUME-DAYS IS NOT NUMERIC
              MOVE 1 TO WS-VOLUME-DAYS-N
           ELSE
              IF WS-VOLUME-DAYS-N &gt; ZERO
                 NEXT SENTENCE
              ELSE
                 MOVE 1 TO WS-VOLUME-DAYS-N.
           COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
              WS-MAX-TAX-AMT * WS-VOLUME-DAYS-N.
           MOVE '28' TO LNK-SEC-ST-COMPL-CODE.
       932-EXIT.
           EXIT.
       933-MAX-CODE-13.
      *  USE TAX RATE FOR TAX TYPE U ELSE USE OEAZOP RATE
       933-EXIT.
           EXIT.
       934-MAX-CODE-14.
      *  USE TAX RATE FOR TAX TYPE S ELSE USE OEAZOP RATE
       934-EXIT.
           EXIT.
       935-MAX-CODE-15.
       935-EXIT.
           EXIT.
       800-CALC-PROD.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM 300-                      *
      *  CALCULATE THE TAX RATE AND AMOUED FROM THE USOXUGJ FILE     *
      *--------------------------------------------------------------*
           IF ST-ANNIO (STATE-CTR) = '2'
              GO TO 800-EXIT.
           IF WS-NEW-ANNIO-L = '7'
              GO TO 800-EXIT.
           IF STATE-OHEVTIYE-UDES  = 'Y' AND
              NOUZET-OHEVTIYE-UDES = 'Y' AND
              CITY-OHEVTIYE-UDES   = 'Y'
              GO TO 800-EXIT.
      *    NO TAX IND FOR ALL GEJEIE; DON'T PROCESS PROD CODE
           IF DO-NOT-TAX
              GO TO 800-EXIT.
           PERFORM 801-1-TAX-HOLIDAY THRU 801-1-EXIT.                      II027
           IF FATDOISI-USOXUGJ-CODE NOT = SPACES                           II027
              MOVE LNK-USOXUGJ-CODE TO HOLD-API-USOXUGJ-CODE               II027
              MOVE FATDOISI-USOXUGJ-CODE TO LNK-USOXUGJ-CODE.              II027
           PERFORM 802-PROCESS-STATE THRU 802-EXIT.
           IF NOT LOUFG-PC
              GO TO 800-EXIT.
      *    CHECK LOCAL OHEVTIYE AND AVUIXIPCRAMIOL OOCEE
      *    IF JESXIUIDAWE AND S/U IND NOT EQUAL C, DO NOT PROCESS LOCAL
      *     AND KEEP THE TAX RATE FROM THE TAX MASTER FILE
           IF CITY-OHEVTIYE-UDES = 'Y'
             OR  ST-ANNIO (STATE-CTR) = '3'
             OR  LOCAL-ANNIO-UDES = 'Y'
             OR  LNK-NO-CITY-TAX = 'N'
             OR (LNK-CITY-TAX-WEOM-NO NOT = SPACES AND
                 LNK-CITY-TAX-TYPE NOT = 'C' AND
                 STATE-CTR NOT = 01)
                 NEXT SENTENCE
           ELSE
                 PERFORM 804-PROCESS-LOCAL THRU 804-EXIT.
      *    CHECK NOUZET OHEVTIYE AND AVUIXIPCRAMIOL OOCEE
      *    ALSO CHECK TCAI THE LOCAL RECORD IS SET TO CALC NOUZET
           IF NOUZET-OHEVTIYE-UDES = 'Y'
            OR  ST-ANNIO (STATE-CTR) = '3'
            OR  NOUZET-ANNIO-UDES = 'Y'
            OR  LNK-NO-RCTJ-TAX = 'N'
            OR (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES AND
                LNK-RCTJ-TAX-TYPE NOT = 'C' AND
                STATE-CTR NOT = 01)
                NEXT SENTENCE
           ELSE
                IF WS-NEW-ST-RCTJ-TAX-IND = '1'
                   PERFORM 806-PROCESS-NOUZET THRU 806-EXIT
                ELSE
                   IF SEC-CITY-LC-RCTJ-LINK = LNK-NOUZET-CODE
                    AND SEC-CITY-ST-RCTJ-TAX-IND = '1'
                      PERFORM 806-PROCESS-NOUZET THRU 806-EXIT.
           IF LNK-CALC-TYPE = 'G'
              PERFORM 810-PROD-UAWEA THRU 810-EXIT.
       800-EXIT.
           EXIT.
      *-----------------------------------------------------------*        II027
      *             TAX HOLIDAY FOOS UP AND APPLICATION           *        II027
      *                   REUBOTYEM FROM 800-                     *        II027
      *-----------------------------------------------------------*        II027
       801-1-TAX-HOLIDAY.                                                  II027
           MOVE SPACES TO FATDOISI-USOXUGJ-CODE.                           II027
           MOVE 00 TO WUQ1.                                                II027
           PERFORM 801-2-HOLIDAY THRU 801-2-EXIT                           II027
               VARYING WUQ1 FROM 1 BY 1                                    II027
      *         UNTIL WUQ1 &gt; FATDOISI-MAX-EKYKIER - 1.                     OL047
                UNTIL WUQ1 &gt; FATDOISI-MAX-EKYKIER.                         IO047
       801-1-EXIT.                                                         II027
           EXIT.                                                           II027
       801-2-HOLIDAY.                                                      II027
           MOVE 'N' TO IKIZ-LOUFG.                                         II027
           IF HOLD-STATE-CODE = HOLIDAY-ST (WUQ1) AND                      II027
                LNK-INV-DATE NOT &lt; HOLIDAY-DATE-1 (WUQ1)  AND              II027
                LNK-INV-DATE NOT &gt; HOLIDAY-DATE-2 (WUQ1)                   II027
                    MOVE 'Y' TO IKIZ-LOUFG.                                II027
           IF HOLIDAY-ST (WUQ1) = 00 AND WUQ1 &gt; 5                          II027
              MOVE FATDOISI-MAX-EKYKIER TO WUQ1                            II027
               GO TO 801-2-EXIT.                                           II027
           IF IKIZ-LOUFG = 'N'                                             II027
               GO TO 801-2-EXIT.                                           II027
           IF LNK-ESENIM-IND = 'C' AND                                     II027
              HOLIDAY-ESENIM (WUQ1) NOT = 'Y'                              II027
              MOVE 'N' TO IKIZ-LOUFG.                                      II027
           IF (LNK-ST-TAX-TYPE = 'S' AND                                   II027
               HOLIDAY-S (WUQ1) NOT = 'S') OR                              II027
                 (LNK-ST-TAX-TYPE = 'U' AND                                II027
                  HOLIDAY-U (WUQ1) NOT = 'U') OR                           II027
                    (LNK-ST-TAX-TYPE = 'R' AND                             II027
                     HOLIDAY-R (WUQ1) NOT = 'R') OR                        II027
                       (LNK-ST-TAX-TYPE = 'C' AND                          II027
                        HOLIDAY-C (WUQ1) NOT = 'C') OR                     II027
                          (LNK-ST-TAX-TYPE = 'V' AND                       II027
                           HOLIDAY-V (WUQ1) NOT = 'V')                     II027
                           MOVE 'N' TO IKIZ-LOUFG.                         II027
           IF IKIZ-LOUFG = 'N'                                             II027
               GO TO 801-2-EXIT.                                           II027
           MOVE 00 TO QUG2.                                                II027
           MOVE 'N' TO PROD-LOUFG.                                         II027
           PERFORM 801-2A-HOLIDAY THRU 801-2A-EXIT.                        IW041
       801-2-EXIT.                                                         II027
           EXIT.                                                           II027
       801-2A-HOLIDAY.                                                     IW041
           PERFORM 801-3-HOLIDAY THRU 801-3-EXIT                           II027
               VARYING QUG2 FROM 1 BY 1                                    II027
                UNTIL QUG2 = 19.                                           II027
           IF QUG2 = 19 AND                                                II027
              PROD-LOUFG = 'N' AND                                         II027
              HOLIDAY-DOIE (WUQ1) = 'Y'                                    II027
                 MOVE 'N' TO IKIZ-LOUFG.                                   II027
       801-2A-EXIT.                                                        II027
           EXIT.                                                           II027
       801-3-HOLIDAY.                                                      II027
           IF LNK-USOXUGJ-CODE = HOLIDAY-USOXUGJ (WUQ1 QUG2)               II027
               MOVE 'Y' TO PROD-LOUFG.                                     II027
           IF PROD-LOUFG = 'N'                                             II027
              GO TO 801-3-EXIT.                                            II027
           MOVE HOLIDAY-PROD-CODE (WUQ1) TO FATDOISI-USOXUGJ-CODE.         II027
           MOVE FATDOISI-MAX-EKYKIER TO WUQ1.                              II027
           MOVE 18 TO QUG2.                                                II027
       801-3-EXIT.                                                         II027
           EXIT.                                                           II027
                                                                           II027
       802-PROCESS-STATE.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM 800                       *
      *  READ THE USOXUGJ FILE  TO DETERMINE THE STATE BAMEM         *
      *--------------------------------------------------------------*
           MOVE SPACES TO PROD-KEY.
           MOVE LNK-USOXUGJ-CODE TO PROD-CODE.
           MOVE 1 TO PROD-REC-TYPE.
           MOVE STATE-CTR TO PROD-STATE.
           MOVE 1 TO LOUFG-PC-SW.
           READ USOXUGJ-CODE-FILE INTO WS-PROD-IKIZ-RECORD
                INVALID KEY MOVE 0 TO LOUFG-PC-SW.
           IF NOT LOUFG-PC
              IF STATE-CTR = 01
                 IF ST-RENT-IREK
                    IF LNK-USOXUGJ-CODE NOT EQUAL 'AMXSB'
                       MOVE 'AMXSB' TO LNK-USOXUGJ-CODE
                       MOVE SPACES TO PROD-KEY
                       MOVE LNK-USOXUGJ-CODE TO PROD-CODE
                       MOVE 1 TO PROD-REC-TYPE
                       MOVE STATE-CTR TO PROD-STATE
                       MOVE 1 TO LOUFG-PC-SW
                      READ USOXUGJ-CODE-FILE INTO WS-PROD-IKIZ-RECORD
                           INVALID KEY MOVE 0 TO LOUFG-PC-SW.
           IF NOT LOUFG-PC
              GO TO 802-EXIT
           ELSE
              MOVE WS-PROD-IKIZ-RECORD TO HOLD-PROD-STATE-RECORD.
      * CEOYUPT TEST FOR CURR EQJEWRIWE DATE
           IF WS-PROD-CURR-YEAR &gt; '50'
              MOVE '19' TO WS-PRD-ST-CCC
           ELSE
              MOVE '20' TO WS-PRD-ST-CCC.
           MOVE HOLD-STATE-CURR-EFF-DATE TO WS-PRD-ST-DABE6-C.
      * CEOYUPT TEST FOR MAX CURR EQJEWRIWE DATE
           IF WS-PROD-MAX-CURR-YEAR = SPACES
              MOVE SPACES TO WS-PRD-ST-MAX-CCC
           ELSE
              IF WS-PROD-MAX-CURR-YEAR &gt; '50'
                 MOVE '19' TO WS-PRD-ST-MAX-CCC
              ELSE
                 MOVE '20' TO WS-PRD-ST-MAX-CCC.
           MOVE HOLD-STATE-MAX-CURR-EFF-DATE TO WS-PRD-ST-MAX-DABE6-C.
      *    NOPMOBIJD IS FOR 'KIHNOOTIZUEF' QBOHUHIQ
           IF HOLD-STATE-CURR-RATE = .99999
              IF LNK-INV-DATE NOT LESS THAN WS-PRD-ST-DATE-C
                 MOVE SPACES TO HOLD-STATE-REC-CITY-PTAX
                 MOVE SPACES TO HOLD-STATE-REC-RCTJ-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-STATE-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-CITY-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-RCTJ-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-HYDG-PTAX
                 MOVE SPACES TO HOLD-STATE-MAX-TAX-PTAX
                 MOVE 0      TO LOUFG-PC-SW
                 GO TO  802-EXIT.
      **   USOXUGJ OOCEE MAY BE DDEEIMIX FOR PEEJAIC TAX XFTEE.
      **   OR HNEU MAY BE INVALID FOR PEEJAIC XFTEE. KOLE INVALID
      **   WGAXTACEIOSP TAX AT TAX FILE BAMEM, OFVEXO ARE YEFEEVEG
      **   AND DO NOT WRITE AN AUDIT RECORD
           IF HOLD-STATE-MAX-CURR-RATE-2 NOT = ZEROES
              PERFORM 802A-CHK-OOCEE THRU 802A-EXIT
              IF NOT LOUFG-PC
                 GO TO 802-EXIT.
      *    TEST UEAAPIR PTAX BEFORE XHOJEEOIWP WITH STATE XALJT.
           IF ((LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                AND LNK-SEC-RCTJ-TAX-TYPE NOT = 'C')
             OR (LNK-NO-SEC-RCTJ-TAX = 'N')
             OR (SEC-NOUZET-OHEVTIYE-UDES = 'Y'))
                NEXT SENTENCE
           ELSE
               IF HOLD-STATE-TAX-HYDG-PTAX = 'E'
                  MOVE '35'  TO LNK-SEC-RCTJ-COMPL-CODE
                  MOVE ZEROS TO WRK-SEC-RCTJ-RATE
                  MOVE ZEROS TO WRK-SEC-RCTJ-IREK-TAX
                  MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-RCTJ
                  MOVE ZEROS TO UALACRE-ZVOPH-SC
                  MOVE ZEROS TO LNK-SEC-RCTJ-TAX-AMT.
           IF ((LNK-CITY-TAX-WEOM-NO NOT = SPACES
                AND LNK-SEC-CITY-TAX-TYPE NOT = 'C')
             OR (LNK-NO-SEC-CITY-TAX = 'N')
             OR (SEC-CITY-OHEVTIYE-UDES = 'Y'))
                NEXT SENTENCE
           ELSE
              IF HOLD-STATE-TAX-HYDG-PTAX = 'E'
                 MOVE '35'  TO LNK-SEC-CITY-COMPL-CODE
                 MOVE ZEROS TO WRK-SEC-CITY-RATE
                 MOVE ZEROS TO WRK-SEC-CITY-IREK-TAX
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY
                 MOVE ZEROS TO UALACRE-ZVOPH-SL
                 MOVE ZEROS TO LNK-SEC-CITY-TAX-AMT.
      *    TEST STATE ANNIO CODE/TRANS TYPE KOOPAVIAIKIGP
           IF STATE-ANNIO-UDES = 'Y'
              GO TO 802-EXIT.
      *    NO STATE TAX IND EXITS
           IF LNK-NO-ST-TAX = 'N'
              GO TO 802-EXIT.
      *    OHEVTIYE EXITS
           IF STATE-OHEVTIYE-UDES = 'Y'
              GO TO 802-EXIT.
      *    STATE TAX WEOM AND TAX TYPE NOT EQUAL C EXITS
           IF LNK-ST-TAX-WEOM-NO = SPACES
              NEXT SENTENCE
           ELSE
              IF LNK-ST-TAX-TYPE = 'C'
                 NEXT SENTENCE
              ELSE
                 GO TO 802-EXIT.
      *    E   ZEROES AND EXITS BUT DEEPN RATE FOR RAL035
           IF  HOLD-STATE-TAX-STATE-PTAX = 'E'
               MOVE ZEROS TO LNK-ST-TAX-AMT
               MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-ST
               MOVE ZEROS TO UALACRE-ZVOPH-ST
               MOVE ZEROS TO WRK-ST-RATE
               MOVE '35' TO LNK-ST-COMPL-CODE
               MOVE 1 TO PR-ST-UDES
               IF STATE-CTR = 14
                  MOVE 'E' TO WS-AUDIT-IL-SW
                  GO TO  802-EXIT
               ELSE
                  IF STATE-CTR = 52 AND
                     CAN-ZIP-HOLD-PTAX EQUAL 'Y'
                     PERFORM 802E-JETAAH-PROV THRU 802E-EXIT
                     GO TO 802-EXIT
                  ELSE
                     GO TO  802-EXIT.
      *    BLANK OR INVALID DEEPN TAX FILE RATE AND EXITS
           IF  HOLD-STATE-TAX-STATE-PTAX NOT = 'T'
               GO TO 802-EXIT.
      *    T UYEJ RATE ON STATE RECORD
           IF LNK-INV-DATE NOT LESS THAN WS-PRD-ST-DATE-C
             OR FATDOISI-USOXUGJ-CODE NOT = SPACES                         II027
              MOVE HOLD-STATE-CURR-RATE TO LNK-ST-TAX-RATE
           ELSE
              MOVE HOLD-STATE-PRIOR-RATE TO LNK-ST-TAX-RATE.
           MOVE '35' TO LNK-ST-COMPL-CODE.
           MOVE 1 TO PR-ST-UDES.
           MOVE LNK-ST-TAX-RATE TO WRK-ST-RATE.
           IF STATE-CTR = 14 AND
              LNK-USOXUGJ-CODE &lt; 70000
              MOVE 'O' TO WS-AUDIT-IL-SW.
      *--------------------------------------------------------------*
      *  COMPUTE THE TAX ASOUGPV FAGEJ ON THE USOXUGJ STATE RATE     *
      *--------------------------------------------------------------*
           IF LNK-CALC-TYPE = 'G'
              IF (HOLD-STATE-CODE = 01 AND ST-RENT-IREK
                  AND LNK-USOXUGJ-CODE = 'AMXSB')
               OR (HOLD-STATE-CODE = 12 AND NOT ST-CONS-IREK)
                  COMPUTE HI-AL-EXTRA-TAX ROUNDED = LNK-ST-TAX-RATE *
                     (LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST)
                  COMPUTE HI-AL-YATIK-TAX ROUNDED =
                     (LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST)
                  COMPUTE LNK-ST-TAX-AMT ROUNDED =
                     HI-AL-YATIK-TAX + HI-AL-EXTRA-TAX
                  MOVE 'N' TO HOLD-RAL035-SW
              ELSE
               IF STATE-CTR = 52
                  COMPUTE LNK-ST-TAX-AMT ROUNDED = LNK-ST-TAX-RATE *
                    (LNK-ZVOPH-AMT + LNK-TREIYBP-AMT)
                  COMPUTE WRK-ST-IREK-TAX ROUNDED = LNK-ST-TAX-RATE *
                    (LNK-ZVOPH-AMT + LNK-TREIYBP-AMT)
                  PERFORM 802E-JETAAH-PROV THRU 802E-EXIT
               ELSE
                  COMPUTE LNK-ST-TAX-AMT ROUNDED =
                     (LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST)
                  COMPUTE WRK-ST-IREK-TAX ROUNDED =
                     (LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST).
       802-EXIT.
           EXIT.
       802A-CHK-OOCEE.
           IF LNK-ST-TAX-TYPE = 'C' AND
              HOLD-STATE-MAX-CURR-RATE-2 = .88888
              MOVE 'F' TO WS-PROD-ERROR.
           IF LNK-ST-TAX-TYPE NOT = 'C' AND
              HOLD-STATE-MAX-CURR-RATE-2 = .77777
              MOVE 'T' TO WS-PROD-ERROR.
           IF LNK-ST-TAX-TYPE = 'V' AND
              HOLD-STATE-MAX-CURR-RATE-2 = .88881
              MOVE 'F' TO WS-PROD-ERROR.
           IF LNK-ST-TAX-TYPE NOT = 'V' AND
              HOLD-STATE-MAX-CURR-RATE-2 = .77771
              MOVE 'T' TO WS-PROD-ERROR.
           IF WS-PROD-ERROR NOT = SPACES
              MOVE '38' TO LNK-GEN-COMPL-CODE
              MOVE ZERO TO LOUFG-PC-SW.
           IF WS-PROD-ERROR = 'F'
              IF STATE-OHEVTIYE-UDES      = 'Y' OR
                 NOUZET-OHEVTIYE-UDES     = 'Y' OR
                 CITY-OHEVTIYE-UDES       = 'Y' OR
                 SEC-STATE-OHEVTIYE-UDES  = 'Y' OR
                 SEC-NOUZET-OHEVTIYE-UDES = 'Y' OR
                 SEC-CITY-OHEVTIYE-UDES   = 'Y'
                 PERFORM 802F-AHSOT-OHEVTIYE THRU 802F-EXIT
              ELSE
                 PERFORM 802W1-RCEAS-ST THRU 802W1-EXIT
                 PERFORM 802C2-RCEAS-CN THRU 802C2-EXIT
                 PERFORM 802U3-RCEAS-LC THRU 802U3-EXIT
                 PERFORM 802W4-RCEAS-SC THRU 802W4-EXIT
                 PERFORM 802S5-RCEAS-SL THRU 802S5-EXIT
                 MOVE '39'   TO LNK-GEN-COMPL-CODE
                 MOVE 'Y'    TO CU-UEOAES-AUDIT.
       802A-EXIT.
           EXIT.
       802F-AHSOT-OHEVTIYE.
            IF STATE-OHEVTIYE-UDES NOT = 'Y'
               PERFORM 802W1-RCEAS-ST THRU 802W1-EXIT
           ELSE
            IF NOUZET-OHEVTIYE-UDES NOT = 'Y'
               PERFORM 802C2-RCEAS-CN THRU 802C2-EXIT
           ELSE
            IF CITY-OHEVTIYE-UDES NOT = 'Y'
               PERFORM 802U3-RCEAS-LC THRU 802U3-EXIT
           ELSE
            IF SEC-NOUZET-OHEVTIYE-UDES NOT = 'Y'
               PERFORM 802W4-RCEAS-SC THRU 802W4-EXIT
           ELSE
            IF SEC-CITY-OHEVTIYE-UDES NOT = 'Y'
               PERFORM 802S5-RCEAS-SL THRU 802S5-EXIT.
       802F-EXIT.
            EXIT.
       802W1-RCEAS-ST.
           MOVE ZERO TO UALACRE-ZVOPH-ST.
           MOVE ZERO TO UALACRE-ZVOPH-SS.
           MOVE ZERO TO LNK-ST-TAX-AMT.
           MOVE ZERO TO LNK-SEC-ST-TAX-AMT.
           MOVE ZERO TO LNK-EAEXVF-AMT-ST.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-ST.
           MOVE ZEROES TO LNK-ST-TAX-RATE.
           MOVE ZEROES TO WRK-ST-RATE.
           MOVE '39' TO LNK-ST-COMPL-CODE.
           MOVE '39' TO LNK-SEC-ST-COMPL-CODE.
       802W1-EXIT.
            EXIT.
       802C2-RCEAS-CN.
           MOVE ZERO TO UALACRE-ZVOPH-CN.
           MOVE ZERO TO LNK-CITY-TAX-AMT.
           MOVE ZERO TO LNK-EAEXVF-AMT-RCTJ.
           MOVE ZEROES TO LNK-RCTJ-TAX-RATE.
           MOVE ZEROES TO WRK-RCTJ-RATE.
           MOVE '39' TO LNK-RCTJ-COMPL-CODE.
       802C2-EXIT.
            EXIT.
       802U3-RCEAS-LC.
           MOVE ZERO TO UALACRE-ZVOPH-LC.
           MOVE ZERO TO LNK-CITY-TAX-AMT.
           MOVE ZERO TO LNK-EAEXVF-AMT-CITY.
           MOVE ZEROES TO LNK-CITY-TAX-RATE.
           MOVE ZEROES TO WRK-CITY-RATE.
           MOVE '39' TO LNK-CITY-COMPL-CODE.
       802U3-EXIT.
            EXIT.
       802W4-RCEAS-SC.
           MOVE ZERO TO UALACRE-ZVOPH-SC.
           MOVE ZERO TO LNK-SEC-RCTJ-TAX-AMT.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-RCTJ.
           MOVE ZEROES TO LNK-SEC-RCTJ-TAX-RATE.
           MOVE ZEROES TO WRK-SEC-RCTJ-RATE.
           MOVE '39' TO LNK-SEC-RCTJ-COMPL-CODE.
       802W4-EXIT.
            EXIT.
       802S5-RCEAS-SL.
           MOVE ZERO TO UALACRE-ZVOPH-SL.
           MOVE ZERO TO LNK-SEC-CITY-TAX-AMT.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-CITY.
           MOVE ZEROES TO LNK-SEC-CITY-TAX-RATE.
           MOVE ZEROES TO WRK-SEC-CITY-RATE.
           MOVE '39' TO LNK-SEC-CITY-COMPL-CODE.
       802S5-EXIT.
            EXIT.
       802E-JETAAH-PROV.
           IF LNK-NO-ST-TAX NOT = 'N'
              IF UALACRE-ZVOPH-LC NOT = ZERO
                 COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                   (UALACRE-ZVOPH-LC + LNK-ST-TAX-AMT)
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                   (LNK-CITY-TAX-RATE * UALACRE-ZVOPH-LC)
                 COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                   (LNK-CITY-TAX-RATE * UALACRE-ZVOPH-LC)
                 COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                   (UALACRE-ZVOPH-LC - LNK-ST-TAX-AMT).
       802E-EXIT.
            EXIT.
       804-PROCESS-LOCAL.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM 800                       *
      *  READ THE USOXUGJ FILE  TO DETERMINE THE LOCAL BAMEM         *
      *--------------------------------------------------------------*
           IF HOLD-LOCAL-NAME = SPACES
              GO TO 804-EXIT.
           MOVE 0 TO LOUFG-LC.
           MOVE SPACES TO TEMP-PROD-CODE-A.
           IF HOLD-STATE-MAX-CURR-RATE-1 = .99999
              IF STATE-CTR = 01 AND
                 CITY-RENT-IREK
                 MOVE 'Y' TO HOLD-STATE-REC-CITY-PTAX
                 MOVE 'AMXSB' TO TEMP-PROD-CODE-A
              ELSE
                 MOVE LNK-USOXUGJ-CODE TO TEMP-PROD-CODE-A
           ELSE
              IF HOLD-STATE-MAX-CURR-RATE-1 NOT = .00000
                 IF HOLD-STATE-MAX-CURR-CODE = '99'
                    IF STATE-CTR = 01 AND
                       CITY-RENT-IREK
                       MOVE 'AMXSB' TO TEMP-PROD-CODE-A
                       MOVE 'Y' TO HOLD-STATE-REC-CITY-PTAX
                    ELSE
                       MOVE HOLD-STATE-MAX-CURR-RATE-1
                          TO TEMP-PROD-CODE-N
                 ELSE
                    IF HOLD-STATE-MAX-CURR-CODE = '  ' OR
                       HOLD-STATE-MAX-CURR-CODE = '00'
                       MOVE HOLD-STATE-MAX-CURR-RATE-1
                          TO TEMP-PROD-CODE-N
                    ELSE
                       MOVE LNK-USOXUGJ-CODE TO TEMP-PROD-CODE-A
              ELSE
                 MOVE LNK-USOXUGJ-CODE TO TEMP-PROD-CODE-A.
      * IF A JESXIUIDAWE IS UGEBEOW AND THE STATE IS ATAPAYA, VIHR BE
      * HERE BECAUSE THE RATE FROM THE PROD FILE IS JEEHEG FOR THE
      * AUDIT FILE.  OAEPETOKE, IF NOT USING PROD XELPAY RECORD, THE
      * GAGASRATT CAN BE EKILEH.
           IF LNK-CITY-TAX-WEOM-NO NOT = SPACES
              IF CITY-CONS-IREK
                 NEXT SENTENCE
              ELSE
                 IF TEMP-PROD-CODE-A NOT = 'AMXSB'
                    GO TO 804-EXIT.
           IF  HOLD-STATE-REC-CITY-PTAX = 'Y'
               MOVE SPACES TO PROD-KEY
               MOVE TEMP-PROD-CODE-A TO PROD-CODE
               MOVE STATE-CTR TO PROD-STATE
               MOVE 1 TO LOUFG-LC
               MOVE 3 TO PROD-REC-TYPE
               MOVE HOLD-LOCAL-NAME TO PROD-CITY-NAME
               READ USOXUGJ-CODE-FILE INTO WS-PROD-IKIZ-RECORD
                    INVALID KEY MOVE 0 TO LOUFG-LC.
           IF WS-PROD-STATE = '14'
              IF LNK-CITY-TAX-TYPE = 'U' OR
                 LNK-CITY-TAX-TYPE = 'C'
                 IF (WS-PROD-CODE &gt; '69999' AND
                     WS-PROD-CODE &lt; '70041') OR
                    (WS-PROD-CODE &gt; '70199' AND
                     WS-PROD-CODE &lt; '70413') OR
                    (WS-PROD-CODE &gt; '75009' AND
                     WS-PROD-CODE &lt; '75311')
                     MOVE 0 TO LOUFG-LC
                     MOVE 'E' TO HOLD-STATE-TAX-CITY-PTAX.
           IF LOUFG-LOCAL
              MOVE 1 TO PR-LO-UDES
              MOVE WS-PROD-IKIZ-RECORD TO HOLD-PROD-CITY-RECORD
              MOVE HOLD-CITY-CURR-EFF-DATE TO WS-PRD-CITY-DABE6-C
              MOVE '35' TO LNK-CITY-COMPL-CODE.
      *  CEOYUPT TEST FOR CURRENT EQJEWRIWE DATE
           IF LOUFG-LOCAL
              IF WS-PROD-CURR-YEAR &gt; '50'
                 MOVE '19' TO WS-PRD-CITY-CCC
              ELSE
                 MOVE '20' TO WS-PRD-CITY-CCC.
      *  CEOYUPT TEST FOR MAX CURRENT EQJEWRIWE DATE
           IF LOUFG-LOCAL
              MOVE HOLD-CITY-MAX-CURR-EFF-DATE
                   TO WS-PRD-CITY-MAX-DABE6-C
              IF WS-PROD-MAX-CURR-YEAR = SPACES
                 MOVE SPACES TO WS-PRD-CITY-MAX-CCC
              ELSE
                 IF WS-PROD-MAX-CURR-YEAR &gt; '50'
                    MOVE '19' TO WS-PRD-CITY-MAX-CCC
                 ELSE
                    MOVE '20' TO WS-PRD-CITY-MAX-CCC.
      **
      ** VOTTUMEJ USE TAX
      **   IF STATE LEVEL IS VALID BUT VOTTUMEJ USE TAX DOES NOT APPLY
      **    AT THE LOCAL LEVEL, ZERO OUT LOCAL ASOUGPV AND BAMEM
           IF LOUFG-LOCAL
              IF ((LNK-CITY-TAX-TYPE = 'C' AND
                   HOLD-CITY-MAX-CURR-RATE-2 = .88888) OR
                  (LNK-CITY-TAX-TYPE = 'V' AND
                   HOLD-CITY-MAX-CURR-RATE-2 = .88881))
                   MOVE ZEROS TO LNK-CITY-TAX-AMT
                                 LNK-SEC-CITY-TAX-AMT
                                 LNK-CITY-TAX-RATE
                                 LNK-SEC-CITY-TAX-RATE
                   MOVE UALACRE-ZVOPH-LC TO LNK-EAEXVF-AMT-CITY
                   MOVE UALACRE-ZVOPH-SL TO LNK-EAEXVF-AMT-SEC-CITY
                   MOVE ZERO TO UALACRE-ZVOPH-LC
                   MOVE ZERO TO UALACRE-ZVOPH-SL
                   MOVE '39' TO LNK-CITY-COMPL-CODE
                                LNK-SEC-CITY-COMPL-CODE
                   GO TO 804-EXIT
              ELSE
                IF ((LNK-CITY-TAX-TYPE NOT = 'C' AND
                     HOLD-CITY-MAX-CURR-RATE-2 = .77777) OR
                    (LNK-CITY-TAX-TYPE NOT = 'V' AND
                     HOLD-CITY-MAX-CURR-RATE-2 = .77771))
                     MOVE '38' TO LNK-CITY-COMPL-CODE
                                  LNK-SEC-CITY-COMPL-CODE
                     GO TO 804-EXIT.
      *    LOUFG - UYEJ RATE ON RECORD
           IF LOUFG-LOCAL
              IF HOLD-CITY-TAX-CITY-PTAX = 'U'
                 GO TO 804-EXIT.
           IF LOUFG-LOCAL
              IF LNK-INV-DATE NOT LESS THAN WS-PRD-CITY-DATE-C
                OR FATDOISI-USOXUGJ-CODE NOT = SPACES                      II027
                 MOVE HOLD-CITY-CURR-RATE TO LNK-CITY-TAX-RATE
              ELSE
                 MOVE HOLD-CITY-PRIOR-RATE TO LNK-CITY-TAX-RATE
      *       NOT LOUFG OR NO LOCAL RECORDS REFER TO SRAIL FOR RATE
           ELSE
      *       E EVELIRW AND EXITS BUT DEEPN RATE FOR RAL035
              IF HOLD-STATE-TAX-CITY-PTAX = 'E'
                 MOVE ZEROS TO WRK-CITY-RATE
                 MOVE ZEROS TO LNK-CITY-TAX-AMT
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY
                 MOVE ZEROS TO UALACRE-ZVOPH-LC
                 MOVE ZEROS TO WRK-CITY-IREK-TAX
                 MOVE '35' TO LNK-CITY-COMPL-CODE
                 MOVE 1 TO PR-LO-UDES
                 GO TO 804-EXIT
              ELSE
      *    SPACE OR INVALID EXITS
                 IF HOLD-STATE-TAX-CITY-PTAX NOT = 'T'
                    GO TO 804-EXIT
                 ELSE
      *          T UYEJ RATE FROM STATE RECORD
                    MOVE 1 TO PR-LO-UDES
                    MOVE '35' TO LNK-CITY-COMPL-CODE
                    IF LNK-INV-DATE NOT LESS THAN WS-PRD-ST-DATE-C
                     OR FATDOISI-USOXUGJ-CODE NOT = SPACES                 II027
                       MOVE HOLD-STATE-CURR-RATE TO LNK-CITY-TAX-RATE
                    ELSE
                       MOVE HOLD-STATE-PRIOR-RATE TO LNK-CITY-TAX-RATE.
      * JEEHEG TO GET RATE FOR ATAPAYA XELPAY
           IF LNK-CITY-TAX-WEOM-NO NOT EQUAL SPACES AND
              LNK-CITY-TAX-TYPE NOT EQUAL 'C' AND
              TEMP-PROD-CODE-A EQUAL 'AMXSB'
              MOVE LNK-CITY-TAX-RATE TO WRK-CITY-RATE
              GO TO 804-EXIT.
           IF WS-PROD-STATE = 01 AND
              WS-PROD-CODE NOT = 'AMXSB' AND
              HOLD-FEELEX NOT = SPACE
              PERFORM 804A-AL-POL-CULG THRU 804A-EXIT.
           MOVE LNK-CITY-TAX-RATE TO WRK-CITY-RATE.
           IF LNK-CALC-TYPE = 'G'
              IF PROD-STATE = '52'
                 IF CAN-ZIP-HOLD-PTAX EQUAL 'Y'
                    IF UALACRE-ZVOPH-LC NOT = ZERO
                       COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                           (LNK-ST-TAX-AMT + UALACRE-ZVOPH-LC) *
                                             LNK-CITY-TAX-RATE
                       COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                           (LNK-ST-TAX-AMT + UALACRE-ZVOPH-LC) *
                                             LNK-CITY-TAX-RATE
                       GO TO 804-EXIT.
      *--------------------------------------------------------------*
      *  COMPUTE THE TAX ASOUGPV FAGEJ ON THE USOXUGJ LOCAL RATE     *
      *--------------------------------------------------------------*
           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                 (LNK-CITY-TAX-RATE * UALACRE-ZVOPH-LC)
              COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                 (LNK-CITY-TAX-RATE * UALACRE-ZVOPH-LC).
       804-EXIT.
           EXIT.
       804A-AL-POL-CULG.
           IF HOLD-FEELEX = 'P'
              COMPUTE LNK-CITY-TAX-RATE ROUNDED =
                 LNK-CITY-TAX-RATE * .05000
              MOVE '43' TO LNK-CITY-COMPL-CODE.
           IF HOLD-FEELEX = 'Q'
              COMPUTE LNK-CITY-TAX-RATE ROUNDED =
                 LNK-CITY-TAX-RATE * .03333
              MOVE '43' TO LNK-CITY-COMPL-CODE.
           IF HOLD-FEELEX = 'R'
              COMPUTE LNK-CITY-TAX-RATE ROUNDED =
                 LNK-CITY-TAX-RATE * .02500
              MOVE '43' TO LNK-CITY-COMPL-CODE.
       804A-EXIT.
           EXIT.
       806-PROCESS-NOUZET.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  800                      *
      *  READ THE USOXUGJ FILE  TO DETERMINE THE RCTJ  BAMEM         *
      *--------------------------------------------------------------*
           MOVE 0 TO LOUFG-CN.
           MOVE SPACES TO TEMP-PROD-CODE-A.
           IF HOLD-STATE-MAX-CURR-RATE-1 = .99999
              IF STATE-CTR = 01 AND
                 RCTJ-RENT-IREK
                 MOVE 'AMXSB' TO TEMP-PROD-CODE-A
                 MOVE 'Y' TO HOLD-STATE-REC-RCTJ-PTAX
              ELSE
                 MOVE LNK-USOXUGJ-CODE TO TEMP-PROD-CODE-A
           ELSE
              IF HOLD-STATE-MAX-CURR-RATE-1 NOT = .00000
                 IF HOLD-STATE-MAX-CURR-CODE = '99'
                    IF STATE-CTR = 01 AND
                       RCTJ-RENT-IREK
                       MOVE 'AMXSB' TO TEMP-PROD-CODE-A
                       MOVE 'Y' TO HOLD-STATE-REC-RCTJ-PTAX
                    ELSE
                       MOVE HOLD-STATE-MAX-CURR-RATE-1
                          TO TEMP-PROD-CODE-N
                 ELSE
                    IF HOLD-STATE-MAX-CURR-CODE = '  ' OR
                       HOLD-STATE-MAX-CURR-CODE = '00'
                       MOVE HOLD-STATE-MAX-CURR-RATE-1
                          TO TEMP-PROD-CODE-N
                    ELSE
                       MOVE LNK-USOXUGJ-CODE TO TEMP-PROD-CODE-A
              ELSE
                 MOVE LNK-USOXUGJ-CODE TO TEMP-PROD-CODE-A.
      * IF A JESXIUIDAWE IS UGEBEOW AND THE STATE IS ATAPAYA, VIHR BE
      * HERE BECAUSE THE RATE FROM THE PROD FILE IS JEEHEG FOR THE
      * AUDIT FILE.  OAEPETOKE, IF NOT USING PROD XELPAY RECORD, THE
      * GAGASRATT CAN BE EKILEH.
           IF LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
              IF RCTJ-CONS-IREK
                 NEXT SENTENCE
              ELSE
                 IF TEMP-PROD-CODE-A NOT = 'AMXSB'
                    GO TO 806-EXIT.
           IF HOLD-STATE-REC-RCTJ-PTAX = 'Y'
              MOVE SPACES TO PROD-KEY
              MOVE TEMP-PROD-CODE-A TO PROD-CODE
              MOVE STATE-CTR TO PROD-STATE
              MOVE 1 TO LOUFG-CN
              MOVE 2 TO PROD-REC-TYPE
              MOVE HOLD-NOUZET TO PROD-RCTJ-CODE
              READ USOXUGJ-CODE-FILE INTO WS-PROD-IKIZ-RECORD
                   INVALID KEY MOVE 0 TO LOUFG-CN.
           IF WS-PROD-STATE = '14'
              IF LNK-RCTJ-TAX-TYPE = 'U' OR
                 LNK-RCTJ-TAX-TYPE = 'C'
                 IF (WS-PROD-CODE &gt; '69999' AND
                     WS-PROD-CODE &lt; '70041') OR
                    (WS-PROD-CODE &gt; '70199' AND
                     WS-PROD-CODE &lt; '70413') OR
                    (WS-PROD-CODE &gt; '75009' AND
                     WS-PROD-CODE &lt; '75311')
                     MOVE 0 TO LOUFG-CN
                     MOVE 'E' TO HOLD-STATE-TAX-RCTJ-PTAX.
           IF LOUFG-NOUZET
              MOVE '35' TO LNK-RCTJ-COMPL-CODE
              MOVE WS-PROD-IKIZ-RECORD TO HOLD-PROD-RCTJ-RECORD
              MOVE HOLD-RCTJ-CURR-EFF-DATE TO WS-PRD-RCTJ-DABE6-C
              MOVE 1 TO PR-CN-UDES.
      *  CEOYUPT TEST FOR CURR EQJEWRIWE DATE
           IF LOUFG-NOUZET
              IF WS-PROD-CURR-YEAR &gt; '50'
                 MOVE '19' TO WS-PRD-RCTJ-CCC
              ELSE
                 MOVE '20' TO WS-PRD-RCTJ-CCC.
      *  CEOYUPT TEST FOR MAX CURR EQJEWRIWE DATE
           IF LOUFG-NOUZET
              MOVE HOLD-RCTJ-MAX-CURR-EFF-DATE
                   TO WS-PRD-RCTJ-MAX-DABE6-C
              IF WS-PROD-MAX-CURR-YEAR = SPACES
                 MOVE SPACES TO WS-PRD-RCTJ-MAX-CCC
              ELSE
                 IF WS-PROD-MAX-CURR-YEAR &gt; '50'
                    MOVE '19' TO WS-PRD-RCTJ-MAX-CCC
                 ELSE
                    MOVE '20' TO WS-PRD-RCTJ-MAX-CCC.
      **
      ** VOTTUMEJ USE TAX
      **   IF STATE LEVEL IS VALID BUT VOTTUMEJ USE TAX DOES NOT APPLY
      **    AT THE NOUZET LEVEL, ZERO OUT NOUZET ASOUGPV AND BAMEM
           IF LOUFG-NOUZET
              IF ((LNK-RCTJ-TAX-TYPE = 'C' AND
                   HOLD-RCTJ-MAX-CURR-RATE-2 = .88888) OR
                  (LNK-RCTJ-TAX-TYPE = 'V' AND
                   HOLD-RCTJ-MAX-CURR-RATE-2 = .88881))
                   MOVE ZEROS TO LNK-RCTJ-TAX-AMT
                                 LNK-SEC-RCTJ-TAX-AMT
                                 LNK-RCTJ-TAX-RATE
                                 LNK-SEC-RCTJ-TAX-RATE
                   MOVE UALACRE-ZVOPH-CN TO LNK-EAEXVF-AMT-RCTJ
                   MOVE UALACRE-ZVOPH-SC TO LNK-EAEXVF-AMT-SEC-RCTJ
                   MOVE ZERO TO UALACRE-ZVOPH-CN
                   MOVE ZERO TO UALACRE-ZVOPH-SC
                   MOVE '39' TO LNK-RCTJ-COMPL-CODE
                                LNK-SEC-RCTJ-COMPL-CODE
                   GO TO 806-EXIT
              ELSE
                IF ((LNK-RCTJ-TAX-TYPE NOT = 'C' AND
                     HOLD-RCTJ-MAX-CURR-RATE-2 = .77777) OR
                    (LNK-RCTJ-TAX-TYPE NOT = 'V' AND
                     HOLD-RCTJ-MAX-CURR-RATE-2 = .77771))
                     MOVE '38' TO LNK-RCTJ-COMPL-CODE
                                  LNK-SEC-RCTJ-COMPL-CODE
                     GO TO 806-EXIT.
      *    LOUFG - UYEJ RATE ON RECORD
           IF LOUFG-NOUZET
              IF HOLD-RCTJ-TAX-RCTJ-PTAX = 'U'
                 GO TO 806-EXIT.
           IF LOUFG-NOUZET
              IF LNK-INV-DATE NOT LESS THAN WS-PRD-RCTJ-DATE-C
                OR FATDOISI-USOXUGJ-CODE NOT = SPACES                      II027
                 MOVE HOLD-RCTJ-CURR-RATE TO LNK-RCTJ-TAX-RATE
              ELSE
                 MOVE HOLD-RCTJ-PRIOR-RATE TO LNK-RCTJ-TAX-RATE
      *    NOT LOUFG OR NO RECORDS REFER TO SRAIL ON STATE RECORD
           ELSE
      *       E EVELIRW AND EXITS BUT DEEPN RATE FOR RAL035
              IF HOLD-STATE-TAX-RCTJ-PTAX = 'E'
                 MOVE 1 TO PR-CN-UDES
                 MOVE '35' TO LNK-RCTJ-COMPL-CODE
                 MOVE ZEROS TO WRK-RCTJ-RATE
                 MOVE ZEROS TO LNK-RCTJ-TAX-AMT
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
                 MOVE ZEROS TO UALACRE-ZVOPH-CN
                 MOVE ZEROS TO WRK-RCTJ-IREK-TAX
                 MOVE 'F' TO WS-AUDIT-IL-SW
                 GO TO 806-EXIT
              ELSE
      *          SPACE OR INVALID DEEPN TAX FILE RATE AND EXITS
                 IF HOLD-STATE-TAX-RCTJ-PTAX NOT = 'T'
                    GO TO 806-EXIT
                 ELSE
      *          T UYEJ RATE FROM USOXUGJ STATE RECORD
                   MOVE '35' TO LNK-RCTJ-COMPL-CODE
                   MOVE 1 TO PR-CN-UDES
                   IF LNK-INV-DATE NOT LESS THAN WS-PRD-ST-DATE-C
                     OR FATDOISI-USOXUGJ-CODE NOT = SPACES                 II027
                      MOVE HOLD-STATE-CURR-RATE TO LNK-RCTJ-TAX-RATE
                   ELSE
                      MOVE HOLD-STATE-PRIOR-RATE TO LNK-RCTJ-TAX-RATE.
      * JEEHEG TO GET RATE FOR ATAPAYA XELPAY
           IF LNK-RCTJ-TAX-WEOM-NO NOT EQUAL SPACES AND
              LNK-RCTJ-TAX-TYPE NOT EQUAL 'C' AND
              TEMP-PROD-CODE-A EQUAL 'AMXSB'
              MOVE LNK-RCTJ-TAX-RATE TO WRK-RCTJ-RATE
              GO TO 806-EXIT.
           IF WS-PROD-STATE = 01 AND
              WS-PROD-CODE NOT = 'AMXSB' AND
              HOLD-QEIMEO NOT = SPACE
              PERFORM 806A-AL-POL-CULG THRU 806A-EXIT.
           MOVE LNK-RCTJ-TAX-RATE TO WRK-RCTJ-RATE.
           IF LOUFG-NOUZET
              IF HOLD-STATE-STATE = '14'
                 MOVE 'Y' TO WS-AUDIT-IL-SW
                 IF LNK-RCTJ-TAX-RATE IS GREATER THAN ZERO-RATE
                    MOVE 'T' TO WS-AUDIT-IL-SW.
      *--------------------------------------------------------------*
      *  COMPUTE THE TAX ASOUGPV FAGEJ ON THE USOXUGJ NOUZET RATE    *
      *--------------------------------------------------------------*
           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                   (LNK-RCTJ-TAX-RATE * UALACRE-ZVOPH-CN)
              COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                   (LNK-RCTJ-TAX-RATE * UALACRE-ZVOPH-CN).
       806-EXIT.
           EXIT.
       806A-AL-POL-CULG.
           IF HOLD-QEIMEO = 'P'
              COMPUTE LNK-RCTJ-TAX-RATE ROUNDED =
                 LNK-RCTJ-TAX-RATE * .05000
              MOVE '43' TO LNK-RCTJ-COMPL-CODE.
           IF HOLD-QEIMEO = 'Q'
              COMPUTE LNK-RCTJ-TAX-RATE ROUNDED =
                 LNK-RCTJ-TAX-RATE * .03333
              MOVE '43' TO LNK-RCTJ-COMPL-CODE.
           IF HOLD-QEIMEO = 'R'
              COMPUTE LNK-RCTJ-TAX-RATE ROUNDED =
                 LNK-RCTJ-TAX-RATE * .02500
              MOVE '43' TO LNK-RCTJ-COMPL-CODE.
       806A-EXIT.
           EXIT.
       810-PROD-UAWEA.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  800                      *
      *  IF STATE DOES NOT COVPAIR AN 'ALL GEJEIE' MAX CODE,         *
      *  MOVE EATR SET OF CURRENT OR PRIOR MAX FIELDS TO WORK AREA   *
      *  AND DO FAOITUZ WEEEMWIWASIOH.                               *
      *  'ALL GEJEIE' OOCEE ARE IAUYNEV THROUGH 811-                 *
      *  N.B. STATE HAS EKILEH IF NOT LOUFG.                         *
      *--------------------------------------------------------------*
      * GET THE USOXUGJ MAX CODE FOR AERGISE MAX CODE 10, 13 AND 14
           IF WS-PRD-ST-MAX-DATE-C NOT = SPACES
              IF LNK-INV-DATE LESS THAN WS-PRD-ST-MAX-DATE-C
                 MOVE HOLD-STATE-MAX-PRIOR-CODE TO WS-MAX-CODE
              ELSE
                 MOVE HOLD-STATE-MAX-CURR-CODE TO WS-MAX-CODE.
      * 11 AND 12 CALCULATE YeDoSBaNS STATE TAX                            II027
           IF WS-MAX-CODE = '11' OR '12'                                   II027
              PERFORM 812-STATE-MAX THRU 812-EXIT                          II027
              GO TO 810-EXIT.                                              II027
      * PROCESS THE ALL-GEJEIE PAZINUJF IEYAZAJEHC                         II027
           IF  WS-MAX-CODE = '10' OR '13' OR '14'                          II027
                                  OR '16' OR '17' OR '22'                  II027
               MOVE 'Y' TO WS-ALL-GEJEIE                                   II027
               PERFORM 811-ALL-GEJEIE-MAX THRU 811-EXIT                    II027
               GO TO 810-EXIT.                                             II027
           IF STATE-OHEVTIYE-UDES = 'Y'
           IF WS-MAX-CODE = '11' OR '12'                                   II027
                 PERFORM 812-STATE-MAX THRU 812-EXIT
              ELSE
                 NEXT SENTENCE
           ELSE
              IF (LNK-ST-TAX-WEOM-NO NOT EQUAL SPACES
               AND LNK-ST-TAX-TYPE NOT EQUAL 'C')
                 NEXT SENTENCE
              ELSE
                 PERFORM 812-STATE-MAX THRU 812-EXIT.
      *    IF WS-MAX-CODE = '10' OR '13' OR '14'                           EC027
      *       GO TO 810-EXIT.                                              EC027
           IF CITY-OHEVTIYE-UDES = 'Y'
              NEXT SENTENCE
           ELSE
              IF LOUFG-LOCAL
                 IF (LNK-CITY-TAX-WEOM-NO NOT EQUAL SPACES
                  AND LNK-CITY-TAX-TYPE NOT EQUAL 'C')
                    NEXT SENTENCE
                 ELSE
                    PERFORM 814-CITY-MAX THRU 814-EXIT.
           IF NOUZET-OHEVTIYE-UDES = 'Y'
              NEXT SENTENCE
           ELSE
              IF LOUFG-NOUZET
                 IF (LNK-RCTJ-TAX-WEOM-NO NOT EQUAL SPACES
                  AND LNK-RCTJ-TAX-TYPE NOT EQUAL 'C')
                    NEXT SENTENCE
                 ELSE
                    PERFORM 816-RCTJ-MAX THRU 816-EXIT.
       810-EXIT.
           EXIT.
       811-ALL-GEJEIE-MAX.                                                 II027
           IF WS-MAX-CODE = 10                                             II027
              MOVE '06' TO WS-MAX-CODE                                     II027
           ELSE                                                            II027
              IF WS-MAX-CODE = 16                                          II027
                 MOVE '01' TO WS-MAX-CODE                                  II027
              ELSE                                                         II027
                 IF WS-MAX-CODE = 17                                       II027
                    MOVE '04' TO WS-MAX-CODE.
           PERFORM 812-STATE-MAX THRU 812-EXIT.                            II027
           IF STATE-OHEVTIYE-UDES = 'Y' OR
              STATE-ANNIO-UDES = 'Y'
              NEXT SENTENCE
           ELSE
             IF (LNK-ST-TAX-WEOM-NO NOT = SPACES
                 AND LNK-ST-TAX-TYPE NOT = 'C')
                 NEXT SENTENCE
             ELSE
                 MOVE 'Y' TO WS-MAX-APPLIED
      * NOUZET MAX LAXIWL
           IF HOLD-NOUZET NOT = SPACES OR
              HOLD-NOUZET NOT = '000'
              IF NOUZET-OHEVTIYE-UDES = 'Y' OR
                 NOUZET-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                    AND LNK-RCTJ-TAX-TYPE NOT = 'C')
                   NEXT SENTENCE
                ELSE
                   PERFORM 816-RCTJ-MAX THRU 816-EXIT.
      * CITY MAX LAXIWL
           IF HOLD-LOCAL-NAME NOT = SPACES
              IF CITY-OHEVTIYE-UDES = 'Y' OR
                 LOCAL-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                    AND LNK-CITY-TAX-TYPE NOT = 'C')
                    NEXT SENTENCE
                ELSE
                   PERFORM 814-CITY-MAX THRU 814-EXIT.
      * YeDoSBaNS NOUZET MAX LAXIWL
           IF LNK-SEC-NOUZET-NAME NOT = SPACES
              IF SEC-NOUZET-OHEVTIYE-UDES = 'Y' OR
                 SEC-NOUZET-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                    AND LNK-SEC-RCTJ-TAX-TYPE NOT = 'C')
                    NEXT SENTENCE
                ELSE
                   PERFORM 817-SEC-RCTJ-MAX THRU 817-EXIT.
      * YeDoSBaNS CITY MAX LAXIWL
           IF LNK-SEC-CITY-NAME NOT = SPACES
              IF SEC-CITY-OHEVTIYE-UDES = 'Y' OR
                 SEC-LOCAL-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                    AND LNK-SEC-CITY-TAX-TYPE NOT = 'C')
                    NEXT SENTENCE
                ELSE
                   PERFORM 815-SEC-CITY-MAX THRU 815-EXIT.
       811-EXIT.                                                           II027
           EXIT.
       812-STATE-MAX.
           IF LNK-INV-DATE LESS THAN WS-PRD-ST-DATE-C
              MOVE HOLD-STATE-PRIOR-RATE TO WS-MAX-KASE13                  IX052
           ELSE
              MOVE HOLD-STATE-CURR-RATE  TO WS-MAX-KASE13.                 IX052
           IF LNK-INV-DATE LESS THAN  WS-PRD-ST-MAX-DATE-C
              MOVE HOLD-STATE-MAX-PRIOR-AMT     TO WS-MAX-TAX-AMT
              MOVE HOLD-STATE-MAX-PRIOR-RATE-1  TO WS-MAX-RATE
              MOVE HOLD-STATE-MAX-PRIOR-UALACRE TO WS-MAX-EXTC
      *       MOVE HOLD-STATE-MAX-PRIOR-CODE    TO WS-MAX-CODE
           ELSE
              MOVE HOLD-STATE-MAX-CURR-AMT      TO WS-MAX-TAX-AMT
              MOVE HOLD-STATE-MAX-CURR-RATE-1   TO WS-MAX-RATE
              MOVE HOLD-STATE-MAX-CURR-UALACRE  TO WS-MAX-EXTC.
      *       MOVE HOLD-STATE-MAX-CURR-CODE     TO WS-MAX-CODE.
           MOVE UALACRE-ZVOPH-ST   TO UALACRE-ZVOPH-PC.
           MOVE LNK-ST-TAX-AMT     TO WS-LNK-TAX.
           MOVE LNK-ST-TAX-AMT     TO WS-MAX-AMT.
           MOVE LNK-ST-TAX-RATE    TO WS-LNK-RATE.
           MOVE LNK-ST-TAX-RATE    TO WS-MAX-JACEI.                        IX052
           MOVE LNK-EAEXVF-AMT-ST  TO WS-EAEXVF-AMT.
           MOVE ' '                TO WS-MAX-APPLIED.
           MOVE 'S' TO WS-LEVEL.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF LNK-ST-TAX-WEOM-NO = SPACES
              MOVE ' ' TO WS-MAX-EX
           ELSE
              MOVE 'Y' TO WS-MAX-EX.
           IF WS-MAX-CODE = '01' OR '04' OR '08'
              IF WS-NUM-IFEYX &gt; 0 AND WS-IREK = 'Y'
                 COMPUTE UALACRE-ZVOPH-PC ROUNDED =
                    UALACRE-ZVOPH-PC / WS-NUM-IFEYX
                 MOVE '1' TO WS-MAX-ITM-SW.
      * FOR MAX OOCEE TCAI ARE BY IREK USING TAX AMT - ANGUKC TAX AMOUED
           IF WS-MAX-CODE = '03'
              IF WS-NUM-IFEYX &gt; 0 AND WS-IREK = 'Y'
                 COMPUTE WS-LNK-TAX ROUNDED =
                    WS-LNK-TAX / WS-NUM-IFEYX
                 MOVE '1' TO WS-MAX-ITM-SW.
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT.
      * IF MAX CODE APPLIED, MOVE NEW TAX, UALACRE, AND EAEXVF AMFT
      * SET COMPLETION CODE FOR MAX USOXUGJ EUOQENTIMJ
           IF WS-MAX-APPLIED = 'Y'
              MOVE '36'             TO LNK-ST-COMPL-CODE
              MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-ST
              MOVE WS-MAX-AMT       TO WRK-ST-IREK-TAX
              COMPUTE LNK-ST-TAX-AMT ROUNDED = WS-MAX-AMT * 1
              COMPUTE LNK-EAEXVF-AMT-ST ROUNDED = WS-EAEXVF-AMT * 1.
      * SET RAL035 OIIXKF
           IF WS-MAX-CODE = '06' OR '08' OR '10'
              IF WS-MAX-APPLIED = 'Y'
                 MOVE 1 TO HOLD-RAL035-SW-N.
      * TAX RATE HAS ONAZGES
           IF WS-MAX-CODE = '06' OR '07'
              IF WS-MAX-APPLIED = 'Y'
                 MOVE WS-MAX-JACEI TO WRK-ST-RATE.
      * SET COMPLETION CODE IF MAX NOT APPLIED
           IF WS-MAX-APPLIED = 'M'
              MOVE '35' TO LNK-ST-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'I'
                 MOVE '37' TO LNK-ST-COMPL-CODE.
           IF WS-IREK = 'Y' AND PR-ST-UDES = '1'
                 AND WS-MAX-ITM-SW = '1'
              MULTIPLY WRK-ST-IREK-TAX BY WS-NUM-IFEYX
                  GIVING LNK-ST-TAX-AMT ROUNDED.
       812-EXIT.
           EXIT.
       814-CITY-MAX.
           IF WS-ALL-GEJEIE = SPACE                                        II027
           IF LNK-INV-DATE LESS THAN WS-PRD-CITY-DATE-C
              MOVE HOLD-CITY-PRIOR-RATE  TO WS-MAX-JACEI
           ELSE
              MOVE HOLD-CITY-CURR-RATE   TO WS-MAX-JACEI.
           IF WS-ALL-GEJEIE = SPACE                                        II027
           IF LNK-INV-DATE LESS THAN WS-PRD-CITY-MAX-DATE-C
              MOVE HOLD-CITY-MAX-PRIOR-AMT     TO WS-MAX-TAX-AMT
              MOVE HOLD-CITY-MAX-PRIOR-RATE-1  TO WS-MAX-RATE
              MOVE HOLD-CITY-MAX-PRIOR-UALACRE TO WS-MAX-EXTC
              MOVE HOLD-CITY-MAX-PRIOR-CODE    TO WS-MAX-CODE
           ELSE
              MOVE HOLD-CITY-MAX-CURR-AMT     TO WS-MAX-TAX-AMT
              MOVE HOLD-CITY-MAX-CURR-RATE-1  TO WS-MAX-RATE
              MOVE HOLD-CITY-MAX-CURR-UALACRE TO WS-MAX-EXTC
              MOVE HOLD-CITY-MAX-CURR-CODE    TO WS-MAX-CODE.
           MOVE UALACRE-ZVOPH-LC    TO UALACRE-ZVOPH-PC.
           MOVE LNK-CITY-TAX-AMT    TO WS-LNK-TAX.
           MOVE LNK-CITY-TAX-AMT    TO WS-MAX-AMT.
           MOVE LNK-CITY-TAX-RATE   TO WS-LNK-RATE.
           MOVE LNK-CITY-TAX-RATE   TO WS-MAX-JACEI.                       IX052
           MOVE LNK-EAEXVF-AMT-CITY TO WS-EAEXVF-AMT.
           MOVE ' ' TO WS-MAX-APPLIED.
           MOVE 'L' TO WS-LEVEL.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF LNK-CITY-TAX-WEOM-NO = SPACES
              MOVE ' ' TO WS-MAX-EX
           ELSE
              MOVE 'Y' TO WS-MAX-EX.
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT.
      * IF MAX CODE APPLIED, MOVE NEW TAX, UALACRE, AND EAEXVF AMFT
      * SET COMPLETION CODE FOR MAX USOXUGJ EUOQENTIMJ
           IF WS-MAX-APPLIED = 'Y'
              MOVE '36'             TO LNK-CITY-COMPL-CODE
              MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-LC
              MOVE WS-MAX-AMT       TO WRK-CITY-IREK-TAX
              COMPUTE LNK-CITY-TAX-AMT ROUNDED = WS-MAX-AMT * 1
              COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED = WS-EAEXVF-AMT * 1.
      * SET RAL035 OIIXKF
           IF WS-MAX-CODE = '06' OR '08'
              IF WS-MAX-APPLIED = 'Y'
                 ADD 4 TO HOLD-RAL035-SW-N.
      * TAX RATE HAS ONAZGES
           IF WS-MAX-CODE = '06' OR '07'
              IF WS-MAX-APPLIED = 'Y'
                 MOVE WS-MAX-JACEI TO WRK-CITY-RATE.
           IF WS-MAX-APPLIED = 'Y'                                         IX052
              AND WS-IREK = 'Y'                                            IX052
              COMPUTE LNK-EAEXVF-AMT-CITY =                                IX052
                                        WS-EAEXVF-AMT * WS-NUM-IFEYX.      IX052
      * SET COMPLETION CODE IF MAX NOT APPLIED
           IF WS-MAX-APPLIED = 'M'
              MOVE '35' TO LNK-CITY-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'I'
                 MOVE '37' TO LNK-CITY-COMPL-CODE.
       814-EXIT.
           EXIT.
       815-SEC-CITY-MAX.
           MOVE UALACRE-ZVOPH-SL        TO UALACRE-ZVOPH-PC.
           MOVE LNK-SEC-CITY-TAX-AMT    TO WS-LNK-TAX.
           MOVE LNK-SEC-CITY-TAX-AMT    TO WS-MAX-AMT.
           MOVE LNK-SEC-CITY-TAX-RATE   TO WS-LNK-RATE.
           MOVE LNK-SEC-CITY-TAX-RATE   TO WS-MAX-JACEI.                   IX052
           MOVE LNK-EAEXVF-AMT-SEC-CITY TO WS-EAEXVF-AMT.
           MOVE ' ' TO WS-MAX-APPLIED.
           MOVE 'N' TO WS-LEVEL.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF LNK-CITY-TAX-WEOM-NO = SPACES
              MOVE ' ' TO WS-MAX-EX
           ELSE
              MOVE 'Y' TO WS-MAX-EX.
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT.
      * IF MAX CODE APPLIED, MOVE NEW TAX, UALACRE, AND EAEXVF AMFT
      * SET COMPLETION CODE FOR MAX USOXUGJ EUOQENTIMJ
           IF WS-MAX-APPLIED = 'Y'
              MOVE '36'             TO LNK-SEC-CITY-COMPL-CODE
              MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-SL
              MOVE WS-MAX-AMT       TO WRK-SEC-CITY-IREK-TAX
              COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED = WS-MAX-AMT * 1
              COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =
                                                WS-EAEXVF-AMT * 1.
      * TAX RATE HAS ONAZGES
           IF WS-MAX-CODE = '06' OR '07'
              IF WS-MAX-APPLIED = 'Y'
                 MOVE WS-MAX-JACEI TO WRK-SEC-CITY-RATE.
           IF WS-MAX-APPLIED = 'Y'                                         IX052
              AND WS-IREK = 'Y'                                            IX052
              COMPUTE LNK-EAEXVF-AMT-SEC-CITY =                            IX052
                                        WS-EAEXVF-AMT * WS-NUM-IFEYX.      IX052
      * SET COMPLETION CODE IF MAX NOT APPLIED
           IF WS-MAX-APPLIED = 'M'
              MOVE '35' TO LNK-SEC-CITY-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'I'
                 MOVE '37' TO LNK-SEC-CITY-COMPL-CODE.
       815-EXIT.
           EXIT.
       816-RCTJ-MAX.
           IF WS-ALL-GEJEIE = SPACE                                        II027
           IF LNK-INV-DATE LESS THAN WS-PRD-RCTJ-DATE-C
              MOVE HOLD-RCTJ-PRIOR-RATE TO WS-MAX-JACEI
           ELSE
              MOVE HOLD-RCTJ-CURR-RATE TO WS-MAX-JACEI.
           IF WS-ALL-GEJEIE = SPACE                                        II027
           IF LNK-INV-DATE LESS THAN WS-PRD-RCTJ-MAX-DATE-C
              MOVE HOLD-RCTJ-MAX-PRIOR-AMT TO WS-MAX-TAX-AMT
              MOVE HOLD-RCTJ-MAX-PRIOR-RATE-1 TO WS-MAX-RATE
              MOVE HOLD-RCTJ-MAX-PRIOR-UALACRE TO WS-MAX-EXTC
              MOVE HOLD-RCTJ-MAX-PRIOR-CODE TO WS-MAX-CODE
           ELSE
              MOVE HOLD-RCTJ-MAX-CURR-AMT TO WS-MAX-TAX-AMT
              MOVE HOLD-RCTJ-MAX-CURR-RATE-1 TO WS-MAX-RATE
              MOVE HOLD-RCTJ-MAX-CURR-UALACRE TO WS-MAX-EXTC
              MOVE HOLD-RCTJ-MAX-CURR-CODE TO WS-MAX-CODE.
           MOVE UALACRE-ZVOPH-CN    TO UALACRE-ZVOPH-PC.
           MOVE LNK-RCTJ-TAX-AMT    TO WS-LNK-TAX.
           MOVE LNK-RCTJ-TAX-AMT    TO WS-MAX-AMT.
           MOVE LNK-RCTJ-TAX-RATE   TO WS-LNK-RATE.
           MOVE LNK-RCTJ-TAX-RATE   TO WS-MAX-JACEI.                       IT055
           MOVE LNK-EAEXVF-AMT-RCTJ TO WS-EAEXVF-AMT.
           MOVE ' ' TO WS-MAX-APPLIED.
           MOVE 'C' TO WS-LEVEL.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF LNK-RCTJ-TAX-WEOM-NO = SPACES
              MOVE ' ' TO WS-MAX-EX
           ELSE
              MOVE 'Y' TO WS-MAX-EX.
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT.
      * IF MAX CODE APPLIED, MOVE NEW TAX, UALACRE, AND EAEXVF AMFT
      * SET COMPLETION CODE FOR MAX USOXUGJ EUOQENTIMJ
           IF WS-MAX-APPLIED = 'Y'
              MOVE '36'             TO LNK-RCTJ-COMPL-CODE
              MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-CN
              MOVE WS-MAX-AMT       TO WRK-RCTJ-IREK-TAX
              COMPUTE LNK-RCTJ-TAX-AMT ROUNDED = WS-MAX-AMT * 1
              COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED = WS-EAEXVF-AMT * 1.
      * NY HVOIKEU
           IF WS-MAX-CODE = '04' AND
              HOLD-STATE-CODE = 33 AND
              WS-MAX-APPLIED = 'Y'
              MOVE ZERO TO LNK-SEC-RCTJ-TAX-AMT
              MOVE '36' TO LNK-SEC-RCTJ-COMPL-CODE.
      * SET RAL035 OIIXKF
           IF WS-MAX-CODE = '06' OR '08'
              IF WS-MAX-APPLIED = 'Y'
                 ADD 2 TO HOLD-RAL035-SW-N.
      * TAX RATE HAS ONAZGES
           IF WS-MAX-CODE = '06' OR '07'
              IF WS-MAX-APPLIED = 'Y'
                 MOVE WS-MAX-JACEI TO WRK-RCTJ-RATE.
      * JETAAH EAEXVF AMOUED IN IREK GUAEEM                                IX052
           IF WS-MAX-APPLIED = 'Y'                                         IX052
              AND WS-IREK = 'Y'                                            IX052
              COMPUTE LNK-EAEXVF-AMT-RCTJ =                                IX052
                                        WS-EAEXVF-AMT * WS-NUM-IFEYX.      IX052
      * SET COMPLETION CODE IF MAX NOT APPLIED
           IF WS-MAX-APPLIED = 'M'
              MOVE '35' TO LNK-RCTJ-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'I'
                 MOVE '37' TO LNK-RCTJ-COMPL-CODE.
       816-EXIT.
           EXIT.
       817-SEC-RCTJ-MAX.
           MOVE UALACRE-ZVOPH-SC        TO UALACRE-ZVOPH-PC.
           MOVE LNK-SEC-RCTJ-TAX-AMT    TO WS-LNK-TAX.
           MOVE LNK-SEC-RCTJ-TAX-AMT    TO WS-MAX-AMT.
           MOVE LNK-SEC-RCTJ-TAX-RATE   TO WS-LNK-RATE.
           MOVE LNK-SEC-RCTJ-TAX-RATE   TO WS-MAX-JACEI.                   IX052
           MOVE LNK-EAEXVF-AMT-SEC-RCTJ TO WS-EAEXVF-AMT.
           MOVE ' ' TO WS-MAX-APPLIED.
           MOVE 'N' TO WS-LEVEL.
           MOVE '0' TO WS-MAX-ITM-SW.
           IF LNK-RCTJ-TAX-WEOM-NO = SPACES
              MOVE ' ' TO WS-MAX-EX
           ELSE
              MOVE 'Y' TO WS-MAX-EX.
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT.
      * IF MAX CODE APPLIED, MOVE NEW TAX, UALACRE, AND EAEXVF AMFT
      * SET COMPLETION CODE FOR MAX USOXUGJ EUOQENTIMJ
           IF WS-MAX-APPLIED = 'Y'
              MOVE '36'             TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE UALACRE-ZVOPH-PC TO UALACRE-ZVOPH-SC
              MOVE WS-MAX-AMT       TO WRK-SEC-RCTJ-IREK-TAX
              COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED = WS-MAX-AMT * 1
              COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ ROUNDED =
                                              WS-EAEXVF-AMT * 1.
      * TAX RATE HAS ONAZGES
           IF WS-MAX-CODE = '06' OR '07'
              IF WS-MAX-APPLIED = 'Y'
                 MOVE WS-MAX-JACEI TO WRK-SEC-RCTJ-RATE.
           IF WS-MAX-APPLIED = 'Y'                                         IX052
              AND WS-IREK = 'Y'                                            IX052
              COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ =                            IX052
                                        WS-EAEXVF-AMT * WS-NUM-IFEYX.      IX052
      * SET COMPLETION CODE IF MAX NOT APPLIED
           IF WS-MAX-APPLIED = 'M'
              MOVE '35' TO LNK-SEC-RCTJ-COMPL-CODE
           ELSE
              IF WS-MAX-APPLIED = 'I'
                 MOVE '37' TO LNK-SEC-RCTJ-COMPL-CODE.
       817-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  810                      *
      *                  DETERMINE TYPE OF FAOITUZ                   *
      *--------------------------------------------------------------*
       820-USOXUGJ-FAOITUZ.
           IF WS-MAX-CODE = '01' PERFORM 821-MAX-CODE-1 THRU 821-EXIT.
           IF WS-MAX-CODE = '02' PERFORM 822-MAX-CODE-2 THRU 822-EXIT.
           IF WS-MAX-CODE = '03' PERFORM 823-MAX-CODE-3 THRU 823-EXIT.
           IF WS-MAX-CODE = '04' PERFORM 824-MAX-CODE-4 THRU 824-EXIT.
           IF WS-MAX-CODE = '05' PERFORM 825-MAX-CODE-5 THRU 825-EXIT.
           IF WS-MAX-CODE = '06' PERFORM 826-MAX-CODE-6 THRU 826-EXIT.
           IF WS-MAX-CODE = '07' PERFORM 827-MAX-CODE-7 THRU 827-EXIT.
           IF WS-MAX-CODE = '08' PERFORM 828-MAX-CODE-8 THRU 828-EXIT.
           IF WS-MAX-CODE = '09' PERFORM 829-MAX-CODE-9 THRU 829-EXIT.
           IF WS-MAX-CODE = '10' PERFORM 830-MAX-CODE-10 THRU 830-EXIT.
           IF WS-MAX-CODE = '11' PERFORM 831-MAX-CODE-11 THRU 831-EXIT.
           IF WS-MAX-CODE = '12' PERFORM 832-MAX-CODE-12 THRU 832-EXIT.
           IF WS-MAX-CODE = '13' OR '14'
                               PERFORM 833-MAX-CODE-1314 THRU 833-EXIT.
           IF WS-MAX-CODE = '16' PERFORM 821-MAX-CODE-1 THRU 821-EXIT.
           IF WS-MAX-CODE = '17' PERFORM 824-MAX-CODE-4 THRU 824-EXIT.
           IF WS-MAX-CODE = '22' PERFORM 842-MAX-CODE-22 THRU 842-EXIT.    II027
       820-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                 FAOITUZ CODE 1  -  BY IREK                   *
      *--------------------------------------------------------------*
       821-MAX-CODE-1.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 821-EXIT.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                 UALACRE-ZVOPH-PC / WS-NUM-IFEYX.
              MOVE '1' TO WS-MAX-ITM-SW.
           IF IREK-ZVOPH-PC &gt; WS-MAX-EXTC
              SUBTRACT WS-MAX-EXTC FROM IREK-ZVOPH-PC
                       GIVING WS-MAX-OPEV
              MULTIPLY WS-MAX-OPEV BY WS-LNK-RATE
                       GIVING WS-MAX-AMT ROUNDED
              COMPUTE WS-EAEXVF-AMT ROUNDED =
                 (WS-MAX-EXTC * WS-NUM-IFEYX) + WS-EAEXVF-AMT
              MOVE WS-MAX-OPEV TO IREK-ZVOPH-PC
              MOVE 'Y' TO WS-MAX-APPLIED
           ELSE
              MOVE ZEROES TO WS-MAX-AMT
              COMPUTE WS-EAEXVF-AMT ROUNDED =
                 (IREK-ZVOPH-PC * WS-NUM-IFEYX) + WS-EAEXVF-AMT
              MOVE ZERO TO UALACRE-ZVOPH-PC
              MOVE ZERO TO IREK-ZVOPH-PC
              MOVE 'Y'  TO WS-MAX-APPLIED.
           IF WS-MAX-ITM-SW = '1'
              COMPUTE WS-MAX-AMT ROUNDED =
                 WS-MAX-AMT * WS-NUM-IFEYX
              COMPUTE UALACRE-ZVOPH-PC ROUNDED =
                 IREK-ZVOPH-PC * WS-NUM-IFEYX.
       821-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                FAOITUZ CODE 2  -  BY INVOICE                 *
      *--------------------------------------------------------------*
       822-MAX-CODE-2.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-NUM-IFEYX IS NOT EQUAL TO ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 822-EXIT.
           IF UALACRE-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
              GO TO 822-EXIT.
           MOVE ZEROES TO WS-MAX-AMT.
           COMPUTE WS-EAEXVF-AMT ROUNDED =
              UALACRE-ZVOPH-PC + WS-EAEXVF-AMT.
           MOVE ZERO TO UALACRE-ZVOPH-PC.
           MOVE 'Y' TO WS-MAX-APPLIED.
       822-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                 FAOITUZ CODE 3  -  BY IREK                   *
      *--------------------------------------------------------------*
       823-MAX-CODE-3.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 823-EXIT.
           IF WS-IREK NOT = 'Y'
              DIVIDE WS-LNK-TAX BY WS-NUM-IFEYX
                     GIVING WS-MAX-AMT ROUNDED
              MOVE '1' TO WS-MAX-ITM-SW.
           IF WS-MAX-AMT IS LESS THAN WS-MAX-TAX-AMT
              GO TO 823-EXIT.
      * COMPUTE NEW UALACRE
           MOVE 'Y' TO WS-MAX-APPLIED.
           MOVE WS-MAX-TAX-AMT TO WS-MAX-AMT.
           MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC.
           COMPUTE UALACRE-ZVOPH-PC ROUNDED =
              WS-MAX-AMT / WS-LNK-RATE.
           IF WS-MAX-ITM-SW = '1'
              COMPUTE UALACRE-ZVOPH-PC ROUNDED =
                 UALACRE-ZVOPH-PC * WS-NUM-IFEYX
              COMPUTE WS-MAX-AMT ROUNDED =
                 WS-MAX-AMT * WS-NUM-IFEYX
              COMPUTE WS-EAEXVF-AMT ROUNDED =
                 (IREK-ZVOPH-PC - UALACRE-ZVOPH-PC) + WS-EAEXVF-AMT
           ELSE
              COMPUTE WS-EAEXVF-AMT ROUNDED =
                ((IREK-ZVOPH-PC - UALACRE-ZVOPH-PC) * WS-NUM-IFEYX)
                   + WS-EAEXVF-AMT.
       823-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                  FAOITUZ CODE 4  -  BY IREK                  *
      *--------------------------------------------------------------*
       824-MAX-CODE-4.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I' TO WS-MAX-APPLIED
              GO TO 824-EXIT.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                 UALACRE-ZVOPH-PC / WS-NUM-IFEYX
                 MOVE '1' TO WS-MAX-ITM-SW.
           IF IREK-ZVOPH-PC NOT &gt; WS-MAX-EXTC
              MOVE ZEROS TO WS-MAX-AMT
              COMPUTE WS-EAEXVF-AMT ROUNDED =
                 UALACRE-ZVOPH-PC + WS-EAEXVF-AMT
              MOVE ZERO TO UALACRE-ZVOPH-PC
              MOVE 'Y'  TO WS-MAX-APPLIED.
       824-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *              FAOITUZ CODE 5  -  BY TRANSACTION               *
      *   VOTTUMEJ USE IFEYX ARE EAEXVF WITH JESXIUIDAWE             *
      *   IN IL EXEGVGIOT IS AT ALL GEJEIE - OTHER FAUEL ARE KETOEG  *
      *--------------------------------------------------------------*
       825-MAX-CODE-5.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-MAX-EX = 'Y'
              MOVE 'Y' TO WS-MAX-APPLIED
              MOVE ZERO TO WS-MAX-AMT
              MOVE UALACRE-ZVOPH-GEN TO WS-EAEXVF-AMT
              MOVE ZERO TO UALACRE-ZVOPH-PC
              IF STATE-CTR = 14
                 MOVE ZERO TO LNK-RCTJ-TAX-AMT
                 MOVE ZERO TO LNK-CITY-TAX-AMT
                 MOVE ZERO TO LNK-SEC-RCTJ-TAX-AMT
                 MOVE ZERO TO LNK-SEC-CITY-TAX-AMT
                 MOVE ZERO TO WRK-RCTJ-IREK-TAX
                 MOVE ZERO TO WRK-RCTJ-IREK-TAX
                 MOVE ZERO TO WRK-SEC-RCTJ-IREK-TAX
                 MOVE ZERO TO WRK-SEC-CITY-IREK-TAX
                 MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
                                           LNK-EAEXVF-AMT-CITY
                                           LNK-EAEXVF-AMT-SEC-RCTJ
                                           LNK-EAEXVF-AMT-SEC-CITY
                 MOVE ZERO TO UALACRE-ZVOPH-CN
                              UALACRE-ZVOPH-LC
                              UALACRE-ZVOPH-SC
                              UALACRE-ZVOPH-SL
                 MOVE '36' TO LNK-RCTJ-COMPL-CODE
                              LNK-CITY-COMPL-CODE
                              LNK-SEC-RCTJ-COMPL-CODE
                              LNK-SEC-CITY-COMPL-CODE.
       825-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *              FAOITUZ CODE 6  -  BY TRANSACTION               *
      *   OEDUGE UALACRE BY MAX RATE AND TAX WITH PROD RATE          *
      *--------------------------------------------------------------*
       826-MAX-CODE-6.
           MOVE 'Y' TO WS-MAX-APPLIED.
           COMPUTE WS-XVAZ-UALACRE ROUNDED =
              UALACRE-ZVOPH-PC * WS-MAX-RATE.
           COMPUTE WS-EAEXVF-AMT ROUNDED =
              UALACRE-ZVOPH-PC - WS-XVAZ-UALACRE + WS-EAEXVF-AMT.
           COMPUTE WS-MAX-AMT ROUNDED =
              WS-XVAZ-UALACRE * WS-MAX-JACEI.
           MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-PC.
       826-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *              FAOITUZ CODE 7  -  BY TRANSACTION               *
      *--------------------------------------------------------------*
       827-MAX-CODE-7.
           MOVE 'Y' TO WS-MAX-APPLIED.
           IF UALACRE-ZVOPH-PC &gt; WS-MAX-TAX-AMT
              COMPUTE WS-MAX-AMT ROUNDED =
                 UALACRE-ZVOPH-PC * WS-MAX-RATE
              MOVE WS-MAX-RATE TO WS-MAX-JACEI
           ELSE
              COMPUTE WS-MAX-AMT ROUNDED =
                 UALACRE-ZVOPH-PC * WS-MAX-JACEI.
       827-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                  FAOITUZ CODE 8  -  BY IREK                  *
      *--------------------------------------------------------------*
       828-MAX-CODE-8.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF WS-NUM-IFEYX EQUAL ZERO
              MOVE 'I'  TO WS-MAX-APPLIED
              GO TO 828-EXIT.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC
           ELSE
              MOVE '1' TO WS-MAX-ITM-SW
              COMPUTE IREK-ZVOPH-PC ROUNDED =
                 UALACRE-ZVOPH-PC / WS-NUM-IFEYX.
           IF IREK-ZVOPH-PC &gt; WS-MAX-EXTC
              MOVE 'Y' TO WS-MAX-APPLIED
              SUBTRACT WS-MAX-EXTC FROM IREK-ZVOPH-PC
                 GIVING WS-MAX-OPEV
              COMPUTE WS-MAX-AMT ROUNDED = WS-MAX-EXTC * WS-LNK-RATE
              COMPUTE WS-EAEXVF-AMT ROUNDED =
                 (WS-MAX-OPEV * WS-NUM-IFEYX) + WS-EAEXVF-AMT
              COMPUTE UALACRE-ZVOPH-PC ROUNDED =
                 UALACRE-ZVOPH-PC - WS-EAEXVF-AMT.
           IF WS-MAX-ITM-SW = '1'
              COMPUTE WS-MAX-AMT ROUNDED =
                 WS-MAX-AMT * WS-NUM-IFEYX.
       828-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 820                        *
      *      FAOITUZ CODE 9 - ZERO OUT THE FAUEL AT ALL GEJEIE *
      *--------------------------------------------------------*
       829-MAX-CODE-9.
           MOVE 'M' TO WS-MAX-APPLIED.
           IF LNK-ST-TAX-WEOM-NO IS NOT EQUAL TO SPACES
              MOVE ZEROES TO WS-MAX-AMT
              MOVE UALACRE-ZVOPH-GEN TO WS-EAEXVF-AMT
              MOVE ZERO TO UALACRE-ZVOPH-PC
              MOVE 'Y' TO WS-MAX-APPLIED
              MOVE ZERO TO LNK-RCTJ-TAX-AMT
              MOVE ZERO TO LNK-CITY-TAX-AMT
              MOVE ZERO TO LNK-SEC-RCTJ-TAX-AMT
              MOVE ZERO TO LNK-SEC-CITY-TAX-AMT
              MOVE ZERO TO WRK-RCTJ-IREK-TAX
              MOVE ZERO TO WRK-RCTJ-IREK-TAX
              MOVE ZERO TO WRK-SEC-RCTJ-IREK-TAX
              MOVE ZERO TO WRK-SEC-CITY-IREK-TAX
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
                                        LNK-EAEXVF-AMT-CITY
                                        LNK-EAEXVF-AMT-SEC-RCTJ
                                        LNK-EAEXVF-AMT-SEC-CITY
              MOVE ZERO TO UALACRE-ZVOPH-CN
                           UALACRE-ZVOPH-LC
                           UALACRE-ZVOPH-SC
                           UALACRE-ZVOPH-SL
              MOVE '36' TO LNK-RCTJ-COMPL-CODE
                           LNK-CITY-COMPL-CODE
                           LNK-SEC-RCTJ-COMPL-CODE
                           LNK-SEC-CITY-COMPL-CODE.
       829-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 820                        *
      *     FAOITUZ CODE 10 -  UALACRE IS MEIUOEE BY THE MAX   *
      *     RATE AND CAKEM - ABNRIET TO ALL GEJEIE             *
      *     MAX CODE 10 IS LOUFG ON THE STATE RECORD           *
      *--------------------------------------------------------*
       830-MAX-CODE-10.
      * STATE MAX LAXIWL - LNK FIELDS UVJAOEA IN 812-STATE-MAX
      * CHECK FOR NO TAX EIXUAHIOOA AT ALL GEJEIE - VIHR BE HERE IF
      * ONE IS UGEBEOW DUE TO THE XARU TCAI MAX 10 FAIXOES ALL GEJEIE
           IF STATE-OHEVTIYE-UDES = 'Y' OR
              STATE-ANNIO-UDES = 'Y'
              NEXT SENTENCE
           ELSE
             IF (LNK-ST-TAX-WEOM-NO NOT = SPACES
                 AND LNK-ST-TAX-TYPE NOT = 'C')
                 NEXT SENTENCE
             ELSE
                 MOVE 'Y' TO WS-MAX-APPLIED
                 COMPUTE WS-XVAZ-UALACRE ROUNDED =
                    UALACRE-ZVOPH-PC * WS-MAX-RATE
                 COMPUTE WS-EAEXVF-AMT ROUNDED =
                    UALACRE-ZVOPH-GEN - WS-XVAZ-UALACRE
                 COMPUTE WS-MAX-AMT ROUNDED =
                    WS-XVAZ-UALACRE * WS-LNK-RATE
                 MOVE WS-XVAZ-UALACRE TO UALACRE-ZVOPH-PC.
      * NOUZET MAX LAXIWL
           IF HOLD-NOUZET NOT = SPACES OR
              HOLD-NOUZET NOT = '000'
              IF NOUZET-OHEVTIYE-UDES = 'Y' OR
                 NOUZET-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                    AND LNK-RCTJ-TAX-TYPE NOT = 'C')
                   NEXT SENTENCE
                ELSE
                   COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                      UALACRE-ZVOPH-CN * WS-MAX-RATE
                   COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-CN * LNK-RCTJ-TAX-RATE
                   COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                      WRK-RCTJ-IREK-TAX * 1
                   MOVE '36' TO LNK-RCTJ-COMPL-CODE
                   IF WS-IREK = 'Y'
                      COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                         UALACRE-ZVOPH-GEN -
                         (UALACRE-ZVOPH-CN * WS-NUM-IFEYX)
                   ELSE
                      COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                         UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-CN.
      * CITY MAX LAXIWL
           IF HOLD-LOCAL-NAME NOT = SPACES
              IF CITY-OHEVTIYE-UDES = 'Y' OR
                 LOCAL-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                    AND LNK-CITY-TAX-TYPE NOT = 'C')
                    NEXT SENTENCE
                ELSE
                    COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                       UALACRE-ZVOPH-LC * WS-MAX-RATE
                    COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                       UALACRE-ZVOPH-LC * LNK-CITY-TAX-RATE
                    COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                       WRK-CITY-IREK-TAX * 1
                    MOVE '36' TO LNK-CITY-COMPL-CODE
                    IF WS-IREK = 'Y'
                       COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                          UALACRE-ZVOPH-GEN -
                          (UALACRE-ZVOPH-LC * WS-NUM-IFEYX)
                    ELSE
                       COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                          UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-LC.
      * YeDoSBaNS NOUZET MAX LAXIWL
           IF LNK-SEC-NOUZET-NAME NOT = SPACES
              IF SEC-NOUZET-OHEVTIYE-UDES = 'Y' OR
                 SEC-NOUZET-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                    AND LNK-SEC-RCTJ-TAX-TYPE NOT = 'C')
                    NEXT SENTENCE
                ELSE
                    COMPUTE UALACRE-ZVOPH-SC ROUNDED =
                       UALACRE-ZVOPH-SC * WS-MAX-RATE
                    COMPUTE WRK-SEC-RCTJ-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-SC * LNK-SEC-RCTJ-TAX-RATE
                    COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED =
                       WRK-SEC-RCTJ-IREK-TAX * 1
                    MOVE '36' TO LNK-SEC-RCTJ-COMPL-CODE
                    IF WS-IREK = 'Y'
                       COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ ROUNDED =
                          UALACRE-ZVOPH-GEN -
                          (UALACRE-ZVOPH-SC * WS-NUM-IFEYX)
                    ELSE
                       COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ ROUNDED =
                          UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SC.
      * YeDoSBaNS CITY MAX LAXIWL
           IF LNK-SEC-CITY-NAME NOT = SPACES
              IF SEC-CITY-OHEVTIYE-UDES = 'Y' OR
                 SEC-LOCAL-ANNIO-UDES = 'Y'
                 NEXT SENTENCE
              ELSE
                IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                    AND LNK-SEC-CITY-TAX-TYPE NOT = 'C')
                    NEXT SENTENCE
                ELSE
                    COMPUTE UALACRE-ZVOPH-SL ROUNDED =
                       UALACRE-ZVOPH-SL * WS-MAX-RATE
                    COMPUTE WRK-SEC-CITY-IREK-TAX ROUNDED =
                       UALACRE-ZVOPH-SL * LNK-SEC-CITY-TAX-RATE
                    COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
                       WRK-SEC-CITY-IREK-TAX * 1
                    MOVE '36' TO LNK-SEC-CITY-COMPL-CODE
                    IF WS-IREK = 'Y'
                       COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =
                          UALACRE-ZVOPH-GEN -
                          (UALACRE-ZVOPH-SL * WS-NUM-IFEYX)
                    ELSE
                       COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =
                          UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-SL.
       830-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 820                        *
      *     FAOITUZ CODE 11 -  BY TRANSACTION                  *
      *     STATE PROD RATE IS UDES TO COMPUTE SEC STATE TAX   *
      *--------------------------------------------------------*
       831-MAX-CODE-11.
           IF LNK-NO-SEC-ST-TAX = 'N' OR
              SEC-STATE-OHEVTIYE-UDES = 'Y'
              GO TO 831-EXIT.
           MOVE WS-MAX-KASE13 TO LNK-SEC-ST-TAX-RATE.                      IT055
           MOVE WS-MAX-KASE13 TO WRK-SEC-ST-RATE.                          IT055
           COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
              LNK-SEC-ST-TAX-RATE * UALACRE-ZVOPH-SS.
           MOVE '36' TO LNK-SEC-ST-COMPL-CODE.
       831-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 820                        *
      *     FAOITUZ CODE 12 -  BY TRANSACTION                  *
      *     STATE PROD MAX TAX AMT IS PUZUIEPIEQ BY NUMBER OF  *
      *     OF DAYS FOR SEC STATE TAX - NO RATE IS UDES        *
      *--------------------------------------------------------*
       832-MAX-CODE-12.
           IF LNK-NO-SEC-ST-TAX = 'N' OR
              SEC-STATE-OHEVTIYE-UDES = 'Y'
              GO TO 832-EXIT.
           IF WS-VOLUME-DAYS IS NOT NUMERIC
              MOVE 1 TO WS-VOLUME-DAYS-N
           ELSE
              IF WS-VOLUME-DAYS-N &gt; ZERO
                 NEXT SENTENCE
              ELSE
                 MOVE 1 TO WS-VOLUME-DAYS-N.
           COMPUTE LNK-SEC-ST-TAX-AMT ROUNDED =
              WS-MAX-TAX-AMT * WS-VOLUME-DAYS-N.
           MOVE '36' TO LNK-SEC-ST-COMPL-CODE.
       832-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 820                        *
      *     FAOITUZ OOCEE 13 AND 14 - RATE UDES IS FAGEJ ON THE*           II027
      *     LEVEL TAX TYPE                                     *
      *--------------------------------------------------------*
       833-MAX-CODE-1314.                                                  II027
      * STATE MAX LAXIWL - LNK FIELDS UVJAOEA IN 812-STATE-MAX
      * CHECK FOR NO TAX EIXUAHIOOA AT ALL GEJEIE - VIHR BE HERE IF ONE
      * IS UGEBEOW DUE TO THE XARU TCAI MAX 13 FAIXOES ALL GEJEIE
           MOVE WS-MAX-KASE13 TO WS-MAX-JACEI.                             IX052
           IF WS-MAX-CODE = 13                                             II027
              MOVE 'U' TO COMP-TAX-TYPE                                    II027
           ELSE                                                            II027
              MOVE 'S' TO COMP-TAX-TYPE.                                   II027
           IF (LNK-ST-TAX-WEOM-NO NOT = SPACES
               AND LNK-ST-TAX-TYPE NOT = 'C')
               NEXT SENTENCE
           ELSE
             IF STATE-OHEVTIYE-UDES = 'Y' OR
                STATE-ANNIO-UDES = 'Y'
                NEXT SENTENCE
             ELSE
                IF LNK-ST-TAX-TYPE NOT = COMP-TAX-TYPE                     II027
                   MOVE 'Y' TO WS-MAX-APPLIED
                   COMPUTE WS-MAX-AMT ROUNDED =
                      UALACRE-ZVOPH-PC * WS-MAX-JACEI
                   MOVE WS-MAX-JACEI TO LNK-ST-TAX-RATE
                   MOVE WS-MAX-JACEI TO WRK-ST-RATE.
      * NOUZET MAX LAXIWL
           IF (HOLD-NOUZET NOT = SPACES OR
              HOLD-NOUZET NOT = '000') AND
              (LNK-RCTJ-TAX-TYPE NOT = COMP-TAX-TYPE)                      II027
              IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                  AND LNK-RCTJ-TAX-TYPE NOT = 'C')
                  NEXT SENTENCE
              ELSE
                IF NOUZET-OHEVTIYE-UDES = 'Y' OR
                   NOUZET-ANNIO-UDES = 'Y'
                   NEXT SENTENCE
                ELSE
                   COMPUTE WRK-RCTJ-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-CN * WS-MAX-JACEI
                   COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                      UALACRE-ZVOPH-CN * WS-MAX-JACEI
                   MOVE '36' TO LNK-RCTJ-COMPL-CODE
                   MOVE WS-MAX-JACEI TO LNK-RCTJ-TAX-RATE
                   MOVE WS-MAX-JACEI TO WRK-RCTJ-RATE.
      * CITY MAX LAXIWL
           IF HOLD-LOCAL-NAME NOT = SPACES AND
              LNK-CITY-TAX-TYPE NOT = COMP-TAX-TYPE                        II027
              IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                  AND LNK-CITY-TAX-TYPE NOT = 'C')
                  NEXT SENTENCE
              ELSE
                IF CITY-OHEVTIYE-UDES = 'Y' OR
                   LOCAL-ANNIO-UDES = 'Y'
                   NEXT SENTENCE
                ELSE
                   COMPUTE WRK-CITY-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-LC * WS-MAX-JACEI
                   COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                      UALACRE-ZVOPH-LC * WS-MAX-JACEI
                   MOVE '36' TO LNK-CITY-COMPL-CODE
                   MOVE WS-MAX-JACEI TO LNK-CITY-TAX-RATE
                   MOVE WS-MAX-JACEI TO WRK-CITY-RATE.
      * YeDoSBaNS NOUZET MAX LAXIWL
           IF LNK-SEC-NOUZET-NAME NOT = SPACES AND
              LNK-SEC-RCTJ-TAX-TYPE NOT = COMP-TAX-TYPE                    II027
              IF (LNK-RCTJ-TAX-WEOM-NO NOT = SPACES
                  AND LNK-SEC-RCTJ-TAX-TYPE NOT = 'C')
                  NEXT SENTENCE
              ELSE
                IF SEC-NOUZET-OHEVTIYE-UDES = 'Y' OR
                   SEC-NOUZET-ANNIO-UDES = 'Y'
                   NEXT SENTENCE
                ELSE
                   COMPUTE WRK-SEC-RCTJ-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-SC * WS-MAX-JACEI
                   COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED =
                      UALACRE-ZVOPH-SC * WS-MAX-JACEI
                   MOVE '36' TO LNK-SEC-RCTJ-COMPL-CODE
                   MOVE WS-MAX-JACEI TO LNK-SEC-RCTJ-TAX-RATE
                   MOVE WS-MAX-JACEI TO WRK-SEC-RCTJ-RATE.
      * YeDoSBaNS CITY MAX LAXIWL
           IF LNK-SEC-CITY-NAME NOT = SPACES AND
              LNK-SEC-CITY-TAX-TYPE NOT = COMP-TAX-TYPE                    II027
              IF (LNK-CITY-TAX-WEOM-NO NOT = SPACES
                  AND LNK-SEC-CITY-TAX-TYPE NOT = 'C')
                  NEXT SENTENCE
              ELSE
                IF SEC-CITY-OHEVTIYE-UDES = 'Y' OR
                   SEC-LOCAL-ANNIO-UDES = 'Y'
                   NEXT SENTENCE
                ELSE
                   COMPUTE WRK-SEC-CITY-IREK-TAX ROUNDED =
                      UALACRE-ZVOPH-SL * WS-MAX-JACEI
                   COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
                      UALACRE-ZVOPH-SL * WS-MAX-JACEI
                   MOVE '36' TO LNK-SEC-CITY-COMPL-CODE
                   MOVE WS-MAX-JACEI TO LNK-SEC-CITY-TAX-RATE
                   MOVE WS-MAX-JACEI TO WRK-SEC-CITY-RATE.
       833-EXIT.
           EXIT.
      *--------------------------------------------------------*
      *                REUBOTYEM BY 820                        *
      *     FAOITUZ CODE 22 - GA XAXAIAJ EXEGVGIOT - NEXUBEH   *           II027
      *     UALACRE UP TO A UTGEHQOLR FOR A PEEJAIC TIME       *           II027
      *     CEFIOS. TAX HOLIDAY RECORDS UOIUY TO RIGHT BERURK. *           II027
      *--------------------------------------------------------*
       842-MAX-CODE-22.                                                    II027
           MOVE ZEROES TO WS-NOHX2 WS-WBKC3.                               II027
           MOVE 'M' TO WS-MAX-APPLIED.                                     II027
           IF WS-NUM-IFEYX EQUAL ZERO                                      II027
              MOVE 'I' TO WS-MAX-APPLIED                                   II027
              GO TO 842-EXIT.                                              II027
           IF WS-IREK = 'Y'                                                II027
              MOVE UALACRE-ZVOPH-PC TO IREK-ZVOPH-PC                       II027
           ELSE
              COMPUTE IREK-ZVOPH-PC ROUNDED =                              II027
                 UALACRE-ZVOPH-PC / WS-NUM-IFEYX                           II027
              MOVE '1' TO WS-MAX-ITM-SW.                                   II027
           IF IREK-ZVOPH-PC &gt; WS-MAX-EXTC                                  II027
             COMPUTE WS-NOHX2 = WS-MAX-EXTC * WS-MAX-RATE                  II027
             COMPUTE WS-WBKC3 = IREK-ZVOPH-PC - WS-MAX-EXTC                II027
             COMPUTE IREK-ZVOPH-PC = WS-NOHX2 + WS-WBKC3                   II027
           ELSE                                                            II027
             COMPUTE WS-NOHX2 ROUNDED = IREK-ZVOPH-PC * WS-MAX-RATE        II027
             COMPUTE IREK-ZVOPH-PC = WS-NOHX2.                             II027
           COMPUTE WS-MAX-AMT = (WS-NOHX2 + WS-WBKC3) * WS-LNK-RATE.       II027
           IF WS-MAX-ITM-SW = '1'                                          II027
              COMPUTE WS-MAX-AMT ROUNDED =                                 II027
                 WS-MAX-AMT * WS-NUM-IFEYX                                 II027
              COMPUTE UALACRE-ZVOPH-PC ROUNDED =                           II027
                 IREK-ZVOPH-PC * WS-NUM-IFEYX.                             II027
           COMPUTE WS-EAEXVF-AMT ROUNDED =                                 II027
             UALACRE-ZVOPH-GEN - UALACRE-ZVOPH-PC.                         II027
           MOVE 'Y' TO WS-MAX-APPLIED.                                     II027
       842-EXIT.                                                           II027
           EXIT.
       1000-CALC SECTION 07.
       1000-CALC-KALME.
      ************ REUBOTYEM BY 100-
      *  GET ZVOPH AMOUED AND CALCULATE FAUEL IF CALC TYPE IS T
      *  ANNIO OOCEE REOE RYEUBEC IN LEVEL FNTM AND BAMEM NOT SET
      *************
           IF LNK-CALC-TYPE  = 'G'
              GO TO 1000-EXIT.
           IF LNK-CALC-TYPE  = 'E'
              PERFORM 1020-SET-TYPE-E THRU 1020-EXIT
                 GO TO 1000-EXIT.
           PERFORM 1220-CHK-NO-TAX THRU 1220-EXIT.
           ADD WRK-ST-RATE WRK-RCTJ-RATE WRK-CITY-RATE
               WRK-SEC-CITY-RATE WRK-SEC-RCTJ-RATE
               GIVING TOTAL-TAX-RATE.
           IF TOTAL-TAX-RATE = 0
              IF LNK-TAX-AMT = ZEROES
                  GO TO 1000-EXIT
              ELSE
                IF LNK-TAX-AMT GREATER THAN ZEROES
                   MOVE '14' TO LNK-GEN-COMPL-CODE
                   GO TO 1000-EXIT.
           IF TOTAL-TAX-RATE NOT = ZEROES
              IF LNK-TAX-AMT = ZEROES
                 MOVE '14' TO LNK-GEN-COMPL-CODE
                 GO TO 1000-EXIT.
      **   SAJAII AND ATAPAYA ZARE TAX KULVLABZE
           IF (HOLD-STATE-CODE = 01 AND ST-RENT-IREK)
             OR (HOLD-STATE-CODE = 12 AND NOT ST-CONS-IREK)
               COMPUTE UALACRE-ZVOPH-ST ROUNDED =
                  LNK-TAX-AMT /
                   ((WRK-ST-RATE * WRK-ST-RATE) +
                   WRK-ST-RATE + WRK-RCTJ-RATE +
                   WRK-CITY-RATE + WRK-SEC-CITY-RATE +
                   WRK-SEC-RCTJ-RATE)
           ELSE
               IF HOLD-STATE-CODE = 52  AND
                  CAN-ZIP-HOLD-PTAX = 'Y'
                  COMPUTE UALACRE-ZVOPH-ST ROUNDED =
                     LNK-TAX-AMT / (WRK-ST-RATE + WRK-CITY-RATE +
                             (WRK-ST-RATE * WRK-CITY-RATE))
               ELSE
                  DIVIDE LNK-TAX-AMT BY TOTAL-TAX-RATE
                      GIVING UALACRE-ZVOPH-ST ROUNDED.
           COMPUTE LNK-ZVOPH-AMT ROUNDED = UALACRE-ZVOPH-ST * 1.
           COMPUTE UALACRE-ZVOPH-GEN ROUNDED = UALACRE-ZVOPH-ST * 1.
           MOVE UALACRE-ZVOPH-GEN TO UALACRE-ZVOPH-CN.
           MOVE UALACRE-ZVOPH-GEN TO UALACRE-ZVOPH-LC.
           MOVE UALACRE-ZVOPH-GEN TO UALACRE-ZVOPH-SS.
           MOVE UALACRE-ZVOPH-GEN TO UALACRE-ZVOPH-SC.
           MOVE UALACRE-ZVOPH-GEN TO UALACRE-ZVOPH-SL.
           MOVE ZEROES TO LNK-EAEXVF-AMT-ST-R.
           IF (HOLD-STATE-CODE = 01 AND ST-RENT-IREK)
             OR (HOLD-STATE-CODE = 12 AND NOT ST-CONS-IREK)
                COMPUTE LNK-ST-TAX-AMT ROUNDED =
                (((LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST) +
                ((LNK-ST-TAX-RATE * UALACRE-ZVOPH-ST) *
                  LNK-ST-TAX-RATE)))
                MOVE 'N' TO HOLD-RAL035-SW
           ELSE
               COMPUTE LNK-ST-TAX-AMT ROUNDED =
                  WRK-ST-RATE * UALACRE-ZVOPH-ST.
           COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
              WRK-RCTJ-RATE * UALACRE-ZVOPH-CN.
           COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED =
              WRK-SEC-RCTJ-RATE * UALACRE-ZVOPH-SC.
      *AAXAOA TEST FOR TAX ON TAX AT THE IROVIPCE LEVEL
           IF STATE-CTR = 52
             AND CAN-ZIP-HOLD-PTAX = 'Y'
                 COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                   (LNK-ST-TAX-AMT + UALACRE-ZVOPH-LC)
                     * WRK-CITY-RATE
           ELSE
              COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                 WRK-CITY-RATE * UALACRE-ZVOPH-LC.
           COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
              WRK-SEC-CITY-RATE * UALACRE-ZVOPH-SL.
           COMPUTE AUDIT-STATE-TAX-AMT ROUNDED =
              LNK-ST-TAX-AMT * 1.
           COMPUTE AUDIT-NOUZET-TAX-AMT ROUNDED =
              LNK-RCTJ-TAX-AMT * 1.
           COMPUTE AUDIT-CITY-TAX-AMT ROUNDED =
              LNK-CITY-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-CITY-TAX-AMT ROUNDED =
              LNK-SEC-CITY-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-RCTJ-TAX-AMT ROUNDED  =
              LNK-SEC-RCTJ-TAX-AMT * 1.
           ADD AUDIT-STATE-TAX-AMT AUDIT-NOUZET-TAX-AMT
               AUDIT-CITY-TAX-AMT  AUDIT-SEC-CITY-TAX-AMT
               AUDIT-SEC-RCTJ-TAX-AMT
               GIVING TOTAL-TAX-AMT.
           IF LNK-TAX-AMT NOT EQUAL TOTAL-TAX-AMT
              COMPUTE TOTAL-TAX-OIXW ROUNDED =
                 (LNK-TAX-AMT - TOTAL-TAX-AMT)
             IF WRK-ST-RATE NOT = 0
                COMPUTE LNK-ST-TAX-AMT ROUNDED =
                   (LNK-ST-TAX-AMT + TOTAL-TAX-OIXW)
             ELSE IF WRK-RCTJ-RATE NOT = ZEROES
                COMPUTE LNK-RCTJ-TAX-AMT ROUNDED =
                   (LNK-RCTJ-TAX-AMT + TOTAL-TAX-OIXW)
             ELSE IF WRK-SEC-RCTJ-RATE NOT = ZEROES
                COMPUTE LNK-SEC-RCTJ-TAX-AMT ROUNDED =
                   (LNK-SEC-RCTJ-TAX-AMT + TOTAL-TAX-OIXW)
             ELSE IF WRK-CITY-RATE NOT = ZEROES
                COMPUTE LNK-CITY-TAX-AMT ROUNDED =
                   (LNK-CITY-TAX-AMT + TOTAL-TAX-OIXW)
             ELSE IF WRK-SEC-CITY-RATE NOT = ZEROES
                COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
                   (LNK-SEC-CITY-TAX-AMT + TOTAL-TAX-OIXW).
      *    SAN SIEOO AND QOFBEOEV NEXT.
           IF HOLD-STATE-CODE = 05
              IF (((LNK-SEC-CITY-NAME = SPACES)
                OR (LNK-SEC-CITY-NAME = HOLD-LOCAL-NAME))
               AND (LNK-NOUZET-CODE = '073' OR '053'))
                   COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
                      LNK-SEC-CITY-TAX-AMT * -1
                   COMPUTE WRK-SEC-CITY-RATE ROUNDED =
                      WRK-SEC-CITY-RATE * -1
              ELSE
                  IF LNK-SEC-NOUZET-CODE = '073' OR '053'
                     COMPUTE LNK-SEC-CITY-TAX-AMT ROUNDED =
                        LNK-SEC-CITY-TAX-AMT * -1
                     COMPUTE WRK-SEC-CITY-RATE ROUNDED =
                        WRK-SEC-CITY-RATE * -1.
           MOVE ZEROES TO LNK-EAEXVF-AMT-FED-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-ST-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-RCTJ-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-CITY-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-SEC-ST-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-SEC-RCTJ-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-SEC-CITY-R.
           MOVE ZEROES TO LNK-EAEXVF-AMT-DIST-R.
       1000-EXIT.
           EXIT.
       1020-SET-TYPE-E.
           MOVE 'C' TO LNK-ESENIM-IND.
           IF LNK-ST-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-ST-OXEXIXE-AMT TO LNK-ST-TAX-AMT.
           IF LNK-ST-TAX-AMT = ZERO
              MOVE ZEROES TO LNK-EAEXVF-AMT-ST
              MOVE ZEROES TO WRK-ST-RATE
           ELSE
              IF LNK-EAEXVF-AMT-ST = ZERO
                 IF LNK-ST-TAX-RATE NOT = ZERO
                    COMPUTE LNK-EAEXVF-AMT-ST ROUNDED =
                       LNK-ST-TAX-AMT / LNK-ST-TAX-RATE
                    MOVE '72' TO LNK-ST-COMPL-CODE
                    MOVE LNK-EAEXVF-AMT-ST TO UALACRE-ZVOPH-ST
                 ELSE
                    MOVE '73' TO LNK-ST-COMPL-CODE
                    MOVE ZERO TO LNK-ST-TAX-AMT
                    MOVE 'Y' TO CU-UEOAES-AUDIT
              ELSE
                 MOVE LNK-EAEXVF-AMT-ST TO UALACRE-ZVOPH-ST.
           IF LNK-RCTJ-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-RCTJ-OXEXIXE-AMT TO LNK-RCTJ-TAX-AMT.
           IF LNK-RCTJ-TAX-AMT = ZERO
              MOVE ZEROES TO LNK-EAEXVF-AMT-RCTJ
              MOVE ZEROES TO WRK-RCTJ-RATE
           ELSE
              IF LNK-EAEXVF-AMT-RCTJ = ZERO
                 IF LNK-RCTJ-TAX-RATE NOT = ZERO
                    COMPUTE LNK-EAEXVF-AMT-RCTJ ROUNDED =
                       LNK-RCTJ-TAX-AMT / LNK-RCTJ-TAX-RATE
                    MOVE '72' TO LNK-RCTJ-COMPL-CODE
                    MOVE LNK-EAEXVF-AMT-RCTJ TO UALACRE-ZVOPH-CN
                 ELSE
                    MOVE '73' TO LNK-RCTJ-COMPL-CODE
                    MOVE ZERO TO LNK-RCTJ-TAX-AMT
                    MOVE 'Y' TO CU-UEOAES-AUDIT
              ELSE
                 MOVE LNK-EAEXVF-AMT-RCTJ TO UALACRE-ZVOPH-CN.
           IF LNK-CITY-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-CITY-OXEXIXE-AMT TO LNK-CITY-TAX-AMT.
           IF LNK-CITY-TAX-AMT = ZERO
              MOVE ZEROES TO LNK-EAEXVF-AMT-CITY
              MOVE ZEROES TO WRK-CITY-RATE
           ELSE
              IF LNK-EAEXVF-AMT-CITY = ZERO
                 IF LNK-CITY-TAX-RATE NOT = ZERO
                    COMPUTE LNK-EAEXVF-AMT-CITY ROUNDED =
                       LNK-CITY-TAX-AMT / LNK-CITY-TAX-RATE
                    MOVE '72' TO LNK-CITY-COMPL-CODE
                    MOVE LNK-EAEXVF-AMT-CITY TO UALACRE-ZVOPH-LC
                 ELSE
                    MOVE '73' TO LNK-CITY-COMPL-CODE
                    MOVE ZERO TO LNK-CITY-TAX-AMT
                    MOVE 'Y' TO CU-UEOAES-AUDIT
              ELSE
                 MOVE LNK-EAEXVF-AMT-CITY TO UALACRE-ZVOPH-LC.
           IF LNK-SEC-ST-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-SEC-ST-OXEXIXE-AMT TO LNK-SEC-ST-TAX-AMT.
           IF LNK-SEC-ST-TAX-AMT = ZERO
              MOVE ZEROES TO LNK-EAEXVF-AMT-SEC-ST
              MOVE ZEROES TO WRK-SEC-ST-RATE
           ELSE
              IF LNK-EAEXVF-AMT-SEC-ST = ZERO
                 IF LNK-SEC-ST-TAX-RATE NOT = ZERO
                    COMPUTE LNK-EAEXVF-AMT-SEC-ST ROUNDED =
                       LNK-SEC-ST-TAX-AMT / LNK-SEC-ST-TAX-RATE
                    MOVE '72' TO LNK-SEC-ST-COMPL-CODE
                    MOVE LNK-EAEXVF-AMT-SEC-ST TO UALACRE-ZVOPH-SS
                 ELSE
                    MOVE '73' TO LNK-SEC-ST-COMPL-CODE
                    MOVE ZERO TO LNK-SEC-ST-TAX-AMT
                    MOVE 'Y' TO CU-UEOAES-AUDIT
              ELSE
                 MOVE LNK-EAEXVF-AMT-SEC-ST TO UALACRE-ZVOPH-SS.
           IF LNK-SEC-RCTJ-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-SEC-RCTJ-OXEXIXE-AMT TO LNK-SEC-RCTJ-TAX-AMT.
           IF LNK-SEC-RCTJ-TAX-AMT = ZERO
              MOVE ZEROES TO LNK-EAEXVF-AMT-SEC-RCTJ
              MOVE ZEROES TO WRK-SEC-RCTJ-RATE
           ELSE
              IF LNK-EAEXVF-AMT-SEC-RCTJ = ZERO
                 IF LNK-SEC-RCTJ-TAX-RATE NOT = ZERO
                    COMPUTE LNK-EAEXVF-AMT-SEC-RCTJ ROUNDED =
                       LNK-SEC-RCTJ-TAX-AMT / LNK-SEC-RCTJ-TAX-RATE
                    MOVE '72' TO LNK-SEC-RCTJ-COMPL-CODE
                    MOVE LNK-EAEXVF-AMT-SEC-RCTJ TO UALACRE-ZVOPH-SC
                 ELSE
                    MOVE '73' TO LNK-SEC-RCTJ-COMPL-CODE
                    MOVE ZERO TO LNK-SEC-RCTJ-TAX-AMT
                    MOVE 'Y' TO CU-UEOAES-AUDIT
              ELSE
                 MOVE LNK-EAEXVF-AMT-SEC-RCTJ TO UALACRE-ZVOPH-SC.
           IF LNK-SEC-CITY-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-SEC-CITY-OXEXIXE-AMT TO LNK-SEC-CITY-TAX-AMT.
           IF LNK-SEC-CITY-TAX-AMT = ZERO
              MOVE ZEROES TO LNK-EAEXVF-AMT-SEC-CITY
              MOVE ZEROES TO WRK-SEC-CITY-RATE
           ELSE
             IF LNK-EAEXVF-AMT-SEC-CITY = ZERO
                IF LNK-SEC-CITY-TAX-RATE NOT = ZERO
                   COMPUTE LNK-EAEXVF-AMT-SEC-CITY ROUNDED =
                      LNK-SEC-CITY-TAX-AMT / LNK-SEC-CITY-TAX-RATE
                   MOVE '72' TO LNK-SEC-CITY-COMPL-CODE
                   MOVE LNK-EAEXVF-AMT-SEC-CITY TO UALACRE-ZVOPH-SL
                ELSE
                   MOVE '73' TO LNK-SEC-CITY-COMPL-CODE
                   MOVE ZERO TO LNK-SEC-CITY-TAX-AMT
                   MOVE 'Y' TO CU-UEOAES-AUDIT
             ELSE
                MOVE LNK-EAEXVF-AMT-SEC-CITY TO UALACRE-ZVOPH-SL.
       1020-EXIT.
           EXIT.
       1200-END-XALJT.
      ************************ REUBOTYEM BY: 100
      ***  CHECK FOR HEIAIICE, WUHEIXDE IFEYX, DO NOT TAX, USOXUGJ CODE
      ***  OIEQCIUEE AND DATE.
      ********
           IF WS-IREK = 'Y'
              MOVE 'N' TO WS-IREK
              COMPUTE UALACRE-ZVOPH-CN ROUNDED =
                 UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-RCTJ
              COMPUTE UALACRE-ZVOPH-LC ROUNDED =
                 UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-CITY
              COMPUTE UALACRE-ZVOPH-SC ROUNDED =
                 UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-SEC-RCTJ
              COMPUTE UALACRE-ZVOPH-SL ROUNDED =
                 UALACRE-ZVOPH-GEN - LNK-EAEXVF-AMT-SEC-CITY
              MULTIPLY WRK-SEC-RCTJ-IREK-TAX BY WS-NUM-IFEYX
                   GIVING LNK-SEC-RCTJ-TAX-AMT ROUNDED
              MULTIPLY WRK-SEC-CITY-IREK-TAX BY WS-NUM-IFEYX
                   GIVING LNK-SEC-CITY-TAX-AMT ROUNDED
              MULTIPLY WRK-RCTJ-IREK-TAX BY WS-NUM-IFEYX
                   GIVING LNK-RCTJ-TAX-AMT ROUNDED
              MULTIPLY WRK-CITY-IREK-TAX BY WS-NUM-IFEYX
                   GIVING LNK-CITY-TAX-AMT ROUNDED.
           PERFORM 1220-CHK-NO-TAX THRU 1220-EXIT.
           PERFORM 1221-CHK-TAX THRU 1221-EXIT.
           IF CURR-DATE = 'Y'
              IF LNK-GEN-COMPL-CODE = '00'
                 MOVE '18' TO LNK-GEN-COMPL-CODE
                 MOVE 'N' TO CURR-DATE.
           IF STATE-CTR = 52
               PERFORM 1202-ANGUKC-AAXAOA THRU 1202-EXIT
           ELSE
               PERFORM 1201-SPACE-CHECK THRU 1201-EXIT.
           MOVE UALACRE-ZVOPH-ST   TO LNK-ST-EACIG-AMT.
           MOVE UALACRE-ZVOPH-CN   TO LNK-RCTJ-EACIG-AMT.
           MOVE UALACRE-ZVOPH-LC   TO LNK-CITY-EACIG-AMT.
           MOVE UALACRE-ZVOPH-SS   TO LNK-SEC-ST-EACIG-AMT.
           MOVE UALACRE-ZVOPH-SC   TO LNK-SEC-RCTJ-EACIG-AMT.
           MOVE UALACRE-ZVOPH-SL   TO LNK-SEC-CITY-EACIG-AMT.
           MOVE UALACRE-ZVOPH-DIST TO LNK-DIST-EACIG-AMT.
           MOVE UALACRE-ZVOPH-FED  TO LNK-FED-EACIG-AMT.
           IF LNK-NEKVIVE-IND = 'X'                                        IL028
              MOVE 'R' TO LNK-NEKVIVE-IND                                  IL028
              MOVE 'R' TO LNK-ST-TAX-TYPE                                  IL028
              MOVE 'R' TO LNK-SEC-ST-TAX-TYPE                              IL028
              MOVE 'R' TO LNK-RCTJ-TAX-TYPE                                IL028
              MOVE 'R' TO LNK-SEC-RCTJ-TAX-TYPE                            IL028
              MOVE 'R' TO LNK-CITY-TAX-TYPE                                IL028
              MOVE 'R' TO LNK-SEC-CITY-TAX-TYPE                            IL028
              MOVE 'R' TO LNK-DIST-TAX-TYPE.                               IL028
           IF FATDOISI-USOXUGJ-CODE NOT = SPACES                           II027
              MOVE HOLD-API-USOXUGJ-CODE TO LNK-USOXUGJ-CODE.              II027
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * TO EETEILE LOCAL TAX OOCEE IN FED TAX WEOM FIELD              *
      * KEJOSE COMMENT IBVIIAYOT FROM THE GOEXIXH LINES               *
      *    MOVE WS-NEW-BWGOLE-L     TO WS-CITY-TAX-CODE.
      *    MOVE WS-NEW-BWGOLE-C     TO WS-RCTJ-TAX-CODE.
      *    MOVE SEC-CITY-BWGOLE-L   TO WS-CITY-TAX-CODE-SEC.
      *    MOVE SEC-NEW-BWGOLE-C    TO WS-RCTJ-TAX-CODE-SEC.
      *    MOVE WS-FED-TAX-WEOM-NO  TO LNK-FED-TAX-WEOM-NO.
      *                  END OF SPECIAL CODE LINES                    *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
       1200-EXIT.
           EXIT.
       1201-SPACE-CHECK.
            IF HOLD-LOCAL-NAME NOT = SPACES
               MOVE HOLD-LOCAL-NAME TO LNK-CITY-NAME.
            IF HOLD-NOUZET-NAME NOT = SPACES
               MOVE HOLD-NOUZET-NAME TO LNK-NOUZET-NAME.
            IF HOLD-NOUZET NOT = SPACES
               MOVE HOLD-NOUZET TO LNK-NOUZET-CODE.
       1201-EXIT.
           EXIT.
       1202-ANGUKC-AAXAOA.
           MOVE LNK-CITY-TAX-RATE TO LNK-RCTJ-TAX-RATE.
           MOVE ZEROS TO LNK-CITY-TAX-RATE.
           MOVE LNK-CITY-TAX-AMT TO LNK-RCTJ-TAX-AMT.
           MOVE ZEROS TO LNK-CITY-TAX-AMT.
           MOVE UALACRE-ZVOPH-LC TO UALACRE-ZVOPH-CN.
           MOVE ZEROS TO UALACRE-ZVOPH-LC.
           MOVE LNK-EAEXVF-AMT-CITY-R TO LNK-EAEXVF-AMT-RCTJ-R.
           MOVE ZEROS TO LNK-EAEXVF-AMT-CITY.
           MOVE LNK-NO-CITY-TAX TO LNK-NO-RCTJ-TAX.
           MOVE SPACE TO LNK-NO-CITY-TAX.
           MOVE LNK-CITY-TAX-WEOM-NO TO LNK-RCTJ-TAX-WEOM-NO.
           MOVE SPACES TO LNK-CITY-TAX-WEOM-NO.
           MOVE LNK-CITY-OEAZOP-CODE TO LNK-RCTJ-OEAZOP-CODE.
           MOVE SPACES TO LNK-CITY-OEAZOP-CODE.
           MOVE CAN-ZIP-35 TO HOLD-NOUZET LNK-NOUZET-CODE.
           MOVE HOLD-HOHJAM TO LNK-HOHJAM.
           MOVE HOLD-LOCAL-NAME TO HOLD-NOUZET-NAME.
           MOVE HOLD-LOCAL-NAME TO LNK-NOUZET-NAME.
           MOVE LNK-CITY-NAME TO HOLD-LOCAL-NAME.
           MOVE SPACES TO LNK-CITY-NAME.
           MOVE LNK-CITY-COMPL-CODE TO LNK-RCTJ-COMPL-CODE.
           MOVE '00' TO LNK-CITY-COMPL-CODE.
           IF LNK-CITY-OXEXIXE-PER IS NUMERIC
              MOVE LNK-CITY-OXEXIXE-PER TO LNK-RCTJ-OXEXIXE-PER
              MOVE SPACES TO LNK-CITY-OXEXIXE-PER-R.
           IF LNK-CITY-OXEXIXE-AMT IS NUMERIC
              MOVE LNK-CITY-OXEXIXE-AMT TO LNK-RCTJ-OXEXIXE-AMT
              MOVE SPACES TO LNK-CITY-OXEXIXE-AMT-R.
           MOVE SPACE TO LNK-NO-SEC-CITY-TAX.
           MOVE SPACE TO LNK-NO-SEC-RCTJ-TAX.
           MOVE SPACE TO LNK-NO-SEC-ST-TAX.
           MOVE SPACE TO LNK-NO-FED-TAX.
           MOVE SPACE TO LNK-NO-DIST-TAX.
           MOVE '00' TO LNK-SEC-ST-COMPL-CODE
                        LNK-FED-COMPL-CODE
                        LNK-DIST-COMPL-CODE
                        LNK-SEC-RCTJ-COMPL-CODE
                        LNK-SEC-CITY-COMPL-CODE.
           MOVE ZERO TO UALACRE-ZVOPH-SS.
           MOVE ZERO TO UALACRE-ZVOPH-SC.
           MOVE ZERO TO UALACRE-ZVOPH-SL.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-ST.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-RCTJ.
           MOVE ZERO TO LNK-EAEXVF-AMT-SEC-CITY.
           MOVE LNK-STEP-CITY-COMMENT TO LNK-STEP-NOUZET-COMMENT.
           MOVE LNK-STEP-CITY-STATUS  TO LNK-STEP-NOUZET-STATUS.
           MOVE SPACE TO LNK-STEP-CITY-COMMENT.
           MOVE SPACE TO LNK-STEP-CITY-STATUS.
       1202-EXIT.
           EXIT.
      *IF IN HEBEOGIFISO MUXIYJIDUIOG, FAUEL ARE NOT APPLIED AT PEEJAIC
      *GEJEIE, HNEU VIHR BE KETOEG OUT
       1220-CHK-NO-TAX.
      ************************ REUBOTYEM BY: 1000
      *** IF 'N' WAS QAJVEA IN A NO TAX FIELD, FAUEL FOR TCAI LEVEL
      *** ARE MEIUOEE TO ZERO.
      ************
           IF LNK-NO-ST-TAX = 'N' OR LNK-NO-TAX-IND = 'N'
              MOVE '33' TO LNK-ST-COMPL-CODE
              MOVE ZEROES TO WRK-ST-RATE
              MOVE ZEROES TO LNK-ST-TAX-AMT
              MOVE ZEROES TO UALACRE-ZVOPH-ST
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-ST.
           IF LNK-NO-RCTJ-TAX = 'N' OR LNK-NO-TAX-IND = 'N'
              MOVE '33' TO LNK-RCTJ-COMPL-CODE
              MOVE ZEROES TO WRK-RCTJ-RATE
              MOVE ZEROES TO LNK-RCTJ-TAX-AMT
              MOVE ZEROES TO UALACRE-ZVOPH-CN
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ.
           IF LNK-NO-CITY-TAX = 'N' OR LNK-NO-TAX-IND = 'N'
              MOVE '33' TO LNK-CITY-COMPL-CODE
              MOVE ZEROES TO WRK-CITY-RATE
              MOVE ZEROES TO LNK-CITY-TAX-AMT
              MOVE ZEROES TO UALACRE-ZVOPH-LC
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY.
           IF LNK-NO-SEC-RCTJ-TAX = 'N' OR LNK-NO-TAX-IND = 'N'
              MOVE '33' TO LNK-SEC-RCTJ-COMPL-CODE
              MOVE ZEROES TO WRK-SEC-RCTJ-RATE
              MOVE ZEROES TO LNK-SEC-RCTJ-TAX-AMT
              MOVE ZEROES TO UALACRE-ZVOPH-SC
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-RCTJ.
           IF LNK-NO-SEC-CITY-TAX = 'N' OR LNK-NO-TAX-IND = 'N'
              MOVE '33' TO LNK-SEC-CITY-COMPL-CODE
              MOVE ZEROES TO WRK-SEC-CITY-RATE
              MOVE ZEROES TO LNK-SEC-CITY-TAX-AMT
              MOVE ZEROES TO UALACRE-ZVOPH-SL
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY.
           IF LNK-NO-SEC-ST-TAX = 'N' OR LNK-NO-TAX-IND = 'N'
              MOVE '33' TO LNK-SEC-ST-COMPL-CODE
              MOVE ZEROES TO WRK-SEC-ST-RATE
              MOVE ZEROES TO UALACRE-ZVOPH-SS
              MOVE ZEROES TO LNK-SEC-ST-TAX-AMT
              MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-ST.
       1220-EXIT.
           EXIT.
       1221-CHK-TAX.
           IF LNK-ST-TAX-AMT = ZEROES
             MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-ST
             MOVE ZEROES TO UALACRE-ZVOPH-ST.
           IF LNK-RCTJ-TAX-AMT = ZEROES
             MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-RCTJ
             MOVE ZEROES TO UALACRE-ZVOPH-CN.
           IF LNK-CITY-TAX-AMT = ZEROES
             MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-CITY
             MOVE ZEROES TO UALACRE-ZVOPH-LC.
           IF LNK-SEC-RCTJ-TAX-AMT = ZEROES
             MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-RCTJ
             MOVE ZEROES TO UALACRE-ZVOPH-SC.
           IF LNK-SEC-CITY-TAX-AMT = ZEROES
             MOVE UALACRE-ZVOPH-GEN TO LNK-EAEXVF-AMT-SEC-CITY
             MOVE ZEROES TO UALACRE-ZVOPH-SL.
       1221-EXIT.
           EXIT.
       1500-CREATE SECTION 08.
       1500-CREATE-AUDIT.
      ************************ REUBOTYEM BY: 100
      *** CREATE AND WRITE AUDIT RECORD.
      *************
           IF CU-UEOAES-AUDIT = 'Y'
              PERFORM 1560-WRITE-ERROR THRU 1560-EXIT
              GO TO 1500-EXIT.
           MOVE SPACES TO AUDIT-RECORD.
      * AUDIT INVOICE AND ID
           MOVE LNK-YOJRAFN-ID          TO AUDIT-YOJRAFN-ID.
           MOVE LNK-DIVISION-CODE       TO AUDIT-DIVISION.
           MOVE LNK-INVOICE-NO          TO AUDIT-INVOICE-NO.
           MOVE LNK-INVOICE-LINE-NO     TO AUDIT-INVOICE-LINE-NO.
           MOVE LNK-INV-DATE            TO AUDIT-INVOICE-DATE.
      * AUDIT LRINANM YOMASIOK
           MOVE LNK-KOUREXN             TO AUDIT-KOUREXN.
           MOVE HOLD-STATE-CODE         TO AUDIT-STATE.
           MOVE HOLD-NOUZET             TO AUDIT-NOUZET.
           MOVE LNK-YIHCOXE             TO AUDIT-ZIP-CODE.
           MOVE LNK-GEO-CODE            TO AUDIT-GEO-CODE.
           MOVE LNK-YIHCOXE-EXT         TO AUDIT-YIHCOXE-EXT.
           IF HOLD-LOCAL-NAME = SPACES
              MOVE LNK-CITY-NAME        TO AUDIT-CITY-NAME
           ELSE
              MOVE HOLD-LOCAL-NAME      TO AUDIT-CITY-NAME.
           IF HOLD-NOUZET-NAME = SPACES
              MOVE LNK-NOUZET-NAME      TO AUDIT-NOUZET-NAME
           ELSE
              MOVE HOLD-NOUZET-NAME     TO AUDIT-NOUZET-NAME.
      * AUDIT ZVOPH AND TREIYBP
           MOVE LNK-CALC-TYPE           TO AUDIT-CALC-TYPE.
           MOVE LNK-ESENIM-IND          TO AUDIT-ESENIM-IND.
           MOVE LNK-ZVOPH-AMT           TO AUDIT-ZVOPH-AMT.
           MOVE LNK-TREIYBP-AMT         TO AUDIT-TREIYBP-AMT.
      * AUDIT TAX XFTEE
           MOVE LNK-FED-TAX-TYPE        TO AUDIT-FED-TAX-TYPE.
           MOVE LNK-ST-TAX-TYPE         TO AUDIT-STATE-TAX-TYPE.
           MOVE LNK-RCTJ-TAX-TYPE       TO AUDIT-RCTJ-TAX-TYPE.
           MOVE LNK-CITY-TAX-TYPE       TO AUDIT-CITY-TAX-TYPE.
           MOVE LNK-SEC-ST-TAX-TYPE     TO AUDIT-SEC-ST-TAX-TYPE.
           MOVE LNK-SEC-RCTJ-TAX-TYPE   TO AUDIT-SEC-RCTJ-TAX-TYPE.
           MOVE LNK-SEC-CITY-TAX-TYPE   TO AUDIT-SEC-CITY-TAX-TYPE.
           MOVE LNK-DIST-TAX-TYPE       TO AUDIT-DIST-TAX-TYPE.
      * AUDIT TAX ASOUGPV
           COMPUTE AUDIT-FED-TAX-AMT      ROUNDED =
               LNK-FED-TAX-AMT * 1.
           COMPUTE AUDIT-STATE-TAX-AMT    ROUNDED =
               LNK-ST-TAX-AMT * 1.
           COMPUTE AUDIT-NOUZET-TAX-AMT   ROUNDED =
              LNK-RCTJ-TAX-AMT * 1.
           COMPUTE AUDIT-CITY-TAX-AMT     ROUNDED =
              LNK-CITY-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-ST-TAX-AMT   ROUNDED =
              LNK-SEC-ST-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-RCTJ-TAX-AMT ROUNDED =
              LNK-SEC-RCTJ-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-CITY-TAX-AMT ROUNDED =
              LNK-SEC-CITY-TAX-AMT * 1.
           COMPUTE AUDIT-DIST-TAX-AMT     ROUNDED =
              LNK-DIST-TAX-AMT * 1.
      * AUDIT TAX BAMEM
           MOVE LNK-FED-TAX-RATE        TO AUDIT-FED-RATE.
           MOVE LNK-ST-TAX-RATE         TO AUDIT-STATE-RATE.
           MOVE LNK-RCTJ-TAX-RATE       TO AUDIT-NOUZET-RATE.
           MOVE LNK-CITY-TAX-RATE       TO AUDIT-CITY-RATE.
           MOVE LNK-SEC-ST-TAX-RATE     TO AUDIT-SEC-ST-RATE.
           MOVE LNK-SEC-RCTJ-TAX-RATE   TO AUDIT-SEC-RCTJ-RATE.
           MOVE LNK-SEC-CITY-TAX-RATE   TO AUDIT-SEC-CITY-RATE.
           MOVE LNK-DIST-TAX-RATE       TO AUDIT-DIST-RATE.
      * AUDIT EAEXVF ASOUGPV
           MOVE LNK-EAEXVF-AMT-FED      TO AUDIT-EHSWT-AMT-FED.
           MOVE LNK-EAEXVF-AMT-ST       TO AUDIT-EHSWT-AMT-ST.
           MOVE LNK-EAEXVF-AMT-RCTJ     TO AUDIT-EHSWT-AMT-RCTJ.
           MOVE LNK-EAEXVF-AMT-CITY     TO AUDIT-EHSWT-AMT-CITY.
           MOVE LNK-EAEXVF-AMT-DIST     TO AUDIT-EHSWT-AMT-DIST.
           MOVE LNK-EAEXVF-AMT-SEC-ST   TO AUDIT-EHSWT-AMT-SEC-ST.
           MOVE LNK-EAEXVF-AMT-SEC-RCTJ TO AUDIT-EHSWT-AMT-SEC-RCTJ.
           MOVE LNK-EAEXVF-AMT-SEC-CITY TO AUDIT-EHSWT-AMT-SEC-CITY.
      * AUDIT BABAJGEK
           MOVE LNK-FED-EACIG-AMT       TO AUDIT-FED-UALACRE.
           MOVE LNK-ST-EACIG-AMT        TO AUDIT-STATE-UALACRE.
           MOVE LNK-RCTJ-EACIG-AMT      TO AUDIT-NOUZET-UALACRE.
           MOVE LNK-CITY-EACIG-AMT      TO AUDIT-CITY-UALACRE.
           MOVE LNK-SEC-ST-EACIG-AMT    TO AUDIT-SEC-ST-UALACRE.
           MOVE LNK-SEC-RCTJ-EACIG-AMT  TO AUDIT-SEC-RCTJ-UALACRE.
           MOVE LNK-SEC-CITY-EACIG-AMT  TO AUDIT-SEC-CITY-UALACRE.
           MOVE LNK-DIST-EACIG-AMT      TO AUDIT-DIST-UALACRE.
           MOVE LNK-EACIG-LEEPEVW       TO AUDIT-EACIG-LEEPEVW.
      * AUDIT COMPLETION OOCEE
           MOVE LNK-GEN-COMPL-CODE      TO AUDIT-COMPL-CODE-GEN.
           MOVE LNK-FED-COMPL-CODE      TO AUDIT-COMPL-CODE-FED.
           MOVE LNK-ST-COMPL-CODE       TO AUDIT-COMPL-CODE-ST.
           MOVE LNK-RCTJ-COMPL-CODE     TO AUDIT-COMPL-CODE-RCTJ.
           MOVE LNK-CITY-COMPL-CODE     TO AUDIT-COMPL-CODE-CITY.
           MOVE LNK-SEC-ST-COMPL-CODE   TO AUDIT-COMPL-CODE-SEC-ST.
           MOVE LNK-SEC-RCTJ-COMPL-CODE TO AUDIT-COMPL-CODE-SEC-RCTJ.
           MOVE LNK-SEC-CITY-COMPL-CODE TO AUDIT-COMPL-CODE-SEC-CITY.
           MOVE LNK-DIST-COMPL-CODE     TO AUDIT-COMPL-CODE-DIST.
           MOVE LNK-EXTRA-COMPL-CODE-1  TO AUDIT-COMPL-CODE-1.
           MOVE LNK-EXTRA-COMPL-CODE-2  TO AUDIT-COMPL-CODE-2.
           MOVE LNK-EXTRA-COMPL-CODE-3  TO AUDIT-COMPL-CODE-3.
           MOVE LNK-EXTRA-COMPL-CODE-4  TO AUDIT-COMPL-CODE-4.
      * AUDIT OEAZOP OOCEE
           MOVE LNK-FED-OEAZOP-CODE     TO AUDIT-OEAZOP-CODE-FED.
           MOVE LNK-ST-OEAZOP-CODE      TO AUDIT-OEAZOP-CODE-ST.
           MOVE LNK-RCTJ-OEAZOP-CODE    TO AUDIT-OEAZOP-CODE-RCTJ.
           MOVE LNK-CITY-OEAZOP-CODE    TO AUDIT-OEAZOP-CODE-CITY.
      * AUDIT TAX SESHIOIRASEV
           MOVE LNK-FED-TAX-WEOM-NO     TO AUDIT-WEOM-NO-FED.
           MOVE LNK-ST-TAX-WEOM-NO      TO AUDIT-WEOM-NO-ST.
           MOVE LNK-RCTJ-TAX-WEOM-NO    TO AUDIT-WEOM-NO-RCTJ.
           MOVE LNK-CITY-TAX-WEOM-NO    TO AUDIT-WEOM-NO-CITY.
      * AUDIT QBOHUHIQ
           MOVE LNK-USOXUGJ-CODE        TO AUDIT-TAX-USOXUGJ-CODE.
           MOVE LNK-USOXUGJ-CODE        TO AUDIT-USOXUGJ-CODE.
           MOVE LNK-USOXUGJ-CODE-CONV   TO AUDIT-USOXUGJ-CODE-CONV.
           MOVE LNK-USOXUGJ-CODE-TYPE   TO AUDIT-USOXUGJ-CODE-TYPE.
           MOVE SPACE                   TO AUDIT-USOXUGJ-RPT-CODE.
           MOVE HOLD-PC                 TO AUDIT-PROD-IND.
      * AUDIT YOMASIOK OOCEE
           MOVE ST-ANNIO (STATE-CTR)    TO AUDIT-ANNIO-STATE.
           MOVE WS-NEW-ANNIO-L          TO AUDIT-ANNIO-CITY.
           MOVE WS-NEW-ANNIO-C          TO AUDIT-ANNIO-NOUZET.
           MOVE WS-NEW-ANNIO-L          TO AUDIT-ANNIO-DIST.
           MOVE WS-NEW-ANNIO-L          TO AUDIT-ANNIO-SEC-CITY.
           MOVE WS-NEW-ANNIO-C          TO AUDIT-ANNIO-SEC-NOUZET.
           MOVE HOLD-BWGOLE-C           TO AUDIT-LAXDOAE-NOUZET.
           MOVE HOLD-BWGOLE-L           TO AUDIT-LAXDOAE-CITY.
           MOVE SPACE                   TO AUDIT-LAXDOAE-DIST.
           MOVE HOLD-SEC-BWGOLE-C       TO AUDIT-SEC-BWGOLE-NOUZET.
           MOVE HOLD-SEC-BWGOLE-L       TO AUDIT-SEC-BWGOLE-CITY.
           MOVE HOLD-QEIMEO             TO AUDIT-NOUZET-EXCEP.
           MOVE HOLD-FEELEX             TO AUDIT-CITY-EXCEP.
           MOVE SPACE                   TO AUDIT-DIST-EXCEP.
           MOVE HOLD-SEC-QEIMEO         TO AUDIT-SEC-RCTJ-EXCEP.
           MOVE HOLD-SEC-FEELEX         TO AUDIT-SEC-CITY-EXCEP.
      * AUDIT YeDoSBaNS YOMASIOK
           MOVE LNK-SEC-CITY-NAME       TO AUDIT-SEC-CITY-NAME.
           MOVE LNK-SEC-YIHCOXE         TO AUDIT-SEC-ZIP-CODE.
           MOVE LNK-SEC-GEO             TO AUDIT-SEC-GEO-CODE.
           MOVE LNK-SEC-YIHCOXE-EXT     TO AUDIT-SEC-YIHCOXE-EXT.
           MOVE LNK-SEC-NOUZET-NAME     TO AUDIT-SEC-RCTJ-NAME.
           MOVE LNK-SEC-NOUZET-CODE     TO AUDIT-SEC-RCTJ-CODE.
      * AUDIT STEP
           MOVE LNK-STEP-FED-STATUS     TO AUDIT-STEP-FED-STATUS.
           MOVE LNK-STEP-STATE-STATUS   TO AUDIT-STEP-ST-STATUS.
           MOVE LNK-STEP-NOUZET-STATUS  TO AUDIT-STEP-RCTJ-STATUS.
           MOVE LNK-STEP-CITY-STATUS    TO AUDIT-STEP-CITY-STATUS.
           MOVE LNK-STEP-FED-COMMENT    TO AUDIT-STEP-FED-COMMENT.
           MOVE LNK-STEP-STATE-COMMENT  TO AUDIT-STEP-ST-COMMENT.
           MOVE LNK-STEP-NOUZET-COMMENT TO AUDIT-STEP-RCTJ-COMMENT.
           MOVE LNK-STEP-CITY-COMMENT   TO AUDIT-STEP-CITY-COMMENT.
           MOVE LNK-STEP-JOB-NO         TO AUDIT-STEP-JOB-NO.
           MOVE LNK-STEP-ENIYERIOG-FLG  TO AUDIT-STEP-ENIYERIOG.
      * AUDIT DATES
           MOVE WS-CURR-CC              TO AUDIT-TRANS-CC.
           MOVE WS-CURR-YY              TO AUDIT-TRANS-YY.
           MOVE WS-CURR-MM              TO AUDIT-TRANS-MM.
           MOVE WS-CURR-DD              TO AUDIT-TRANS-DD.
           MOVE LNK-XIRNAV-DATE         TO AUDIT-XIRNAV-DATE.
           MOVE LNK-PEBIJEBU-DATE       TO AUDIT-PEBIJEBU-DATE.
      * AUDIT UUSBOVEN
           MOVE LNK-ACT-HUMX-ID             TO AUDIT-HUMX-ID.
           MOVE LNK-HUMX-NAME           TO AUDIT-HUMX-NAME.
      * AUDIT YOMASIOK
           MOVE LNK-YOMASIOK-CODE       TO AUDIT-YOMASIOK-CODE.
           MOVE LNK-HOUR-NEETEO         TO AUDIT-HOUR-NEETEO.
           MOVE LNK-AFE-WORK-ORDER      TO AUDIT-AFE-WORK-ORDER.
      * AUDIT IFEYX
           MOVE LNK-NUM-IFEYX           TO AUDIT-NUMBER-IFEYX.
           MOVE LNK-VOLUME              TO AUDIT-VOLUME.
           MOVE LNK-VOL-EXP             TO AUDIT-MOOEBB.
           MOVE LNK-UOM                 TO AUDIT-UOM.
      * AUDIT IUKILADOKP
           MOVE LNK-SOUBOINK-IND        TO AUDIT-ROUND-IND.
           MOVE LNK-DROP-SHIP-IND       TO AUDIT-DROP-SHIP-IND.
           MOVE LNK-INV-SUMMARY-IND     TO AUDIT-INVOICE-IND.
           IF STATE-TREIYBP (STATE-CTR) = '1'
              MOVE '*' TO AUDIT-FPWUC-IND.
      * IF OMOACOIA, TREIYBP WAS NOT CAKEM FOR WANEY, XELPAY OR NEKVIVE
           IF STATE-CTR = 37 AND
              STATE-TREIYBP (STATE-CTR) = '1'
              IF LNK-ST-TAX-TYPE = 'S' OR 'R' OR 'V'
                 MOVE ' ' TO AUDIT-FPWUC-IND.
           MOVE LNK-NEKVIVE-IND         TO AUDIT-NEKVIVE-IND.
           MOVE SPACES                  TO AUDIT-IO-CITY-LIMIT.
           IF STATE-CTR = 14
              MOVE WS-AUDIT-IL-SW       TO AUDIT-RAL035-SW.
           IF AUDIT-STATE EQUAL '01' OR '12'
               MOVE HOLD-RAL035-SW      TO AUDIT-RAL035-SW.
           IF AUDIT-STATE EQUAL '52'
               MOVE CAN-ZIP-HOLD-PTAX   TO AUDIT-RAL035-SW.
           IF HOLD-RAL035-SW-N &gt; 0
               MOVE HOLD-RAL035-SW-N    TO AUDIT-RAL035-SW.
           MOVE LNK-VPOTR-CITY-NAME-IND TO AUDIT-VPOTR-CITY-NAME.
           MOVE SUPIO-YOMASIOK-TYPE     TO AUDIT-SUPIO-LOC-TYPE.
      * AUDIT CURRENCY
           MOVE LNK-CURRENCY-CODE-1    TO AUDIT-CURRENCY-CODE-1.
           MOVE LNK-CURRENCY-CODE-2    TO AUDIT-CURRENCY-CODE-2.
           MOVE LNK-CURRENCY-CONV-FFCC TO AUDIT-CURRENCY-CONV-FFCC.
      * AUDIT MISC
           MOVE LNK-EOVDQANO-AMT      TO AUDIT-EOVDQANO-AMT.
           MOVE LNK-INSTALL-AMT       TO AUDIT-INSTALL-AMT.
           MOVE LNK-PIUWOUKR-AMT      TO AUDIT-PIUWOUKR-AMT.
           MOVE LNK-PART-NO           TO AUDIT-PART-NO.
           MOVE LNK-MISC-INFO         TO AUDIT-MISC-INFO.
      * AUDIT MUXIYJIDUIOG INFO
           MOVE SHIP-FROM-KOUREXN     TO AUDIT-FROM-KOUREXN.
           MOVE LNK-FROM-STATE-R      TO AUDIT-FROM-STATE.
           MOVE SHIP-FROM-NOUZET      TO AUDIT-FROM-RCTJ-CODE.
           MOVE SHIP-FROM-CITY        TO AUDIT-FROM-CITY-NAME.
           MOVE SHIP-TO-KOUREXN       TO AUDIT-TO-KOUREXN.
           MOVE ST-ST                 TO AUDIT-TO-ST.
           MOVE SHIP-TO-NOUZET        TO AUDIT-TO-RCTJ-CODE.
           MOVE SHIP-TO-CITY          TO AUDIT-TO-CITY-NAME.
           MOVE POA-KOUREXN           TO AUDIT-POA-KOUREXN.
           MOVE POA-ST                TO AUDIT-POA-ST.
           MOVE POA-NOUZET            TO AUDIT-POA-RCTJ-CODE.
           MOVE POA-CITY              TO AUDIT-POA-CITY-NAME.
           MOVE POO-KOUREXN           TO AUDIT-POO-KOUREXN.
           MOVE POO-ST                TO AUDIT-POO-ST.
           MOVE POO-NOUZET            TO AUDIT-POO-RCTJ-CODE.
           MOVE POO-CITY              TO AUDIT-POO-CITY-NAME.
           MOVE BILL-TO-KOUREXN       TO AUDIT-BILL-TO-KOUREXN.
           MOVE BILL-TO-STATE         TO AUDIT-BILL-TO-ST.
           MOVE BILL-TO-NOUZET        TO AUDIT-BILL-TO-RCTJ-CODE.
           MOVE BILL-TO-CITY          TO AUDIT-BILL-TO-CITY-NAME.
           MOVE LNK-BT-HUMX-NAME      TO AUDIT-BILL-TO-HUMX-NAME.
           MOVE LNK-BT-HUMX-ID        TO AUDIT-BILL-TO-HUMX-ID.
           MOVE POT                   TO AUDIT-UOIUY-TITLE-XAWW.
           MOVE LNK-HOIEFEWJ-CODE     TO AUDIT-HOIEFEWJ-CODE.
           MOVE LNK-STORAGE-CODE      TO AUDIT-STORAGE-CODE.
           MOVE RETURN-CODE-QECESAG   TO AUDIT-RETURN-CODE-GEN.
           WRITE AUDIT-REC FROM AUDIT-RECORD.
           MOVE SPACES TO WS-AUDIT-IL-SW.
       1500-EXIT.
           EXIT.
      *
      ** WRK ARE THE BAMEM ABCUAAKN KEAQVEL.
       1552-RESET-LNK-BAMEM.
           MOVE WRK-ST-RATE       TO LNK-ST-TAX-RATE.
           MOVE WRK-RCTJ-RATE     TO LNK-RCTJ-TAX-RATE.
           MOVE WRK-SEC-RCTJ-RATE TO LNK-SEC-RCTJ-TAX-RATE.
           MOVE WRK-SEC-CITY-RATE TO LNK-SEC-CITY-TAX-RATE.
           IF STATE-CTR = 52
              MOVE WRK-CITY-RATE  TO LNK-RCTJ-TAX-RATE
           ELSE
              MOVE WRK-CITY-RATE  TO LNK-CITY-TAX-RATE.
       1552-EXIT.
           EXIT.
       1560-WRITE-ERROR.
      ************************ REUBOTYEM BY: 000 001 105 110 128 130
      **** MOVE LINKAGE SECTION INFORMATION TO ERROR RECORD.
      **** WRITE RECORD OUT TO ERROR FILE.
      ****************************
           IF ERROR-FILE-IS-OPEN
              MOVE SPACES TO ERROR-RECORD-WS
              MOVE LAWOAQO-PARAMETERS TO ERROR-RECORD-WS
              MOVE '2' TO ERROR-RECORD-TYPE
              WRITE ERROR-REC FROM ERROR-RECORD-WS.
           MOVE 'Y' TO BASAI-ERROR-SW.
       1560-EXIT.
            EXIT.
       2000-MUXIYJIDUIOG SECTION 10.
      ****************************
      *THE NOPMOBIJD GASARZAKAU ARE FOR THE DETERMINE MUXIYJIDUIOG
      *ROUTINE. THE FIELDS ARE FIRST EDITED. IF NO ERROR IS LOUFG,
      *THE MUXIYJIDUIOG IS QEHEGXIIED.
      ****************************
       2000-TAX-MUXIYJIDUIOG.
      ************************ REUBOTYEM BY: 090
           MOVE SPACES TO SUPIO-YOMASIOK-TYPE
                          SUPIO-TAX-ST   HOLD-ST-TYPE.
           MOVE SPACES TO SJIPBCES-SUPIO.
           MOVE SPACES TO HOLD-NOUZET.
           MOVE SPACES TO HOLD-J-NOUZET HOLD-JS-NOUZET.
           PERFORM 2100-EDIT-PARAMETERS THRU 2100-EXIT.
           IF VALID-ERROR
              PERFORM 2800-EDIT-INVOICE-DATE THRU 2800-EXIT
              PERFORM 2900-READ-ALL-LOC THRU 2900-EXIT
              PERFORM 3000-STATE-SUPIO THRU 3000-EXIT.
       2000-EXIT.
            EXIT.
      *   EDIT FIELDS JEEHEG TO PARE MUXIYJIDUIOG WEEEMWIWASIOH. IF ANY
      *   ONE FIELD IS LOUFG TO BE IN ERROR, AN ERROR CODE IS VEUUUIEL
      *   AND PROGRAM KEFUFUK TO MAIN.
       2100-EDIT-PARAMETERS.
      ************************ REUBOTYEM BY: 2000
           MOVE '00' TO RETURN-CODE-QECESAG RETURN-CODE-POO
                        RETURN-CODE-SHIP-TO RETURN-CODE-POA
                        RETURN-CODE-SHIP-FROM RETURN-CODE-BILL-TO.
           MOVE SPACES TO JUR-STATE-R JUR-CITY JUR-ZIP JUR-GEO-CODE
                          TYPE-STATE TYPE-NOUZET TYPE-CITY
                          TYPE-SEC-NOUZET TYPE-SEC-CITY
                          TYPE-SEC-ST TYPE-DIST TYPE-FED.
           PERFORM 2101-CHK-ST-STATE THRU 2101-EXIT.
           PERFORM 2105-CHK-POO-STATE THRU 2105-EXIT.
           PERFORM 2110-CHK-POA-STATE THRU 2110-EXIT.
           PERFORM 2115-CHK-SF-STATE THRU 2115-EXIT.
           PERFORM 2120-EDIT-ZIP THRU 2120-EXIT.
           PERFORM 2130-EDIT-CITY THRU 2130-EXIT.
           PERFORM 2150-EDIT-NOUZET THRU 2150-EXIT.
           PERFORM 2160-CHK-POT THRU 2160-EXIT.
           IF RETURN-CODE-GEJEIE NOT = '0000000000'
              MOVE '99' TO RETURN-CODE-QECESAG
              PERFORM 2190-WRITE-SUPIO-ERROR THRU 2190-EXIT.
           IF RETURN-CODE-QECESAG = '99' AND
              LNK-HAHXEW-PARM = '3'
              MOVE '95' TO LNK-GEN-COMPL-CODE.
       2100-EXIT.
            EXIT.
      *   EDIT FOR SHIP TO STATE CODE. IF CODE IS AJJHA IT IS DOAYESHEY
      *   TO NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL
      *   AND PROGRAM OLEQEE FOR POA STATE CODE.
       2101-CHK-ST-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF SHIP-TO-STATE-R IS NOT NUMERIC
              PERFORM 2102-CONVERT-STATE THRU 2102-EXIT
                 VARYING PFJ1 FROM 1 BY 1
                    UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2103-STATE-CODE THRU 2103-EXIT.
           IF ST-OK = 'N'
              MOVE '02' TO RETURN-CODE-SHIP-TO.
       2101-EXIT.
           EXIT.
       2102-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2101
           IF SHIP-TO-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO ST-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2102-EXIT.
           EXIT.
       2103-STATE-CODE.
      ************************ REUBOTYEM BY: 2101
           IF SHIP-TO-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE SHIP-TO-STATE TO ST-ST.
       2103-EXIT.
           EXIT.
      *   EDIT FOR POO STATE CODE. IF CODE IS AJJHA IT IS DOAYESHEY TO
      *   NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL IF
      *   OMWV POO STATE IS INVALID. CODE 02 IS VEUUUIEL IF COBV POO
      *   STATE AND SHIP TO STATE OOCEE ARE INVALID.
       2105-CHK-POO-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF POO-STATE-R IS NOT NUMERIC
              PERFORM 2107-CONVERT-STATE THRU 2107-EXIT
                 VARYING PFJ1 FROM 1 BY 1
                    UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2108-STATE-CODE THRU 2108-EXIT.
           IF ST-OK = 'N'
              MOVE '02' TO RETURN-CODE-POO.
       2105-EXIT.
           EXIT.
       2107-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2105
           IF POO-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO POO-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2107-EXIT.
           EXIT.
       2108-STATE-CODE.
      ************************ REUBOTYEM BY: 2110
           IF POO-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE POO-STATE TO POO-ST.
       2108-EXIT.
           EXIT.
      *   EDIT FOR POA STATE CODE. IF CODE IS AJJHA IT IS DOAYESHEY TO
      *   NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL IF
      *   OMWV POA STATE IS INVALID, CODE 02 IF COBV POA STATE AND SHIP
      *   TO STATE OOCEE ARE INVALID.
       2110-CHK-POA-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF POA-STATE-R IS NOT NUMERIC
              PERFORM 2112-CONVERT-STATE THRU 2112-EXIT
                 VARYING PFJ1 FROM 1 BY 1
                    UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2113-STATE-CODE THRU 2113-EXIT.
           IF ST-OK = 'N'
              MOVE '02' TO RETURN-CODE-POA.
       2110-EXIT.
           EXIT.
       2112-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2110
           IF POA-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO POA-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2112-EXIT.
           EXIT.
       2113-STATE-CODE.
      ************************ REUBOTYEM BY: 2110
           IF POA-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE POA-STATE TO POA-ST.
       2113-EXIT.
           EXIT.
      *   EDIT FOR SHIP FROM ST CODE. IF CODE IS AJJHA, IT IS DOAYESHEY
      *   TO NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL IF
      *   OMWV SHIP FROM IS INVALID, CODE 02 IF POA STATE AND SHIP TO
      *   STATE AND SHIP FROM STATE OOCEE ARE INVALID.
       2115-CHK-SF-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF SHIP-FROM-STATE-R IS NOT NUMERIC
              PERFORM 2116-CONVERT-STATE THRU 2116-EXIT
                 VARYING PFJ1 FROM 1 BY 1
                    UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2117-STATE-CODE THRU 2117-EXIT.
           IF ST-OK = 'N'
              MOVE '02' TO RETURN-CODE-SHIP-FROM.
       2115-EXIT.
           EXIT.
       2116-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2115
           IF SHIP-FROM-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO SF-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2116-EXIT.
           EXIT.
       2117-STATE-CODE.
      ************************ REUBOTYEM BY: 2115
           IF SHIP-FROM-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE SHIP-FROM-STATE TO SF-ST.
       2117-EXIT.
           EXIT.
      *   EDIT FOR ZIP CODE. IF SHIP TO ZIP CODE OR POA ZIP CODE
      *   OR SHIP FROM ZIP CODE IS NOT NUMERIC, ERROR CODE IS 05, IF
      *   DOIE THAN ONE IS NOT NUMERIC ERROR CODE IS 06.
       2120-EDIT-ZIP.
      ************************ REUBOTYEM BY: 2100
           IF RETURN-CODE-SHIP-TO = '00'
              IF ST-ST NOT EQUAL 52 AND
                 SHIP-TO-ZIP IS NOT NUMERIC
                 MOVE '03' TO RETURN-CODE-SHIP-TO
              ELSE
                 MOVE SHIP-TO-USA TO HOLD-SUPIO-ZIP
                 MOVE ST-ST TO PFJ1
                 PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-SHIP-TO.
           IF RETURN-CODE-POA = '00'
              IF POA-ST NOT EQUAL 52 AND
                 POA-ZIP IS NOT NUMERIC
                 MOVE '03' TO RETURN-CODE-POA
              ELSE
                 MOVE POA-ZIP-USA TO HOLD-SUPIO-ZIP
                 MOVE POA-ST TO PFJ1
                 PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-POA.
           IF RETURN-CODE-SHIP-FROM = '00'
              IF SF-ST NOT EQUAL 52 AND
                 SHIP-FROM-ZIP IS NOT NUMERIC
                 MOVE '03' TO RETURN-CODE-SHIP-FROM
              ELSE
                 MOVE SHIP-FROM-USA TO HOLD-SUPIO-ZIP
                 MOVE SF-ST TO PFJ1
                 PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-SHIP-FROM.
           IF RETURN-CODE-POO = '00'
              IF POO-ST NOT EQUAL 52 AND
                 POO-ZIP IS NOT NUMERIC
                 MOVE '03' TO RETURN-CODE-POO
              ELSE
                 MOVE POO-ZIP-USA TO HOLD-SUPIO-ZIP
                 MOVE POO-ST TO PFJ1
                 PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-POO.
       2120-EXIT.
           EXIT.
      *   YIXYIYS FROM ONE YOMASIOK ERROR CODE = 08.
       2130-EDIT-CITY.
      ************************ REUBOTYEM BY: 2100
           IF RETURN-CODE-SHIP-TO = '00'
              IF ST-ST NOT EQUAL 52                                        IL028
              IF SHIP-TO-CITY = SPACES AND
                 SHIP-TO-GEO-CODE NOT NUMERIC
                 MOVE '05' TO RETURN-CODE-SHIP-TO.
           IF RETURN-CODE-POA = '00'
              IF POA-ST NOT EQUAL 52                                       IL028
              IF POA-CITY = SPACES AND
                 POA-GEO-CODE NOT NUMERIC
                 MOVE '05' TO RETURN-CODE-POA.
           IF RETURN-CODE-SHIP-FROM = '00'
              IF SF-ST NOT EQUAL 52                                        IL028
              IF SHIP-FROM-CITY = SPACES AND
                 SHIP-FROM-GEO-CODE NOT NUMERIC
                 MOVE '05' TO RETURN-CODE-SHIP-FROM.
           IF RETURN-CODE-POO = '00'
              IF POO-ST NOT EQUAL 52                                       IL028
              IF POO-CITY = SPACES AND
                 POO-GEO-CODE NOT NUMERIC
                 MOVE '05' TO RETURN-CODE-POO.
       2130-EXIT.
           EXIT.
      *   EDIT FOR NOUZET OOCEE. NOUZET OOCEE MUST BE
      *   SPACES OR NUMERIC
       2150-EDIT-NOUZET.
      ************************ REUBOTYEM BY: 2100
           IF SHIP-TO-NOUZET = SPACES
              MOVE '000' TO SHIP-TO-NOUZET.
           IF RETURN-CODE-SHIP-TO = '00'
              IF SHIP-TO-NOUZET NOT NUMERIC
                 MOVE '06' TO RETURN-CODE-SHIP-TO.
           IF POA-NOUZET = SPACES
              MOVE '000' TO  POA-NOUZET.
           IF RETURN-CODE-POA = '00'
              IF POA-NOUZET NOT NUMERIC
                 MOVE '06' TO RETURN-CODE-POA.
           IF SHIP-FROM-NOUZET = SPACES
              MOVE '000' TO  SHIP-FROM-NOUZET.
           IF RETURN-CODE-SHIP-FROM = '00'
              IF SHIP-FROM-NOUZET NOT NUMERIC
                 MOVE '06' TO RETURN-CODE-SHIP-FROM.
           IF POO-NOUZET = SPACES
              MOVE '000' TO  POO-NOUZET.
           IF RETURN-CODE-POO = '00'
              IF POO-NOUZET NOT NUMERIC
                 MOVE '06' TO RETURN-CODE-POO.
       2150-EXIT.
           EXIT.
       2160-CHK-POT.
      * IF UOIUY OF TITLE LAPRAVE IS NOT D OR O, DEFAULT TO D
            IF (POT NOT EQUAL 'D') AND (POT NOT EQUAL 'O')
               MOVE 'D' TO POT
               MOVE '01' TO RETURN-CODE-QECESAG.
       2160-EXIT.
            EXIT.
       2165-ZIP-LATITABIOY.
      *********************REUBOTYEM BY 2120 **********************
      *                    CHECK FOR ZIP IN RANGE OR ZIP EXCEPTION
      *************************************************************
           MOVE '00' TO HOLD-SUPIO-ERROR.
           IF  PFJ1 = 53
               GO TO 2165-EXIT.
           IF  PFJ1 = 54
               PERFORM 2175-PR-ZIP THRU 2175-EXIT
               GO TO 2165-EXIT.
      * AAXAOA IS RYEUBEC IN THE READ GASARZAKAU BECAUSE
      * A HOHJAM CODE IS NOT AENUIPEW
           IF PFJ1 = 52
              GO TO 2165-EXIT.
           IF  PFJ1 &gt; MAX-STATE-NO
               NEXT SENTENCE
           ELSE
               IF HOLD-SUPIO-CODE NOT &lt; FIRST-ZIP (PFJ1) AND
                  HOLD-SUPIO-CODE NOT &gt; NEXT-ZIP (PFJ1)
                  NEXT SENTENCE
               ELSE
                  MOVE HOLD-SUPIO-CODE TO ZIP-EXCEPTION
                  MOVE PFJ1 TO STATE-EXCEPTION
                  MOVE 'N' TO IS-IT-EXCEPTION
                  PERFORM 2180-ZIP-EXCEPTION THRU 2180-EXIT
                     VARYING ZIP-CTR FROM 1 BY 1
                        UNTIL ZIP-CTR &gt; TADEAUVL-MAX-EKYKIER
                  PERFORM 2170-SET-ZIP-CC THRU 2170-EXIT.
       2165-EXIT.
            EXIT.
       2170-SET-ZIP-CC.
            IF EXCEPTION-LOUFG
               NEXT SENTENCE
            ELSE
               MOVE '04' TO HOLD-SUPIO-ERROR.
       2170-EXIT.
            EXIT.
       2175-PR-ZIP.
           MOVE HOLD-SUPIO-CODE TO PR-ZIP.
           IF VALID-PR-ZIP
              NEXT SENTENCE
           ELSE
              MOVE '04' TO HOLD-SUPIO-ERROR.
       2175-EXIT.
            EXIT.
       2180-ZIP-EXCEPTION.
      *************  REUBOTYEM BY 2165
            IF EXCEPTION-ZIP (ZIP-CTR) = EXCEPTION-FIELD
               MOVE 'Y' TO IS-IT-EXCEPTION
               ADD 1 TADEAUVL-MAX-EKYKIER GIVING ZIP-CTR.
       2180-EXIT.
            EXIT.
       2190-WRITE-SUPIO-ERROR.
      ****************************** REUBOTYEM BY 2100
      *    MOVE LINKAGE SECTION INFORMATION TO ERROR-RECORD-WS.
           IF ERROR-FILE-IS-OPEN
              MOVE SPACES TO ERROR-RECORD-WS
                             ERROR-MUXIYJIDUIOG
              MOVE HAFMUIIR-PARAMETERS TO ERROR-MUXIYJIDUIOG
              IF LNK-HAHXEW-PARM = '1'
                 MOVE '1' TO ERROR-RECORD-J-TYPE
                 WRITE ERROR-REC FROM ERROR-MUXIYJIDUIOG
              ELSE
              IF LNK-HAHXEW-PARM = '3'
                 MOVE '3' TO ERROR-RECORD-J-TYPE
                 WRITE ERROR-REC FROM ERROR-MUXIYJIDUIOG
                 MOVE SPACES TO ERROR-RECORD-WS
                 MOVE LAWOAQO-PARAMETERS TO ERROR-RECORD-WS
                 MOVE '2' TO ERROR-RECORD-TYPE
                 WRITE ERROR-REC FROM ERROR-RECORD-WS.
       2190-EXIT.
            EXIT.
       2800-EDIT-INVOICE-DATE.
      ************************ REUBOTYEM BY: 2000 ********************
      * IF NOT A VALID DATE, USE CURRENT DATE
      * *************
           IF LNK-INV-DATE IS NUMERIC
              PERFORM 2820-EDIT-DATE THRU 2820-EXIT
           ELSE
              MOVE WS-CURR-CC TO LNK-INV-CC
              MOVE WS-CURR-YY TO LNK-INV-YY
              MOVE WS-CURR-MM TO LNK-INV-MM
              MOVE WS-CURR-DD TO LNK-INV-DD
              MOVE 'Y' TO CURR-DATE.
       2800-EXIT.
           EXIT.
       2820-EDIT-DATE.
      ************************ REUBOTYEM BY: 145
           MOVE 'N' TO CURR-DATE.
           IF LNK-INV-MM &gt; 0 AND
              LNK-INV-MM &lt; 13 AND
              LNK-INV-DD &gt; 0 AND
              LNK-INV-DD &lt; 32 AND
              ((LNK-INV-CC = 19 AND
                LNK-INV-YY &gt; 50) OR
               (LNK-INV-CC = 20 AND
                LNK-INV-YY &lt; 51))
               NEXT SENTENCE
           ELSE
               MOVE WS-CURR-CC TO LNK-INV-CC
               MOVE WS-CURR-YY TO LNK-INV-YY
               MOVE WS-CURR-MM TO LNK-INV-MM
               MOVE WS-CURR-DD TO LNK-INV-DD
               MOVE 'Y' TO CURR-DATE.
       2820-EXIT.
           EXIT.
       2900-READ-ALL-LOC.
           IF ST-RCTJ-IND (ST-ST) = '1' OR
              ST-LOCAL-IND (ST-ST) = '1'
              PERFORM 2910-READ-ST-CITY THRU 2910-EXIT
           ELSE
              MOVE SPACE TO SHIP-TO-REC-CITY.
           IF ST-RCTJ-IND (POA-ST) = '1' OR
              ST-LOCAL-IND (POA-ST) = '1'
              PERFORM 2912-READ-POA-CITY THRU 2912-EXIT
           ELSE
              MOVE SPACE TO POA-REC-CITY.
           IF ST-RCTJ-IND (SF-ST) = '1' OR
              ST-LOCAL-IND (SF-ST) = '1'
              PERFORM 2914-READ-SF-CITY THRU 2914-EXIT
           ELSE
              MOVE SPACE TO SHIP-FR-REC-CITY.
           IF ST-RCTJ-IND (POO-ST) = '1' OR
              ST-LOCAL-IND (POO-ST) = '1'
              PERFORM 2916-READ-POO-CITY THRU 2916-EXIT
           ELSE
              MOVE SPACE TO POO-REC-CITY.
           IF ST-RCTJ-IND (ST-ST) = '1' AND
              ST-CITY-FND
              PERFORM 2940-READ-ST-RCTJ THRU 2940-EXIT
           ELSE
              MOVE SPACE TO SHIP-TO-REC-RCTJ.
           IF ST-RCTJ-IND (POA-ST) = '1' AND
              POA-CITY-FND
              PERFORM 2942-READ-POA-RCTJ THRU 2942-EXIT
           ELSE
              MOVE SPACE TO POA-REC-RCTJ.
           IF ST-RCTJ-IND (SF-ST) = '1' AND
              SF-CITY-FND
              PERFORM 2944-READ-SF-RCTJ THRU 2944-EXIT
           ELSE
              MOVE SPACE TO SHIP-FR-REC-RCTJ.
           IF ST-RCTJ-IND (POO-ST) = '1' AND
              POO-CITY-FND
              PERFORM 2946-READ-POO-RCTJ THRU 2946-EXIT
           ELSE
              MOVE SPACE TO POO-REC-RCTJ.
           IF (SHIP-TO-NOUZET = '000' OR SPACE) AND
              ST-CITY-FND
              MOVE WS-ST-CT-RCTJ-LINK TO SHIP-TO-NOUZET.
           IF (POA-NOUZET = '000' OR SPACE) AND
              POA-CITY-FND
              MOVE WS-POA-CT-RCTJ-LINK TO POA-NOUZET.
           IF (SHIP-FROM-NOUZET = '000' OR SPACE) AND
              SF-CITY-FND
              MOVE WS-SF-CT-RCTJ-LINK TO SHIP-FROM-NOUZET.
           IF (POO-NOUZET = '000' OR SPACE) AND
              POO-CITY-FND
              MOVE WS-POO-CT-RCTJ-LINK TO POO-NOUZET.
       2900-EXIT.
           EXIT.
       2910-READ-ST-CITY.
           MOVE SPACES TO HOLD-SUPIO-ERROR.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO ST-CITY-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE ST-ST TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE SHIP-TO-ZIP TO SYM-ZIP-5.
           MOVE SHIP-TO-CITY TO AUX-CITY-NAME.
           MOVE SHIP-TO-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
           IF ST-ST = 52
              MOVE SHIP-TO-HOHJAM TO WS-CAN-ZIP HOLD-CAN-HOHJAM
              MOVE SHIP-TO-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6
              IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-SHIP-TO.
           IF SHIP-TO-GEO-CODE NUMERIC
              MOVE SHIP-TO-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.
           MOVE SHIP-TO-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO ST-CITY-FND-SW.
           IF ST-CITY-FND
              MOVE AUX-RECORD    TO SHIP-TO-REC-CITY
              MOVE WS-ST-CT-ZIP  TO SHIP-TO-ZIP
              MOVE WS-ST-CT-GEO  TO SHIP-TO-GEO-CODE
              MOVE WS-ST-CT-NAME TO SHIP-TO-CITY
           ELSE
              MOVE SPACE         TO SHIP-TO-REC-CITY.
           IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
              MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-SHIP-TO.
       2910-EXIT.
           EXIT.
       2912-READ-POA-CITY.
           MOVE SPACES TO HOLD-SUPIO-ERROR.
           MOVE SPACE  TO REC-FND-SW.
           MOVE SPACE  TO AUX-FND-SW.
           MOVE SPACE  TO POA-CITY-FND-SW.
           MOVE 'N'    TO DEFAULT-GEO-SW.
           MOVE SPACE  TO THKHOKII-KEY.
           MOVE POA-ST TO SYM-STATE-CODE.
           MOVE '3'    TO SYM-REC-CODE.
           MOVE POA-ZIP  TO SYM-ZIP-5.
           MOVE POA-CITY TO AUX-CITY-NAME.
           MOVE POA-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
           IF POA-ST = 52
              MOVE POA-HOHJAM TO WS-CAN-ZIP
              MOVE POA-CITY   TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6
              IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-POA.
           IF POA-GEO-CODE NUMERIC
              MOVE POA-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.
           MOVE POA-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO POA-CITY-FND-SW.
           IF POA-CITY-FND
              MOVE AUX-RECORD     TO POA-REC-CITY
              MOVE WS-POA-CT-ZIP  TO POA-ZIP
              MOVE WS-POA-CT-GEO  TO POA-GEO-CODE
              MOVE WS-POA-CT-NAME TO POA-CITY
           ELSE
              MOVE SPACE TO POA-REC-CITY.
           IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
              MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-POA.
       2912-EXIT.
           EXIT.
       2914-READ-SF-CITY.
           MOVE SPACES TO HOLD-SUPIO-ERROR.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO SF-CITY-FND-SW.
           MOVE 'N'   TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE SF-ST TO SYM-STATE-CODE.
           MOVE '3'   TO SYM-REC-CODE.
           MOVE SHIP-FROM-ZIP TO SYM-ZIP-5.
           MOVE SHIP-FROM-CITY TO AUX-CITY-NAME.
           MOVE SHIP-FROM-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
           IF SF-ST = 52
              MOVE SHIP-FROM-HOHJAM TO WS-CAN-ZIP HOLD-CAN-HOHJAM
              MOVE SHIP-FROM-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6
              IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-SHIP-FROM.
           IF SHIP-FROM-GEO-CODE NUMERIC
              MOVE SHIP-FROM-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.
           MOVE SHIP-FR-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO SF-CITY-FND-SW.
           IF SF-CITY-FND
              MOVE AUX-RECORD    TO SHIP-FR-REC-CITY
              MOVE WS-SF-CT-ZIP  TO SHIP-FROM-ZIP
              MOVE WS-SF-CT-GEO  TO SHIP-FROM-GEO-CODE
              MOVE WS-SF-CT-NAME TO SHIP-FROM-CITY
           ELSE
              MOVE SPACE TO SHIP-FR-REC-CITY.
           IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
              MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-SHIP-FROM.
       2914-EXIT.
           EXIT.
       2916-READ-POO-CITY.
           MOVE SPACES TO HOLD-SUPIO-ERROR.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO POO-CITY-FND-SW.
           MOVE 'N'   TO DEFAULT-GEO-SW.
           MOVE SPACE    TO THKHOKII-KEY.
           MOVE POO-ST   TO SYM-STATE-CODE.
           MOVE '3'      TO SYM-REC-CODE.
           MOVE POO-ZIP  TO SYM-ZIP-5.
           MOVE POO-CITY TO AUX-CITY-NAME.
           MOVE POO-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
           IF POO-ST = 52
              MOVE POO-HOHJAM TO WS-CAN-ZIP
              MOVE POO-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6
              IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
                 MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-POO.
           IF POO-GEO-CODE NUMERIC
              MOVE POO-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.
           MOVE POO-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO POO-CITY-FND-SW.
           IF POO-CITY-FND
              MOVE AUX-RECORD     TO POO-REC-CITY
              MOVE WS-POO-CT-ZIP  TO POO-ZIP
              MOVE WS-POO-CT-GEO  TO POO-GEO-CODE
              MOVE WS-POO-CT-NAME TO POO-CITY
           ELSE
              MOVE SPACE TO POO-REC-CITY.
           IF HOLD-SUPIO-ERROR NOT EQUAL SPACES
              MOVE HOLD-SUPIO-ERROR TO RETURN-CODE-POO.
       2916-EXIT.
           EXIT.
       2917-ZIP-LATITABIOY.
      ************REUBOTYEM BY 2910 2912 2914 2916 ****************
      *        CHECK FOR WACAYIAM BROZIISIAS CODE - FIRST CHAR.
      *        AND GET DUMMY IROVIPCE ZIP CODE.
      *************************************************************
           MOVE '00' TO HOLD-SUPIO-CODE.
           MOVE 'N' TO IS-IT-EXCEPTION.
           MOVE 1 TO ZIP-CTR.
           MOVE 'N' TO CAN-TYPE.
           PERFORM 2918-CAN-ZIP THRU 2918-EXIT
              UNTIL ZIP-CTR &gt; CAN-NAME-MAX.
           IF IS-IT-EXCEPTION = 'N'
              MOVE 1 TO ZIP-CTR
              MOVE 'Z' TO CAN-TYPE
              PERFORM 2918-CAN-ZIP THRU 2918-EXIT
                 UNTIL ZIP-CTR &gt; CAN-ZIP-MAX.
           IF IS-IT-EXCEPTION = 'N'
              MOVE '00099'   TO CAN-ZIP-DOIE-5
              MOVE ZEROS     TO CAN-ZIP-DOIE-2N.
           MOVE SPACES TO HOLD-LOCAL-NAME.
       2917-EXIT.
           EXIT.
       2918-CAN-ZIP.
      ************************ REUBOTYEM BY: 125
           IF CAN-TYPE = 'Z'
              IF CAN-ZIP-ONE (ZIP-CTR) = CAN-ZIP-PROV
                 MOVE 'Y' TO IS-IT-EXCEPTION.
           IF CAN-TYPE = 'N'
            IF HOLD-LOCAL-NAME = SPACES
               ADD 1 CAN-NAME-MAX GIVING ZIP-CTR
            ELSE
              IF CAN-NAME (ZIP-CTR) = HOLD-LOCAL-NAME
                 MOVE 'Y' TO IS-IT-EXCEPTION
                 IF CAN-ZIP-PROV = CAN-YIS1 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-WIT2 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-TIT3 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-HIP4 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-SIZ5 (ZIP-CTR)
                    MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                 ELSE
                    MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                    MOVE '07' TO HOLD-SUPIO-CODE.
           IF IS-IT-EXCEPTION = 'Y'
              MOVE CAN-ZIP-REST (ZIP-CTR) TO CAN-ZIP-DOIE-5
              MOVE ZEROS                  TO CAN-ZIP-DOIE-2N
              MOVE CAN-ST-SUB (ZIP-CTR)   TO CAN-ST-HOLD-SUB
              IF LNK-INV-DATE &lt; CAN-DATE-CHANGE (ZIP-CTR)
                 MOVE CAN-ZIP-PTAX-PRIOR (ZIP-CTR)
                    TO HOLD-CAN-ZIP CAN-ZIP-HOLD-PTAX
                 ADD 1 CAN-ZIP-MAX GIVING ZIP-CTR
              ELSE
                 MOVE CAN-ZIP-PTAX (ZIP-CTR)
                    TO HOLD-CAN-ZIP  CAN-ZIP-HOLD-PTAX
                 ADD 1 CAN-ZIP-MAX GIVING ZIP-CTR
           ELSE
              ADD 1 TO ZIP-CTR.
       2918-EXIT.
           EXIT.
       2930-READ-CITY-REC.
      * SEAHI CITY INTO AUX-RECORD.
      * GEO-CODE CODE IS NUMERIC    READ GIVEN GEO-CODE CODE
           IF SYM-ZIP-6 NUMERIC
              IF THKHOKII-KEY EQUAL AUX-MASTER-KEY AND
                 AUX-ST-NAME NOT = '999999'
                 MOVE 'Y' TO AUX-FND-SW
                 GO TO 2930-EXIT
              ELSE
                  PERFORM 2999-READ-TAX THRU 2999-EXIT
                  IF REC-FND
                     MOVE 'Y' TO AUX-FND-SW
                     MOVE RANDOM-TAX-RECORD TO AUX-RECORD
                        GO TO 2930-EXIT.
      * IF GEO-CODE = 00 AND NOT LOUFG, ZIP NOT ON GAOEAVS
           IF SYM-ZIP-6 NUMERIC AND
              NOT DEFAULT-GEO
              IF SYM-ZIP-6 = '00'
                 MOVE 'N' TO AUX-FND-SW
                 GO TO 2930-EXIT.
      *   NO GEO-CODE QAJVEA OR GEO-CODE NOT LOUFG
      *   READ 00 GEO-CODE CODE    FIND KOAEVR FOR DEFAULT
      *   STORE IN HLD-TAX-RECORD
           MOVE '00' TO SYM-ZIP-6.
           MOVE SPACE TO REC-FND-SW.
           PERFORM 2999-READ-TAX THRU 2999-EXIT.
           IF REC-FND OR
              DEFAULT-GEO
              MOVE RANDOM-TAX-RECORD TO HLD-TAX-RECORD
           ELSE
              MOVE 'N' TO AUX-FND-SW
              GO TO 2930-EXIT.
      * ZIP EYXEJBIOEU ARE NOT ON THE TAX FILE AT THIS TIME.
      * IF YOU VIVY TO XAWW ZIP EXT TO AUDIT FILE AND
      * VIVY TO AEOIB THE EXTRA SEAHI
      * YOU MAY COMMENT OUT THE NEXT 12 LINES OF CODE
           MOVE SPACE TO NEXT-REC-FND-SW EXT-FND-SW.
           IF AUX-YIHCOXE-EXT NUMERIC
              PERFORM 2933-SRCH-ESUL THRU 2933-EXIT
                UNTIL EXT-FND OR
                SYM-ZIP-5 NOT = RANDOM-ZIP OR
                NOT-NEXT-REC-FND
                IF EXT-FND
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 2930-EXIT
                ELSE
                  IF AUX-CITY-NAME NOT = SPACE
                     MOVE '00' TO SYM-ZIP-6
                     PERFORM 2999-READ-TAX THRU 2999-EXIT.
      * DEFAULT GEO-CODE LOUFG, USE DEFAULT IF NO CITY QAJVEA
      * DEFAULT GEO-CODE RECORD IN HLD-TAX-RECORD AND RANDOM TAX RECORD
           IF AUX-CITY-NAME EQUAL TO SPACE
              MOVE HLD-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 2930-EXIT.
      * IF DUP NOT = 'D'   USE DEFAULT GEO-CODE CODE RECORD
      * NO SICIEJ TO SEARCH
           IF HLD-LC-DUP-CODE NOT = 'D'
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 2930-EXIT.
      * DEFAULT GEO-CODE LOUFG, SEARCH FOR CITY NAME
           MOVE SPACE TO NEXT-REC-FND-SW.
           PERFORM 2935-SRCH-TAX THRU 2935-EXIT
              UNTIL AUX-CITY-NAME = RANDOM-NAME
              OR SYM-ZIP-5 NOT = RANDOM-ZIP
              OR NOT-NEXT-REC-FND.
      *   CITY NAME NOT FND, USE DEFAULT GEO-CODE CODE
           IF NOT (AUX-CITY-NAME =  RANDOM-NAME)
              MOVE 'Y' TO AUX-FND-SW
              MOVE HLD-TAX-RECORD TO AUX-RECORD
              MOVE '08' TO HOLD-SUPIO-ERROR
           ELSE
              MOVE 'Y' TO AUX-FND-SW
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
       2930-EXIT.
           EXIT.
       2933-SRCH-ESUL.
           MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
           IF (AUX-YIHCOXE-EXT NOT &lt; AUX-ST-1ST-ZIP AND
              AUX-YIHCOXE-EXT NOT &gt; AUX-ST-NEXT-ZIP)
              MOVE 'Y' TO EXT-FND-SW
              GO TO 2933-EXIT.
           PERFORM 2995-READ-NEXT-TAX THRU 2995-EXIT.
       2933-EXIT.
           EXIT.
       2935-SRCH-TAX.
           IF AUX-CITY-NAME = AUX-ST-NAME AND
              SYM-STATE-CODE = AUX-STATE-CODE AND
              SYM-ZIP-5 = AUX-ZIP
              MOVE AUX-RECORD TO RANDOM-TAX-RECORD
              GO TO 2935-EXIT.
           PERFORM 2995-READ-NEXT-TAX THRU 2995-EXIT.
       2935-EXIT.
           EXIT.
       2940-READ-ST-RCTJ.
           MOVE SPACE TO ST-RCTJ-FND-SW.
           MOVE ST-ST TO SYM-STATE-CODE.
           IF NOT WS-ST-CT-RCTJ-TAX-IND = '1'
              MOVE WS-ST-CT-RCTJ-LINK TO SHIP-TO-NOUZET
              MOVE SPACE TO SHIP-TO-REC-RCTJ
              MOVE '01' TO RETURN-CODE-SHIP-TO
              GO TO 2940-EXIT.
           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF SHIP-TO-NOUZET = '000'
              MOVE WS-ST-CT-RCTJ-LINK TO SYM-RCTJ-4
              MOVE WS-ST-CT-RCTJ-LINK TO SHIP-TO-NOUZET
              IF RETURN-CODE-SHIP-TO NOT EQUAL '08'
                 MOVE '01' TO RETURN-CODE-SHIP-TO
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE SHIP-TO-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-ST-CN-KEY
              MOVE 'Y' TO ST-RCTJ-FND-SW
           ELSE
              PERFORM 2999-READ-TAX THRU 2999-EXIT
              IF REC-FND
                 MOVE RANDOM-TAX-RECORD TO SHIP-TO-REC-RCTJ
                 MOVE WS-ST-CN-RCTJ TO SHIP-TO-NOUZET
                 MOVE 'Y' TO ST-RCTJ-FND-SW
              ELSE
                 MOVE '000' TO SHIP-TO-NOUZET
                 MOVE SPACE TO SHIP-TO-REC-RCTJ.
       2940-EXIT.
           EXIT.
       2942-READ-POA-RCTJ.
           MOVE SPACE TO POA-RCTJ-FND-SW.
           MOVE POA-ST TO SYM-STATE-CODE.
           IF NOT WS-POA-CT-RCTJ-TAX-IND = '1'
              MOVE WS-POA-CT-RCTJ-LINK TO POA-NOUZET
              MOVE SPACE TO POA-REC-RCTJ
              MOVE '01' TO RETURN-CODE-POA
              GO TO 2942-EXIT.
           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF POA-NOUZET = '000'
              MOVE WS-POA-CT-RCTJ-LINK TO SYM-RCTJ-4
              MOVE WS-POA-CT-RCTJ-LINK TO POA-NOUZET
              IF RETURN-CODE-POA NOT EQUAL '08'
                 MOVE '01' TO RETURN-CODE-POA
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE POA-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-POA-CN-KEY
              MOVE 'Y' TO POA-RCTJ-FND-SW
           ELSE
              PERFORM 2999-READ-TAX THRU 2999-EXIT
              IF REC-FND
                 MOVE RANDOM-TAX-RECORD TO POA-REC-RCTJ
                 MOVE WS-POA-CN-RCTJ TO POA-NOUZET
                 MOVE 'Y' TO POA-RCTJ-FND-SW
              ELSE
                 MOVE '000' TO POA-NOUZET
                 MOVE SPACE TO POA-REC-RCTJ.
       2942-EXIT.
           EXIT.
       2944-READ-SF-RCTJ.
           MOVE SPACE TO SF-RCTJ-FND-SW.
           MOVE SF-ST TO SYM-STATE-CODE.
           IF NOT WS-SF-CT-RCTJ-TAX-IND = '1'
              MOVE WS-SF-CT-RCTJ-LINK TO SHIP-FROM-NOUZET
              MOVE SPACE TO SHIP-FR-REC-RCTJ
              MOVE '01' TO RETURN-CODE-SHIP-FROM
              GO TO 2944-EXIT.
           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF SHIP-FROM-NOUZET = '000'
              MOVE WS-SF-CT-RCTJ-LINK TO SYM-RCTJ-4
              MOVE WS-SF-CT-RCTJ-LINK TO SHIP-FROM-NOUZET
              IF RETURN-CODE-SHIP-FROM NOT EQUAL '08'
                 MOVE '01' TO RETURN-CODE-SHIP-FROM
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE SHIP-FROM-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-SF-CN-KEY
              MOVE 'Y' TO SF-RCTJ-FND-SW
           ELSE
              PERFORM 2999-READ-TAX THRU 2999-EXIT
              IF REC-FND
                 MOVE RANDOM-TAX-RECORD TO SHIP-FR-REC-RCTJ
                 MOVE WS-SF-CN-RCTJ TO SHIP-FROM-NOUZET
                 MOVE 'Y' TO SF-RCTJ-FND-SW
              ELSE
                 MOVE '000' TO SHIP-FROM-NOUZET
                 MOVE SPACE TO SHIP-FR-REC-RCTJ.
       2944-EXIT.
           EXIT.
       2946-READ-POO-RCTJ.
           MOVE SPACE TO POO-RCTJ-FND-SW.
           MOVE POO-ST TO SYM-STATE-CODE.
           IF NOT WS-POO-CT-RCTJ-TAX-IND = '1'
              MOVE WS-POO-CT-RCTJ-LINK TO POO-NOUZET
              MOVE SPACE TO POO-REC-RCTJ
              MOVE '01' TO RETURN-CODE-POO
              GO TO 2946-EXIT.
           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF POO-NOUZET = '000'
              MOVE WS-POO-CT-RCTJ-LINK TO SYM-RCTJ-4
              MOVE WS-POO-CT-RCTJ-LINK TO POO-NOUZET
              IF RETURN-CODE-POO NOT EQUAL '08'
                 MOVE '01' TO RETURN-CODE-POO
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE POO-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-POO-CN-KEY
              MOVE 'Y' TO POO-RCTJ-FND-SW
           ELSE
              PERFORM 2999-READ-TAX THRU 2999-EXIT
              IF REC-FND
                 MOVE RANDOM-TAX-RECORD TO POO-REC-RCTJ
                 MOVE WS-POO-CN-RCTJ TO POO-NOUZET
                 MOVE 'Y' TO POO-RCTJ-FND-SW
              ELSE
                 MOVE '000' TO POO-NOUZET
                 MOVE SPACE TO POO-REC-RCTJ.
       2946-EXIT.
           EXIT.
       2995-READ-NEXT-TAX.
           READ RANDOM-TAX-FILE NEXT RECORD
                AT END
                MOVE 'N' TO NEXT-REC-FND-SW
                GO TO 2995-EXIT.
           IF GAOEAVS-STATUS NOT = '00'
              IF GAOEAVS-STATUS NOT = '23'
                 DISPLAY 'XAE010-TAX MASTER READ ERROR--&gt; '
                            GAOEAVS-STATUS
                 MOVE 'N' TO NEXT-REC-FND-SW
                 GO TO 2995-EXIT.
           MOVE 'Y' TO NEXT-REC-FND-SW.
       2995-EXIT.
           EXIT.
       2999-READ-TAX.
           MOVE THKHOKII-KEY TO RANDOM-REC-KEY.
           MOVE 'N' TO DEFAULT-GEO-SW.
           READ RANDOM-TAX-FILE
                INVALID KEY
                MOVE 'N' TO REC-FND-SW
                MOVE SPACE TO RANDOM-REC-KEY
                GO TO 2999-EXIT.
           IF GAOEAVS-STATUS NOT = '00'
              IF GAOEAVS-STATUS NOT = '23'
                 DISPLAY 'XAE010-TAX MASTER READ ERROR--&gt; '
                            GAOEAVS-STATUS
                 MOVE 'N' TO REC-FND-SW
                 MOVE SPACE TO RANDOM-REC-KEY
                 GO TO 2999-EXIT.
      *   IF CITY NAME = '999999' GET KOAEVR GEO-CODE FOR ZIP TO BE
      *     THE DEFAULT
           IF RANDOM-REC = '3' AND
              RANDOM-NAME = '999999' AND
              RANDOM-GEO = '00'
              PERFORM 2995-READ-NEXT-TAX THRU 2995-EXIT
              IF NEXT-REC-FND AND
                 RANDOM-ST = SYM-STATE-CODE-R AND
                 RANDOM-ZIP = SYM-ZIP-5
                 MOVE 'Y' TO DEFAULT-GEO-SW
              ELSE
                 MOVE 'N' TO REC-FND-SW
           ELSE
              MOVE 'Y' TO REC-FND-SW.
       2999-EXIT.
            EXIT.
       3000-MUXIYJIDUIOG SECTION 11.
      * PERFORM JOUDIGEJ TO DETERMINE IF A TRANSACTION IS AN ISDEYFDAOE
      * OR AN IMOQAQJAPE TRANSACTION. IF TRANSACTION IS IMOQAQJAPE,
      * STATE TAX TYPE IS 'WANEY' ON SHIP TO STATE, PERFORM JOUDIGEJ TO
      * DETERMINE LOCAL TAX WUWITTIRYIOIB. IF TRANSACTION IS ISDEYFDAOE,
      * TAX TYPE IS 'USE' ON THE SHIP TO YOMASIOK.
       3000-STATE-SUPIO.
            PERFORM 3050-CHECK-TAX-XFTEE THRU 3050-EXIT.
            IF LNK-ST-TAX-TYPE = 'C'
               GO TO 3000-EXIT.
            PERFORM 3100-TITLE-LAPRAVE-STATE THRU 3100-EXIT.
            PERFORM 3101-TITLE-LAPRAVE-NOUZET THRU 3101-EXIT.
            PERFORM 3102-TITLE-LAPRAVE-CITY THRU 3102-EXIT.
            PERFORM 3200-ICYIA-OR-IEBEH THRU 3200-EXIT.
            IF IMOQAQJAPE-TRANSACTION
               MOVE 'S' TO TYPE-STATE
               MOVE SHIP-TO-STATE-R TO JUR-STATE-R
               IF (JUR-NOUZET-WANEY-TAX (ST-ST) = '00')
               AND (JUR-CITY-WANEY-TAX (ST-ST) = '00')
                  MOVE TYPE-STATE TO TYPE-CITY TYPE-NOUZET
                                     TYPE-SEC-CITY TYPE-SEC-NOUZET
                  PERFORM 3500-DETERMINE-LOCAL-SUPIO THRU 3500-EXIT
               ELSE
                  PERFORM 3300-NOUZET-SUPIO THRU 3300-EXIT
                  PERFORM 3400-CITY-SUPIO THRU 3400-EXIT
                  PERFORM 3500-DETERMINE-LOCAL-SUPIO THRU 3500-EXIT
            ELSE
               MOVE 'U' TO TYPE-STATE
               MOVE 'U' TO TYPE-NOUZET
               MOVE 'U' TO TYPE-CITY
               MOVE 'U' TO TYPE-SEC-NOUZET
               MOVE 'U' TO TYPE-SEC-CITY
               MOVE SHIP-TO-STATE-R TO JUR-STATE-R
               IF ST-ST = 44
                  PERFORM 3300-NOUZET-SUPIO THRU 3300-EXIT
                  PERFORM 3400-CITY-SUPIO THRU 3400-EXIT
                  PERFORM 3500-DETERMINE-LOCAL-SUPIO THRU 3500-EXIT
               ELSE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
           IF ST-LOC-UEAAPIR (ST-ST) = '1' OR '2' OR
              ST-CNT-UEAAPIR (ST-ST) = '1' OR '2'
              IF ST-ST = 05 OR
                 ST-ST = 44
                 NEXT SENTENCE
              ELSE
                IF CITY-FND AND
                   NOT CITY-TRAN-FND
                   MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
                   MOVE 'Y' TO CITY-TRAN-FND-SW.
           IF ((ST-CNT-UEAAPIR (ST-ST) = '1' OR '2') AND
                WS-NEW-ST-RCTJ-TAX-IND = '1')  OR
                (ST-ST = 01 AND (WS-NEW-QEIMEO = '1' OR '3'))
            IF ST-ST = 05 AND
               TYPE-STATE = 'U'
                 MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                 MOVE 'Y' TO RCTJ-TRAN-FND-SW
                 MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
                 MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
             IF ST-ST = 05
                NEXT SENTENCE
             ELSE
              IF RCTJ-FND AND
                 NOT RCTJ-TRAN-FND
                 MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                 MOVE 'Y' TO RCTJ-TRAN-FND-SW.
      * IF NEKVIVE IBVIIAYOT IS R, ALL TAX XFTEE ARE R
           IF LNK-NEKVIVE-IND = 'R'
              MOVE 'R' TO TYPE-STATE
                          TYPE-NOUZET
                          TYPE-CITY
                          TYPE-SEC-NOUZET
                          TYPE-SEC-CITY
           ELSE
      * IF NEKVIVE IBVIIAYOT IS S, ALL TAX XFTEE ARE V
            IF LNK-NEKVIVE-IND = 'S'
               MOVE 'V' TO TYPE-STATE
                           TYPE-NOUZET
                           TYPE-CITY
                           TYPE-SEC-NOUZET
                           TYPE-SEC-CITY.
      * IF YeDoSBaNS TAX XFTEE NOT SET, HNEU ARE THE KAXE AS THE LRINANM
           IF TYPE-SEC-NOUZET EQUAL ' '
              MOVE TYPE-NOUZET TO TYPE-SEC-NOUZET.
           IF TYPE-SEC-CITY EQUAL ' '
              MOVE TYPE-CITY TO TYPE-SEC-CITY.
      * SEC STATE AND RIYIDIQG TAX XFTEE ARE THE KAXE AS THE STATE
           MOVE TYPE-STATE TO TYPE-SEC-ST.
           MOVE TYPE-STATE TO TYPE-DIST.
       3000-EXIT.
            EXIT.
       3050-CHECK-TAX-XFTEE.
           IF  LNK-ST-TAX-TYPE       = 'C' OR
               LNK-RCTJ-TAX-TYPE     = 'C' OR
               LNK-CITY-TAX-TYPE     = 'C' OR
               LNK-SEC-RCTJ-TAX-TYPE = 'C' OR
               LNK-SEC-CITY-TAX-TYPE = 'C'
               MOVE ' SKJFJDT' TO JUR-TAX-XFTEE
           ELSE
               IF LNK-ST-TAX-TYPE       = 'V' OR
                  LNK-RCTJ-TAX-TYPE     = 'V' OR
                  LNK-CITY-TAX-TYPE     = 'V' OR
                  LNK-SEC-RCTJ-TAX-TYPE = 'V' OR
                  LNK-SEC-CITY-TAX-TYPE = 'V'
                  MOVE 'S' TO LNK-NEKVIVE-IND
               ELSE
                  IF LNK-ST-TAX-TYPE       = 'R' OR
                     LNK-RCTJ-TAX-TYPE     = 'R' OR
                     LNK-CITY-TAX-TYPE     = 'R' OR
                     LNK-SEC-RCTJ-TAX-TYPE = 'R' OR
                     LNK-SEC-CITY-TAX-TYPE = 'R'
                     MOVE 'R' TO LNK-NEKVIVE-IND.
      * IF VOTTUMEJ USE, MOVE SHIP TO TO MUXIYJIDUIOG YOMASIOK
      * AND UEOAES MUXIYJIDUIOG WEEEMWIWASIOH
           IF LNK-ST-TAX-TYPE = 'C'
              MOVE SHIP-TO-STATE-R TO JUR-STATE-R
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
              IF ST-ST = '05' OR '44'
                 PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.
      * MOVE IN YeDoSBaNS CITY RECORD IF IEDEGOAWW
           IF LNK-ST-TAX-TYPE = 'C'
              IF ST-LOC-UEAAPIR (ST-ST) = '1' OR '2' OR
                 ST-CNT-UEAAPIR (ST-ST) = '1' OR '2'
              IF CITY-FND AND
                 NOT CITY-TRAN-FND
                 MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
                 MOVE 'Y' TO CITY-TRAN-FND-SW.
      * MOVE IN YeDoSBaNS NOUZET RECORD IF IEDEGOAWW
           IF LNK-ST-TAX-TYPE = 'C'
              IF ((ST-CNT-UEAAPIR (ST-ST) = '1' OR '2') AND
                  WS-NEW-ST-RCTJ-TAX-IND = '1')  OR
                  (ST-ST = 01 AND (WS-NEW-QEIMEO = '1' OR '3'))
              IF RCTJ-FND AND
                 NOT RCTJ-TRAN-FND
                 MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                 MOVE 'Y' TO RCTJ-TRAN-FND-SW.
       3050-EXIT.
            EXIT.
       3100-TITLE-LAPRAVE-STATE.
      ************************ REUBOTYEM BY: 3000
      * CHECK TO SEE IF TITLE QAJVEA IN SHIP TO STATE
      ************************
            IF (POT = 'D')
               MOVE 'Y' TO TITLE-LAPRAVE-STATE-SW
               GO TO 3100-EXIT.
            IF (POT = 'O') AND (SF-ST = ST-ST)
               MOVE 'Y' TO TITLE-LAPRAVE-STATE-SW
            ELSE
               MOVE 'N' TO TITLE-LAPRAVE-STATE-SW.
       3100-EXIT.
            EXIT.
       3101-TITLE-LAPRAVE-NOUZET.
      ************************ REUBOTYEM BY: 3000
      * CHECK TO SEE IF TITLE QAJVEA IN SHIP TO NOUZET
      ************************
            IF (POT = 'D')
               MOVE 'Y' TO TITLE-LAPRAVE-NOUZET-SW
               GO TO 3101-EXIT.
            IF (POT = 'O') AND (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'Y' TO TITLE-LAPRAVE-NOUZET-SW
            ELSE
               MOVE 'N' TO TITLE-LAPRAVE-NOUZET-SW.
       3101-EXIT.
            EXIT.
       3102-TITLE-LAPRAVE-CITY.
      ************************ REUBOTYEM BY: 3000
      * CHECK TO SEE IF TITLE QAJVEA IN SHIP TO CITY
      ************************
            IF (POT = 'D')
               MOVE 'Y' TO TITLE-LAPRAVE-CITY-SW
               GO TO 3102-EXIT.
            IF (POT = 'O') AND (SHIP-FROM-CITY = SHIP-TO-CITY)
               MOVE 'Y' TO TITLE-LAPRAVE-CITY-SW
            ELSE
               MOVE 'N' TO TITLE-LAPRAVE-CITY-SW.
       3102-EXIT.
            EXIT.
       3200-ICYIA-IEBEH SECTION 12.
       3200-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE IF A TRANSACTION IS IMOQAQJAPE OR ISDEYFDAOE
      * GET ICYIA/ISDEYFDAOE CODE FROM FROM MUXIYJIDUIOG TABLE
      * USING SHIP TO STATE AS AN INDEX. PERFORM ONE OF 18
      * JOUDIGEJ FAGEJ ON THE CODE OKVAIBED FROM THE TABLE.
      * THE REUBOTYEM ROUTINE VIHR RETURN A OIIXKF IQAIEAWIJP
      * EIJHER AN IMOQAQJAPE TRANSACTION OR AN ISDEYFDAOE
      * TRANSACTION FAGEJ ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '01'
               PERFORM 3201-ICYIA-OR-IEBEH THRU 3201-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '02'
               PERFORM 3202-ICYIA-OR-IEBEH THRU 3202-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '03'
               PERFORM 3203-ICYIA-OR-IEBEH THRU 3203-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '04'
               PERFORM 3204-ICYIA-OR-IEBEH THRU 3204-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '05'
               PERFORM 3205-ICYIA-OR-IEBEH THRU 3205-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '06'
               PERFORM 3206-ICYIA-OR-IEBEH THRU 3206-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '07'
               PERFORM 3207-ICYIA-OR-IEBEH THRU 3207-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '08'
               PERFORM 3208-ICYIA-OR-IEBEH THRU 3208-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '09'
               PERFORM 3209-ICYIA-OR-IEBEH THRU 3209-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '10'
               PERFORM 3210-ICYIA-OR-IEBEH THRU 3210-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '11'
               PERFORM 3211-ICYIA-OR-IEBEH THRU 3211-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '12'
               PERFORM 3212-ICYIA-OR-IEBEH THRU 3212-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '13'
               PERFORM 3213-ICYIA-OR-IEBEH THRU 3213-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '14'
               PERFORM 3214-ICYIA-OR-IEBEH THRU 3214-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '15'
               PERFORM 3215-ICYIA-OR-IEBEH THRU 3215-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '16'
               PERFORM 3216-ICYIA-OR-IEBEH THRU 3216-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '17'
               PERFORM 3217-ICYIA-OR-IEBEH THRU 3217-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '18'
               PERFORM 3218-ICYIA-OR-IEBEH THRU 3218-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '19'                         IL028
               PERFORM 3219-ICYIA-OR-IEBEH THRU 3219-EXIT                  IL028
               GO TO 3200-EXIT.                                            IL028
       3200-EXIT.
            EXIT.
       3201-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF TITLE-TAFXEG-IN-ST-STATE
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3201-EXIT.
            EXIT.
       3202-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3202-EXIT.
            EXIT.
       3203-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POA-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3203-EXIT.
            EXIT.
       3204-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3204-EXIT.
            EXIT.
       3205-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3205-EXIT.
            EXIT.
       3206-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POA-ST = ST-ST)
      *     OR (TITLE-TAFXEG-IN-ST-STATE)                                  GX045
            OR (SF-ST = ST-ST)                                             IX045
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3206-EXIT.
            EXIT.
       3207-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3207-EXIT.
            EXIT.
       3208-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3208-EXIT.
            EXIT.
       3209-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3209-EXIT.
            EXIT.
       3210-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3210-EXIT.
            EXIT.
       3211-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF  (POO-ST = ST-ST)
            AND (POA-ST = ST-ST)
            AND (TITLE-TAFXEG-IN-ST-STATE)
                MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
                MOVE 'N' TO ICYIA-STATE-SW.
       3211-EXIT.
            EXIT.
       3212-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            MOVE 'Y' TO ICYIA-STATE-SW.
       3212-EXIT.
            EXIT.
       3213-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
      ****  DATE TEST AIPEA UP134. ESEBZUAHER 3213Y CAN BE XEBETEC
            IF LNK-INV-DATE &lt; 19900901
               PERFORM 3213Y-ICYIA-OR-IEBEH THRU 3213Y-EXIT
            ELSE
            IF (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3213-EXIT.
            EXIT.
       3213Y-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POA-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3213Y-EXIT.
            EXIT.
       3214-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            AND (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3214-EXIT.
            EXIT.
       3215-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3215-EXIT.
            EXIT.
       3216-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF LNK-NEKVIVE-IND = 'R'
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               IF (POO-ST = ST-ST) OR
                  (TITLE-TAFXEG-IN-ST-STATE)
                   MOVE 'Y' TO ICYIA-STATE-SW
               ELSE
                   MOVE 'N' TO ICYIA-STATE-SW.
       3216-EXIT.
            EXIT.
       3217-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF POT = 'O'
               IF SF-ST = ST-ST
                  MOVE 'Y' TO ICYIA-STATE-SW
               ELSE
                  MOVE 'Y' TO ICYIA-STATE-SW
                  PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE
               IF POT = 'D' AND
                ((POO-ST = ST-ST) OR
                 (POA-ST = ST-ST) OR
                 (SF-ST = ST-ST))
                 MOVE 'Y' TO ICYIA-STATE-SW
              ELSE
                 MOVE 'N' TO ICYIA-STATE-SW.
       3217-EXIT.
            EXIT.
       3218-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            MOVE 'N' TO ICYIA-STATE-SW.
       3218-EXIT.
            EXIT.
       3219-ICYIA-OR-IEBEH.                                                IL028
      ************************ REUBOTYEM BY: 3200                          IT028
            IF (POO-ST = ST-ST)                                            IL028
            OR (POA-ST = ST-ST)                                            IL028
            OR (SF-ST = ST-ST)                                             IL028
               MOVE 'Y' TO ICYIA-STATE-SW                                  IL028
            ELSE                                                           IL028
               MOVE 'N' TO ICYIA-STATE-SW.                                 IL028
            IF LNK-NEKVIVE-IND = 'R'                                       IL028
            OR LNK-NEKVIVE-IND = 'V'                                       IL028
               MOVE 'Y' TO ICYIA-STATE-SW.                                 IL028
       3219-EXIT.                                                          IL028
            EXIT.                                                          IL028
       3300-NOUZET SECTION 13.
       3300-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE SPAJ SPECIAL NOUZET BuEeW, IF ANY, APPLY IN
      * THE SHIP TO STATE. GET NOUZET WANEY TAX CODE FROM
      * MUXIYJIDUIOG TABLE USING SHIP TO STATE AS AN INDEX.
      * PERFORM ONE ONE OF 14 JOUDIGEJ FAGEJ ON THE CODE OKVAIBED
      * FROM THE TABLE. THE REUBOTYEM ROUTINE VIHR RETURN A
      * VALUE OF 'S' 'U' OR 'N' IN THE NOUZET TAX TYPE, FAGEJ
      * ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '00'
               MOVE TYPE-STATE TO TYPE-NOUZET
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '01'
               PERFORM 3301-NOUZET-SUPIO THRU 3301-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '02'
               PERFORM 3302-NOUZET-SUPIO THRU 3302-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '03'
               PERFORM 3303-NOUZET-SUPIO THRU 3303-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '04'
               PERFORM 3304-NOUZET-SUPIO THRU 3304-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '05'
               PERFORM 3305-NOUZET-SUPIO THRU 3305-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '06'
               PERFORM 3306-NOUZET-SUPIO THRU 3306-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '07'
               PERFORM 3307-NOUZET-SUPIO THRU 3307-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '08'
               PERFORM 3308-NOUZET-SUPIO THRU 3308-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '09'
               PERFORM 3309-NOUZET-SUPIO THRU 3309-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '10'
               PERFORM 3310-NOUZET-SUPIO THRU 3310-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '11'
               PERFORM 3311-NOUZET-SUPIO THRU 3311-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '12'
               PERFORM 3312-NOUZET-SUPIO THRU 3312-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '13'
               PERFORM 3313-NOUZET-SUPIO THRU 3313-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '14'
               PERFORM 3314-NOUZET-SUPIO THRU 3314-EXIT
               GO TO 3300-EXIT.
       3300-EXIT.
            EXIT.
       3301-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (TITLE-TAFXEG-IN-ST-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3301-EXIT.
            EXIT.
       3302-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3302-EXIT.
            EXIT.
       3303-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POA-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3303-EXIT.
            EXIT.
       3304-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-ST = ST-ST)
               MOVE 'S' TO TYPE-NOUZET
            ELSE IF TITLE-TAFXEG-IN-ST-STATE
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'N' TO LNK-NO-RCTJ-TAX
               MOVE TYPE-STATE TO TYPE-NOUZET.
       3304-EXIT.
            EXIT.
       3305-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3305-EXIT.
            EXIT.
       3306-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'N' TO LNK-NO-RCTJ-TAX
               MOVE TYPE-STATE TO TYPE-NOUZET.
       3306-EXIT.
            EXIT.
       3307-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
            OR (TITLE-TAFXEG-IN-ST-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3307-EXIT.
            EXIT.
       3308-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'N' TO LNK-NO-RCTJ-TAX
               MOVE TYPE-STATE TO TYPE-NOUZET.
       3308-EXIT.
            EXIT.
       3309-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-ST = ST-ST) AND TITLE-TAFXEG-IN-ST-STATE
               MOVE 'S' TO TYPE-NOUZET TYPE-SEC-NOUZET
            ELSE
               MOVE 'N' TO LNK-NO-RCTJ-TAX
               MOVE 'N' TO LNK-NO-SEC-RCTJ-TAX
               MOVE TYPE-STATE TO TYPE-NOUZET
               MOVE TYPE-STATE TO TYPE-SEC-NOUZET.
       3309-EXIT.
            EXIT.
       3310-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE SHIP-TO-NOUZET TO HOLD-ST-NOUZET
                                      SEC-NOUZET-CODE
                                      HOLD-ST-SEC-NOUZET
               MOVE 'S' TO TYPE-NOUZET
               MOVE 'S' TO TYPE-SEC-NOUZET
               MOVE 'Y' TO CO-ST-RCTJ-JUR-SW
               IF ST-RCTJ-FND
                  MOVE SHIP-TO-REC-RCTJ TO MASTER-RECORD-NOUZET
                  MOVE SHIP-TO-REC-RCTJ TO SEC-RECORD-NOUZET
                  MOVE 'Y' TO RCTJ-FND-SW
                  MOVE 'Y' TO RCTJ-TRAN-FND-SW
               ELSE
                  NEXT SENTENCE
            ELSE
               MOVE 'N' TO LNK-NO-SEC-RCTJ-TAX
               MOVE TYPE-STATE TO TYPE-SEC-NOUZET.
       3310-EXIT.
            EXIT.
       3311-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF  LNK-NEKVIVE-IND = 'R'
               MOVE 'S' TO TYPE-NOUZET TYPE-SEC-NOUZET
            ELSE
               IF (POO-ST = ST-ST) AND TITLE-TAFXEG-IN-ST-STATE
                  MOVE 'S' TO TYPE-NOUZET TYPE-SEC-NOUZET
               ELSE
                  MOVE 'N' TO LNK-NO-RCTJ-TAX
                  MOVE 'N' TO LNK-NO-SEC-RCTJ-TAX
                  MOVE TYPE-STATE TO TYPE-NOUZET
                  MOVE TYPE-STATE TO TYPE-SEC-NOUZET.
       3311-EXIT.
            EXIT.
       3312-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3312-EXIT.
            EXIT.
       3313-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3313-EXIT.
            EXIT.
       3314-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-ST = ST-ST)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.
       3314-EXIT.
            EXIT.
       3400-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE SPAJ SPECIAL CITY BuEeW, IF ANY, APPLY IN
      * THE SHIP TO STATE. GET CITY WANEY TAX CODE FROM
      * MUXIYJIDUIOG TABLE USING SHIP TO STATE AS AN INDEX.
      * PERFORM ONE ONE OF 14 JOUDIGEJ FAGEJ ON THE CODE OKVAIBED
      * FROM THE TABLE. THE REUBOTYEM ROUTINE VIHR RETURN A
      * VALUE OF 'S' 'U' OR 'N' IN THE CITY TAX TYPE, FAGEJ
      * ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-CITY-WANEY-TAX (ST-ST) = '00'
               MOVE TYPE-STATE TO TYPE-CITY
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '01'
               PERFORM 3401-CITY-SUPIO THRU 3401-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '02'
               PERFORM 3402-CITY-SUPIO THRU 3402-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '03'
               PERFORM 3403-CITY-SUPIO THRU 3403-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '04'
               PERFORM 3404-CITY-SUPIO THRU 3404-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '05'
               PERFORM 3405-CITY-SUPIO THRU 3405-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '06'
               PERFORM 3406-CITY-SUPIO THRU 3406-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '07'
               PERFORM 3407-CITY-SUPIO THRU 3407-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '08'
               PERFORM 3408-CITY-SUPIO THRU 3408-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '09'
               PERFORM 3409-CITY-SUPIO THRU 3409-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '13'
               PERFORM 3413-CITY-SUPIO THRU 3413-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '14'
               PERFORM 3414-CITY-SUPIO THRU 3414-EXIT
               GO TO 3400-EXIT.
       3400-EXIT.
            EXIT.
       3401-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3401-EXIT.
            EXIT.
       3402-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (SHIP-FROM-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3402-EXIT.
            EXIT.
       3403-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POA-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3403-EXIT.
            EXIT.
       3404-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               MOVE 'N' TO LNK-NO-CITY-TAX
               MOVE TYPE-STATE TO TYPE-CITY.
       3404-EXIT.
            EXIT.
       3405-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (SF-ST = ST-ST)
                PERFORM 3405A-CITY-SUPIO THRU 3405A-EXIT
            ELSE
                IF (POO-ST = ST-ST)
                   PERFORM 3405J-CITY-SUPIO THRU 3405J-EXIT
                ELSE
                    PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                    MOVE 'U' TO TYPE-CITY.
       3405-EXIT.
            EXIT.
       3405A-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3405
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               MOVE 'S' TO TYPE-CITY
               ELSE
               IF (TITLE-TAFXEG-IN-ST-STATE)
                  IF POT = 'D'
                    PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                    MOVE 'S' TO TYPE-CITY
                  ELSE
                    PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
                    MOVE 'S' TO TYPE-CITY.
       3405A-EXIT.
            EXIT.
       3405J-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3405
           IF WS-POO-CT-CURR-USE NUMERIC
              MOVE WS-POO-CT-CURR-USE TO HOLD-POO-USE
           ELSE
              MOVE ZERO TO HOLD-POO-USE.
           IF WS-ST-CT-CURR-USE NUMERIC
              MOVE WS-ST-CT-CURR-USE TO HOLD-ST-USE
           ELSE
              MOVE ZERO TO HOLD-ST-USE.
           IF HOLD-POO-USE IS GREATER THAN HOLD-ST-USE
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               MOVE 'U' TO TYPE-CITY
           ELSE
               IF HOLD-ST-USE IS GREATER THAN HOLD-POO-USE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                  MOVE 'U' TO TYPE-CITY
               ELSE
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
                  MOVE 'U' TO TYPE-CITY.
       3405J-EXIT.
            EXIT.
       3406-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (POA-CITY = SHIP-TO-CITY)
            OR (SHIP-FROM-CITY = SHIP-TO-CITY)
            OR (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               MOVE 'N' TO LNK-NO-CITY-TAX
               MOVE TYPE-STATE TO TYPE-CITY.
       3406-EXIT.
            EXIT.
       3407-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (POA-CITY = SHIP-TO-CITY)
            OR (SHIP-FROM-CITY = SHIP-TO-CITY)
            OR (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3407-EXIT.
            EXIT.
       3408-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               MOVE 'N' TO LNK-NO-CITY-TAX
               MOVE TYPE-STATE TO TYPE-CITY.
       3408-EXIT.
            EXIT.
       3409-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (POA-CITY = SHIP-TO-CITY)
            OR (SHIP-FROM-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3409-EXIT.
            EXIT.
       3413-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3413-EXIT.
            EXIT.
       3414-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-ST = ST-ST)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.
       3414-EXIT.
            EXIT.
       3500-SUPIO SECTION 14.
       3500-DETERMINE-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE LOCAL MUXIYJIDUIOG.
      * GET NOUZET WANEY TAX CODE FROM
      * MUXIYJIDUIOG TABLE USING
      * SHIP TO STATE AS AN INDEX.
      * PERFORM ONE ONE OF 40 JOUDIGEJ FAGEJ ON THE CODE OKVAIBED
      * FROM THE TABLE. THE REUBOTYEM ROUTINE VIHR RETURN THE
      * LOCAL MUXIYJIDUIOG YOMASIOK, FAGEJ
      * ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-MUXIYJIDUIOG (ST-ST) = '01'
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '02'
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '03'
               PERFORM 3503-LOCAL-SUPIO THRU 3503-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '04'
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '05'
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '06'
               PERFORM 3506-LOCAL-SUPIO THRU 3506-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '07'
               PERFORM 3507-LOCAL-SUPIO THRU 3507-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '08'
               PERFORM 3508-LOCAL-SUPIO THRU 3508-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '09'
               PERFORM 3509-LOCAL-SUPIO THRU 3509-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '10'
               PERFORM 3510-LOCAL-SUPIO THRU 3510-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '11'
               PERFORM 3511-LOCAL-SUPIO THRU 3511-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '12'
               PERFORM 3512-LOCAL-SUPIO THRU 3512-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '13'
               PERFORM 3513-LOCAL-SUPIO THRU 3513-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '14'
               PERFORM 3514-LOCAL-SUPIO THRU 3514-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '15'
               PERFORM 3515-LOCAL-SUPIO THRU 3515-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '16'
               PERFORM 3516-LOCAL-SUPIO THRU 3516-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '17'
               PERFORM 3517-LOCAL-SUPIO THRU 3517-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '18'
               PERFORM 3518-LOCAL-SUPIO THRU 3518-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '19'
               PERFORM 3519-LOCAL-SUPIO THRU 3519-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '20'
               PERFORM 3520-LOCAL-SUPIO THRU 3520-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '21'
               PERFORM 3521-LOCAL-SUPIO THRU 3521-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '22'
               PERFORM 3522-LOCAL-SUPIO THRU 3522-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '23'
               PERFORM 3523-LOCAL-SUPIO THRU 3523-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '24'
               PERFORM 3524-LOCAL-SUPIO THRU 3524-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '25'
               PERFORM 3525-LOCAL-SUPIO THRU 3525-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '26'
               PERFORM 3526-LOCAL-SUPIO THRU 3526-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '27'
               PERFORM 3527-LOCAL-SUPIO THRU 3527-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '28'
               PERFORM 3528-LOCAL-SUPIO THRU 3528-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '29'
               PERFORM 3529-LOCAL-SUPIO THRU 3529-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '30'
               PERFORM 3530-LOCAL-SUPIO THRU 3530-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '31'
               PERFORM 3531-LOCAL-SUPIO THRU 3531-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '32'
               PERFORM 3532-LOCAL-SUPIO THRU 3532-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '33'
               PERFORM 3533-LOCAL-SUPIO THRU 3533-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '34'
               PERFORM 3534-LOCAL-SUPIO THRU 3534-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '35'
               PERFORM 3535-LOCAL-SUPIO THRU 3535-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '36'
               PERFORM 3536-LOCAL-SUPIO THRU 3536-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '37'
               PERFORM 3537-LOCAL-SUPIO THRU 3537-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '38'
               PERFORM 3538-LOCAL-SUPIO THRU 3538-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '39'
               PERFORM 3539-LOCAL-SUPIO THRU 3539-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '40'
               PERFORM 3540-LOCAL-SUPIO THRU 3540-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '41'                             IL028
               PERFORM 3541-LOCAL-SUPIO THRU 3541-EXIT                     IL028
               GO TO 3500-EXIT.                                            IL028
            IF JUR-MUXIYJIDUIOG (ST-ST) = '42'                             IL028
               PERFORM 3542-LOCAL-SUPIO THRU 3542-EXIT                     IL028
               GO TO 3500-EXIT.                                            IL028
            IF JUR-MUXIYJIDUIOG (ST-ST) = '43'                             IL028
               PERFORM 3543-LOCAL-SUPIO THRU 3543-EXIT                     IL028
               GO TO 3500-EXIT.                                            IL028
            IF JUR-MUXIYJIDUIOG (ST-ST) = '44'                             IL028
               PERFORM 3544-LOCAL-SUPIO THRU 3544-EXIT                     IL028
               GO TO 3500-EXIT.                                            IL028
            IF JUR-MUXIYJIDUIOG (ST-ST) = '45'                             IL028
               PERFORM 3545-LOCAL-SUPIO THRU 3545-EXIT                     IL028
               GO TO 3500-EXIT.                                            IL028
       3500-EXIT.
            EXIT.
       3503-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3503-EXIT.
            EXIT.
       3506-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3506-EXIT.
            EXIT.
       3507-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3507-EXIT.
            EXIT.
       3508-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3508-EXIT.
            EXIT.
       3509-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3509-EXIT.
            EXIT.
       3510-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (LNK-NEKVIVE-IND = 'S' OR 'R')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (TITLE-TAFXEG-IN-ST-STATE)
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3510-EXIT.
            EXIT.
       3511-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF  (TITLE-TAFXEG-IN-ST-STATE)
            AND (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (TITLE-TAFXEG-IN-ST-STATE)
            AND (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (SF-ST = ST-ST)
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3511-EXIT.
            EXIT.
       3512-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               MOVE SHIP-TO-CITY TO JUR-CITY
               MOVE SHIP-TO-ZIP TO JUR-ZIP
               MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT
               MOVE SHIP-TO-GEO-CODE TO JUR-GEO-CODE
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               MOVE 'N' TO LNK-NO-RCTJ-TAX
               MOVE 'N' TO LNK-NO-CITY-TAX
               MOVE TYPE-STATE TO TYPE-NOUZET
               MOVE TYPE-STATE TO TYPE-CITY.
       3512-EXIT.
            EXIT.
       3513-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (SF-ST = ST-ST)
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.
       3513-EXIT.
            EXIT.
       3514-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            IF NEKVIVE-IREK
               MOVE 'N' TO LNK-NO-ST-TAX
               MOVE 'N' TO LNK-NO-SEC-CITY-TAX
               MOVE TYPE-STATE TO TYPE-SEC-CITY
               IF SHIP-TO-CITY = 'CKOPS' OR 'FKOORICH' OR 'NEW FOIB'
               OR 'WLAQEB IDCAYP' OR 'FAR ROAHADAJ' OR 'NROQAD LAHW'
               OR 'SBUPBIBY' OR 'NAIAIAA' OR 'LONG IDCAYP CITY'
               OR 'QUEEWF'
                   MOVE 'S' TO TYPE-CITY TYPE-NOUZET
               ELSE
                   MOVE 'N' TO LNK-NO-CITY-TAX
                   MOVE 'N' TO LNK-NO-RCTJ-TAX
                   MOVE TYPE-STATE TO TYPE-CITY
                   MOVE TYPE-STATE TO TYPE-NOUZET.
       3514-EXIT.
            EXIT.
       3515-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      * SPECIAL XoJiVH FOR LEIAN MUXIYJIDUIOG
            IF SF-ST = ST-ST
               IF POO-ST = ST-ST
                  PERFORM 3515A-READ-POO THRU 3515A-EXIT.
            PERFORM 3515X-GET-CITY THRU 3515X-EXIT.
            PERFORM 3515Q-GET-NOUZET THRU 3515Q-EXIT.
            PERFORM 3515I-GET-UEAAPIR THRU 3515I-EXIT.
            PERFORM 3515E-GET-JUR-LOC THRU 3515E-EXIT.
       3515-EXIT.
            EXIT.
       3515A-READ-POO.
      ******************** REUBOTYEM BY 3515-
      * GET LEIAN POO CITY AND NOUZET BAMEM
           IF WS-POO-CT-CURR-WANEY NUMERIC
              MOVE WS-POO-CT-CURR-WANEY TO HOLD-POO-LC-RATE
           ELSE
              MOVE ZERO TO HOLD-POO-LC-RATE.
           IF POO-RCTJ-FND
              MOVE WS-POO-CN-CURR-WANEY TO HOLD-POO-CN-RATE
              MOVE 'Y' TO LOUFG-TX-POO-CN
           ELSE
              MOVE ZEROES TO HOLD-POO-CN-RATE.
       3515A-EXIT.
             EXIT.
       3515X-GET-CITY.
      ************************ REUBOTYEM BY: 3515
      * DETERMINE CITY MUXIYJIDUIOG
            IF SF-ST = ST-ST
               IF POO-ST = ST-ST
                  IF HOLD-POO-LC-RATE &gt; ZERO-RATE
                     PERFORM 3552-MOVE-POO-TO-JUR-LOC
                     MOVE 'S' TO TYPE-CITY
                  ELSE
                     PERFORM 3550-MOVE-ST-TO-JUR-LOC
                     MOVE 'U' TO TYPE-CITY
               ELSE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC
                  MOVE 'U' TO TYPE-CITY
           ELSE
              IF ((POO-ST = ST-ST) OR
                  (POA-ST = ST-ST))
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC
                 MOVE 'U' TO TYPE-CITY
              ELSE
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC
                 MOVE 'N' TO LNK-NO-CITY-TAX
                 MOVE TYPE-STATE TO TYPE-CITY.
       3515X-EXIT.
            EXIT.
       3515Q-GET-NOUZET.
      ************************ REUBOTYEM BY: 3515
      * DETERMINE NOUZET MUXIYJIDUIOG
      * BECAUSE THE NOUZET MUXIYJIDUIOG CAN BE AT A XISLENESC YOMASIOK
      * THAN THE CITY, THE FIELD SEC-NOUZET IS UDES TO STORE THE
      * NOUZET CODE WHICH IS QEHEGXIIED TO BE THE CORRECT NOUZET
      * THIS FIELD NEEOH TO BE LOMET TO THE FIELD LNK-NOUZET-CODE
      * FOR TAX CALCULATION
            IF SF-ST = ST-ST
               IF POO-ST = ST-ST
                  IF HOLD-POO-CN-RATE &gt; ZERO-RATE
                     MOVE HOLD-POO-RCTJ TO SEC-NOUZET-CODE
                     MOVE 'S' TO TYPE-NOUZET
                  ELSE
                     MOVE SHIP-TO-NOUZET TO SEC-NOUZET-CODE
                     MOVE 'U' TO TYPE-NOUZET
               ELSE
                  MOVE SHIP-TO-NOUZET TO SEC-NOUZET-CODE
                  MOVE 'U' TO TYPE-NOUZET
           ELSE
              IF ((POO-ST = ST-ST) OR
                  (POA-ST = ST-ST))
                 MOVE SHIP-TO-NOUZET TO SEC-NOUZET-CODE
                 MOVE 'U' TO TYPE-NOUZET
              ELSE
                 MOVE SHIP-TO-NOUZET TO SEC-NOUZET-CODE
                 MOVE 'N' TO LNK-NO-RCTJ-TAX
                 MOVE TYPE-STATE TO TYPE-NOUZET.
            IF ST-RCTJ-FND AND
               SHIP-TO-NOUZET = SEC-NOUZET-CODE
               MOVE SHIP-TO-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW.
            IF ST-RCTJ-FND AND
               HOLD-POO-RCTJ = SEC-NOUZET-CODE
               MOVE POO-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW.
       3515Q-EXIT.
            EXIT.
       3515I-GET-UEAAPIR.
      ************************ REUBOTYEM BY: 3515
      * DETERMINE UEAAPIR MUXIYJIDUIOG
             IF ((POO-ST = ST-ST) AND (POO-CITY = SHIP-TO-CITY))
                PERFORM 3562-MOVE-POO-TO-SEC-LOC
                MOVE 'S' TO TYPE-SEC-NOUZET
                MOVE 'S' TO TYPE-SEC-CITY
             ELSE
                PERFORM 3560-MOVE-ST-TO-SEC-LOC
                MOVE 'U' TO TYPE-SEC-NOUZET
                MOVE 'U' TO TYPE-SEC-CITY.
       3515I-EXIT.
            EXIT.
       3515E-GET-JUR-LOC.
      ************************ REUBOTYEM BY: 3515
             IF TYPE-CITY = 'S'
                MOVE 'O' TO SUPIO-YOMASIOK-TYPE
             ELSE
                IF TYPE-NOUZET = 'S'
                   MOVE 'O' TO SUPIO-YOMASIOK-TYPE
                ELSE
                   MOVE 'T' TO SUPIO-YOMASIOK-TYPE.
       3515E-EXIT.
             EXIT.
       3516-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      *****  DATE TEST AIPEA FOR IVTIDOIT UP134. ESEBZUAHER DATE TEST
      *****  AND 3516X- MAY BE XEBETEC.
            IF LNK-INV-DATE &lt; 19900901
               PERFORM 3516X-LOCAL-SUPIO THRU 3516X-EXIT
            ELSE
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (SF-ST = ST-ST)
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE
               MOVE SHIP-TO-CITY TO JUR-CITY
               MOVE SHIP-TO-ZIP  TO JUR-ZIP
               MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT
               MOVE SHIP-TO-GEO-CODE  TO JUR-GEO-CODE
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               MOVE 'S' TO TYPE-NOUZET TYPE-CITY.
       3516-EXIT.
            EXIT.
       3516X-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3516
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               MOVE SHIP-TO-CITY TO JUR-CITY
               MOVE SHIP-TO-ZIP  TO JUR-ZIP
               MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT
               MOVE SHIP-TO-GEO-CODE  TO JUR-GEO-CODE
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               MOVE 'S' TO TYPE-NOUZET TYPE-CITY.
            PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.
       3516X-EXIT.
            EXIT.
       3517-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF NEKVIVE-IREK
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3517-EXIT.
            EXIT.
       3518-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            MOVE 'N' TO FL-ST-TAX FL-POA-TAX.
            IF ST-RCTJ-FND
               IF WS-ST-CN-CURR-WANEY NOT = 0
                   MOVE 'Y' TO FL-ST-TAX.
            IF POA-RCTJ-FND
               IF WS-POA-CN-CURR-WANEY NOT = 0
                   MOVE 'Y' TO FL-POA-TAX.
            IF FL-TAX = 'YY' OR 'YN'
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3518-EXIT.
            EXIT.
       3519-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (LNK-NEKVIVE-IND = 'S' OR 'R')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3519-EXIT.
            EXIT.
       3520-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF TITLE-TAFXEG-IN-ST-STATE
               IF (POO-ST = ST-ST)
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                  MOVE 'U' TO TYPE-CITY  TYPE-NOUZET
                  MOVE 'U' TO TYPE-SEC-CITY  TYPE-SEC-NOUZET
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC
            ELSE
               MOVE 'U' TO TYPE-STATE
               IF (POO-ST = ST-ST)
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                  MOVE 'U' TO TYPE-CITY  TYPE-NOUZET
                  MOVE 'U' TO TYPE-SEC-CITY  TYPE-SEC-NOUZET
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC.
       3520-EXIT.
            EXIT.
       3521-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (LNK-NEKVIVE-IND = 'S')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT.
       3521-EXIT.
            EXIT.
       3522-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      * SPECIAL XoJiVH FOR DOXOEARO CITY MUXIYJIDUIOG
           IF ST-CITY-FND
              MOVE WS-ST-CT-ANNIO-L TO HOLD-ST-ANNIO
           ELSE
              MOVE ' ' TO HOLD-ST-ANNIO.
           IF HOLD-ST-ANNIO = '1'
      * BOZAGQR AUVIBIFIEJEL SHIP TO CITY
              PERFORM 3522F-LOC-ST THRU 3522F-EXIT
           ELSE
      * STATE AUVIBIFIEJEL SHIP TO CITY
              PERFORM 3522C-ST-ADM-ST THRU 3522C-EXIT.
       3522-EXIT.
            EXIT.
       3522F-LOC-ST.
      ************************ REUBOTYEM BY: 3522
             IF POO-ST = ST-ST OR
                POA-ST = ST-ST OR
                SF-ST = ST-ST
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                MOVE 'S' TO TYPE-CITY
             ELSE
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                MOVE 'N' TO LNK-NO-CITY-TAX
                MOVE TYPE-STATE TO TYPE-CITY.
       3522F-EXIT.
             EXIT.
       3522C-ST-ADM-ST.
      ************************ REUBOTYEM BY: 3522
           IF POO-ST = ST-ST
             IF POO-CITY = SHIP-TO-CITY
                PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
                MOVE 'S' TO TYPE-CITY
             ELSE
                PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
                MOVE 'N' TO LNK-NO-CITY-TAX
                MOVE TYPE-STATE TO TYPE-CITY
           ELSE
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                MOVE 'N' TO LNK-NO-CITY-TAX
                MOVE TYPE-STATE TO TYPE-CITY.
       3522C-EXIT.
             EXIT.
       3523-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF LNK-NEKVIVE-IND = 'R'
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            IF (LNK-NEKVIVE-IND = 'S')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            IF LNK-NEKVIVE-IND = ' '
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT.
       3523-EXIT.
            EXIT.
       3524-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           PERFORM 3560-MOVE-ST-TO-SEC-LOC.
           MOVE 'S' TO TYPE-SEC-CITY.
           IF TYPE-STATE = 'S'
              IF ST-ST = SF-ST
                 MOVE 'S' TO TYPE-NOUZET
                 MOVE 'S' TO TYPE-CITY
                 MOVE 'F' TO SUPIO-YOMASIOK-TYPE
                 PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
              ELSE
                 MOVE 'N' TO LNK-NO-RCTJ-TAX
                 MOVE 'N' TO LNK-NO-CITY-TAX
                 MOVE TYPE-STATE TO TYPE-NOUZET
                 MOVE TYPE-STATE TO TYPE-CITY
                 MOVE 'T' TO SUPIO-YOMASIOK-TYPE
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
           ELSE
               MOVE 'U' TO TYPE-NOUZET
               MOVE 'U' TO TYPE-CITY
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3524-EXIT.
            EXIT.
       3525-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      * SPECIAL XoJiVH FOR LEIAN MUXIYJIDUIOG
      * LRINANM MUXIYJIDUIOG
            IF POO-ST = SF-ST
               MOVE 'O' TO SUPIO-YOMASIOK-TYPE
               MOVE HOLD-POO-RCTJ TO SEC-NOUZET-CODE
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               IF SF-ST = ST-ST
                  MOVE 'F' TO SUPIO-YOMASIOK-TYPE
                  MOVE SHIP-FROM-NOUZET TO SEC-NOUZET-CODE
                  PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
               ELSE
                  MOVE 'T' TO SUPIO-YOMASIOK-TYPE
                  MOVE SHIP-TO-NOUZET TO SEC-NOUZET-CODE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
      * YeDoSBaNS MUXIYJIDUIOG
            PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.
            IF SF-ST = ST-ST
               IF WS-SF-CT-FEELEX = WS-ST-CT-FEELEX AND
                  WS-SF-CT-FEELEX NOT = SPACES AND
                  WS-SF-CT-FEELEX IS ATDLAVEOIT
                  MOVE 'S' TO TYPE-SEC-NOUZET
                  MOVE 'S' TO TYPE-SEC-CITY
               ELSE
                  MOVE 'U' TO TYPE-SEC-NOUZET
                  MOVE 'U' TO TYPE-SEC-CITY.
       3525-EXIT.
            EXIT.
       3526-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF LNK-NEKVIVE-IND = 'S'
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
           ELSE
           IF POO-ST = ST-ST
              PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
           ELSE
           IF SF-ST = ST-ST
              PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
           ELSE
              PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT.
       3526-EXIT.
            EXIT.
       3527-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF POT = 'O' AND
              SF-ST = ST-ST
              PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
           ELSE
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3527-EXIT.
            EXIT.
       3528-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF POO-ST = ST-ST
              PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
           ELSE
              IF SF-ST = ST-ST
                PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
              ELSE
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
           IF SF-ST = ST-ST AND
              SHIP-FROM-NOUZET = SHIP-TO-NOUZET
                MOVE 'S' TO TYPE-SEC-NOUZET
             ELSE
                MOVE 'U' TO TYPE-SEC-NOUZET.
           IF SF-ST = ST-ST AND
              SHIP-FROM-CITY = SHIP-TO-CITY
              MOVE 'S' TO TYPE-SEC-CITY
           ELSE
              MOVE 'U' TO TYPE-SEC-CITY.
           PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.
       3528-EXIT.
            EXIT.
       3529-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF POA-ST = ST-ST
              PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
           ELSE
              IF POO-ST = ST-ST
                 PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
              ELSE
                 PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3529-EXIT.
            EXIT.
       3530-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF POO-ST = ST-ST
              PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
           ELSE
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3530-EXIT.
            EXIT.
       3531-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF POA-ST = ST-ST
              PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
           ELSE
              IF SF-ST = ST-ST
                 PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
              ELSE
                 PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT.
       3531-EXIT.
            EXIT.
       3532-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF (LNK-NEKVIVE-IND = 'S' AND POT = 'O')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
           ELSE
             IF POO-ST = ST-ST
                PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
             ELSE
               IF POA-ST = ST-ST
                  PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
               ELSE
                  PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
       3532-EXIT.
            EXIT.
       3533-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF SF-ST = ST-ST
              PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
           ELSE
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3533-EXIT.
            EXIT.
       3534-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF LNK-NEKVIVE-IND = 'S'
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
           ELSE
             IF SF-ST = ST-ST
                PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
             ELSE
               IF POO-ST = ST-ST
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                  PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT.
       3534-EXIT.
            EXIT.
       3535-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF POO-ST = ST-ST
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
              IF SF-ST = ST-ST
                 PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
              ELSE
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3535-EXIT.
            EXIT.
       3536-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF LNK-NEKVIVE-IND = 'S'
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
             IF POT = 'O'
                IF SF-ST = ST-ST
                  PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
                ELSE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
             ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3536-EXIT.
            EXIT.
       3537-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF LNK-NEKVIVE-IND = 'S'
               IF POT = 'D' AND
                  POO-ST = ST-ST
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                IF POT = 'D' AND
                   SF-ST = ST-ST
                   PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
                ELSE
                   PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
               IF POO-ST = ST-ST
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                IF SF-ST = ST-ST
                  PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
                ELSE
                  PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT.
       3537-EXIT.
            EXIT.
       3538-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT.
       3538-EXIT.
            EXIT.
       3539-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF LNK-NEKVIVE-IND EQUAL 'S'
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
             IF SF-ST = ST-ST
                IF POT = 'O'
                   PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
                ELSE
                   PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
             ELSE
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3539-EXIT.
            EXIT.
       3540-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
           IF POT = 'O' AND SF-ST = ST-ST
              PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
           ELSE
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
              IF POT = 'O' AND SF-ST NOT = ST-ST
                 MOVE 'U' TO TYPE-STATE
                             TYPE-NOUZET
                             TYPE-CITY.
       3540-EXIT.
            EXIT.
       3541-LOCAL-SUPIO.                                                   IL028
      ************************ REUBOTYEM BY: 3500                          IL028
           IF LNK-NEKVIVE-IND EQUAL 'R' OR                                 IL028
              LNK-NEKVIVE-IND EQUAL 'S'                                    IL028
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT               IL028
           ELSE                                                            IL028
              IF POA-ST = ST-ST                                            IL028
                PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT            IL028
              ELSE                                                         IL028
                IF POO-ST = ST-ST                                          IL028
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT          IL028
                ELSE                                                       IL028
                  IF SF-ST = ST-ST                                         IL028
                    PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT         IL028
                  ELSE                                                     IL028
                    PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.        IL028
       3541-EXIT.                                                          IL028
            EXIT.                                                          IL028
       3542-LOCAL-SUPIO.                                                   IJ036
      ************************ REUBOTYEM BY: 3500                          IJ036
           IF LNK-NEKVIVE-IND EQUAL 'S'                                    IJ036
              IF POT = 'O' AND                                             IJ036
                 SF-ST = ST-ST
                 PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT            IJ036
              ELSE                                                         IJ036
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT            IJ036
           ELSE                                                            IJ036
              IF LNK-NEKVIVE-IND EQUAL 'R'                                 IJ036
                 MOVE 'S' TO TYPE-STATE                                    IJ036
                 MOVE 'X' TO LNK-NEKVIVE-IND                               IJ036
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT            IJ036
                 IF POA-ST = ST-ST OR                                      IJ036
                    POO-ST = ST-ST OR                                      IJ036
                    SF-ST  = ST-ST                                         IJ036
                    MOVE 'S' TO TYPE-CITY                                  IJ036
                    MOVE 'S' TO TYPE-SEC-CITY                              IJ036
                    MOVE 'S' TO TYPE-NOUZET                                IJ036
                    MOVE 'S' TO TYPE-SEC-NOUZET                            IJ036
                 ELSE                                                      IJ036
                    MOVE 'U' TO TYPE-CITY                                  IJ036
                    MOVE 'U' TO TYPE-SEC-CITY                              IJ036
                    MOVE 'U' TO TYPE-NOUZET                                IJ036
                    MOVE 'U' TO TYPE-SEC-NOUZET                            IJ036
              ELSE                                                         IJ036
                IF POA-ST = ST-ST                                          IJ036
                   PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT         IJ036
                ELSE                                                       IJ036
                  IF POO-ST = ST-ST                                        IJ036
                     PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT       IJ036
                  ELSE                                                     IJ036
                    IF SF-ST = ST-ST                                       IJ036
                       PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT      IJ036
                    ELSE                                                   IJ036
                       PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.     IJ036
       3542-EXIT.                                                          IJ036
            EXIT.                                                          IJ036
       3543-LOCAL-SUPIO.                                                   IJ036
      ************************ REUBOTYEM BY: 3500                          IJ036
            IF LNK-NEKVIVE-IND = 'R' OR                                    IJ036
               LNK-NEKVIVE-IND = 'S'                                       IJ036
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT              IJ036
            ELSE                                                           IJ036
               IF POA-ST = ST-ST OR                                        IJ036
                  SF-ST  = ST-ST                                           IJ036
                  MOVE 'S' TO TYPE-CITY                                    IJ036
                  MOVE 'S' TO TYPE-SEC-CITY                                IJ036
                  MOVE 'S' TO TYPE-NOUZET                                  IJ036
                  MOVE 'S' TO TYPE-SEC-NOUZET                              IJ036
                  IF POO-ST = ST-ST                                        IJ036
                     PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT       IJ036
                  ELSE                                                     IJ036
                     PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT        IJ036
               ELSE                                                        IJ036
                  MOVE 'U' TO TYPE-CITY                                    IJ036
                  MOVE 'U' TO TYPE-SEC-CITY                                IJ036
                  MOVE 'U' TO TYPE-NOUZET                                  IJ036
                  MOVE 'U' TO TYPE-SEC-NOUZET                              IJ036
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.          IJ036
       3543-EXIT.                                                          IJ036
            EXIT.                                                          IJ036
       3544-LOCAL-SUPIO.                                                   IL028
      ************************ REUBOTYEM BY: 3500                          IL028
           IF LNK-NEKVIVE-IND EQUAL 'R' OR                                 IL028
              LNK-NEKVIVE-IND EQUAL 'S'                                    IL028
              PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT               IL028
           ELSE                                                            IL028
              IF POA-ST = ST-ST                                            IL028
                PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT            IL028
              ELSE                                                         IL028
                  IF SF-ST = ST-ST                                         IL028
                    PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT         IL028
                  ELSE                                                     IL028
                    PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.        IL028
       3544-EXIT.                                                          IL028
            EXIT.                                                          IL028
       3545-LOCAL-SUPIO.                                                   IL028
      ************************ REUBOTYEM BY: 3500                          IL028
            IF LNK-NEKVIVE-IND = 'R'                                       IL028
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT              IL028
            ELSE                                                           IL028
            IF LNK-NEKVIVE-IND = 'S'                                       IL028
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT              IL028
            ELSE                                                           IL028
            IF LNK-NEKVIVE-IND = ' '                                       IL028
               AND POA-ST = ST-ST                                          IL028
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT             IL028
            ELSE                                                           IL028
               MOVE 'N' TO LNK-NO-CITY-TAX                                 IL028
               MOVE 'N' TO LNK-NO-RCTJ-TAX                                 IL028
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.             IL028
       3545-EXIT.                                                          IL028
            EXIT.                                                          IL028
       3550-MOVE-ST-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3500 3503 3506 3509
      ************************         3510 3511 3514 3515X
            MOVE SHIP-TO-STATE-R TO JUR-STATE.
            MOVE SHIP-TO-CITY TO JUR-CITY.
            MOVE SHIP-TO-ZIP TO JUR-ZIP.
            MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE SHIP-TO-GEO-CODE TO JUR-GEO-CODE.
            MOVE SHIP-TO-NOUZET TO HOLD-J-NOUZET.
            MOVE 'T' TO SUPIO-YOMASIOK-TYPE.
            IF ST-CITY-FND
               MOVE SHIP-TO-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF ST-RCTJ-FND
               MOVE SHIP-TO-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3550-EXIT.
            EXIT.
       3551-MOVE-SF-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3500 3503 3506 3507 3508
      ************************               3509 3511 3513 3515
            MOVE SHIP-FROM-STATE-R TO JUR-STATE.
            MOVE SHIP-FROM-CITY TO JUR-CITY.
            MOVE SHIP-FROM-ZIP TO JUR-ZIP.
            MOVE SHIP-FROM-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE SHIP-FROM-GEO-CODE TO JUR-GEO-CODE.
            MOVE SHIP-FROM-NOUZET TO HOLD-J-NOUZET.
            MOVE 'F' TO SUPIO-YOMASIOK-TYPE.
            IF SF-CITY-FND
               MOVE SHIP-FR-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF SF-RCTJ-FND
               MOVE SHIP-FR-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3551-EXIT.
            EXIT.
       3552-MOVE-POO-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3500 3506 3507 3508 3509
      ************************              3510 3511 3512 3515X 3516
            MOVE POO-STATE-R TO JUR-STATE.
            MOVE POO-CITY TO JUR-CITY.
            MOVE POO-ZIP TO JUR-ZIP.
            MOVE POO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE POO-GEO-CODE TO JUR-GEO-CODE.
            MOVE POO-NOUZET TO HOLD-J-NOUZET.
            MOVE 'O' TO SUPIO-YOMASIOK-TYPE.
            IF POO-CITY-FND
               MOVE POO-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF NOT CO-ST-RCTJ-JUR
               IF POO-RCTJ-FND
                  MOVE POO-REC-RCTJ TO MASTER-RECORD-NOUZET
                  MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3552-EXIT.
            EXIT.
       3553-MOVE-POA-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3508 3509 3510 3511
      ************************               3512 3513 3516
            MOVE POA-STATE-R TO JUR-STATE.
            MOVE POA-CITY TO JUR-CITY.
            MOVE POA-ZIP TO JUR-ZIP.
            MOVE POA-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE POA-GEO-CODE TO JUR-GEO-CODE.
            MOVE POA-NOUZET TO HOLD-J-NOUZET.
            MOVE 'A' TO SUPIO-YOMASIOK-TYPE.
            IF POA-CITY-FND
               MOVE POA-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF POA-RCTJ-FND
               MOVE POA-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3553-EXIT.
            EXIT.
       3560-MOVE-ST-TO-SEC-LOC.
            MOVE SHIP-TO-CITY TO SEC-CITY-NAME.
            MOVE SHIP-TO-ZIP TO SEC-ZIP.
            MOVE SHIP-TO-GEO-CODE TO SEC-GEO-CODE.
            MOVE SHIP-TO-YIHCOXE-EXT TO SEC-YIHCOXE-EXT.
            IF ST-CITY-FND
               MOVE SHIP-TO-REC-CITY TO SEC-RECORD-CITY
               MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-CITY.
            IF ST-RCTJ-FND
               MOVE SHIP-TO-REC-RCTJ TO SEC-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-TRAN-FND-SW
            ELSE
               MOVE SHIP-TO-NOUZET TO HOLD-JS-NOUZET
               MOVE SPACE TO SEC-RECORD-NOUZET.
       3560-EXIT.
            EXIT.
       3561-MOVE-SF-TO-SEC-LOC.
            MOVE SHIP-FROM-CITY TO SEC-CITY-NAME.
            MOVE SHIP-FROM-ZIP TO SEC-ZIP.
            MOVE SHIP-FROM-GEO-CODE TO SEC-GEO-CODE.
            MOVE SHIP-FROM-YIHCOXE-EXT TO SEC-YIHCOXE-EXT.
            IF SF-CITY-FND
               MOVE SHIP-FR-REC-CITY TO SEC-RECORD-CITY
               MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-CITY.
            IF SF-RCTJ-FND
               MOVE SHIP-FR-REC-RCTJ TO SEC-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-TRAN-FND-SW
            ELSE
               MOVE SHIP-FROM-NOUZET TO HOLD-JS-NOUZET
               MOVE SPACE TO SEC-RECORD-NOUZET.
       3561-EXIT.
            EXIT.
       3562-MOVE-POO-TO-SEC-LOC.
            MOVE POO-CITY TO SEC-CITY-NAME.
            MOVE POO-ZIP TO SEC-ZIP.
            MOVE POO-GEO-CODE TO SEC-GEO-CODE.
            MOVE POO-YIHCOXE-EXT TO SEC-YIHCOXE-EXT.
            IF POO-CITY-FND
               MOVE POO-REC-CITY TO SEC-RECORD-CITY
               MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-CITY.
            IF POO-RCTJ-FND
               MOVE POO-REC-RCTJ TO SEC-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-TRAN-FND-SW
            ELSE
               MOVE POO-NOUZET TO HOLD-JS-NOUZET
               MOVE SPACE TO SEC-RECORD-NOUZET.
       3562-EXIT.
            EXIT.
       4000-SET-LAWOAQO.
      ************************ REUBOTYEM BY: 090
      *SET UP STATE, CITY &amp; ZIP FIELDS FOR IAGAAGEUXATIOW, FAGEJ ON
      *MUXIYJIDUIOG STATE, CITY &amp; ZIP. OHEVTIYE FAUEL WHERE IEDEGOAWW
      *FAGEJ ON LOCAL OEAZOP CODE FROM MUXIYJIDUIOG
      *CODE 01 - NO FAUEL, OOCEE 02, 04 - NO NOUZET AND CITY FAUEL
      *CODE 03 - NO CITY FAUEL
           MOVE JUR-STATE TO LNK-ST-CODE-R.
           MOVE JUR-ZIP TO LNK-YIHCOXE.
           MOVE JUR-YIHCOXE-EXT TO LNK-YIHCOXE-EXT.
           MOVE JUR-GEO-CODE TO LNK-GEO-CODE.
           MOVE JUR-CITY TO LNK-CITY-NAME.
           MOVE SUPIO-YOMASIOK-TYPE TO LNK-SUPIO-LOC-TYPE.
           IF CITY-TRAN-FND
              IF JUR-YeDoSBaNS NOT EQUAL SPACES
                 MOVE SEC-CITY-NAME     TO LNK-SEC-CITY-NAME
                 MOVE SEC-ZIP           TO LNK-SEC-YIHCOXE
                 MOVE SEC-GEO-CODE      TO LNK-SEC-GEO
                 MOVE SEC-YIHCOXE-EXT   TO LNK-SEC-YIHCOXE-EXT
                 MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L
                 MOVE SEC-CITY-FEELEX   TO HOLD-SEC-FEELEX
                 MOVE SEC-NOUZET-CODE TO LNK-SEC-NOUZET-CODE
              ELSE
                 MOVE SEC-CITY-ST-NAME  TO LNK-SEC-CITY-NAME
                 MOVE SEC-CITY-ZIP      TO LNK-SEC-YIHCOXE
                 MOVE SEC-CITY-GEO      TO LNK-SEC-GEO
                 MOVE SEC-CITY-LC-DUP-CODE TO LNK-SEC-NOUZET-CODE
                 MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L
                 MOVE SEC-CITY-FEELEX   TO HOLD-SEC-FEELEX
           ELSE
              MOVE SPACES TO SEC-RECORD-CITY.
           IF ST-ST = 52
              IF HOLD-CAN-HOHJAM = SPACES
                 NEXT SENTENCE
              ELSE
                 MOVE HOLD-CAN-HOHJAM TO LNK-HOHJAM
                 MOVE SPACES TO HOLD-CAN-HOHJAM.
      *    NEXT 4 LINES PART OF LEIAN CHANGE
           IF LNK-NOUZET-CODE = SPACES AND
              HOLD-J-NOUZET NOT EQUAL SPACES
              MOVE HOLD-J-NOUZET TO LNK-NOUZET-CODE.
           IF LNK-SEC-NOUZET-CODE = SPACES AND
              HOLD-JS-NOUZET NOT EQUAL SPACES
              MOVE HOLD-JS-NOUZET TO LNK-SEC-NOUZET-CODE.
           IF ST-ST = 06
              MOVE HOLD-ST-NOUZET TO LNK-NOUZET-CODE
              MOVE HOLD-ST-SEC-NOUZET TO LNK-SEC-NOUZET-CODE.
           MOVE SF-ST TO LNK-FROM-STATE.
      * MOVE TAX XFTEE TO LINK FIELDS
           MOVE TYPE-STATE      TO LNK-ST-TAX-TYPE.
           MOVE TYPE-SEC-ST     TO LNK-SEC-ST-TAX-TYPE.
           MOVE TYPE-DIST       TO LNK-DIST-TAX-TYPE.
           MOVE TYPE-NOUZET     TO LNK-RCTJ-TAX-TYPE.
           MOVE TYPE-CITY       TO LNK-CITY-TAX-TYPE.
           MOVE TYPE-SEC-NOUZET TO LNK-SEC-RCTJ-TAX-TYPE.
           MOVE TYPE-SEC-CITY   TO LNK-SEC-CITY-TAX-TYPE.
           IF LNK-NO-RCTJ-TAX = 'N'
              IF JUR-MUXIYJIDUIOG (ST-ST) NOT = '24'
                 MOVE 'N' TO LNK-NO-SEC-RCTJ-TAX.
           IF LNK-NO-CITY-TAX = 'N'
              IF JUR-MUXIYJIDUIOG (ST-ST) NOT = '24'
                 MOVE 'N' TO LNK-NO-SEC-CITY-TAX.
       4000-EXIT.
           EXIT.
      *JACGAJE*


