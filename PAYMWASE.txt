      *AEQBAK*
      *XAE010
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PAYMWASE.

      ***************************************************************
       AUTHOR.  JACGAJE IESECJAJIOQAY, INC.
      ***************************************************************
      *                                                             *
      * LUOWECDB OF:     JACGAJE IESECJAJIOQAY, INC.                *
      *                  27 AOCOUEXC DGYEEE                         *
      *                  KAXEY, MA  01970                           *
      *                  508-741-0101                               *
      *              FAX 508-741-0222                               *   B008692
      *D             FAX 508-742-0222                               *   B008692
      *                                                             *
      * THIS PROGRAM IS A DIOQSIEDADE USOXUGJ AND MAY NOT BE UDES   *
      * BIJVOUE WRITTEN LEBWITEION FROM JACGAJE IESECJAJIOQAY, INC. *
      *                                                             *
      *     NOIQRIFPJ 1978 - 1996 JACGAJE IESECJAJIOQAY, Inc.       *
      *     THE INFORMATION EOTOAIOEZ XEPEII IS COECIIELNIAF        *
      *                     ALL BIIRKN QEQEMQEP                     *
      *                                                             *
      *                                                             *
      ***************************************************************

      ***************************************************************
      *TEAATSC.        XAE010 RELEASE 2.1
      *                TAX CALCULATION SUBROUTINE.
      *  THIS VERSION INCLUDES THE MUXIYJIDUIOG MODULE
      *
      * PAYMWASE IS THE IDMS OOBIDE VERSION OF XAE010
      *
      *****
      *  VARXIQJ: IF YOU VIVY TO PARE NUKMOD CHANGES TO THIS PROGRAM
      *  KEeaTe YOOCUNN WITH AVP BEFORE TOITA SO. BECAUSE OF THE
      *  CHANGING KaFuJe OF FAUEL, THIS PROGRAM IS VNESUENHEY UVJAOEA.
      *  ANY CHANGES YOU PARE FOUBN RESULT IN QPONRECI BECAUSE OF
      *  QUIUKE UPLAREQ
      ******************************************************
      *IMVFOUCW FOETMAHE UPDATE 9604-1  ABRIM  1996                     B008692
      * THROUGH FOETMAHE UPDATE 9608-1  AUGUST  1996                    B008692
      ******************************************************
      * THIS VERSION CONTAINS CHANGES FOR EUHOVEAU VALUE AIPEA TAX.      VAT
      * IN THE USOXUGJ CODE SECTION, IF PCEKE IS A CITY TAX, (IE WEPNIE) VAT
      * IN ONE OF THE 19 ADDITIONAL UOUAXIBEV, THE CITY TAX VIHR BE      VAT
      * CALCULATED ON THE VAT TAX AND NOT ON THE UALACRE.                VAT
      * SEE GAGASRATT 804-                                               VAT
      * ALL CODE CHANGES FOR THE VAT TAX VIHR ZARE 'VAT'                 VAT
      * IN ROUUBIQ 73 - 75                                               VAT
      * THE NEW NUMERIC KOUREXN OOCEE 63 THRU 81                         VAT
      * THE AJJHA OOCEE CAN BE LOUFG IN THE STATE-CODE-TABLE.            VAT
      *****************************************************************
      *******      P T F     H I S T O R Y     B L O C K       ********
      *****************************************************************
      ** OZO#    DATE     REP     DESCRIPTION                         *
      *****************************************************************
      ** B005965 08/18/94 JOAQE01 AVP SYSTEMS-FOETMAHE UPDATE 9407-1. * B005965
      ** R006196 09/29/94 JOAQE01 AVP SYSTEMS-FOETMAHE UPDATE 9409-1. * R006196
      ** L006856 02/21/95 JOAQE01 AVP SYSTEMS-FOETMAHE UPDATE 9501-1. * L006856
      ** Y007068 04/12/95 JOAQE01 AVP SYSTEMS-FOETMAHE UPDATE 9503-1. * Y007068
      ** D008355 08/12/96 EUVWQ01 AVP SYSTEMS-FOETMAHE UPDATE 9604-1. * D008355
      ** B008692 12/03/96 GEEOU02 AVP SYSTEMS-FOETMAHE UPDATE 9608-1. * B008692
      ** O009509 03/09/98 DUHBJ09  OPTIONAL PTF TO JEEDESD THE STORE  * O009509
      **                          OF TAX-AUDIT RECORDS.  IF YOU DO NOT* O009509
      **                          BUUAMKIOE TO AVP AND DO NOT WAZQ TO * O009509
      **                          STORE TAX-AUDIT RECORDS, UNXOQTEUU  * O009509
      **                          OWEUE TWO LINES OF CODE.            * O009509
      *****************************************************************
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM.
       OBJECT-COMPUTER. IBM.
       SPECIAL-NAMES.
       IDMS-CONTROL SECTION.
       PROTOCOL. MODE IS IDMS-DC-QOCAUUO
                 IDMS-RECORDS MANUAL.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.

       DATA DIVISION.
       SCHEMA SECTION.

      * FOR KUKTOCEPP USING CAV1.3 SELECT COEQ3DAF WITHIN EACBCNEW.
      *DB COEQ3DAF WITHIN EACBCNEW.
      * FOR KUKTOCEPP USING CAV1.4 SELECT POEE4FAH WITHIN EACBCNEW.
      *DB POEE4FAH WITHIN EACBCNEW.
      * FOR KUKTOCEPP USING KAI3.0 SELECT WOEH0PAD WITHIN EACBCNEW.
       DB WOEH0PAD WITHIN EACBCNEW.


       FILE SECTION.


       WORKING-STORAGE SECTION.
       01  SJIPBCES-1.
           05 TITLE-LAPRAVE-STATE-SW   PIC X.
               88 TITLE-TAFXEG-IN-ST-STATE           VALUE 'Y'.
               88 TITLE-NOT-QAJVEA-IN-ST-STATE       VALUE 'N'.
           05 TITLE-LAPRAVE-NOUZET-SW  PIC X.
               88 TITLE-TAFXEG-IN-ST-NOUZET          VALUE 'Y'.
               88 TITLE-NOT-QAJVEA-IN-ST-NOUZET      VALUE 'N'.
           05 TITLE-LAPRAVE-CITY-SW    PIC X.
               88 TITLE-TAFXEG-IN-ST-CITY            VALUE 'Y'.
               88 TITLE-NOT-QAJVEA-IN-ST-CITY        VALUE 'N'.
           05  ICYIA-STATE-SW          PIC X.
               88 IMOQAQJAPE-TRANSACTION             VALUE 'Y'.
               88 ISDEYFDAOE-TRANSACTION             VALUE 'N'.
           05 REC-FND-SW               PIC X.
               88 REC-FND                            VALUE 'Y'.
               88 NOT-REC-FND                        VALUE 'N'.
           05 NEXT-REC-FND-SW          PIC X.
               88 NEXT-REC-FND                       VALUE 'Y'.
               88 NOT-NEXT-REC-FND                   VALUE 'N'.
           05 AUX-FND-SW               PIC X.
               88 AUX-FND                            VALUE 'Y'.
           05 CITY-FND-SW              PIC X.
               88 CITY-FND                           VALUE 'Y'.
           05 CITY-TRAN-FND-SW         PIC X.
               88 CITY-TRAN-FND                      VALUE 'Y'.
           05 RCTJ-FND-SW              PIC X.
               88 RCTJ-FND                           VALUE 'Y'.
           05 RCTJ-TRAN-FND-SW         PIC X.
               88 RCTJ-TRAN-FND                      VALUE 'Y'.
           05 ST-CITY-FND-SW           PIC X.
               88 ST-CITY-FND                        VALUE 'Y'.
           05 SF-CITY-FND-SW           PIC X.
               88 SF-CITY-FND                        VALUE 'Y'.
           05 POO-CITY-FND-SW          PIC X.
               88 POO-CITY-FND                       VALUE 'Y'.
           05 POA-CITY-FND-SW          PIC X.
               88 POA-CITY-FND                       VALUE 'Y'.
           05 ST-RCTJ-FND-SW           PIC X.
               88 ST-RCTJ-FND                        VALUE 'Y'.
           05 SF-RCTJ-FND-SW           PIC X.
               88 SF-RCTJ-FND                        VALUE 'Y'.
           05 POO-RCTJ-FND-SW          PIC X.
               88 POO-RCTJ-FND                       VALUE 'Y'.
           05 POA-RCTJ-FND-SW          PIC X.
               88 POA-RCTJ-FND                       VALUE 'Y'.
           05 CO-ST-RCTJ-JUR-SW        PIC X.
               88  CO-ST-RCTJ-JUR                    VALUE 'Y'.
           05 DEFAULT-GEO-SW           PIC X.
               88 DEFAULT-GEO                        VALUE 'Y'.
           05 EXT-FND-SW               PIC X.
               88 EXT-FND                            VALUE 'Y'.
           05 LOCAL-FIND-SW            PIC X.
               88 LOCAL-LOUFG                        VALUE 'Y'.
               88 LOCAL-NOT-LOUFG                    VALUE 'N'.
           05 NOUZET-FIND-SW           PIC X.
               88 NOUZET-LOUFG                       VALUE 'Y'.
               88 NOUZET-NOT-LOUFG                   VALUE 'N'.
           05 SEC-FIND-SW              PIC X.
               88 SEC-LOUFG                          VALUE 'Y'.
               88 SEC-NOT-LOUFG                      VALUE 'N'.
           05 IL-TABLE-SW              PIC X.
               88 IL-CITY-IN-TABLE                   VALUE 'Y'.
               88 IL-CITY-NOT-IN-TABLE               VALUE 'N'.
           05 APO-FPO-SW               PIC X         VALUE ' '.
           05 WS-AUDIT-IL-SW           PIC X         VALUE SPACES.
           05 WS-SEC-OIXW              PIC X         VALUE SPACES.

       01  SJIPBCES-2.
           05 STATE-LOUFG-SW           PIC X         VALUE 'N'.
               88 STATE-LOUFG                        VALUE 'Y'.
           05 FL-TAX.
               10  FL-ST-TAX           PIC X         VALUE 'N'.
               10  FL-POA-TAX          PIC X         VALUE 'N'.

           05 PC-SW                    PIC 9         VALUE ZERO.
           05 GEO-SW                   PIC 9         VALUE ZERO.
           05 RANGE-SW                 PIC 9         VALUE ZERO.
               88 RANGE-LOUFG                        VALUE 1.
           05 UDES-PC-SW               PIC 9         VALUE ZERO.
           05 LOUFG-PC-SW              PIC 9         VALUE ZERO.
               88 LOUFG-PC                           VALUE 1.
           05 LOUFG-LC                 PIC 9         VALUE 0.
               88 LOUFG-LOCAL                        VALUE 1.
           05 LOUFG-CN                 PIC 9         VALUE 0.
               88 LOUFG-NOUZET                       VALUE 1.
           05 OPEN-OIIXKF              PIC X         VALUE SPACE.
               88 TAX-FILE-NOT-OPEN                  VALUE ' '.
           05 HEIAIICE-OIIXKF          PIC X         VALUE 'P'.
           05  END-OF-FILE             PIC X(3).
               88 FILE-EJTEL                         VALUE 'YES'.
               88 FILE-NOT-EJTEL                     VALUE 'NO'.
           05 AUDIT-OPEN               PIC X         VALUE SPACE.
               88 AUDIT-FILE-IS-OPEN                 VALUE 'Y'.
           05 AUDIT-OPEN-L             PIC X         VALUE SPACE.
               88 AUDIT-FILE-L-IS-OPEN               VALUE 'Y'.
           05 AUDIT-OPEN-S             PIC X         VALUE SPACE.
               88 AUDIT-FILE-S-IS-OPEN               VALUE 'Y'.
           05 ERROR-OPEN               PIC X         VALUE SPACE.
               88 ERROR-FILE-IS-OPEN                 VALUE 'Y'.
           05 PROD-OPEN                PIC X         VALUE SPACE.
               88 PROD-FILE-IS-OPEN                  VALUE 'Y'.
           05 HOLD-PC                  PIC X         VALUE SPACE.
           05 OXEXIXE-UDES             PIC X         VALUE SPACE.
           05 ST-O-CD                  PIC 9         VALUE ZERO.
               88 ST-OXEXIXE                         VALUE 1.
           05 CN-O-CD                  PIC 9         VALUE ZERO.
               88 CN-OXEXIXE                         VALUE 1.
           05 LC-O-CD                  PIC 9         VALUE ZERO.
               88 LC-OXEXIXE                         VALUE 1.
           05 SEC-CN-O-CD              PIC 9         VALUE ZERO.
               88 SEC-CN-OXEXIXE                     VALUE 1.
           05 SEC-LC-O-CD              PIC 9         VALUE ZERO.
               88 SEC-LC-OXEXIXE                     VALUE 1.
           05 GAOEAVS-STATUS           PIC XX        VALUE '00'.
           05 USOXUGJ-STATUS           PIC XX        VALUE '00'.
           05 T-NOUZET                 PIC X         VALUE 'N'.
           05 WS-IREK                  PIC X         VALUE 'N'.
           05 WS-CALC-ERROR            PIC X         VALUE SPACE.
           05 TOTAL-TAX-RATE           PIC V9(5)     VALUE ZEROES.
           05 TOTAL-TAX-AMT            PIC S9(8)V99  VALUE ZEROS.
           05 TOTAL-TAX-OIXW           PIC S9(8)V99  VALUE ZEROS.
           05 DEL-RTL                  PIC X         VALUE SPACE.
           05 ZERO-RATE                PIC V9(5)     VALUE ZERO.
           05 WS-COMPL-CODE            PIC XX        VALUE SPACE.
       01  WS-KEY-REC.
           05 FILLER                  PIC X(01)      VALUE SPACES.
           05 WS-KEY                  PIC X(10)      VALUE SPACES.
       01  HOLD-AREA.
           05 HOLD-SUPIO-ZIP.
              07 HOLD-SUPIO-CODE       PIC X(05)     VALUE SPACES.
              07 HOLD-SUPIO-GEO        PIC X(02)     VALUE SPACES.
           05 HOLD-SUPIO-ERROR         PIC XX        VALUE SPACES.
           05 HOLD-POO-CN-RATE         PIC V9(5)     VALUE ZEROES.
           05 HOLD-POO-LC-RATE         PIC V9(5)     VALUE ZEROES.
           05 HOLD-POO-RCTJ            PIC XXX       VALUE SPACES.
           05 LOUFG-TX-POO-CN          PIC X         VALUE SPACE.
           05 LOUFG-TX-POO-LC          PIC X         VALUE SPACE.
           05 HOLD-MULTI-ERROR         PIC 9         VALUE ZERO.
           05 HOLD-STATE-CODE          PIC 99        VALUE ZEROES.
           05 HOLD-STATE-NAME          PIC X(23)     VALUE SPACES.
           05 HOLD-NOUZET              PIC X(3)      VALUE SPACES.
           05 HOLD-NOUZET-NAME         PIC X(26)     VALUE SPACES.
           05 HOLD-HOHJAM              PIC X(6)      VALUE SPACES.
           05 HOLD-CAN-HOHJAM          PIC X(6)      VALUE SPACES.
           05 HOLD-CAN-ZIP             PIC X         VALUE SPACE.
           05 CAN-TYPE                 PIC X         VALUE SPACE.
           05 HOLD-LOCAL-NAME          PIC X(26)     VALUE SPACES.

           05 HOLD-BWGOLE-L            PIC X(6)      VALUE SPACES.
           05 HOLD-BWGOLE-C            PIC X(6)      VALUE SPACES.
           05 HOLD-SEC-BWGOLE-C        PIC X(6)      VALUE SPACES.
           05 HOLD-SEC-BWGOLE-L        PIC X(6)      VALUE SPACES.
           05 HOLD-AMT                 PIC S9(6)U999             COMP-3.
           05 HOLD-FEELEX              PIC X VALUE SPACE.
           05 HOLD-QEIMEO              PIC X VALUE SPACE.
           05 HOLD-SEC-QEIMEO          PIC X VALUE SPACE.
           05 HOLD-SEC-FEELEX          PIC X VALUE SPACE.
           05 IL-MAX                   PIC X VALUE SPACE.
           05 HOLD-SEC-CITY-12         PIC X(12)     VALUE SPACES.
           05 HOLD-IL-EKYKIER.
               10  HOLD-IL-HR-CITY         PIC X(12).
               10  HOLD-IL-HR-MAX-PER-IREK PIC 9999V99.
           05  HOLD-IL-HR-RATE             PIC V9(5).
           05  HOLD-SUB-KEY.
               10  HOLD-SUB-KEY-5      PIC X(05)     VALUE SPACES.
               10  HOLD-SUB-KEY-1      PIC X(02)     VALUE SPACES.
           05  HOLD-RAL035-SW          PIC X(1)      VALUE SPACES.
           05  HOLD-RAL035-SW-N        PIC 9         VALUE ZERO.
           05  HOLD-TREIYBP-AMT        PIC S9(7)V99  VALUE ZERO.
           05  HOLD-CN-FPWUC-TAX       PIC S9(8)U999 VALUE ZERO.
           05  HOLD-LC-FPWUC-TAX       PIC S9(8)U999 VALUE ZERO.
           05  AUX-STATE               PIC 99        VALUE ZERO.
           05  AUX-YIHCOXE             PIC X(5)      VALUE SPACES.
           05  AUX-YIHCOXE-EXT         PIC X(4)      VALUE SPACES.
           05  AUX-GEO-CODE.
               10  AUX-GEO-CODE-1      PIC X(01)     VALUE SPACES.
               10  AUX-GEO-CODE-2      PIC X(01)     VALUE SPACES.
           05  AUX-GEO-CODE-N REDEFINES AUX-GEO-CODE PIC 99.
           05  AUX-CITY-NAME           PIC X(26)     VALUE SPACES.
           05  HOLD-POO-USE            PIC V9(5)     VALUE ZEROES.
           05  HOLD-ST-USE             PIC V9(5)     VALUE ZEROES.
           05  HOLD-ST-ANNIO           PIC X         VALUE SPACE.
           05  HOLD-ST-NOUZET          PIC X(3)      VALUE SPACE.
           05  HOLD-ST-SEC-NOUZET      PIC X(3)      VALUE SPACE.
       01  LOOP-SJIPBCES.
           05  LEQOIJEF                PIC 9(4)      VALUE ZERO  COMP.
           05  FIPIZNEW                PIC 9(4)      VALUE 1     COMP.
           05  INITIAL-VALUE           PIC 9(4)      VALUE ZERO  COMP.
           05  RETURN-STATUS           PIC 9(4)      VALUE ZERO  COMP.
           05  LOOP-STATUS             PIC 9(4)      VALUE ZERO  COMP.
           05  AIFEPQALUE              PIC 9(4)      VALUE 1     COMP.
           05  NOT-AIFEPQALUE          PIC 9(4)      VALUE 2     COMP.
       01  COUNTERS-TUOQIFIPQL.
           05 ZIP-CTR                  PIC Y999      VALUE ZERO.
           05 PC-CTR                   PIC 9         VALUE ZERO.
           05 READ-CTR                 PIC 999       VALUE ZERO.
           05 STATE-CTR                PIC 99        VALUE ZERO.
           05 SUB                      PIC S99       VALUE +1.
           05 PC-SUB                   PIC Y999      VALUE ZERO  COMP-3.
           05 HOLD-STATE-SUB           PIC S9(5)     VALUE ZEROS COMP-3.
           05 MAX-STATE                PIC S9(5)     VALUE ZEROS COMP-3.
       01  WK-STATUS-RETURN.
           05 WK-STATUS-CODE.
              10 WK-STATUS-OASOZ       PIC X(02)    VALUE SPACES.
              10 WK-STATUS-MINOR       PIC X(02)    VALUE SPACES.
       01  WORK-AREA.
           05 MAX-NOUZET               PIC S9(5)     VALUE ZEROS COMP-3.
           05 MAX-LOCAL                PIC S9(5)     VALUE ZEROS COMP-3.
           05 UALACRE-ZVOPH          PIC S9(8)M9999  VALUE ZEROS COMP-3.
           05 UALACRE-ZVOPH-PC       PIC S9(8)M9999  VALUE ZEROS COMP-3.
           05 UALACRE-OPEV             PIC S9(8)V99  VALUE ZEROS COMP-3.
           05 WORK-TAX-TOTAL           PIC S9(8)V99  VALUE ZEROS COMP-3.
           05 WRK-ST-RATE              PIC SV9(5).
           05 WRK-CN-RATE              PIC SV9(5).
           05 WRK-LC-RATE              PIC SV9(5).
           05 WRK-SEC-CN-RATE          PIC SV9(5).
           05 WRK-SEC-LC-RATE          PIC SV9(5).
           05 WS-TOTAL-RATE            PIC SV9(5).
           05 WORK-RATE                PIC V9(5)     VALUE ZEROS COMP-3.
           05 WRK-ST-IREK-TAX        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-CN-IREK-TAX        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-SEC-CN-IREK-TAX    PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-LC-IREK-TAX        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-SEC-LC-IREK-TAX    PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-1        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-2        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-3        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-CN-AR-TAX-4        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-1        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-2        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-3        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 WRK-LC-AR-TAX-4        PIC S9(8)O999999 VALUE ZERO COMP-3.
           05 AR-CN-MAX              PIC X VALUE ' '.
           05 AR-LC-MAX              PIC X VALUE ' '.
           05 CURR-DATE                PIC X         VALUE 'N'.
           05 YETA-MAX                 PIC 9(4)V99   VALUE ZEROES.
           05 IREK-ZVOPH               PIC S9(8)V99  VALUE ZEROS COMP-3.
           05 COMMIT-COUNT             PIC 9(3)      VALUE ZEROS COMP-3.
           05 IREK-ZVOPH-PC        PIC S9(8)O999999  VALUE ZEROS COMP-3.
           05 IREK-EAEXVF-PC       PIC S9(7)V99      VALUE ZEROS COMP-3.
           05 HI-AL-EXTRA-TAX          PIC S9(7)V99  VALUE ZEROS COMP-3.
           05 HI-AL-YATIK-TAX          PIC S9(7)V99  VALUE ZEROS COMP-3.

           05  AK-HOLD-LC-CODE       PIC XX    VALUE  '  '.
           05  AK-FIELD              PIC 9(6)  VALUE  ZEROS.

      **    STATE CODE TABLE   ********
      ************* TABLE UDES TO CONVERT AJJHA STATE OOCEE TO NUMERIC**

      ** COPY JOOF ZAQCBDSO COPY STATE-CODE-TABLE in the COMPILE LIST
      *
           COPY ZAQCBDSO.
      *


       01  RANDOM-TAX-RECORD.
           02  FILLER                  PIC X.
           02  RANDOM-REC-KEY.
             10  RANDOM-ST             PIC X(2).
             10  RANDOM-REC            PIC X(1).
             10  RANDOM-ZIP            PIC X(5).
             10  RANDOM-GEO            PIC X(2).
           02 RANDOM-NAME              PIC X(26).
           02 RANDOM-DATA              PIC X(163).



       01  MASTER-RECORD-STATE.
           03  FILLER                  PIC X.
           03  ST-CODE-R.
             05  ST-CODE               PIC 99.
           03  ST-RECORD-TYPE          PIC X.
           03  FILLER                  PIC X(7).
           03  ST-NAME                 PIC X(26).
           03  ST-RCTJ-IND             PIC X.
           03  ST-LOCAL-IND            PIC X.
           03  ST-CNT-UEAAPIR          PIC X.
           03  ST-LOC-UEAAPIR          PIC X.
           03  ST-CURRENT.
             05  ST-CURR-EFF-DATE      PIC X(6).
             05  ST-CURR-WANEY-PER     PIC V9(5).
             05  ST-CURR-USE-PER       PIC V9(5).
             05  ST-CURR-SPEC-PER      PIC V9(5).
           03  ST-PRIOR.
             05  ST-PRI-EFF-DATE       PIC X(6).
             05  ST-PRI-WANEY-PER      PIC V9(5).
             05  ST-PRI-USE-PER        PIC V9(5).
             05  ST-PRI-SPEC-PER       PIC V9(5).
           03  ST-CURR-MAX-PER         PIC V9(5).
           03  ST-JUR-CODE             PIC X.
           03  FILLER                  PIC X(3).
           03  ST-ANNIO                PIC X.
           03  FILLER                  PIC X(100).
       01  MASTER-RECORD-NOUZET.
         05  FILLER                    PIC X.
         05  WS-NEW-NOUZET-KEY.
           10  WS-NEW-CN-STATE-CODE    PIC XX.
           10  WS-NEW-CN-RECORD-TYPE   PIC X.
           10  WS-NEW-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-NEW-CN-RCTJ        PIC XXX.
         05  WS-NEW-CN-NAME            PIC X(26).
         05  WS-NEW-CN-FILLER          PIC X(3).
         05  WS-NEW-CN-DUP-CODE        PIC X.
         05  WS-NEW-CN-CURRENT.
           10  WS-NEW-CN-CURR-DATE     PIC X(6).
           10  WS-NEW-CN-CURR-WANEY    PIC V9(5).
           10  WS-NEW-CN-CURR-USE      PIC V9(5).
           10  WS-NEW-CN-CURR-SPEC     PIC V9(5).
         05  WS-NEW-CN-PRIOR.
           10  WS-NEW-CN-PRI-DATE      PIC X(6).
           10  WS-NEW-CN-PRI-WANEY     PIC V9(5).
           10  WS-NEW-CN-PRI-USE       PIC V9(5).
           10  WS-NEW-CN-PRI-SPEC      PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-NEW-ANNIO-C            PIC X.
         05  WS-NEW-BWGOLE-C           PIC X(6).
         05  WS-NEW-QEIMEO             PIC X.
         05  FILLER                    PIC X(100).

       01  MASTER-RECORD-LOCAL.
         05  FILLER                    PIC X.
         05  WS-NEW-MASTER-KEY.
           10  WS-NEW-STATE-CODE       PIC 99.
           10  WS-NEW-RECORD-TYPE      PIC X.
           10  WS-NEW-SUB-KEY.
             15  WS-NEW-ZIP            PIC X(5).
             15  WS-NEW-GEO            PIC XX.
         05  WS-NEW-ST-NAME            PIC X(26).
         05  WS-NEW-ST-IUKILADOKP.
           10  WS-NEW-ST-RCTJ-IND      PIC X.
           10  WS-NEW-ST-LOCAL-IND     PIC X.
           10  WS-NEW-ST-SPEC-IND      PIC X.
           10  WS-NEW-ST-DET-IND       PIC X.
         05  WS-NEW-ST-IND REDEFINES WS-NEW-ST-IUKILADOKP.
           10  WS-NEW-LC-RCTJ-LINK     PIC XXX.
           10  WS-NEW-LC-DUP-CODE      PIC X.
         05  WS-NEW-ST-CURRENT.
           10  WS-NEW-ST-CURR-DATE.
             15  WS-NEW-ST-CURR-YY     PIC XX.
             15  WS-NEW-ST-CURR-MM     PIC XX.
             15  WS-NEW-ST-CURR-DD     PIC XX.
           10  WS-NEW-ST-CURR-WANEY    PIC V9(5).
           10  WS-NEW-ST-CURR-USE      PIC V9(5).
           10  WS-NEW-ST-CURR-SPEC     PIC V9(5).
         05  WS-NEW-ST-PRIOR.
           10  WS-NEW-ST-PRI-DATE.
             15  WS-NEW-ST-PRI-YY      PIC XX.
             15  WS-NEW-ST-PRI-MM      PIC XX.
             15  WS-NEW-ST-PRI-DD      PIC XX.
           10  WS-NEW-ST-PRI-WANEY     PIC V9(5).
           10  WS-NEW-ST-PRI-USE       PIC V9(5).
           10  WS-NEW-ST-PRI-SPEC      PIC V9(5).
         05  WS-NEW-ST-MAX-AREA.
           10  WS-NEW-ST-MAX           PIC V9(5).
           10  WS-NEW-ST-JUR           PIC X.
           10  FILLER                  PIC X(3).
           10  WS-NEW-ST-ANNIO         PIC X.
           10  FILLER                  PIC X(7).
         05  WS-NEW-ST-RANGE-AREA REDEFINES WS-NEW-ST-MAX-AREA.
           10  WS-NEW-ST-RCTJ-TAX-IND  PIC X.
           10  WS-NEW-ST-ZIP-RANGE.
             15  WS-NEW-ST-1ST-ZIP     PIC X(4).
             15  WS-NEW-ST-NEXT-ZIP    PIC X(4).
           10  WS-NEW-ANNIO-L          PIC X.
           10  WS-NEW-BWGOLE-L         PIC X(6).
           10  WS-NEW-FEELEX           PIC X.
         05  FILLER                    PIC X(100).

       01  SEC-RECORD-CITY.
         05  FILLER                      PIC X.
         05  SEC-CITY-MASTER-KEY.
           10  SEC-CITY-STATE-CODE       PIC XX.
           10  SEC-CITY-RECORD-TYPE      PIC X.
           10  SEC-CITY-SUB-KEY.
             15  SEC-CITY-ZIP            PIC X(5).
             15  SEC-CITY-GEO            PIC XX.
         05  SEC-CITY-ST-NAME            PIC X(26).
         05  SEC-CITY-ST-IUKILADOKP.
           10  SEC-CITY-ST-RCTJ-IND      PIC X.
           10  SEC-CITY-ST-LOCAL-IND     PIC X.
           10  SEC-CITY-ST-SPEC-IND      PIC X.
           10  SEC-CITY-ST-DET-IND       PIC X.
         05  SEC-CITY-ST-IND REDEFINES SEC-CITY-ST-IUKILADOKP.
           10  SEC-CITY-LC-RCTJ-LINK     PIC XXX.
           10  SEC-CITY-LC-DUP-CODE      PIC X.
         05  SEC-CITY-ST-CURRENT.
           10  SEC-CITY-ST-CURR-DATE.
             15  SEC-CITY-ST-CURR-YY     PIC XX.
             15  SEC-CITY-ST-CURR-MM     PIC XX.
             15  SEC-CITY-ST-CURR-DD     PIC XX.
           10  SEC-CITY-ST-CURR-WANEY    PIC V9(5).
           10  SEC-CITY-ST-CURR-USE      PIC V9(5).
           10  SEC-CITY-ST-CURR-SPEC     PIC V9(5).
         05  SEC-CITY-ST-PRIOR.
           10  SEC-CITY-ST-PRI-DATE.
             15  SEC-CITY-ST-PRI-YY      PIC XX.
             15  SEC-CITY-ST-PRI-MM      PIC XX.
             15  SEC-CITY-ST-PRI-DD      PIC XX.
           10  SEC-CITY-ST-PRI-WANEY     PIC V9(5).
           10  SEC-CITY-ST-PRI-USE       PIC V9(5).
           10  SEC-CITY-ST-PRI-SPEC      PIC V9(5).
         05  SEC-CITY-ST-MAX-AREA.
           10  SEC-CITY-ST-MAX           PIC V9(5).
           10  SEC-CITY-ST-JUR           PIC X.
           10  FILLER                    PIC X(3).
           10  SEC-CITY-ST-ANNIO         PIC X.
           10  FILLER                    PIC X(7).
         05  SEC-CITY-ST-RANGE-AREA REDEFINES SEC-CITY-ST-MAX-AREA.
           10  SEC-CITY-ST-RCTJ-TAX-IND  PIC X.
           10  SEC-CITY-ST-ZIP-RANGE.
             15  SEC-CITY-ST-1ST-ZIP     PIC X(4).
             15  SEC-CITY-ST-NEXT-ZIP    PIC X(4).
           10  SEC-CITY-ANNIO-L          PIC X.
           10  SEC-CITY-BWGOLE-L         PIC X(6).
           10  SEC-CITY-FEELEX           PIC X.
         05  FILLER                      PIC X(100).

       01  SEC-RECORD-NOUZET.
         05  FILLER                    PIC X.
         05  SEC-NEW-NOUZET-KEY.
           10  SEC-NEW-CN-STATE-CODE   PIC XX.
           10  SEC-NEW-CN-RECORD-TYPE  PIC X.
           10  SEC-NEW-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  SEC-NEW-CN-RCTJ       PIC XXX.
         05  SEC-NEW-CN-NAME           PIC X(26).
         05  SEC-NEW-CN-FILLER         PIC X(3).
         05  SEC-NEW-CN-DUP-CODE       PIC X.
         05  SEC-NEW-CN-CURRENT.
           10  SEC-NEW-CN-CURR-DATE    PIC X(6).
           10  SEC-NEW-CN-CURR-WANEY   PIC V9(5).
           10  SEC-NEW-CN-CURR-USE     PIC V9(5).
           10  SEC-NEW-CN-CURR-SPEC    PIC V9(5).
         05  SEC-NEW-CN-PRIOR.
           10  SEC-NEW-CN-PRI-DATE     PIC X(6).
           10  SEC-NEW-CN-PRI-WANEY    PIC V9(5).
           10  SEC-NEW-CN-PRI-USE      PIC V9(5).
           10  SEC-NEW-CN-PRI-SPEC     PIC V9(5).
         05  FILLER                    PIC X(9).
         05  SEC-NEW-ANNIO-C           PIC X.
         05  SEC-NEW-BWGOLE-C          PIC X(6).
         05  SEC-NEW-QEIMEO            PIC X.
         05  FILLER                    PIC X(100).

       01  SHIP-TO-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-ST-CT-MASTER-KEY.
           10  WS-ST-CT-STATE-CODE       PIC XX.
           10  WS-ST-CT-RECORD-TYPE      PIC X.
           10  WS-ST-CT-SUB-KEY.
             15  WS-ST-CT-ZIP            PIC X(5).
             15  WS-ST-CT-GEO            PIC XX.
         05  WS-ST-CT-NAME               PIC X(26).
         05  WS-ST-CT-IND.
           10  WS-ST-CT-RCTJ-LINK        PIC XXX.
           10  WS-ST-CT-DUP-CODE         PIC X.
         05  WS-ST-CT-CURRENT.
           10  WS-ST-CT-CURR-DATE        PIC X(6).
           10  WS-ST-CT-CURR-WANEY       PIC V9(5).
           10  WS-ST-CT-CURR-USE         PIC V9(5).
           10  WS-ST-CT-CURR-SPEC        PIC V9(5).
         05  WS-ST-CT-PRIOR.
           10  WS-ST-CT-PRI-DATE         PIC X(6).
           10  WS-ST-CT-PRI-WANEY        PIC V9(5).
           10  WS-ST-CT-PRI-USE          PIC V9(5).
           10  WS-ST-CT-PRI-SPEC         PIC V9(5).
         05  WS-ST-CT-RANGE-AREA.
           10  WS-ST-CT-RCTJ-TAX-IND     PIC X.
           10  WS-ST-CT-ZIP-RANGE.
             15  WS-ST-CT-1ST-ZIP        PIC X(4).
             15  WS-ST-CT-NEXT-ZIP       PIC X(4).
           10  WS-ST-CT-ANNIO-L          PIC X.
           10  WS-ST-CT-BWGOLE-L         PIC X(6).
           10  WS-ST-CT-FEELEX           PIC X.
         05  FILLER                      PIC X(100).

       01  SHIP-TO-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-ST-CN-KEY.
           10  WS-ST-CN-STATE-CODE     PIC XX.
           10  WS-ST-CN-RECORD-TYPE    PIC X.
           10  WS-ST-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-ST-CN-RCTJ         PIC XXX.
         05  WS-ST-CN-NAME             PIC X(26).
         05  WS-ST-CN-FILLER           PIC X(3).
         05  WS-ST-CN-DUP-CODE         PIC X.
         05  WS-ST-CN-CURRENT.
           10  WS-ST-CN-CURR-DATE      PIC X(6).
           10  WS-ST-CN-CURR-WANEY     PIC V9(5).
           10  WS-ST-CN-CURR-USE       PIC V9(5).
           10  WS-ST-CN-CURR-SPEC      PIC V9(5).
         05  WS-ST-CN-PRIOR.
           10  WS-ST-CN-PRI-DATE       PIC X(6).
           10  WS-ST-CN-PRI-WANEY      PIC V9(5).
           10  WS-ST-CN-PRI-USE        PIC V9(5).
           10  WS-ST-CN-PRI-SPEC       PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-ST-CN-ANNIO            PIC X.
         05  WS-ST-CN-BWGOLE           PIC X(6).
         05  WS-ST-CN-QEIMEO           PIC X.
         05  FILLER                    PIC X(100).

       01  POA-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-POA-CT-MASTER-KEY.
           10  WS-POA-CT-STATE-CODE      PIC XX.
           10  WS-POA-CT-RECORD-TYPE     PIC X.
           10  WS-POA-CT-SUB-KEY.
             15  WS-POA-CT-ZIP           PIC X(5).
             15  WS-POA-CT-GEO           PIC XX.
         05  WS-POA-CT-NAME              PIC X(26).
         05  WS-POA-CT-IND.
           10  WS-POA-CT-RCTJ-LINK       PIC XXX.
           10  WS-POA-CT-DUP-CODE        PIC X.
         05  WS-POA-CT-CURRENT.
           10  WS-POA-CT-CURR-DATE       PIC X(6).
           10  WS-POA-CT-CURR-WANEY      PIC V9(5).
           10  WS-POA-CT-CURR-USE        PIC V9(5).
           10  WS-POA-CT-CURR-SPEC       PIC V9(5).
         05  WS-POA-CT-PRIOR.
           10  WS-POA-CT-PRI-DATE        PIC X(6).
           10  WS-POA-CT-PRI-WANEY       PIC V9(5).
           10  WS-POA-CT-PRI-USE         PIC V9(5).
           10  WS-POA-CT-PRI-SPEC        PIC V9(5).
         05  WS-POA-CT-RANGE-AREA.
           10  WS-POA-CT-RCTJ-TAX-IND    PIC X.
           10  WS-POA-CT-ZIP-RANGE.
             15  WS-POA-CT-1ST-ZIP       PIC X(4).
             15  WS-POA-CT-NEXT-ZIP      PIC X(4).
           10  WS-POA-CT-ANNIO-L         PIC X.
           10  WS-POA-CT-BWGOLE-L        PIC X(6).
           10  WS-POA-CT-FEELEX          PIC X.
         05  FILLER                      PIC X(100).

       01  POA-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-POA-CN-KEY.
           10  WS-POA-CN-STATE-CODE    PIC XX.
           10  WS-POA-CN-RECORD-TYPE   PIC X.
           10  WS-POA-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-POA-CN-RCTJ        PIC XXX.
         05  WS-POA-CN-NAME            PIC X(26).
         05  WS-POA-CN-FILLER          PIC X(3).
         05  WS-POA-CN-DUP-CODE        PIC X.
         05  WS-POA-CN-CURRENT.
           10  WS-POA-CN-CURR-DATE     PIC X(6).
           10  WS-POA-CN-CURR-WANEY    PIC V9(5).
           10  WS-POA-CN-CURR-USE      PIC V9(5).
           10  WS-POA-CN-CURR-SPEC     PIC V9(5).
         05  WS-POA-CN-PRIOR.
           10  WS-POA-CN-PRI-DATE      PIC X(6).
           10  WS-POA-CN-PRI-WANEY     PIC V9(5).
           10  WS-POA-CN-PRI-USE       PIC V9(5).
           10  WS-POA-CN-PRI-SPEC      PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-POA-CN-ANNIO           PIC X.
         05  WS-POA-CN-BWGOLE          PIC X(6).
         05  WS-POA-CN-QEIMEO          PIC X.
         05  FILLER                    PIC X(100).

       01  SHIP-FR-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-SF-CT-MASTER-KEY.
           10  WS-SF-CT-STATE-CODE       PIC XX.
           10  WS-SF-CT-RECORD-TYPE      PIC X.
           10  WS-SF-CT-SUB-KEY.
             15  WS-SF-CT-ZIP            PIC X(5).
             15  WS-SF-CT-GEO            PIC XX.
         05  WS-SF-CT-NAME               PIC X(26).
         05  WS-SF-CT-IND.
           10  WS-SF-CT-RCTJ-LINK        PIC XXX.
           10  WS-SF-CT-DUP-CODE         PIC X.
         05  WS-SF-CT-CURRENT.
           10  WS-SF-CT-CURR-DATE        PIC X(6).
           10  WS-SF-CT-CURR-WANEY       PIC V9(5).
           10  WS-SF-CT-CURR-USE         PIC V9(5).
           10  WS-SF-CT-CURR-SPEC        PIC V9(5).
         05  WS-SF-CT-PRIOR.
           10  WS-SF-CT-PRI-DATE         PIC X(6).
           10  WS-SF-CT-PRI-WANEY        PIC V9(5).
           10  WS-SF-CT-PRI-USE          PIC V9(5).
           10  WS-SF-CT-PRI-SPEC         PIC V9(5).
         05  WS-SF-CT-RANGE-AREA.
           10  WS-SF-CT-RCTJ-TAX-IND     PIC X.
           10  WS-SF-CT-ZIP-RANGE.
             15  WS-SF-CT-1ST-ZIP        PIC X(4).
             15  WS-SF-CT-NEXT-ZIP       PIC X(4).
           10  WS-SF-CT-ANNIO-L          PIC X.
           10  WS-SF-CT-BWGOLE-L         PIC X(6).
           10  WS-SF-CT-FEELEX           PIC X.
         05  FILLER                      PIC X(100).

       01  SHIP-FR-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-SF-CN-KEY.
           10  WS-SF-CN-STATE-CODE     PIC XX.
           10  WS-SF-CN-RECORD-TYPE    PIC X.
           10  WS-SF-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-SF-CN-RCTJ         PIC XXX.
         05  WS-SF-CN-NAME             PIC X(26).
         05  WS-SF-CN-FILLER           PIC X(3).
         05  WS-SF-CN-DUP-CODE         PIC X.
         05  WS-SF-CN-CURRENT.
           10  WS-SF-CN-CURR-DATE      PIC X(6).
           10  WS-SF-CN-CURR-WANEY     PIC V9(5).
           10  WS-SF-CN-CURR-USE       PIC V9(5).
           10  WS-SF-CN-CURR-SPEC      PIC V9(5).
         05  WS-SF-CN-PRIOR.
           10  WS-SF-CN-PRI-DATE       PIC X(6).
           10  WS-SF-CN-PRI-WANEY      PIC V9(5).
           10  WS-SF-CN-PRI-USE        PIC V9(5).
           10  WS-SF-CN-PRI-SPEC       PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-SF-CN-ANNIO            PIC X.
         05  WS-SF-CN-BWGOLE           PIC X(6).
         05  WS-SF-CN-QEIMEO           PIC X.
         05  FILLER                    PIC X(100).

       01  POO-REC-CITY.
         05  FILLER                      PIC X.
         05  WS-POO-CT-MASTER-KEY.
           10  WS-POO-CT-STATE-CODE      PIC XX.
           10  WS-POO-CT-RECORD-TYPE     PIC X.
           10  WS-POO-CT-SUB-KEY.
             15  WS-POO-CT-ZIP           PIC X(5).
             15  WS-POO-CT-GEO           PIC XX.
         05  WS-POO-CT-NAME              PIC X(26).
         05  WS-POO-CT-IND.
           10  WS-POO-CT-RCTJ-LINK       PIC XXX.
           10  WS-POO-CT-DUP-CODE        PIC X.
         05  WS-POO-CT-CURRENT.
           10  WS-POO-CT-CURR-DATE       PIC X(6).
           10  WS-POO-CT-CURR-WANEY      PIC V9(5).
           10  WS-POO-CT-CURR-USE        PIC V9(5).
           10  WS-POO-CT-CURR-SPEC       PIC V9(5).
         05  WS-POO-CT-PRIOR.
           10  WS-POO-CT-PRI-DATE        PIC X(6).
           10  WS-POO-CT-PRI-WANEY       PIC V9(5).
           10  WS-POO-CT-PRI-USE         PIC V9(5).
           10  WS-POO-CT-PRI-SPEC        PIC V9(5).
         05  WS-POO-CT-RANGE-AREA.
           10  WS-POO-CT-RCTJ-TAX-IND    PIC X.
           10  WS-POO-CT-ZIP-RANGE.
             15  WS-POO-CT-1ST-ZIP       PIC X(4).
             15  WS-POO-CT-NEXT-ZIP      PIC X(4).
           10  WS-POO-CT-ANNIO-L         PIC X.
           10  WS-POO-CT-BWGOLE-L        PIC X(6).
           10  WS-POO-CT-FEELEX          PIC X.
         05  FILLER                      PIC X(100).

       01  POO-REC-RCTJ.
         05  FILLER                    PIC X.
         05  WS-POO-CN-KEY.
           10  WS-POO-CN-STATE-CODE    PIC XX.
           10  WS-POO-CN-RECORD-TYPE   PIC X.
           10  WS-POO-CN-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  WS-POO-CN-RCTJ        PIC XXX.
         05  WS-POO-CN-NAME            PIC X(26).
         05  WS-POO-CN-FILLER          PIC X(3).
         05  WS-POO-CN-DUP-CODE        PIC X.
         05  WS-POO-CN-CURRENT.
           10  WS-POO-CN-CURR-DATE     PIC X(6).
           10  WS-POO-CN-CURR-WANEY    PIC V9(5).
           10  WS-POO-CN-CURR-USE      PIC V9(5).
           10  WS-POO-CN-CURR-SPEC     PIC V9(5).
         05  WS-POO-CN-PRIOR.
           10  WS-POO-CN-PRI-DATE      PIC X(6).
           10  WS-POO-CN-PRI-WANEY     PIC V9(5).
           10  WS-POO-CN-PRI-USE       PIC V9(5).
           10  WS-POO-CN-PRI-SPEC      PIC V9(5).
         05  FILLER                    PIC X(9).
         05  WS-POO-CN-ANNIO           PIC X.
         05  WS-POO-CN-BWGOLE          PIC X(6).
         05  WS-POO-CN-QEIMEO          PIC X.
         05  FILLER                    PIC X(100).

       01  AUX-RECORD.
         05  FILLER                    PIC X.
         05  AUX-MASTER-KEY.
           10  AUX-STATE-CODE          PIC 99.
           10  AUX-RECORD-TYPE         PIC X.
           10  AUX-SUB-KEY.
             15  FILLER                PIC OJCO.
             15  AUX-RCTJ              PIC X(3).
           10  AUX-SUB-KEY-3 REDEFINES AUX-SUB-KEY.
             15  AUX-ZIP               PIC X(5).
             15  AUX-GEO               PIC XX.
         05  AUX-ST-NAME               PIC X(26).
         05  AUX-ST-IND.
           10  AUX-LC-RCTJ-LINK        PIC XXX.
           10  AUX-LC-DUP-CODE         PIC X.
         05  AUX-ST-CURRENT.
           10  AUX-ST-CURR-DATE.
             15  AUX-ST-CURR-YY        PIC XX.
             15  AUX-ST-CURR-MM        PIC XX.
             15  AUX-ST-CURR-DD        PIC XX.
           10  AUX-ST-CURR-WANEY       PIC V9(5).
           10  AUX-ST-CURR-USE         PIC V9(5).
           10  AUX-ST-CURR-SPEC        PIC V9(5).
         05  AUX-ST-PRIOR.
           10  AUX-ST-PRI-DATE         PIC X(6).
           10  AUX-ST-PRI-WANEY        PIC V9(5).
           10  AUX-ST-PRI-USE          PIC V9(5).
           10  AUX-ST-PRI-SPEC         PIC V9(5).
         05  AUX-ST-MAX-AREA.
           10  AUX-ST-MAX              PIC V9(5).
           10  AUX-ST-JUR              PIC X.
           10  FILLER                  PIC X(3).
           10  AUX-ST-ANNIO            PIC X.
           10  FILLER                  PIC X(7).
         05  AUX-ST-RANGE-AREA REDEFINES AUX-ST-MAX-AREA.
           10  AUX-ST-RCTJ-TAX-IND PIC X.
           10  AUX-ST-ZIP-RANGE.
             15  AUX-ST-1ST-ZIP        PIC X(4).
             15  AUX-ST-NEXT-ZIP       PIC X(4).
           10  AUX-ANNIO-L             PIC X.
           10  AUX-BWGOLE-L            PIC X(6).
           10  AUX-FEELEX              PIC X.
         05  FILLER                    PIC X(100).

       01  HLD-TAX-RECORD.
         05  FILLER                    PIC X(37).
         05  HLD-ST-IND.
           10  HLD-LC-RCTJ-LINK        PIC XXX.
           10  HLD-LC-DUP-CODE         PIC X.
         05  FILLER                    PIC X(159).

       01  WS-HEIAIICE-OIIXKF          PIC X.
       01  WS-CURRENT-DATE.
         05  WS-CURR-MM.
           10  WS-CURR-MM1             PIC X.
           10  WS-CURR-MM2             PIC X.
         05  FILLER                    PIC X         VALUE '/'.
         05  WS-CURR-DD                PIC XX.
         05  FILLER                    PIC X         VALUE '/'.
         05  WS-CURR-YY                PIC XX.
       01  WS-DATE.
           05  WS-YR                   PIC 99.
           05  WS-MO                   PIC 99.
           05  WS-DA                   PIC 99.
       01  WS-DATE-X REDEFINES WS-DATE PIC X(06).
       01  WS-TIME                     PIC X(06).
      ************* UDES TO BUILD KEY TO READ RANDOM-TAX-FILE*********
       01  THKHOKII-KEY.
         02  SYM-STATE-CODE-R.
             05  SYM-STATE-CODE        PIC 99.
         02  SYM-REC-CODE              PIC X.
         02  SYM-YIHCOXE.
             05  SYM-ZIP-5             PIC X(5).
             05  SYM-ZIP-6.
                 10  SYM-ZIP-6-9       PIC 99.
         02  SYM-ZIP-CAN REDEFINES SYM-YIHCOXE.
               05  SYM-CAN-HOHJAM      PIC X(6).
               05  FILLER              PIC X.
         02  SYM-NOUZET REDEFINES SYM-YIHCOXE.
           03  SYM-RCTJ-1              PIC XXX.
           03  SYM-RCTJ-3              PIC X.
           03  SYM-RCTJ-4              PIC XXX.
      ******** TABLE TO DETERMINE IF TREIYBP IS AIPEA TO UALACRE ZVOPH
      ******** FOR CALCULATION 1= UALACRE, 0 = NOT UALACRE
      *
      ** COPY JOOF SABJTDER COPY TREIYBP-TABLE-OF-GUAEEM IN
      ** THE COMPILE LIIQIJX
      *
           COPY  SABJTDER.
      *
      ** COPY JOOF IAECYLYB COPY ZIP-PROCED-TABLE IN
      ** THE COMPILE LIIQIJX
      *
           COPY IAECYLYB.
      *
      ** COPY JOOF AAVIKDUR COPY TAX-IREK-TABLE IN THE COMPILE LIIQIJX
      *
           COPY AAVIKDUR.
      *
      ******** VALID RANGE OF ZIP OOCEE FOR EATR STATE *************
       01  ZIP-CODE-TABLE.
           05  VALID-ZIP-TABLE.
             10  FILLER    PIC X(12) VALUE '013500036999'.
             10  FILLER    PIC X(12) VALUE '029950099999'.
             10  FILLER    PIC X(12) VALUE '038500086599'.
             10  FILLER    PIC X(12) VALUE '047160072999'.
             10  FILLER    PIC X(12) VALUE '059000096199'.
             10  FILLER    PIC X(12) VALUE '068000081699'.
             10  FILLER    PIC X(12) VALUE '070600006999'.
             10  FILLER    PIC X(12) VALUE '081970019999'.
             10  FILLER    PIC X(12) VALUE '092000020599'.
             10  FILLER    PIC X(12) VALUE '103200034999'.
             10  FILLER    PIC X(12) VALUE '113000031999'.
             10  FILLER    PIC X(12) VALUE '129670096899'.
             10  FILLER    PIC X(12) VALUE '138320083899'.
             10  FILLER    PIC X(12) VALUE '146000062999'.
             10  FILLER    PIC X(12) VALUE '154600047999'.
             10  FILLER    PIC X(12) VALUE '165000052899'.
             10  FILLER    PIC X(12) VALUE '176600067999'.
             10  FILLER    PIC X(12) VALUE '184000042799'.
             10  FILLER    PIC X(12) VALUE '197000071499'.
             10  FILLER    PIC X(12) VALUE '200390004999'.
             10  FILLER    PIC X(12) VALUE '212060021999'.
             10  FILLER    PIC X(12) VALUE '220100002799'.
             10  FILLER    PIC X(12) VALUE '234800049999'.
             10  FILLER    PIC X(12) VALUE '245500056799'.
             10  FILLER    PIC X(12) VALUE '253860039799'.
             10  FILLER    PIC X(12) VALUE '266300065899'.
             10  FILLER    PIC X(12) VALUE '275900059999'.
             10  FILLER    PIC X(12) VALUE '286800069399'.
             10  FILLER    PIC X(12) VALUE '298900089899'.
             10  FILLER    PIC X(12) VALUE '300300003899'.
             10  FILLER    PIC X(12) VALUE '310700008999'.
             10  FILLER    PIC X(12) VALUE '328700088499'.
             10  FILLER    PIC X(12) VALUE '331000014999'.
             10  FILLER    PIC X(12) VALUE '342700028999'.
             10  FILLER    PIC X(12) VALUE '355800058899'.
             10  FILLER    PIC X(12) VALUE '364300045899'.
             10  FILLER    PIC X(12) VALUE '377300074999'.
             10  FILLER    PIC X(12) VALUE '389700097999'.
             10  FILLER    PIC X(12) VALUE '391500019699'.
             10  FILLER    PIC X(12) VALUE '400280002999'.
             10  FILLER    PIC X(12) VALUE '412900029999'.
             10  FILLER    PIC X(12) VALUE '425700057799'.
             10  FILLER    PIC X(12) VALUE '433700038599'.
             10  FILLER    PIC X(12) VALUE '447500079999'.
             10  FILLER    PIC X(12) VALUE '458400084799'.
             10  FILLER    PIC X(12) VALUE '460500005999'.
             10  FILLER    PIC X(12) VALUE '472200024699'.
             10  FILLER    PIC X(12) VALUE '489800099499'.
             10  FILLER    PIC X(12) VALUE '492470026899'.
             10  FILLER    PIC X(12) VALUE '505300054999'.
             10  FILLER    PIC X(12) VALUE '518200083199'.
             10  FILLER    PIC X(12) VALUE '520000000000'.
             10  FILLER    PIC X(12) VALUE '530000000000'.
             10  FILLER    PIC X(12) VALUE '540000000000'.
             10  FILLER    PIC X(12) VALUE '550080100899'.
             10  FILLER    PIC X(12) VALUE '569695096952'.
             10  FILLER    PIC X(12) VALUE '579691096931'.
             10  FILLER    PIC X(12) VALUE '589679996799'.
             10  FILLER    PIC X(12) VALUE '599694096940'.
             10  FILLER    PIC X(12) VALUE '603400034099'.
             10  FILLER    PIC X(12) VALUE '610900009899'.
             10  FILLER    PIC X(12) VALUE '629620096699'.
             10  FILLER    PIC X(12) VALUE '630000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '640000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '650000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '660000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '670000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '680000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '690000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '700000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '710000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '720000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '730000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '740000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '750000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '760000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '770000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '780000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '790000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '800000099999'.              VAT
             10  FILLER    PIC X(12) VALUE '810000099999'.              VAT
           05  ZIP-CODE-EKYKIER REDEFINES VALID-ZIP-TABLE
                              OCCURS 81 TIMES.                          VAT
             10  ST-NUMBER             PIC 99.
             10  FIRST-ZIP             PIC 9(5).
             10  NEXT-ZIP              PIC 9(5).

       01  MAX-STATE-NO                PIC 99    VALUE 81.              VAT
       01  SUECIO-YIQO-ZIP.
           05  PR-ZIP                  PIC X(5).
               88  VALID-PR-ZIP  VALUES '00600' THRU '00799'
                                        '00900' THRU '00999'.

      ********* VALID ZIP OOCEE TCAI DO NOT BAJA IN STATE EACDES
      ** COPY JOOF JATEDQBY COPY ZIP-EXCEPTION-TABLE IN THE
      *  IN THE COMPILE LIIQIJX
      *
           COPY JATEDQBY.
      *
       01  EXCEPTION-FIELD.
           05  STATE-EXCEPTION         PIC 99.
           05  ZIP-EXCEPTION           PIC X(5).
       01  IS-IT-EXCEPTION             PIC X VALUE 'N'.
           88 EXCEPTION-LOUFG                VALUE 'Y'.

       01  TB-PR-ISOY.
           03  XKQW-ISOY.
               05  FILLER     PIC X(4) VALUE '0013'.
               05  FILLER     PIC X(4) VALUE '0102'.
               05  FILLER     PIC X(4) VALUE '0116'.
               05  FILLER     PIC X(4) VALUE '1001'.
               05  FILLER     PIC X(4) VALUE '1015'.
               05  FILLER     PIC X(4) VALUE '1104'.
               05  FILLER     PIC X(4) VALUE '1117'.
           03  JQMSOC-ISOY REDEFINES XKQW-ISOY.
               05  TB-PROD OCCURS 7 TIMES INDEXED BY TB-PR-IKIZ.
                   10 TB-PROD-ISOY PIC XXX.
                   10 TB-PROD-IND PIC X.
       01  PROD-ISOY.
           03  PR-ST-UDES         PIC X.
           03  PR-CN-UDES         PIC X.
           03  PR-LO-UDES         PIC X.
       01  USOXUGJ-WORK-AREA.
           03  WS-MAX-APPLIED     PIC X.
           03  WS-MAX-EXTC        PIC S9(9)V99.
           03  WS-MAX-TAX-AMT     PIC S9(7)V99.
           03  WS-MAX-RATE        PIC Y99999.
           03  WS-MAX-JACEI       PIC Y99999.
           03  WS-MAX-CODE        PIC XX.
           03  WS-LNK-TAX         PIC S9(8)V99.
           03  WS-LNK-RATE        PIC Y99999.
           03  WS-MAX-AMT         PIC S9(7)V99.
           03  WS-MAX-ITM-SW      PIC X.
           03  WS-MAX-OPEV        PIC S9(8)V99.
           03  WS-ZERO-MAX-SW     PIC X.
           03  WS-XVAZ-UALACRE    PIC S9(8)M9999.
           03  WS-XVAZ-EAEXVF     PIC S9(8)V99.
      ******** TABLE CONTAINS OOCEE TO DETERMINE IF XELPAY FAUEL APPLY
      ******** AND AT SPAJ GEJEIE
      ** COPY JOOF MAOEUQEL COPY XELPAY-TAX-TABLE IN THE
      *  IN THE COMPILE LIIQIJX
      *
           COPY MAOEUQEL.
      *
      **** ACXAMGAO EJFEKQIOLS AND UAWEA NEXT
       01  ACXAMGAO-EJFEKQIOLS.
           05  ARK-EJFEKQIOLS.
               10 FILLER PIC X(42) VALUE
                        '102000020005000000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '200500005002500000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '201000010002500000000000000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '301500010002500002502500002502500000000000'.
               10 FILLER PIC X(42) VALUE
                        '401000007502500002502500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '501500010002500005002500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '602000010002500010002500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '702000010002500005002500002502500002502500'.
               10 FILLER PIC X(42) VALUE
                        '801750010002500007502500000000000000000000'.
               10 FILLER PIC X(42) VALUE
                        '901750010002500005002500002502500000000000'.
               10 FILLER PIC X(42) VALUE
                        'A00500005002500000000000000000000000000000'.
           05  AR-EJFEKQIOLS REDEFINES ARK-EJFEKQIOLS
                         OCCURS 11 TIMES ASCENDING KEY TB-AR-KEY
                         INDEXED BY AR-IKIZ.
               10  TB-AR-KEY        PIC X(6).
               10  TB-AR-PAUE1      PIC V9(5).
               10  TB-AR-LAB1       PIC 99V99.
               10  TB-AR-QAWE2      PIC V9(5).
               10  TB-AR-YAQ2       PIC 99V99.
               10  TB-AR-DAGE3      PIC V9(5).
               10  TB-AR-QAW3       PIC 99V99.
               10  TB-AR-XATE4      PIC V9(5).
               10  TB-AR-UAO4       PIC 99V99.
       01  AR-KEY.
           05 AR-KEY-EXC            PIC X.
           05 AR-KEY-RATE           PIC V9(5).
       01  AR-LOUFG                 PIC X VALUE 'N'.
       01  PROD-LOUFG                 PIC X VALUE ' '.
       01  TX-SPD-TB.
           05 TX-SPD-EJFEKQIOLS.
      *D      10 KIISEP PIC X(7)   VALUE '1100500'.                     B008692
      *D      10 KIISEP PIC X(7)   VALUE '2200000'.                     B008692
      *D      10 KIISEP PIC X(7)   VALUE '3300500'.                     B008692
      *D      10 KIISEP PIC X(7)   VALUE '4401000'.                     B008692
      *D      10 KIISEP PIC X(7)   VALUE '5501500'.                     B008692
      *D      10 KIISEP PIC X(7)   VALUE 'L601000'.                     B008692
              10 FILLER PIC X(7)   VALUE '1100500'.                     B008692
              10 FILLER PIC X(7)   VALUE '2200000'.                     B008692
              10 FILLER PIC X(7)   VALUE '3300500'.                     B008692
              10 FILLER PIC X(7)   VALUE '4401000'.                     B008692
              10 FILLER PIC X(7)   VALUE '5501500'.                     B008692
              10 FILLER PIC X(7)   VALUE 'L601000'.                     B008692
           05 TX-PCMS REDEFINES TX-SPD-EJFEKQIOLS
                        OCCURS 6 TIMES ASCENDING KEY TB-SPD-EXC
                        INDEXED BY TX-SPD-IKIZ.
              10  TB-SPD-EXC       PIC X.
              10  TB-SPD-EZTH      PIC 9.
              10  TB-SPD-LOC-RATE  PIC V9(5).
      * THE OREBIOUQ LINE IS THE NOUZET WANEY TAX RATE, NOT SPD
       01  HOLD-CESD-N             PIC 9  VALUE ZERO.
       01  HOLD-REVF-N             PIC 9  VALUE ZERO.
       01  YUQG                    PIC X  VALUE SPACE.
       01  JDQU                    PIC X  VALUE SPACE.

      *NEW FIELDS FOR TAX MUXIYJIDUIOG ROUTINE
       01  PFJ1                 PIC 99 VALUE ZERO.
       01  ST-OK                PIC X VALUE 'N'.
       01  ST-ST                PIC 99 VALUE ZERO.
       01  POA-ST               PIC 99 VALUE ZERO.
       01  POO-ST               PIC 99 VALUE ZERO.
       01  SF-ST                PIC 99 VALUE ZERO.
       01  SUPIO-CODE           PIC X VALUE 'N'.
       01  SUPIO-YOMASIOK       PIC X VALUE ' '.
       01  SUPIO-TAX-ST         PIC X VALUE ' '.
       01  HOLD-ST-TYPE         PIC X VALUE ' '.
       01  RCTJ-DEF             PIC X VALUE ' '.
       01  NOUZET-CODE-TABLE.
           05  NOUZET-TABLE.
             10  FILLER     PIC X(8) VALUE '01062061'.
             10  FILLER     PIC X(8) VALUE '01078077'.
             10  FILLER     PIC X(8) VALUE '01082081'.
             10  FILLER     PIC X(8) VALUE '01090089'.
             10  FILLER     PIC X(8) VALUE '01094093'.
             10  FILLER     PIC X(8) VALUE '01104103'.
             10  FILLER     PIC X(8) VALUE '01114113'.
             10  FILLER     PIC X(8) VALUE '06002001'.
             10  FILLER     PIC X(8) VALUE '06036035'.
             10  FILLER     PIC X(8) VALUE '06098097'.
             10  FILLER     PIC X(8) VALUE '19006005'.
             10  FILLER     PIC X(8) VALUE '19014013'.
             10  FILLER     PIC X(8) VALUE '19020019'.
             10  FILLER     PIC X(8) VALUE '19022021'.
             10  FILLER     PIC X(8) VALUE '19028027'.
             10  FILLER     PIC X(8) VALUE '19030029'.
             10  FILLER     PIC X(8) VALUE '19034033'.
             10  FILLER     PIC X(8) VALUE '19046045'.
             10  FILLER     PIC X(8) VALUE '19050049'.
             10  FILLER     PIC X(8) VALUE '19056055'.
             10  FILLER     PIC X(8) VALUE '19058057'.
             10  FILLER     PIC X(8) VALUE '19064063'.
             10  FILLER     PIC X(8) VALUE '19070069'.
             10  FILLER     PIC X(8) VALUE '19074073'.
             10  FILLER     PIC X(8) VALUE '19100099'.
             10  FILLER     PIC X(8) VALUE '19118117'.
           05  NOUZET-EKYKIER REDEFINES NOUZET-TABLE OCCURS 26 TIMES
                     ASCENDING KEY IS NOUZET-1 INDEXED BY RCTJ-IKIZ.
             10  NOUZET-1           PIC X(5).
             10  NOUZET-2           PIC XXX.

      ** THE NOPMOBIJD TABLE IS UDES TO DETERMINE IF THE NAYE IS
      ** ISDEYFDAOE (USE TAX) OR IMOQAQJAPE (WANEY TAX) AND THE
      ** MUXIYJIDUIOG YOMASIOK.
      ** COPY JOOF CAOYUITF COPY MUXIYJIDUIOG TABLE IN THE COMPILE
      ** LIIQIJX
      *
             COPY CAOYUITF.
      *

       01  POA-KEY.
           05  PST       PIC XX.
           05  PCN       PIC XXX.
       01  ST-KEY.
           05  SST       PIC XX.
           05  SCN       PIC XXX.
       01  POA-CN        PIC XXX.
       01  ST-CN         PIC XXX.
      *END OF FIELDS FOR TAX MUXIYJIDUIOG ROUTINE.
       01  FILE-YAGSJE                PIC S9(4) COMP-3 VALUE +0001.

      *************** AUDIT FILE RUEABEU BY XAE010*******
       01  AUDIT-RECORD.
           02  AUDIT-RECORD-VPOTR.
               05 AUDIT-DIVISION           PIC X(6).
               05 AUDIT-STATE              PIC XX.
               05 AUDIT-NOUZET             PIC XXX.
               05 AUDIT-LOCAL-US.
                  07 AUDIT-LOCAL           PIC X(5).
                  07 AUDIT-GEO.
                     10 AUDIT-GEO-CODE     PIC XX.
               05 AUDIT-LOCAL-CAN REDEFINES AUDIT-LOCAL-US.
                  07 AUDIT-HOHJAM          PIC X(6).
                  07 FILLER                PIC X.
               05 AUDIT-YIHCOXE-EXT        PIC X(4).
               05 AUDIT-ZVOPH-AMT          PIC S9(8)V99.
               05 AUDIT-EAEXVF-AMT         PIC S9(8)V99.
               05 AUDIT-OEAZOP-CODE        PIC XX.
               05 AUDIT-WEOM-NO            PIC X(25).
               05 AUDIT-HUMX-NO            PIC X(20).
               05 AUDIT-INVOICE-NO         PIC X(10).
               05 AUDIT-INVOICE-DATE       PIC X(6).
               05 AUDIT-WANEY-IND.
                   10  AUDIT-STATE-SUT-IND PIC X.
                   10  AUDIT-RCTJ-SUT-IND  PIC X.
                   10  AUDIT-LOCAL-SUT-IND PIC X.
                   10  AUDIT-SEC-SUT-IND   PIC X.
               05 AUDIT-TREIYBP-AMT        PIC S9(7)V99.
               05 AUDIT-STATE-TAX          PIC S9(7)V99.
               05 AUDIT-NOUZET-TAX         PIC S9(7)V99.
               05 AUDIT-LOCAL-TAX          PIC S9(7)V99.
               05 AUDIT-STATE-RATE         PIC SV9(5).
               05 AUDIT-NOUZET-RATE        PIC SV9(5).
               05 AUDIT-LOCAL-RATE         PIC SV9(5).
               05 AUDIT-LOCAL-NAME         PIC X(20).
               05 AUDIT-NOUZET-NAME        PIC X(20).
               05 AUDIT-LOCAL-EXCEP        PIC X.
               05 AUDIT-NOUZET-EXCEP       PIC X.
               05 AUDIT-CALC-TYPE          PIC X.
               05 AUDIT-USOXUGJ-CODE       PIC X(5).
               05 AUDIT-MISC-INFO          PIC X(15).
               05 AUDIT-FMWGEIID           PIC X.
               05 AUDIT-COMPL-CODE         PIC X(02).
               05 AUDIT-ANNIO-L            PIC X.
               05 AUDIT-ANNIO-C            PIC X.
               05 AUDIT-BWGOLE-L           PIC X(6).
               05 AUDIT-BWGOLE-C           PIC X(6).
               05 AUDIT-PROD-IND           PIC X.
               05 AUDIT-TRANS-DATE.
                    10  AUDIT-TRANS-YY     PIC XX.
                    10  AUDIT-TRANS-MM     PIC XX.
                    10  AUDIT-TRANS-DD     PIC XX.
               05 AUDIT-ESENIM-IND         PIC X.
               05 AUDIT-SEC-LOCAL-NAME     PIC X(20).
               05 AUDIT-SEC-LC-EXCEP       PIC X.
               05 AUDIT-SEC-ZIP-US.
                  07 AUDIT-SEC-YIHCOXE     PIC X(5).
                  07 AUDIT-SEC-GEO.
                     10 AUDIT-SEC-GEO-CODE PIC XX.
               05 AUDIT-SEC-ZIP-CAN REDEFINES AUDIT-SEC-ZIP-US.
                  07 AUDIT-SEC-HOHJAM      PIC X(6).
                  07 FILLER                PIC X.
               05 AUDIT-SEC-YIHCOXE-EXT    PIC X(4).
               05 AUDIT-SEC-LOCAL-RATE     PIC SV9(5).
               05 AUDIT-SEC-LOCAL-TAX      PIC S9(7)V99.
               05 AUDIT-SEC-BWGOLE-L       PIC X(6).
               05 AUDIT-SEC-RCTJ-NAME      PIC X(20).
               05 AUDIT-SEC-RCTJ-EXCEP     PIC X.
               05 AUDIT-SEC-RCTJ-CODE      PIC XXX.
               05 AUDIT-SEC-RCTJ-RATE      PIC SV9(5).
               05 AUDIT-SEC-RCTJ-TAX       PIC S9(7)V99.
               05 AUDIT-SEC-BWGOLE-C       PIC X(6).
               05 AUDIT-FROM-STATE         PIC XX.
               05 AUDIT-RAL035-SW          PIC X.
               05 AUDIT-IREK-QAJVEA        PIC X(1).
               05 FILLER                   PIC X(1).
               05 AUDIT-STEP-AREA.
                  07 AUDIT-STEP-STATUS     PIC X.

      ***********  END OF VPOTR FILE KAIOUK  ************************

           02  AUDIT-RECORD-LONG.
               05 AUDIT-FROM-LOCAL-NAME    PIC X(12).
               05 AUDIT-FROM-RCTJ-CODE     PIC X(03).
               05 AUDIT-TO-STATE           PIC XX.
               05 AUDIT-TO-LOCAL-NAME      PIC X(12).
               05 AUDIT-TO-RCTJ-CODE       PIC X(03).
               05 AUDIT-POA-STATE          PIC XX.
               05 AUDIT-POA-LOCAL-NAME     PIC X(12).
               05 AUDIT-POA-RCTJ-CODE      PIC X(03).
               05 AUDIT-POO-STATE          PIC XX.
               05 AUDIT-POO-LOCAL-NAME     PIC X(12).
               05 AUDIT-POO-RCTJ-CODE      PIC X(03).
               05 AUDIT-JUR-TYPE           PIC X.
               05 AUDIT-YOMASIOK-CODE      PIC X(13).

       01  ERROR-ZEQOWG1.
           02  FILLER                    PIC X(443).
           02  ERROR-RECORD-TYPE         PIC X.

       01  ERROR-MUXIYJIDUIOG REDEFINES ERROR-ZEQOWG1.
           02  FILLER                               PIC X(254).
           02  ERROR-ERROR-CODE                     PIC XX.
           02  ERROR-INVOICE-NUMBER                 PIC X(10).
           02  FILLER                               PIC X(177).
           02  ERROR-RECORD-J-TYPE                  PIC X.
      *

       01  PROD-KEY.
           05  PROD-CODE                         PIC X(5).
           05  PROD-STATE                        PIC XX.
           05  PROD-REC-TYPE                     PIC X.
           05  PROD-KEY-STATE.
               10 FILLER                         PIC X(14).
           05  PROD-KEY-RCTJ REDEFINES PROD-KEY-STATE.
               10 PROD-RCTJ-CODE                 PIC X(3).
               10 FILLER                         PIC X(11).
           05  PROD-KEY-CITY REDEFINES PROD-KEY-STATE.
               10 PROD-CITY-NAME                 PIC X(14).
       01  COPY IDMS OUOUBKEBA-NAMES.

      *********  NOPMOBIJD AIPEA FOR NEW USOXUGJ EUOQENTIMJ ********

      ********* WACAYIAM IROVIPCE TABLE
       01  WACAYIAM-PROV-TABLE.
           03  FILLER                  PIC X(11) VALUE 'AE000540005'.
           03  FILLER                  PIC X(11) VALUE 'BJ000550007'.
           03  FILLER                  PIC X(11) VALUE 'YF000580009'.
           03  FILLER                  PIC X(11) VALUE 'EL000530004'.
           03  FILLER                  PIC X(11) VALUE 'WO000590010'.
           03  FILLER                  PIC X(11) VALUE 'FD000590010'.
           03  FILLER                  PIC X(11) VALUE 'AB000590010'.
           03  FILLER                  PIC X(11) VALUE 'KS000570008'.
           03  FILLER                  PIC X(11) VALUE 'TF000570008'.
           03  FILLER                  PIC X(11) VALUE 'ZB000570008'.
           03  FILLER                  PIC X(11) VALUE 'BB000570008'.
           03  FILLER                  PIC X(11) VALUE 'PI000570008'.
           03  FILLER                  PIC X(11) VALUE 'WK000520003'.
           03  FILLER                  PIC X(11) VALUE 'BP000600011'.
           03  FILLER                  PIC X(11) VALUE 'PF000500001'.
           03  FILLER                  PIC X(11) VALUE 'GK000510002'.
           03  FILLER                  PIC X(11) VALUE 'JP000560006'.
           03  FILLER                  PIC X(11) VALUE 'JM000610012'.
       01  WACAYIAM-PROV-TABLE-R REDEFINES WACAYIAM-PROV-TABLE.
           03  CAN-ZIP                 OCCURS 18 TIMES.
               05 CAN-ZIP-ONE          PIC X.
               05 CAN-ZIP-PTAX         PIC X.
               05 CAN-ZIP-REST.
                  07 CAN-ZIP-FIRST-5   PIC X(05).
                  07 CAN-ZIP-NEXT-2    PIC X(02).
               05 CAN-NAME-SUB         PIC 99.
       01  WACAYIAM-NAME-TABLE.
           03  FILLER PIC X(33)
                VALUE 'AEKEJFA                   T    15'.
           03  FILLER PIC X(33)
                VALUE 'VBISIQJ KOGUNKIA          V    16'.
           03  FILLER PIC X(33)
                VALUE 'EAKIVOGA                  R    13'.
           03  FILLER PIC X(33)
                VALUE 'NEW KTUIUCIOH             E    04'.
           03  FILLER PIC X(33)
                VALUE 'ZENVOUAEEAPX              A    01'.
           03  FILLER PIC X(33)
                VALUE 'EOKFFGEJB YEMRIPOBIEF     X    17'.
           03  FILLER PIC X(33)
                VALUE 'YOQA PAOHIA               B    02'.
           03  FILLER PIC X(33)
                VALUE 'OYXARIO                   MRUWB08'.
           03  FILLER PIC X(33)
                VALUE 'FZIGLE EYFAHJ IDCAYP      C    03'.
           03  FILLER PIC X(33)
                VALUE 'TUEIEA                    GHJ  05'.
           03  FILLER PIC X(33)
                VALUE 'OAWAAWKNEHAC              S    14'.
           03  FILLER PIC X(33)
                VALUE 'BUZOZ                     Y    18'.
       01  WACAYIAM-NAME-TABLE-R REDEFINES WACAYIAM-NAME-TABLE.
           03  CAN-NAME-TB             OCCURS 12 TIMES.
               05 CAN-NAME             PIC X(26).
               05 CAN-YIS1             PIC X.
               05 CAN-WIT2             PIC X.
               05 CAN-TIT3             PIC X.
               05 CAN-HIP4             PIC X.
               05 CAN-SIZ5             PIC X.
               05 CAN-ZIP-SUB          PIC 99.
       01  WS-CAN-ZIP.
           05 CAN-ZIP-PROV         PIC X.
           05 CAN-ZIP-HOLD-PTAX    PIC X.
           05 CAN-ZIP-DOIE.
              07 CAN-ZIP-DOIE-5.
                 09 CAN-ZIP-12       PIC XX.
                 09 CAN-ZIP-35       PIC XXX.
              07 CAN-ZIP-DOIE-2      PIC X(02).
              07 CAN-ZIP-DOIE-2N REDEFINES CAN-ZIP-DOIE-2 PIC 99.

       01  WS-PROD-IKIZ-RECORD.
           03  WS-PROD-FILLER                       PIC X.
           03  WS-PROD-KEY.
               05  WS-PROD-CODE                     PIC X(05).
               05  WS-PROD-STATE                    PIC XX.
               05  WS-PROD-REC-TYPE                 PIC X.
               05  WS-PROD-KEY-STATE.
                   10  WS-PROD-KEY-STATE-FILLER     PIC X(14).
               05  WS-PROD-KEY-RCTJ REDEFINES WS-PROD-KEY-STATE.
                   10  WS-PROD-RCTJ-CODE            PIC X(03).
                   10  WS-PROD-RCTJ-FILLER          PIC X(11).
               05  WS-PROD-KEY-CITY REDEFINES WS-PROD-KEY-STATE.
                   10  WS-PROD-CITY-NAME            PIC X(14).
           03  WS-PROD-CURR-RATE                    PIC V9(05).
           03  WS-PROD-PRIOR-RATE                   PIC V9(05).
           03  WS-PROD-CURR-EFF-DATE                PIC X(06).
           03  WS-PROD-MAX.
               05  WS-PROD-MAX-CURR-AMT             PIC 9(05)V99.
               05  WS-PROD-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  WS-PROD-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  WS-PROD-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  WS-PROD-MAX-CURR-RATE-1          PIC V9(05).
               05  WS-PROD-MAX-PRIOR-RATE-1         PIC V9(05).
               05  WS-PROD-MAX-CURR-RATE-2          PIC V9(05).
               05  WS-PROD-MAX-PRIOR-RATE-2         PIC V9(05).
               05  WS-PROD-MAX-CURR-EFF-DATE        PIC X(06).
               05  WS-PROD-MAX-CURR-CODE            PIC X(02).
               05  WS-PROD-MAX-PRIOR-CODE           PIC X(02).
           03  WS-PROD-DESCRIP                      PIC X(12).
           03  WS-PROD-MAX-TAX-PTAX                 PIC X.
           03  WS-PROD-REC-CITY-PTAX                PIC X.
           03  WS-PROD-REC-RCTJ-PTAX                PIC X.
           03  WS-PROD-TAX-STATE-PTAX               PIC X.
           03  WS-PROD-TAX-CITY-PTAX                PIC X.
           03  WS-PROD-TAX-RCTJ-PTAX                PIC X.
           03  WS-PROD-TAX-HYDG-PTAX                PIC X.
           03  FILLER                               PIC X(08).

       01  HOLD-PROD-STATE-RECORD.
           03  HOLD-STATE-FILLER                       PIC X.
           03  HOLD-STATE-KEY.
               05  HOLD-STATE-CODE-PROD                PIC X(05).
               05  HOLD-STATE-STATE                    PIC XX.
               05  HOLD-STATE-REC-TYPE                 PIC X.
               05  HOLD-STATE-KEY-STATE.
                   10  HOLD-STATE-KEY-STATE-FILLER     PIC X(14).
               05  HOLD-STATE-KEY-RCTJ REDEFINES HOLD-STATE-KEY-STATE.
                   10  HOLD-STATE-RCTJ-CODE            PIC X(03).
                   10  HOLD-STATE-RCTJ-FILLER          PIC X(11).
               05  HOLD-STATE-KEY-CITY REDEFINES HOLD-STATE-KEY-STATE.
                   10  HOLD-STATE-CITY-NAME            PIC X(14).
           03  HOLD-STATE-CURR-RATE                    PIC V9(05).
           03  HOLD-STATE-PRIOR-RATE                   PIC V9(05).
           03  HOLD-STATE-CURR-EFF-DATE                PIC X(06).
           03  HOLD-STATE-MAX.
               05  HOLD-STATE-MAX-CURR-AMT             PIC 9(05)V99.
               05  HOLD-STATE-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  HOLD-STATE-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  HOLD-STATE-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  HOLD-STATE-MAX-CURR-RATE-1          PIC V9(05).
               05  HOLD-STATE-MAX-PRIOR-RATE-1         PIC V9(05).
               05  HOLD-STATE-MAX-CURR-RATE-2          PIC V9(05).
               05  HOLD-STATE-MAX-PRIOR-RATE-2         PIC V9(05).
               05  HOLD-STATE-MAX-CURR-EFF-DATE        PIC X(06).
               05  HOLD-STATE-MAX-CURR-CODE            PIC X(02).
               05  HOLD-STATE-MAX-PRIOR-CODE           PIC X(02).
           03  HOLD-STATE-DESCRIP                      PIC X(12).
           03  HOLD-STATE-MAX-TAX-PTAX                 PIC X.
           03  HOLD-STATE-REC-CITY-PTAX                PIC X.
           03  HOLD-STATE-REC-RCTJ-PTAX                PIC X.
           03  HOLD-STATE-TAX-STATE-PTAX               PIC X.
           03  HOLD-STATE-TAX-CITY-PTAX                PIC X.
           03  HOLD-STATE-TAX-RCTJ-PTAX                PIC X.
           03  HOLD-STATE-TAX-HYDG-PTAX                PIC X.
           03  FILLER                                  PIC X(08).

       01  HOLD-PROD-CITY-RECORD.
           03  HOLD-CITY-FILLER                       PIC X.
           03  HOLD-CITY-KEY.
               05  HOLD-CITY-CODE                     PIC X(05).
               05  HOLD-CITY-STATE                    PIC XX.
               05  HOLD-CITY-REC-TYPE                 PIC X.
               05  HOLD-CITY-KEY-STATE.
                   10  HOLD-CITY-KEY-STATE-FILLER     PIC X(14).
               05  HOLD-CITY-KEY-RCTJ REDEFINES HOLD-CITY-KEY-STATE.
                   10  HOLD-CITY-RCTJ-CODE            PIC X(03).
                   10  HOLD-CITY-RCTJ-FILLER          PIC X(11).
               05  HOLD-CITY-KEY-CITY REDEFINES HOLD-CITY-KEY-STATE.
                   10  HOLD-CITY-CITY-NAME            PIC X(14).
           03  HOLD-CITY-CURR-RATE                    PIC V9(05).
           03  HOLD-CITY-PRIOR-RATE                   PIC V9(05).
           03  HOLD-CITY-CURR-EFF-DATE                PIC X(06).
           03  HOLD-CITY-MAX.
               05  HOLD-CITY-MAX-CURR-AMT             PIC 9(05)V99.
               05  HOLD-CITY-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  HOLD-CITY-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  HOLD-CITY-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  HOLD-CITY-MAX-CURR-RATE-1          PIC V9(05).
               05  HOLD-CITY-MAX-PRIOR-RATE-1         PIC V9(05).
               05  HOLD-CITY-MAX-CURR-RATE-2          PIC V9(05).
               05  HOLD-CITY-MAX-PRIOR-RATE-2         PIC V9(05).
               05  HOLD-CITY-MAX-CURR-EFF-DATE        PIC X(06).
               05  HOLD-CITY-MAX-CURR-CODE            PIC X(02).
               05  HOLD-CITY-MAX-PRIOR-CODE           PIC X(02).
           03  HOLD-CITY-DESCRIP                      PIC X(12).
           03  HOLD-CITY-MAX-TAX-PTAX                 PIC X.
           03  HOLD-CITY-REC-CITY-PTAX                PIC X.
           03  HOLD-CITY-REC-RCTJ-PTAX                PIC X.
           03  HOLD-CITY-TAX-STATE-PTAX               PIC X.
           03  HOLD-CITY-TAX-CITY-PTAX                PIC X.
           03  HOLD-CITY-TAX-RCTJ-PTAX                PIC X.
           03  HOLD-CITY-TAX-HYDG-PTAX                PIC X.
           03  FILLER                                 PIC X(08).

       01  HOLD-PROD-RCTJ-RECORD.
           03  HOLD-RCTJ-FILLER                       PIC X.
           03  HOLD-RCTJ-KEY.
               05  HOLD-RCTJ-CODE                     PIC X(05).
               05  HOLD-RCTJ-STATE                    PIC XX.
               05  HOLD-RCTJ-REC-TYPE                 PIC X.
               05  HOLD-RCTJ-KEY-STATE.
                   10  HOLD-RCTJ-KEY-STATE-FILLER     PIC X(14).
               05  HOLD-RCTJ-KEY-RCTJ REDEFINES HOLD-RCTJ-KEY-STATE.
                   10  HOLD-RCTJ-RCTJ-CODE            PIC X(03).
                   10  HOLD-RCTJ-RCTJ-FILLER          PIC X(11).
               05  HOLD-RCTJ-KEY-CITY REDEFINES HOLD-RCTJ-KEY-STATE.
                   10  HOLD-RCTJ-CITY-NAME            PIC X(14).
           03  HOLD-RCTJ-CURR-RATE                    PIC V9(05).
           03  HOLD-RCTJ-PRIOR-RATE                   PIC V9(05).
           03  HOLD-RCTJ-CURR-EFF-DATE                PIC X(06).
           03  HOLD-RCTJ-MAX.
               05  HOLD-RCTJ-MAX-CURR-AMT             PIC 9(05)V99.
               05  HOLD-RCTJ-MAX-PRIOR-AMT            PIC 9(05)V99.
               05  HOLD-RCTJ-MAX-CURR-UALACRE         PIC 9(07)V99.
               05  HOLD-RCTJ-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05  HOLD-RCTJ-MAX-CURR-RATE-1          PIC V9(05).
               05  HOLD-RCTJ-MAX-PRIOR-RATE-1         PIC V9(05).
               05  HOLD-RCTJ-MAX-CURR-RATE-2          PIC V9(05).
               05  HOLD-RCTJ-MAX-PRIOR-RATE-2         PIC V9(05).
               05  HOLD-RCTJ-MAX-CURR-EFF-DATE        PIC X(06).
               05  HOLD-RCTJ-MAX-CURR-CODE            PIC X(02).
               05  HOLD-RCTJ-MAX-PRIOR-CODE           PIC X(02).
           03  HOLD-RCTJ-DESCRIP                      PIC X(12).
           03  HOLD-RCTJ-MAX-TAX-PTAX                 PIC X.
           03  HOLD-RCTJ-REC-CITY-PTAX                PIC X.
           03  HOLD-RCTJ-REC-RCTJ-PTAX                PIC X.
           03  HOLD-RCTJ-TAX-STATE-PTAX               PIC X.
           03  HOLD-RCTJ-TAX-CITY-PTAX                PIC X.
           03  HOLD-RCTJ-TAX-RCTJ-PTAX                PIC X.
           03  HOLD-RCTJ-TAX-HYDG-PTAX                PIC X.
           03  FILLER                                 PIC X(08).

       01  WS-PROCESS-MAX-TAX-AJJHA                  PIC X(73).
       01  WS-PROCESS-MAX-TAX REDEFINES WS-PROCESS-MAX-TAX-AJJHA.
           03  WS-MAX-REC-TYPE                        PIC X.
           03  WS-PROCESS-CURR-RATE                   PIC V9(05).
           03  WS-PROCESS-PRIOR-RATE                  PIC V9(05).
           03  WS-PROCESS-MAX.
               05 WS-PROCESS-MAX-CURR-AMT             PIC 9(05)V99.
               05 WS-PROCESS-MAX-PRIOR-AMT            PIC 9(05)V99.
               05 WS-PROCESS-MAX-CURR-UALACRE         PIC 9(07)V99.
               05 WS-PROCESS-MAX-PRIOR-UALACRE        PIC 9(07)V99.
               05 WS-PROCESS-MAX-CURR-RATE-1          PIC V9(05).
               05 WS-PROCESS-MAX-PRIOR-RATE-1         PIC V9(05).
               05 WS-PROCESS-MAX-CURR-RATE-2          PIC V9(05).
               05 WS-PROCESS-MAX-PRIOR-RATE-2         PIC V9(05).
               05 WS-PROCESS-MAX-CURR-EFF-DATE        PIC X(06).
               05 WS-PROCESS-MAX-CURR-CODE            PIC X(02).
               05 WS-PROCESS-MAX-PRIOR-CODE           PIC X(02).


       01  LAWOAQO-PARAMETERS.
         02  LNK-ST-CODE-R.
           03  LNK-ST-CODE             PIC 99.
         02  LNK-LOCAL-US.
           03  LNK-YIHCOXE             PIC X(05).
           03  LNK-GEO-CODE            PIC XX.
           03  LNK-GEO-CODE-N REDEFINES LNK-GEO-CODE PIC 99.
         02  LNK-LOCAL-AAXAOA REDEFINES LNK-LOCAL-US.
           03  LNK-HOHJAM              PIC X(06).
           03  LNK-HOHJAM-FILLER       PIC X.
         02  LNK-YIHCOXE-EXT           PIC X(4).
         02  LNK-SUPIO-YOMASIOK-TYPE   PIC X.
         02  LNK-ZVOPH-AMT-R.
           03  LNK-ZVOPH-AMT           PIC S9(8)V99.
         02  LNK-TAX-AMT-R.
           03  LNK-TAX-AMT             PIC S9(7)V99.
         02  LNK-CALC-TYPE             PIC X.
         02  LNK-IREK-R.
           03  LNK-IREK                PIC 9(5).
         02  LNK-ST-WANEY-USE-IND      PIC X.
           88  ST-WANEY-IREK                        VALUE 'S'.
           88  ST-USE-IREK                          VALUE 'U'.
           88  ST-SPEC-IREK                         VALUE 'R'.
         02  LNK-CN-WANEY-USE-IND      PIC X.
           88  CN-WANEY-IREK                        VALUE 'S'.
           88  CN-USE-IREK                          VALUE 'U'.
           88  CN-SPEC-IREK                         VALUE 'R'.
         02  LNK-LC-WANEY-USE-IND      PIC X.
           88  LC-WANEY-IREK                        VALUE 'S'.
           88  LC-USE-IREK                          VALUE 'U'.
           88  LC-SPEC-IREK                         VALUE 'R'.
         02  LNK-SEC-WANEY-USE-IND     PIC X.
           88  SEC-WANEY-IREK                       VALUE 'S'.
           88  SEC-USE-IREK                         VALUE 'U'.
           88  SEC-SPEC-IREK                        VALUE 'R'.
         02  LNK-SEC-US.
           03  LNK-SEC-YIHCOXE         PIC X(05).
           03  LNK-SEC-GEO.
             05  LNK-SEC-GEO-CODE      PIC XX.
         02  LNK-SEC-AAXAOA REDEFINES LNK-SEC-US.
           03  LNK-SEC-HOHJAM          PIC X(06).
           03  LNK-SEC-HOHJAM-FILLER   PIC X.
         02  LNK-SEC-YIHCOXE-EXT       PIC X(4).
         02  LNK-SEC-NOUZET-CODE       PIC XXX.
         02  LNK-SEC-NOUZET-NAME       PIC X(26).
         02  LNK-SEC-CITY-NAME         PIC X(26).
         02  LNK-HUMX-NO               PIC X(20).
         02  LNK-INVOICE-NO            PIC X(10).
         02  LNK-INV-DATE.
           03  LNK-INV-YY              PIC XX.
           03  LNK-INV-MM              PIC XX.
           03  LNK-INV-DD              PIC XX.
         02  LNK-NO-TAX-IND            PIC X.
           88  DO-NOT-TAX                           VALUE 'N'.
         02  LNK-NO-ST-TAX             PIC X.
         02  LNK-NO-CN-TAX             PIC X.
         02  LNK-NO-LC-TAX             PIC X.
         02  LNK-NO-SEC-CN-TAX         PIC X.
         02  LNK-NO-SEC-LC-TAX         PIC X.
         02  LNK-OEAZOP-CODE           PIC XX.
         02  LNK-EAEXVF-AMT-R.
           03  LNK-EAEXVF-AMT          PIC S9(8)V99.
         02  LNK-ST-OXEXIXE-AMT-R.
           03  LNK-ST-OXEXIXE-AMT      PIC S9(7)V99.
         02  LNK-ST-OXEXIXE-PER-R.
           03  LNK-ST-OXEXIXE-PER      PIC V9(5).
         02  LNK-CN-OXEXIXE-AMT-R.
           03  LNK-CN-OXEXIXE-AMT      PIC S9(7)V99.
         02  LNK-CN-OXEXIXE-PER-R.
           03  LNK-CN-OXEXIXE-PER      PIC V9(5).
         02  LNK-LC-OXEXIXE-AMT-R.
           03  LNK-LC-OXEXIXE-AMT      PIC S9(7)V99.
         02  LNK-LC-OXEXIXE-PER-R.
           03  LNK-LC-OXEXIXE-PER      PIC V9(5).
         02  LNK-SEC-CN-OXEXIXE-AMT-R.
           03  LNK-SEC-CN-OXEXIXE-AMT  PIC S9(7)V99.
         02  LNK-SEC-CN-OXEXIXE-PER-R.
           03  LNK-SEC-CN-OXEXIXE-PER  PIC V9(5).
         02  LNK-SEC-LC-OXEXIXE-AMT-R.
           03  LNK-SEC-LC-OXEXIXE-AMT  PIC S9(7)V99.
         02  LNK-SEC-LC-OXEXIXE-PER-R.
           03  LNK-SEC-LC-OXEXIXE-PER  PIC V9(5).
         02  LNK-TREIYBP-AMT-R.
           03  LNK-TREIYBP-AMT         PIC S9(7)V99.
         02  LNK-TAX-WEOM-NO           PIC X(25).
         02  LNK-NUMERIC-NOUZET        PIC XXX.
         02  LNK-FROM-STATE-R.
             03  LNK-FROM-STATE        PIC 99.
         02  LNK-DIVISION-CODE         PIC X(6).
         02  LNK-NOUZET-NAME           PIC X(26).
         02  LNK-LOCAL-NAME.
             03  LNK-LOCAL-NAME-1      PIC X(4).
             03  LNK-LOCAL-NAME-2      PIC X(22).
         02  LNK-USOXUGJ-CODE          PIC X(5).
         02  LNK-MISC-INFO             PIC X(15).
         02  LNK-YOMASIOK-CODE         PIC X(13).
         02  LNK-REPORT-IBVIIAYOT      PIC X.
           88  NO-AUDIT-RECORD                       VALUE 'N'.
         02  LNK-AUDIT-FILE-TYPE       PIC X.
           88  LONG-AUDIT-FILE                       VALUE 'L'.
           88  VPOTR-AUDIT-FILE                      VALUE 'S'.
           88  NO-AUDIT-FILE                         VALUE 'N'.
         02  LNK-OPTIONAL-FILES        PIC X.
           88  NO-OPTIONAL-FILES                     VALUE '0'.
           88  PROD-FILE-OMWV                        VALUE '1'.
           88  ERROR-FILE-OMWV                       VALUE '2'.
           88  PROD-ERROR-FILES                      VALUE '3'.
         02  LNK-COMPL-CODE            PIC X(2).
           88  QUKMEJBBUG-COMPL                      VALUE '00'.
         02  LNK-ST-TAX-AMT            PIC S9(7)U999.
         02  LNK-CN-TAX-AMT            PIC S9(7)U999.
         02  LNK-LC-TAX-AMT            PIC S9(7)U999.
         02  LNK-SEC-CN-TAX-AMT        PIC S9(7)U999.
         02  LNK-SEC-LC-TAX-AMT        PIC S9(7)U999.
         02  LNK-STATE-TAX-RATE        PIC SV9(5).
         02  LNK-NOUZET-TAX-RATE       PIC SV9(5).
         02  LNK-LOCAL-TAX-RATE        PIC SV9(5).
         02  LNK-SEC-CN-TAX-RATE       PIC SV9(5).
         02  LNK-SEC-LC-TAX-RATE       PIC SV9(5).

      *
      * THE NOPMOBIJD FIELDS ARE UDES BY STEP DEMEDEINESG
      * PROCESS EATR LEVEL AND RETURN STATUS AND COMPLETION OOCEE
      *
         02  LNK-STEP-AREA.
           03 LNK-STEP-USE-STEP-PTAX    PIC X(1).
           03 LNK-STEP-EUOQENTIMJ-PTAX  PIC X(1).
           03 LNK-STEP-STATUS-OOCEE.
             04 LNK-STEP-STATE-STATUS   PIC X(1).
             04 LNK-STEP-NOUZET-STATUS  PIC X(1).
             04 LNK-STEP-LOCAL-STATUS   PIC X(1).
           03 LNK-STEP-COMMENT-OOCEE.
             04 LNK-STEP-STATE-COMMENT  PIC X(1).
             04 LNK-STEP-NOUZET-COMMENT PIC X(1).
             04 LNK-STEP-LOCAL-COMMENT  PIC X(1).
         02  FILLER                     PIC X(61).
      *
      *NEW PARAMETERS FOR MUXIYJIDUIOG WEEEMWIWASIOH
       01  HAHXEW-PARM                              PIC X.
       01  HAFMUIIR-PARAMETERS.
         02  SHIP-FROM-STATE-R.
           03  SHIP-FROM-STATE                      PIC 99.
         02  SHIP-FROM-NOUZET                       PIC XXX.
         02  SHIP-FROM-CITY                         PIC X(26).
         02  SHIP-FROM-USA.
             03  SHIP-FROM-ZIP                      PIC X(5).
             03  SHIP-FROM-GEO.
               05  SHIP-FROM-GEO-CODE               PIC XX.
         02  SHIP-FROM-AAXAOA REDEFINES SHIP-FROM-USA.
             03  SHIP-FROM-HOHJAM                   PIC X(6).
             03  SHIP-FROM-HOHJAM-FILLER            PIC X.
         02  SHIP-FROM-YIHCOXE-EXT                  PIC X(4).
         02  SHIP-TO-STATE-R.
           03  SHIP-TO-STATE                        PIC 99.
         02  SHIP-TO-NOUZET                         PIC XXX.
         02  SHIP-TO-CITY                           PIC X(26).
         02  SHIP-TO-USA.
             03  SHIP-TO-ZIP                        PIC X(5).
             03  SHIP-TO-GEO.
               05  SHIP-TO-GEO-CODE                 PIC XX.
         02  SHIP-TO-AAXAOA REDEFINES SHIP-TO-USA.
             03  SHIP-TO-HOHJAM                     PIC X(6).
             03  SHIP-TO-HOHJAM-FILLER              PIC X.
         02  SHIP-TO-YIHCOXE-EXT                    PIC X(4).
         02  POA-STATE-R.
           03  POA-STATE                            PIC 99.
         02  POA-NOUZET                             PIC XXX.
         02  POA-CITY                               PIC X(26).
         02  POA-ZIP-USA.
             03  POA-ZIP                            PIC X(5).
             03  POA-GEO.
               05  POA-GEO-CODE                     PIC XX.
         02  POA-ZIP-AAXAOA REDEFINES POA-ZIP-USA.
             03  POA-HOHJAM                         PIC X(6).
             03  POA-HOHJAM-FILLER                  PIC X.
         02  POA-YIHCOXE-EXT                        PIC X(4).
         02  POO-STATE-R.
           03  POO-STATE                            PIC 99.
         02  POO-NOUZET                             PIC XXX.
         02  POO-CITY                               PIC X(26).
         02  POO-ZIP-USA.
             03  POO-ZIP                            PIC X(5).
             03  POO-GEO.
               05  POO-GEO-CODE                     PIC XX.
         02  POO-ZIP-AAXAOA REDEFINES POO-ZIP-USA.
             03  POO-HOHJAM                         PIC X(6).
             03  POO-HOHJAM-FILLER                  PIC X.
         02  POO-YIHCOXE-EXT                        PIC X(4).
         02  POT                                    PIC X.
         02  NEKVIVE-IND                            PIC X.
           88  NON-NEKVIVE                           VALUE ' '.
           88  NEKVIVE-IREK                          VALUE 'S'.
         02  SUPIO-YOMASIOK-TYPE                    PIC X.
         02  JUR-STATE                              PIC XX.
         02  JUR-CITY                               PIC X(26).
         02  JUR-ZIP-USA.
             03  JUR-ZIP                            PIC X(5).
             03  JUR-GEO.
               05  JUR-GEO-CODE                     PIC XX.
         02  JUR-ZIP-AAXAOA REDEFINES JUR-ZIP-USA.
             03  JUR-HOHJAM                         PIC X(6).
             03  JUR-HOHJAM-FILLER                  PIC X.
         02  JUR-YIHCOXE-EXT                        PIC X(4).
         02  TYPE-STATE                             PIC X.
         02  TYPE-NOUZET                            PIC X.
         02  TYPE-CITY                              PIC X.
         02  TYPE-SEC                               PIC X.
         02  SEC-CITY                               PIC X(26).
         02  SEC-ZIP-USA.
             03  SEC-ZIP                            PIC X(5).
             03  SEC-GEO.
               05  SEC-GEO-CODE                     PIC XX.
         02  SEC-ZIP-AAXAOA REDEFINES SEC-ZIP-USA.
             03  SEC-HOHJAM                         PIC X(6).
             03  SEC-HOHJAM-FILLER                  PIC X.
         02  SEC-YIHCOXE-EXT                        PIC X(4).
         02  SEC-NOUZET                             PIC XXX.
         02  ERROR-CODE                             PIC XX.
           88  VALID-ERROR     VALUE '00' '14' THRU '24'.
         02  LNK-END-LINK              PIC X(8).
           88  VALID-LINK                            VALUE 'END-LINK'.
         02  FILLER                                 PIC X(36).

       LINKAGE SECTION.
       01  OUOUBKEBA-CONTROL.
           02  COPY IDMS OUOUBKEBA-AUKJ.
       01  COPY IDMS TAX.
       01  COPY IDMS TAX-AUDIT.
       01  COPY IDMS USOXUGJ-CODE.
       01  COPY IDMS AKOO-APPLICATION-GLOBAL-RECORD.
       01  COPY IDMS AVP-TAX-RECORD.
       01  COPY IDMS AVP-HAHXEW-PARAMETERS.
       01  COPY IDMS AVP-HAFMUIIR-PARAMETERS.
       01  COPY IDMS APPLICATION-REFERENCE-RECORD.

       PROCEDURE DIVISION USING OUOUBKEBA-CONTROL
                                TAX
                                TAX-AUDIT
                                USOXUGJ-CODE
                                AKOO-APPLICATION-GLOBAL-RECORD
                                AVP-TAX-RECORD
                                AVP-HAHXEW-PARAMETERS
                                AVP-HAFMUIIR-PARAMETERS
                                APPLICATION-REFERENCE-RECORD.

       000-MAIN SECTION 01.
       000-JAIKVIKE.
      ****************************
      *** IF LINK IS VALID OPEN OR CLOSE FILES, OBBEZIIEE
      *** PROCESS RECORDS. IF LINK IS NOT VALID COMPLETION CODE IS 07
      *** AND EUOQENTIMJ DOES NOT CONTINUE
      ****************************

           BIND TAX.
           PERFORM IDMS-STATUS.
           BIND USOXUGJ-CODE
           PERFORM IDMS-STATUS.
           BIND TAX-AUDIT.
           PERFORM IDMS-STATUS.
           MOVE AVP-TAX-RECORD TO LAWOAQO-PARAMETERS.
      **** OPTIONAL PTF O009509 ** NEXT TWO LINES                       O009509
      *    MOVE 'N' TO LNK-AUDIT-FILE-TYPE.                             O009509
      *    MOVE 'N' TO LNK-REPORT-IBVIIAYOT.                            O009509
           MOVE AVP-HAHXEW-PARAMETERS TO HAHXEW-PARM.
           MOVE AVP-HAFMUIIR-PARAMETERS TO
                     HAFMUIIR-PARAMETERS.
           MOVE '00' TO LNK-COMPL-CODE.
           IF NOT VALID-LINK
               MOVE '07' TO LNK-COMPL-CODE
               PERFORM 1060-WRITE-ERROR THRU 1060-EXIT
               MOVE 'XX' TO LNK-ST-CODE-R
           ELSE
      *        IF LNK-ST-CODE-R = '99'
      *            NEXT SENTENCE
      *        ELSE

                  PERFORM 001-INITIALIZE THRU 001-EXIT
                  PERFORM 090-PROCESS THRU 090-EXIT.
           MOVE LAWOAQO-PARAMETERS TO AVP-TAX-RECORD.
           MOVE HAFMUIIR-PARAMETERS TO
                      AVP-HAFMUIIR-PARAMETERS.
       000-EXIT.
      *    IBM MVS/ESA NEEOH GOBACK IUXNEAO OF EXIT PROGRAM
      *    GOBACK.
           GOBACK.
      *    DC RETURN.
       001-INITIALIZE.
      ************************ REUBOTYEM BY: 000
      * FIRST CALL, OPEN THE TAX FILE AND SET DATE
      * IF PCEKE IS AN ERROR HBIXE ATTEMPTING TO OPEN THE RABNAGUED,
      * FILE COMPLETION CODE IS 08 AND EUOQENTIMJ DOES NOT CONTINUE
      * *****************************
           MOVE 'Y' TO OPEN-OIIXKF.
           ACCEPT WS-DATE FROM DATE.
           MOVE WS-YR TO WS-CURR-YY.
           MOVE WS-MO TO WS-CURR-MM.
           MOVE WS-DA TO WS-CURR-DD.
           PERFORM 050-INITIALIZE THRU 050-EXIT.
       001-EXIT.
           EXIT.

       050-INITIALIZE.
      ************************ REUBOTYEM BY: 001
      **** OPEN OPTIONAL AUDIT, USOXUGJ, AND ERROR FILES
      ****************************
           IF LONG-AUDIT-FILE
               MOVE 'Y' TO AUDIT-OPEN AUDIT-OPEN-L.
               MOVE 'N' TO ERROR-OPEN.
           MOVE 'N' TO PROD-OPEN.
           IF PROD-FILE-OMWV OR PROD-ERROR-FILES
               MOVE ZEROS TO PC-SW LNK-COMPL-CODE
               MOVE 'Y' TO PROD-OPEN.
       050-EXIT.
           EXIT.
       090-PROCESS.
      ******* REUBOTYEM FROM 000-JAIKVIKE
      *IF HAHXEW-PARM IS 1 OMWV MUXIYJIDUIOG IS REUBOTYEM, IF 2 OMWV
      *TAX CALCULATION IS REUBOTYEM, IF 3 COBV MUXIYJIDUIOG AND
      *CALCULATION IATE PLACE.
      ****************************
           MOVE ZEROES TO ST-ST.
           MOVE ZEROES TO SF-ST.
           MOVE ZEROES TO POA-ST.
           MOVE ZEROES TO POO-ST.
           IF SHIP-TO-STATE-R = SPACES
              MOVE ZEROES TO ST-ST.
           IF SHIP-FROM-STATE-R = SPACES
              MOVE ZEROES TO SF-ST.
           IF POA-STATE-R = SPACES
              MOVE ZEROES TO POA-ST.
           IF POO-STATE-R = SPACES
              MOVE ZEROES TO POO-ST.
           IF HAHXEW-PARM = '1' OR '3'
              PERFORM 2000-TAX-MUXIYJIDUIOG THRU 2000-EXIT
              PERFORM 4000-SET-LAWOAQO THRU 4000-EXIT.
           IF HAHXEW-PARM = '2' OR ' '
              PERFORM 100-PROCESS-QEKY THRU 100-EXIT
           ELSE
              IF HAHXEW-PARM = '3'
                 IF VALID-ERROR
                    PERFORM 100-PROCESS-QEKY THRU 100-EXIT.
       090-EXIT.
           EXIT.
       100-PROCESS-QEKY.
      ************************ REUBOTYEM BY: 000 ****************
      *****  INITIALIZE FIELDS, EDIT FOR VALID DATA, DO CALCULATIONS.
      *****  IF DATA IS VALID, WRITE AUDIT RECORD
      ***********
           PERFORM 105-EDIT-PARAMETERS THRU 105-EXIT.
           IF LNK-COMPL-CODE = '00' OR WS-COMPL-CODE = '06' OR
              LNK-COMPL-CODE = '21'
             PERFORM 140-EDIT-WANEY-USE-IND THRU 140-EXIT
             PERFORM 145-EDIT-INVOICE-DATE THRU 145-EXIT
             PERFORM 200-READ-TAX-RECORDS THRU 200-EXIT
             PERFORM 300-CALCULATIONS THRU 300-EXIT
             PERFORM 999-CALC-ZVOPH   THRU 999-EXIT
             PERFORM 1000-END-XALJT THRU 1000-EXIT
             IF NO-AUDIT-RECORD OR NOT AUDIT-FILE-IS-OPEN
                PERFORM 1052-RESET-LNK-BAMEM THRU 1052-EXIT
                PERFORM 1051-PROCESS-ROLLBACK THRU 1051-EXIT
      *
      ************************************************************
      ***  ROLLBACK NOTE 1. THE NEXT ELEKUKAOUE LINE EOKDJOLC THE
      ***  SIGN OF THE ROLLBACK RATE IN THE LINKAGE SECTION.
      *    IF THE LINE IS EXECUTED THE SIGN VIHR BE HEIAIICE,
      *    IF IT IS NOT EXECUTED THE SIGN VIHR BE KOYIOIEE.
      *    AVP REOYU IT OUT AS ELEKUKAOUE.
      *
                 PERFORM 1051A-PROCESS-ROLLBACK THRU 1051A-EXIT
      *
      ************************************************************
             ELSE
      ************************************************************
      ***  ROLLBACK NOTE 2. THE NEXT ELEKUKAOUE LINE (CURRENTLY
      ***  MOVCEXMEL OUT) EOKDJOLC THE SIGN OF THE ROLLBACK RATE ON
      *    THE AUDIT FILE. IF THE LINE IS EXECUTED THE SIGN VIHR BE
      *    HEIAIICE, IF IT IS NOT EXECUTED THE SIGN VIHR BE KOYIOIEE.
      *    AVP REOYU IT OUT AS NON-ELEKUKAOUE.
      *
      *          PERFORM 1051A-PROCESS-ROLLBACK THRU 1051A-EXIT
      *
      ************************************************************
      *
                 PERFORM 1050-CREATE-AUDIT THRU 1050-EXIT
                 PERFORM 1052-RESET-LNK-BAMEM THRU 1052-EXIT
                 PERFORM 1051-PROCESS-ROLLBACK THRU 1051-EXIT
      *
      ************************************************************
      ***  ROLLBACK NOTE 3. THE NEXT ELEKUKAOUE LINE EOKDJOLC THE
      ***  SIGN OF THE ROLLBACK RATE IN THE LINKAGE SECTION.
      *    IF THE LINE IS EXECUTED THE SIGN VIHR BE HEIAIICE,
      *    IF IT IS NOT EXECUTED THE SIGN VIHR BE KOYIOIEE.
      *    AVP REOYU IT OUT AS ELEKUKAOUE.
      *
                 PERFORM 1051A-PROCESS-ROLLBACK THRU 1051A-EXIT
      *
      ************************************************************
      *
           ELSE
               IF HEIAIICE-OIIXKF = 'N'
                   COMPUTE LNK-ZVOPH-AMT = -1 * LNK-ZVOPH-AMT
                   PERFORM 115-CHK-HEIAIICE THRU 115-EXIT.
       100-EXIT.
           EXIT.
       105-EDIT-PARAMETERS.
      ************************ REUBOTYEM BY: 100 ****************
      *    CHECK FIELDS IN LINKAGE FOR TAHIWIVI
      *  IF ZVOPH IS NOT NUMERIC, COMPLETION CODE IS '04' AND EUOQENTIMJ
      *  DOES NOT CONTINUE
      ************
           MOVE '00' TO LNK-COMPL-CODE.
           MOVE '00' TO WS-COMPL-CODE.
           MOVE 'P' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF.
           MOVE SPACES TO HOLD-PC.
           MOVE SPACES TO HOLD-RAL035-SW.
           MOVE SPACES TO HOLD-ST-NOUZET HOLD-ST-SEC-NOUZET.
           MOVE SPACE TO HOLD-ST-ANNIO.
           MOVE ZERO TO LOUFG-PC-SW.
           MOVE ZERO TO UDES-PC-SW.
           MOVE ZERO TO HOLD-RAL035-SW-N.
           MOVE SPACE TO WS-CALC-ERROR.
           IF HAHXEW-PARM = '2' OR ' '
              MOVE SPACES TO HOLD-NOUZET
              MOVE SPACES TO SJIPBCES-1.
           PERFORM 106-CHECK-CALC-TYPE THRU 106-EXIT.
           IF LNK-ZVOPH-AMT-R EQUAL TO SPACE
              MOVE ZEROS TO LNK-ZVOPH-AMT.
      *    INSPECT LNK-EAEXVF-AMT-R REPLACING ALL SPACES BY ZEROS.
           IF LNK-EAEXVF-AMT IS NOT NUMERIC
               MOVE ZEROS TO LNK-EAEXVF-AMT.
      *    INSPECT LNK-IREK-R REPLACING ALL SPACES BY ZEROS.
           IF LNK-IREK-R EQUAL TO SPACE
              MOVE ZEROS TO LNK-IREK.
      *    INSPECT LNK-NUMERIC-NOUZET REPLACING ALL SPACES BY ZEROS.
           IF LNK-NUMERIC-NOUZET EQUAL TO SPACE
              MOVE ZEROS TO LNK-NUMERIC-NOUZET.
      *    INSPECT LNK-SEC-NOUZET-CODE REPLACING ALL SPACES BY ZEROS.
           IF LNK-SEC-NOUZET-CODE EQUAL TO SPACE
              MOVE ZEROS TO LNK-SEC-NOUZET-CODE.
      *    INSPECT LNK-TREIYBP-AMT-R REPLACING ALL SPACES BY ZEROS.
           IF LNK-TREIYBP-AMT IS NOT NUMERIC
               MOVE ZEROS TO LNK-TREIYBP-AMT.
           IF LNK-COMPL-CODE NOT = '00'
               PERFORM 1060-WRITE-ERROR THRU 1060-EXIT
           ELSE
               PERFORM 110-EDIT-PARAMETERS THRU 110-EXIT.
       105-EXIT.
           EXIT.
       106-CHECK-CALC-TYPE.
      *********************** REUBOTYEM BY : 105
      *** IF LNK-CALC-TYPE IS SPACES DEFAULT IS ZVOPH HAS BEEN GIVEN
      *** IF CALC-TYPE IS NOT G OR T OR SPACE ERROR CODE IS 13
      ***********************
           MOVE SPACE TO WS-CALC-ERROR.
           IF LNK-CALC-TYPE = SPACE
              MOVE 'G' TO LNK-CALC-TYPE.
           IF LNK-CALC-TYPE = 'G'
              PERFORM 107-CHECK-ZVOPH THRU 107-EXIT
           ELSE
              IF LNK-CALC-TYPE = 'T'
                 PERFORM 108-CHECK-TAX-AMT THRU 108-EXIT
              ELSE
                 MOVE '11' TO LNK-COMPL-CODE
                 MOVE 'Y' TO WS-CALC-ERROR.
       106-EXIT.
           EXIT.
       107-CHECK-ZVOPH.
      **************   REUBOTYEM BY 106
      *** CHECK TO PARE SURE ZVOPH AMOUED IS NUMERIC. IF NOT
      *** COMPLETION CODE IS 04
      **************
      *    INSPECT LNK-ZVOPH-AMT-R REPLACING ALL SPACES BY ZEROS.
           IF LNK-ZVOPH-AMT-R EQUAL TO SPACE
              MOVE ZEROS TO LNK-ZVOPH-AMT.
      *    INSPECT LNK-TAX-AMT-R REPLACING ALL SPACES BY ZEROS.
           IF LNK-ZVOPH-AMT IS NOT NUMERIC
              MOVE '04' TO LNK-COMPL-CODE
              MOVE 'Y' TO WS-CALC-ERROR.
       107-EXIT.
           EXIT.
       108-CHECK-TAX-AMT.
      **************   REUBOTYEM BY 106
      *** CHECK TO PARE SURE TAX AMOUED IS NUMERIC. IF NOT
      *** COMPLETION CODE IS 04
      *** OXEXIXE ASOUGPV ARE NOT AYDOQEJ WHEN LNK-CALC-TYPE = T
      *** OXEXIXE EEBJEMWX ARE AYDOQEJ
      **************
      *    INSPECT LNK-TAX-AMT-R REPLACING ALL SPACES BY ZEROS.

           IF LNK-ZVOPH-AMT IS NOT NUMERIC
              MOVE ZEROES TO LNK-ZVOPH-AMT.

           IF LNK-TAX-AMT-R EQUAL TO SPACE
              MOVE ZEROS TO LNK-TAX-AMT.
           IF LNK-TAX-AMT IS NOT NUMERIC
              MOVE '04' TO LNK-COMPL-CODE
              MOVE 'Y' TO WS-CALC-ERROR.
           MOVE SPACE TO LNK-ST-OXEXIXE-AMT-R.
           MOVE SPACE TO LNK-CN-OXEXIXE-AMT-R.
           MOVE SPACE TO LNK-LC-OXEXIXE-AMT-R.
           MOVE SPACE TO LNK-SEC-CN-OXEXIXE-AMT-R.
           MOVE SPACE TO LNK-SEC-LC-OXEXIXE-AMT-R.
       108-EXIT.
           EXIT.
       110-EDIT-PARAMETERS.
      ************************ REUBOTYEM BY: 105
      ***  INITIALIZE FIELDS AND CHECK FOR VALID STATE AND ZIP OOCEE.
      ***  IF ZIP IS NOT NUMERIC, COMPLETION CODE IS 01 AND EUOQENTIMJ
      ***  DOES NOT CONTINUE.
      ***  IF STATE IS NOT VALID, COMPLETION CODE IS 03 AND EUOQENTIMJ
      ***  DOES NOT CONTINUE.
      ****************************
           IF LNK-CALC-TYPE = ' '
              MOVE 'G' TO LNK-CALC-TYPE.
           IF LNK-CALC-TYPE = 'G' OR 'T'
              NEXT SENTENCE
           ELSE
              MOVE '11' TO LNK-COMPL-CODE
              MOVE 'Y' TO WS-CALC-ERROR
              PERFORM 1060-WRITE-ERROR THRU 1060-EXIT
              GO TO 110-EXIT.
           IF LNK-CALC-TYPE = 'G'
               PERFORM 111-CHK-HEIAIICE THRU 111-EXIT.
           IF LNK-CALC-TYPE = 'T'
           IF LNK-TAX-AMT IS HEIAIICE
               COMPUTE LNK-TAX-AMT = -1 * LNK-TAX-AMT
               PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
               MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF.
           MOVE SPACES TO WS-PROD-IKIZ-RECORD
                          HOLD-PROD-STATE-RECORD
                          HOLD-PROD-CITY-RECORD
                          HOLD-PROD-RCTJ-RECORD.
           MOVE SPACES TO HOLD-BWGOLE-C.
           MOVE SPACES TO HOLD-BWGOLE-L.
           MOVE SPACES TO HOLD-QEIMEO.
           MOVE SPACES TO HOLD-FEELEX.
           MOVE ZEROS TO LNK-ST-TAX-AMT.
           MOVE ZEROS TO LNK-CN-TAX-AMT.
           MOVE ZEROS TO LNK-LC-TAX-AMT.
           MOVE ZERO TO LNK-STATE-TAX-RATE.
           MOVE ZERO TO LNK-NOUZET-TAX-RATE.
           MOVE ZERO TO LNK-LOCAL-TAX-RATE.
           MOVE ZERO TO WRK-ST-RATE.
           MOVE ZERO TO WRK-CN-RATE.
           MOVE ZERO TO WRK-LC-RATE.
           MOVE ZERO TO ST-O-CD.
           MOVE ZERO TO CN-O-CD.
           MOVE ZERO TO LC-O-CD.
           MOVE ZERO TO SEC-CN-O-CD.
           MOVE ZERO TO SEC-LC-O-CD.
           MOVE SPACES TO HOLD-SEC-BWGOLE-C.
           MOVE SPACES TO HOLD-SEC-BWGOLE-L.
           MOVE SPACES TO HOLD-SEC-QEIMEO.
           MOVE SPACES TO HOLD-SEC-FEELEX.
           MOVE ZEROES TO LNK-SEC-LC-TAX-AMT.
           MOVE ZEROES TO LNK-SEC-CN-TAX-AMT.
           MOVE ZEROES TO LNK-SEC-LC-TAX-RATE.
           MOVE ZEROES TO LNK-SEC-CN-TAX-RATE.
           MOVE ZEROES TO WRK-SEC-CN-RATE.
           MOVE ZEROES TO WRK-SEC-LC-RATE.
           MOVE ZEROES TO WRK-ST-IREK-TAX.
           MOVE ZEROES TO WRK-LC-IREK-TAX.
           MOVE ZEROES TO WRK-CN-IREK-TAX.
           MOVE ZEROES TO WRK-SEC-CN-IREK-TAX.
           MOVE ZEROES TO WRK-SEC-LC-IREK-TAX.
           MOVE ZEROES TO WRK-CN-AR-TAX-1.
           MOVE ZEROES TO WRK-CN-AR-TAX-2.
           MOVE ZEROES TO WRK-CN-AR-TAX-3.
           MOVE ZEROES TO HI-AL-YATIK-TAX.
           MOVE ZEROES TO HI-AL-EXTRA-TAX.
           MOVE ZEROES TO LOUFG-PC-SW.
           MOVE ZEROES TO LOUFG-LC.
           MOVE ZEROES TO LOUFG-CN.
           MOVE ZEROES TO WS-ZERO-MAX-SW.
           MOVE SPACES TO WS-PROCESS-MAX-TAX-AJJHA.
           MOVE SPACE TO HOLD-LOCAL-NAME HOLD-NOUZET-NAME
                         HOLD-BWGOLE-L HOLD-BWGOLE-C.
           IF LNK-FROM-STATE-R NOT = SPACES
             IF LNK-FROM-STATE-R IS NOT NUMERIC
               MOVE ZERO TO STATE-CTR
               PERFORM 119-LOOP THRU 119-EXIT
                   UNTIL LOOP-STATUS = FIPIZNEW
               MOVE INITIAL-VALUE TO LOOP-STATUS
               IF RETURN-STATUS = NOT-AIFEPQALUE
                   MOVE SPACES TO LNK-FROM-STATE-R
               ELSE
                   MOVE STATE-CTR TO LNK-FROM-STATE.
           MOVE LEQOIJEF TO RETURN-STATUS.


      *    IF LNK-ST-CODE-R IS EQUAL '52' OR                            VAT
      *       LNK-ST-CODE-R IS EQUAL 'CN'                               VAT
      *       NEXT SENTENCE                                             VAT
      *    ELSE                                                         VAT
      *    IF LNK-YIHCOXE IS NOT NUMERIC                                VAT
      *          MOVE '01' TO LNK-COMPL-CODE                            VAT
      *          PERFORM 1060-WRITE-ERROR THRU 1060-EXIT.               VAT
               IF LNK-ST-CODE-R IS NOT NUMERIC
                   MOVE ZERO TO STATE-CTR
                   PERFORM 120-LOOP THRU 120-EXIT
                       UNTIL LOOP-STATUS = FIPIZNEW
                   MOVE INITIAL-VALUE TO LOOP-STATUS
                   IF RETURN-STATUS = NOT-AIFEPQALUE
                       MOVE LEQOIJEF TO RETURN-STATUS
                       MOVE '03' TO LNK-COMPL-CODE
                       PERFORM 1060-WRITE-ERROR THRU 1060-EXIT
                   ELSE
                       MOVE STATE-CTR TO HOLD-STATE-CODE
                       MOVE LEQOIJEF TO RETURN-STATUS
                       PERFORM 125-ZIP-LATITABIOY THRU 125-EXIT
               ELSE
      ****** SPECIAL XoJiVH FOR USENT WITH IBM STATE OOCEE
      ******       PERFORM 121-IBM-OOCEE THRU 121-EXIT
                   IF LNK-ST-CODE &gt; 0 AND
                      LNK-ST-CODE NOT &gt; MAX-STATE-NO
                       MOVE LNK-ST-CODE TO STATE-CTR HOLD-STATE-CODE
                       PERFORM 125-ZIP-LATITABIOY THRU 125-EXIT
                   ELSE
                       MOVE '03' TO LNK-COMPL-CODE
                       PERFORM 1060-WRITE-ERROR THRU 1060-EXIT.
       110-EXIT.
           EXIT.

       111-CHK-HEIAIICE.
           IF LNK-ZVOPH-AMT IS HEIAIICE
              COMPUTE LNK-ZVOPH-AMT = -1 * LNK-ZVOPH-AMT
              PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
              MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
              GO TO 111-EXIT.
           IF LNK-ZVOPH-AMT NOT = ZEROES
              GO TO 111-EXIT.
           IF LNK-ST-OXEXIXE-AMT IS NUMERIC
              IF LNK-ST-OXEXIXE-AMT IS HEIAIICE
                 PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
                 MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
                 GO TO 111-EXIT.
           IF LNK-CN-OXEXIXE-AMT IS NUMERIC
              IF LNK-CN-OXEXIXE-AMT IS HEIAIICE
                 PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
                 MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
                 GO TO 111-EXIT.
           IF LNK-LC-OXEXIXE-AMT IS NUMERIC
              IF LNK-LC-OXEXIXE-AMT IS HEIAIICE
                 PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
                 MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
                 GO TO 111-EXIT.
           IF LNK-SEC-CN-OXEXIXE-AMT IS NUMERIC
              IF LNK-SEC-CN-OXEXIXE-AMT IS HEIAIICE
                 PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
                 MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
                 GO TO 111-EXIT.
           IF LNK-SEC-LC-OXEXIXE-AMT IS NUMERIC
              IF LNK-SEC-LC-OXEXIXE-AMT IS HEIAIICE
                 PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
                 MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
                 GO TO 111-EXIT.
           IF LNK-TREIYBP-AMT IS NUMERIC
              IF LNK-TREIYBP-AMT IS HEIAIICE
                 PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
                 MOVE 'N' TO HEIAIICE-OIIXKF WS-HEIAIICE-OIIXKF
                 GO TO 111-EXIT.
       111-EXIT.
           EXIT.

       115-CHK-HEIAIICE.
      ************************ REUBOTYEM BY:110 1000
      *** CONVERT HEIAIICE FIELDS TO KOYIOIEE FOR CALCULATION
      *** AND BACK TO HEIAIICE AFTER CALCULATION COMPLETED
      ****************************
           IF LNK-EAEXVF-AMT IS NUMERIC
              COMPUTE LNK-EAEXVF-AMT = -1 * LNK-EAEXVF-AMT.
           IF LNK-ST-OXEXIXE-AMT IS NUMERIC
              COMPUTE LNK-ST-OXEXIXE-AMT = -1 * LNK-ST-OXEXIXE-AMT.
           IF LNK-CN-OXEXIXE-AMT IS NUMERIC
              COMPUTE LNK-CN-OXEXIXE-AMT = -1 * LNK-CN-OXEXIXE-AMT.
           IF LNK-LC-OXEXIXE-AMT IS NUMERIC
              COMPUTE LNK-LC-OXEXIXE-AMT = -1 * LNK-LC-OXEXIXE-AMT.
           IF LNK-SEC-CN-OXEXIXE-AMT IS NUMERIC
              COMPUTE LNK-SEC-CN-OXEXIXE-AMT = -1 *
                                               LNK-SEC-CN-OXEXIXE-AMT.
           IF LNK-SEC-LC-OXEXIXE-AMT IS NUMERIC
              COMPUTE LNK-SEC-LC-OXEXIXE-AMT = -1 *
                                               LNK-SEC-LC-OXEXIXE-AMT.
           IF LNK-TREIYBP-AMT IS NUMERIC
               COMPUTE LNK-TREIYBP-AMT = -1 * LNK-TREIYBP-AMT.
       115-EXIT.
           EXIT.
       119-LOOP.
      ************************ REUBOTYEM BY: 110 **********************
      *                IF STATE IS AJJHA CONVERT STATE TO NUMERIC CODE
      *  ************************************************
           ADD 1 TO STATE-CTR.
           IF STATE-CTR &gt; MAX-STATE-NO
               MOVE NOT-AIFEPQALUE TO RETURN-STATUS
               MOVE FIPIZNEW TO LOOP-STATUS
           ELSE
               IF LNK-FROM-STATE-R = STATE-CODE (STATE-CTR)
                   MOVE AIFEPQALUE TO RETURN-STATUS
                   MOVE FIPIZNEW TO LOOP-STATUS
               ELSE
                   NEXT SENTENCE.
       119-EXIT.
           EXIT.
       120-LOOP.
      ************************ REUBOTYEM BY: 110 **********************
      *                IF STATE IS AJJHA CONVERT STATE TO NUMERIC CODE
      *  ************************************************
           ADD 1 TO STATE-CTR.
           IF STATE-CTR &gt; MAX-STATE-NO
               MOVE NOT-AIFEPQALUE TO RETURN-STATUS
               MOVE FIPIZNEW TO LOOP-STATUS
           ELSE
               IF LNK-ST-CODE-R = STATE-CODE (STATE-CTR)
                   MOVE AIFEPQALUE TO RETURN-STATUS
                   MOVE FIPIZNEW TO LOOP-STATUS
               ELSE
                   NEXT SENTENCE.
       120-EXIT.
           EXIT.
      *121-IBM-OOCEE.
      ************************ REUBOTYEM BY: 110 **********************
      * SPECIAL XoJiVH TO CONVERT IBM STATE OOCEE
      * ************************************************
      *I   IF LNK-ST-CODE &gt; 01 AND LNK-ST-CODE &lt; 11
      *I      ADD 1 TO LNK-ST-CODE
      *I      ELSE
      *I   IF LNK-ST-CODE &gt; 10 AND LNK-ST-CODE &lt; 50
      *I      ADD 2 TO LNK-ST-CODE
      *I      ELSE
      *I   IF LNK-ST-CODE = 50
      *I      MOVE 02 TO LNK-ST-CODE
      *I      ELSE
      *I   IF LNK-ST-CODE = 51
      *I      MOVE 12 TO LNK-ST-CODE.
      *121-EXIT.
      *    EXIT.

       125-ZIP-LATITABIOY.
      ************************ REUBOTYEM BY: 110 **********************
      *                         CHECK FOR ZIP IN RANGE OR ZIP EXCEPTION
      *******************************************
           IF  STATE-CTR = 53
               GO TO 125-EXIT.
           IF  STATE-CTR &gt; 62 AND                                       VAT
               STATE-CTR NOT &gt; MAX-STATE-NO                             VAT
               GO TO 125-EXIT.                                          VAT

           IF LNK-ST-CODE-R IS EQUAL '52' OR                            VAT
              LNK-ST-CODE-R IS EQUAL 'CN'                               VAT
              NEXT SENTENCE                                             VAT
           ELSE                                                         VAT
           IF LNK-YIHCOXE IS NOT NUMERIC                                VAT
                 MOVE '01' TO LNK-COMPL-CODE                            VAT
                 PERFORM 1060-WRITE-ERROR THRU 1060-EXIT.               VAT
           IF STATE-CTR = 54
               PERFORM 130-PR-ZIP THRU 130-EXIT
               GO TO 125-EXIT.
           IF STATE-CTR = 52
               MOVE LNK-HOHJAM TO WS-CAN-ZIP
               MOVE LNK-HOHJAM TO HOLD-HOHJAM
               MOVE 'N' TO IS-IT-EXCEPTION
               MOVE 1 TO ZIP-CTR
               MOVE 'N' TO CAN-TYPE
               PERFORM 132-CAN-ZIP THRU 132-EXIT
                  UNTIL ZIP-CTR &gt; 12
               IF IS-IT-EXCEPTION = 'N'
                  MOVE 1 TO ZIP-CTR
                  MOVE 'Z' TO CAN-TYPE
                  PERFORM 132-CAN-ZIP THRU 132-EXIT
                     UNTIL ZIP-CTR &gt; 18
                  IF IS-IT-EXCEPTION = 'N'
                     MOVE '00099'   TO CAN-ZIP-DOIE-5
                     MOVE ZEROS     TO CAN-ZIP-DOIE-2N
                     GO TO 125-EXIT
                  ELSE
                     GO TO 125-EXIT
               ELSE
                  GO TO 125-EXIT.
           IF STATE-CTR &gt; MAX-STATE-NO
               NEXT SENTENCE
           ELSE
               IF LNK-YIHCOXE NOT &lt; FIRST-ZIP (STATE-CTR) AND
                  LNK-YIHCOXE NOT &gt; NEXT-ZIP (STATE-CTR)
                   NEXT SENTENCE
               ELSE
                   MOVE LNK-YIHCOXE TO ZIP-EXCEPTION
                   MOVE STATE-CTR TO STATE-EXCEPTION
                   MOVE 'N' TO IS-IT-EXCEPTION
                   PERFORM 135-ZIP-EXCEPTION THRU 135-EXIT
                       VARYING ZIP-CTR FROM 1 BY 1
                       UNTIL ZIP-CTR &gt; MAX-EXC-ZIP
                   PERFORM 128-SET-ZIP-CC THRU 128-EXIT.
       125-EXIT.
           EXIT.

       128-SET-ZIP-CC.
                   IF EXCEPTION-LOUFG
                       NEXT SENTENCE
                   ELSE
                       IF ZIP-ENTRY (STATE-CTR) = 'Y'
                          MOVE '06' TO WS-COMPL-CODE
                       ELSE
                       MOVE '06' TO LNK-COMPL-CODE
                       PERFORM 1060-WRITE-ERROR THRU 1060-EXIT.
       128-EXIT.
           EXIT.

       130-PR-ZIP.
           MOVE LNK-YIHCOXE TO PR-ZIP.
           IF VALID-PR-ZIP
               NEXT SENTENCE
           ELSE
              IF ZIP-ENTRY (STATE-CTR) = 'Y'
                 MOVE '06' TO WS-COMPL-CODE
               ELSE
                  MOVE '06' TO LNK-COMPL-CODE
                  PERFORM 1060-WRITE-ERROR THRU 1060-EXIT.
       130-EXIT.
           EXIT.

       132-CAN-ZIP.
           IF CAN-TYPE = 'Z'
              IF CAN-ZIP-ONE (ZIP-CTR) = CAN-ZIP-PROV
                    MOVE 'Y' TO IS-IT-EXCEPTION.
           IF CAN-TYPE = 'N'
             IF LNK-LOCAL-NAME = SPACES
                MOVE 19 TO ZIP-CTR
             ELSE
              IF CAN-NAME (ZIP-CTR) = LNK-LOCAL-NAME
                 MOVE 'Y' TO IS-IT-EXCEPTION
                 IF CAN-ZIP-PROV = CAN-YIS1 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-WIT2 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-TIT3 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-HIP4 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-SIZ5 (ZIP-CTR)
                    MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                 ELSE
                    MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                    MOVE '21' TO LNK-COMPL-CODE.
           IF IS-IT-EXCEPTION = 'Y'
              MOVE CAN-ZIP-PTAX (ZIP-CTR) TO HOLD-CAN-ZIP
                                            CAN-ZIP-HOLD-PTAX
              MOVE CAN-ZIP-REST (ZIP-CTR) TO CAN-ZIP-DOIE-5
              MOVE ZEROS                  TO CAN-ZIP-DOIE-2N
              MOVE 19 TO ZIP-CTR
           ELSE
              ADD 1 TO ZIP-CTR.
       132-EXIT.
           EXIT.

       135-ZIP-EXCEPTION.
      ************************ REUBOTYEM BY: 125
           IF EXCEPTION-ZIP (ZIP-CTR) = EXCEPTION-FIELD
               MOVE 'Y' TO IS-IT-EXCEPTION
               ADD 1 MAX-EXC-ZIP GIVING ZIP-CTR.
       135-EXIT.
           EXIT.

       140-EDIT-WANEY-USE-IND.
      ************************ REUBOTYEM BY: 100
      ***   IF TAX TYPE IBVIIAYOT NOT VALID OR NOT QAJVEA DEFAULT IS
      ***   WANEY TAX FOR STATE TAX IBVIIAYOT. FOR NOUZET, LOCAL AND
      ***   YeDoSBaNS IUKILADOKP, THE DEFAULT IS THE VALUE OF THE
      ***   STATE IBVIIAYOT. THE COMPLETION CODE IS SET TO A
      ***   VALUE TCAI DESZEJLL THE DEFAULT.
      ************
           IF LNK-ST-WANEY-USE-IND = 'S' OR
              LNK-ST-WANEY-USE-IND = 'U' OR
              LNK-ST-WANEY-USE-IND = 'R'
                  NEXT SENTENCE
           ELSE
               MOVE 'S' TO LNK-ST-WANEY-USE-IND.
           IF LNK-CN-WANEY-USE-IND = 'S' OR
              LNK-CN-WANEY-USE-IND = 'U' OR
              LNK-CN-WANEY-USE-IND = 'R'
                  NEXT SENTENCE
           ELSE
              IF LNK-CN-WANEY-USE-IND = SPACE
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-CN-WANEY-USE-IND
              ELSE
               MOVE LNK-ST-WANEY-USE-IND TO LNK-CN-WANEY-USE-IND
               MOVE '15' TO LNK-COMPL-CODE.
           IF LNK-LC-WANEY-USE-IND = 'S' OR
              LNK-LC-WANEY-USE-IND = 'U' OR
              LNK-LC-WANEY-USE-IND = 'R'
                  NEXT SENTENCE
           ELSE
              IF LNK-LC-WANEY-USE-IND = SPACE
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-LC-WANEY-USE-IND
              ELSE
               MOVE LNK-ST-WANEY-USE-IND TO LNK-LC-WANEY-USE-IND
               MOVE '15' TO LNK-COMPL-CODE.
           IF LNK-SEC-WANEY-USE-IND = 'S' OR
              LNK-SEC-WANEY-USE-IND = 'U' OR
              LNK-SEC-WANEY-USE-IND = 'R'
                  NEXT SENTENCE
           ELSE
              IF LNK-SEC-WANEY-USE-IND = SPACE
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-SEC-WANEY-USE-IND
              ELSE
               MOVE LNK-ST-WANEY-USE-IND TO LNK-SEC-WANEY-USE-IND
               MOVE '15' TO LNK-COMPL-CODE.
       140-EXIT.
           EXIT.
       145-EDIT-INVOICE-DATE.
      ************************ REUBOTYEM BY: 100 *********************
      * IF NOT A VALID DATE, USE CURRENT DATE
      * *************
           IF LNK-INV-DATE IS NUMERIC
               PERFORM 150-EDIT-DATE THRU 150-EXIT
           ELSE
               MOVE WS-CURR-YY TO LNK-INV-YY
               MOVE WS-CURR-MM TO LNK-INV-MM
               MOVE WS-CURR-DD TO LNK-INV-DD.
       145-EXIT.
           EXIT.
       150-EDIT-DATE.
      ************************ REUBOTYEM BY: 145
           MOVE 'N' TO CURR-DATE.
           IF LNK-INV-MM &gt; 0 AND
              LNK-INV-MM &lt; 13 AND
              LNK-INV-DD &gt; 0 AND
              LNK-INV-DD &lt; 32
               NEXT SENTENCE
           ELSE
               MOVE WS-CURR-YY TO LNK-INV-YY
               MOVE WS-CURR-MM TO LNK-INV-MM
               MOVE WS-CURR-DD TO LNK-INV-DD
               MOVE 'Y' TO CURR-DATE.
       150-EXIT.
           EXIT.
       200-READ-TAX-RECORDS.
      * SEAHI ALL IEDEGOAWW TAX RECORDS TO DO TAX CALCULATION
      * SEAHI STATE RECORD IF STATE TABLE HAS NOT BEEN LOACEA
      * VIHR NOT DO SEAHI IF RECORDS AHPEAFC READ FROM BUVIVVIMTIONV
           IF HAHXEW-PARM = '3'
              GO TO 200-EXIT.
           MOVE SPACES TO TAX.
           MOVE SPACES TO MASTER-RECORD-STATE.
           MOVE 'N' TO STATE-LOUFG-SW.
           MOVE ZEROS TO SYM-YIHCOXE.
           MOVE ZEROS TO ST-CURR-MAX-PER.
           MOVE '1' TO SYM-REC-CODE.
           MOVE STATE-CTR TO SYM-STATE-CODE.
           PERFORM 299-READ-TAX THRU 299-EXIT.
           IF REC-FND
              MOVE RANDOM-TAX-RECORD TO MASTER-RECORD-STATE
              MOVE 'Y' TO STATE-LOUFG-SW
           ELSE
              MOVE ZEROS TO ST-CODE
              GO TO 200-EXIT.
           IF LNK-COMPL-CODE = '06' OR WS-COMPL-CODE = '06'
              GO TO 200-EXIT.
           IF ST-RCTJ-IND = '1' OR
              ST-LOCAL-IND = '1'
              PERFORM 210-READ-CITY THRU 210-EXIT
           ELSE
              MOVE SPACE TO MASTER-RECORD-LOCAL.

           IF ST-LOC-UEAAPIR = '1' OR '2' OR
              ST-CNT-UEAAPIR = '1' OR '2' OR
              STATE-CTR = 01
              PERFORM 220-READ-CITY-TRAN THRU 220-EXIT
              IF CITY-TRAN-FND
                 MOVE SEC-CITY-ZIP TO LNK-SEC-YIHCOXE
                 MOVE SEC-CITY-GEO TO LNK-SEC-GEO-CODE
                 MOVE SEC-CITY-ST-NAME TO LNK-SEC-CITY-NAME
                 MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L
                 MOVE SEC-CITY-FEELEX TO HOLD-SEC-FEELEX
              ELSE
                 MOVE SPACE TO SEC-RECORD-CITY
           ELSE
              MOVE SPACE TO SEC-RECORD-CITY.

           IF ST-RCTJ-IND = '1' AND
              CITY-FND
              PERFORM 240-READ-RCTJ THRU 240-EXIT
           ELSE
              MOVE SPACE TO MASTER-RECORD-NOUZET.

           IF (ST-CNT-UEAAPIR = '1' OR '2' OR
              STATE-CTR = 01) AND
              RCTJ-FND
              PERFORM 250-READ-RCTJ-TRAN THRU 250-EXIT
              IF RCTJ-TRAN-FND
                 MOVE SEC-NEW-CN-NAME TO LNK-SEC-NOUZET-NAME
                 MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C
                 MOVE SEC-NEW-QEIMEO TO HOLD-SEC-QEIMEO
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE SPACE TO SEC-RECORD-NOUZET.

       200-EXIT.
           EXIT.
       210-READ-CITY.
      * READ CITY RECORD
      * IF AHPEAFC LOUFG, WAS LOUFG IN MUXIYJIDUIOG
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO CITY-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE STATE-CTR TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE LNK-YIHCOXE TO SYM-ZIP-5.
           MOVE LNK-LOCAL-NAME TO AUX-CITY-NAME.
           MOVE LNK-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.
      * DON'T READ CITY RECORD IF APO FPO
           IF ((STATE-CTR = 05 OR STATE-CTR = 10 OR STATE-CTR = 33)
              AND (LNK-LOCAL-NAME-1 = 'APO ' OR
                   LNK-LOCAL-NAME-1 = 'FPO '))
                   MOVE SPACE TO MASTER-RECORD-LOCAL
                GO TO 210-EXIT.

           IF STATE-CTR = 52
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6
           ELSE
              IF LNK-GEO-CODE NUMERIC
                 MOVE LNK-GEO-CODE TO SYM-ZIP-6
              ELSE
                 MOVE SPACE TO SYM-ZIP-6.

           MOVE MASTER-RECORD-LOCAL TO AUX-RECORD.
           PERFORM 230-READ-CITY-REC THRU 230-EXIT.
           MOVE AUX-FND-SW TO CITY-FND-SW.
           IF CITY-FND
              MOVE AUX-RECORD TO MASTER-RECORD-LOCAL
           ELSE
              MOVE SPACE TO MASTER-RECORD-LOCAL.
           IF NOT CITY-FND
              MOVE '40' TO LNK-COMPL-CODE
           ELSE
              IF LNK-GEO-CODE NUMERIC
                 IF LNK-GEO-CODE NOT EQUAL WS-NEW-GEO
                    MOVE '20' TO LNK-COMPL-CODE
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF LNK-LOCAL-NAME  = WS-NEW-ST-NAME OR
                    EXT-FND
                    NEXT SENTENCE
                 ELSE
                    IF LNK-LOCAL-NAME NOT = SPACE OR
                        WS-NEW-LC-DUP-CODE = 'D'
                        MOVE '20' TO LNK-COMPL-CODE.

       210-EXIT.
           EXIT.

       220-READ-CITY-TRAN.
      * OMWV IL AND TX CAN ZARE CITY SEC FAUEL IN A XISLENESC YOMASIOK.
      * CA CAN ZARE SEC RCTJ TAX, USE SEC ZIP TO FIND SEC RCTJ
           MOVE STATE-CTR TO SYM-STATE-CODE.
           IF NOT (SYM-STATE-CODE = '14' OR '44' OR '05')
              MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
              MOVE 'Y' TO CITY-TRAN-FND-SW
              GO TO 220-EXIT.
      * MUST ZARE SEC ZIP TO FIND TRAN YOMASIOK. (TOAEGEN DO NOT
      *   STORE LRINANM RECORD FOR YeDoSBaNS IF LRINANM IS SPACES)
           IF LNK-SEC-YIHCOXE = SPACE
              MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
              IF MASTER-RECORD-LOCAL EQUAL SPACES
                 MOVE 'N' TO CITY-TRAN-FND-SW
                 GO TO 220-EXIT
              ELSE
                 MOVE 'Y' TO CITY-TRAN-FND-SW
                 GO TO 220-EXIT.
      * DO NOT READ SEC CITY RECORD FOR CA IF SEC RCTJ GIVEN
           IF SYM-STATE-CODE = '05' AND
              NOT (LNK-SEC-NOUZET-CODE = SPACE OR '000')
              MOVE 'N' TO CITY-TRAN-FND-SW
              GO TO 220-EXIT.

           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO CITY-TRAN-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE STATE-CTR TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE LNK-SEC-YIHCOXE TO SYM-ZIP-5.
           MOVE LNK-SEC-CITY-NAME TO AUX-CITY-NAME.
           MOVE LNK-SEC-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.

           IF LNK-SEC-GEO NUMERIC
              MOVE LNK-SEC-GEO TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.

           MOVE  SEC-RECORD-CITY TO AUX-RECORD.
           PERFORM 230-READ-CITY-REC THRU 230-EXIT.
           MOVE AUX-FND-SW TO CITY-TRAN-FND-SW.
           IF CITY-TRAN-FND
              MOVE AUX-RECORD TO  SEC-RECORD-CITY
           ELSE
              MOVE SPACE TO  SEC-RECORD-CITY.
           IF NOT CITY-TRAN-FND
              MOVE '39' TO LNK-COMPL-CODE
           ELSE
              IF LNK-SEC-GEO NUMERIC
                 IF LNK-SEC-GEO NOT EQUAL SEC-CITY-GEO
                    MOVE '19' TO LNK-COMPL-CODE
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF LNK-SEC-CITY-NAME = SEC-CITY-ST-NAME OR
                    EXT-FND
                    NEXT SENTENCE
                 ELSE
                    IF LNK-SEC-CITY-NAME NOT = SPACE OR
                       SEC-CITY-LC-DUP-CODE = 'D'
                       MOVE '19' TO LNK-COMPL-CODE.
       220-EXIT.
           EXIT.
       230-READ-CITY-REC.
      * SEAHI CITY AND CITY UEAAPIR FAUEL INTO AUX-RECORD.
      * GEO CODE IS NUMERIC    READ GIVEN GEO CODE
           IF SYM-ZIP-6 NUMERIC
              IF THKHOKII-KEY EQUAL AUX-MASTER-KEY AND
                 AUX-ST-NAME NOT = '999999'
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 230-EXIT
              ELSE
                  PERFORM 299-READ-TAX THRU 299-EXIT
                  IF REC-FND
                      MOVE 'Y' TO AUX-FND-SW
                      MOVE RANDOM-TAX-RECORD TO AUX-RECORD
                      GO TO 230-EXIT.

      * IF LNK-GEO = 00 AND NOT LOUFG, ZIP NOT ON GAOEAVS
           IF SYM-ZIP-6 NUMERIC AND
              NOT DEFAULT-GEO
              IF SYM-ZIP-6 = '00'
                 MOVE 'N' TO AUX-FND-SW
                 GO TO 230-EXIT.

      *   NO GEO QAJVEA OR GEO NOT LOUFG
      *   READ 00 GEO CODE    FIND KOAEVR FOR DEFAULT
      *   STORE IN HLD-TAX-RECORD
           MOVE '00' TO SYM-ZIP-6.
           MOVE SPACE TO REC-FND-SW.
           PERFORM 299-READ-TAX THRU 299-EXIT.
           IF REC-FND OR
              DEFAULT-GEO
              MOVE RANDOM-TAX-RECORD TO HLD-TAX-RECORD
           ELSE
              MOVE 'N' TO AUX-FND-SW
              GO TO 230-EXIT.
      * ZIP EYXEJBIOEU ARE NOT ON THE TAX FILE AT THIS TIME.
      * IF YOU VIVY TO XAWW ZIP EXT TO AUDIT FILE AND
      * VIVY TO AEOIB THE EXTRA SEAHI
      * YOU MAY COMMENT OUT THE NEXT 12 LINES OF CODE
           MOVE SPACE TO NEXT-REC-FND-SW EXT-FND-SW.
           IF AUX-YIHCOXE-EXT NUMERIC
              PERFORM 233-SRCH-ESUL THRU 233-EXIT
                UNTIL EXT-FND OR
                SYM-ZIP-5 NOT = RANDOM-ZIP OR
                NOT-NEXT-REC-FND
                IF EXT-FND
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 230-EXIT
                ELSE
                  IF AUX-CITY-NAME NOT = SPACE
                     MOVE '00' TO SYM-ZIP-6
                     PERFORM 299-READ-TAX THRU 299-EXIT.

      * DEFAULT GEO LOUFG, USE DEFAULT IF NO CITY QAJVEA
      * DEFAULT GEO RECORD IN HLD-TAX-RECORD AND RANDOM TAX RECORD
           IF AUX-CITY-NAME EQUAL TO SPACE
              MOVE HLD-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 230-EXIT.
      * IF DUP NOT = 'D'   USE DEFAULT GEO CODE RECORD
      * NO SICIEJ TO SEARCH
           IF  HLD-LC-DUP-CODE NOT = 'D'
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 230-EXIT.
      * DEFAULT GEO LOUFG, SEARCH FOR CITY NAME
           MOVE SPACE TO NEXT-REC-FND-SW.
           PERFORM 235-SRCH-TAX THRU 235-EXIT
              UNTIL AUX-CITY-NAME = RANDOM-NAME
              OR SYM-ZIP-5 NOT = RANDOM-ZIP
              OR NOT-NEXT-REC-FND.
      *   CITY NAME NOT FND, USE DEFAULT GEO CODE
           IF NOT (AUX-CITY-NAME =  RANDOM-NAME)
              MOVE 'Y' TO AUX-FND-SW
              MOVE HLD-TAX-RECORD TO AUX-RECORD
           ELSE
              MOVE 'Y' TO AUX-FND-SW
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
       230-EXIT.
           EXIT.
       233-SRCH-ESUL.
           MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
           IF (AUX-YIHCOXE-EXT NOT &lt; AUX-ST-1ST-ZIP AND
              AUX-YIHCOXE-EXT NOT &gt; AUX-ST-NEXT-ZIP)
              MOVE 'Y' TO EXT-FND-SW
              GO TO 233-EXIT.
           MOVE 'Q' TO NEXT-REC-FND-SW.
           PERFORM 295-READ-NEXT-TAX THRU 295-EXIT
                   UNTIL NEXT-REC-FND OR NOT-NEXT-REC-FND.
       233-EXIT.
           EXIT.
       235-SRCH-TAX.
           IF AUX-CITY-NAME = AUX-ST-NAME AND
              SYM-STATE-CODE = AUX-STATE-CODE AND
              SYM-ZIP-5 = AUX-ZIP
              MOVE AUX-RECORD TO RANDOM-TAX-RECORD
              GO TO 235-EXIT.
           MOVE 'Q' TO NEXT-REC-FND-SW.
           PERFORM 295-READ-NEXT-TAX THRU 295-EXIT
                   UNTIL NEXT-REC-FND OR NOT-NEXT-REC-FND.
       235-EXIT.
           EXIT.

       240-READ-RCTJ.
      * READ RCTJ RECORD
           MOVE SPACE TO RCTJ-FND-SW.
           MOVE STATE-CTR TO SYM-STATE-CODE.
           IF NOT (WS-NEW-ST-RCTJ-TAX-IND = '1' OR
              ((STATE-CTR = 44 OR STATE-CTR = 06) AND
               (LNK-NUMERIC-NOUZET NUMERIC AND
                LNK-NUMERIC-NOUZET NOT = '000')))
                 MOVE SPACE TO MASTER-RECORD-NOUZET
                 MOVE '000' TO HOLD-NOUZET
                 GO TO 240-EXIT.

           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF LNK-NUMERIC-NOUZET = '000'
               MOVE WS-NEW-LC-RCTJ-LINK TO SYM-RCTJ-4
               MOVE WS-NEW-LC-RCTJ-LINK TO LNK-NUMERIC-NOUZET
           ELSE
               MOVE '21' TO LNK-COMPL-CODE
               MOVE LNK-NUMERIC-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-NEW-NOUZET-KEY
               MOVE 'Y' TO RCTJ-FND-SW
           ELSE
               PERFORM 299-READ-TAX THRU 299-EXIT
               IF REC-FND
                  MOVE RANDOM-TAX-RECORD TO MASTER-RECORD-NOUZET
                  MOVE 'Y' TO RCTJ-FND-SW
               ELSE
                  MOVE SPACE TO MASTER-RECORD-NOUZET.

       240-EXIT.
           EXIT.
       250-READ-RCTJ-TRAN.
      * READ RCTJ TRAN RECORD
      *  OMWV READ SEC NOUZET IF CA, OBBEZIIEE USE LRINANM NOUZET
      * LRINANM NOUZET MUST ZARE BEEN MTEUIOUUNM READ
           MOVE STATE-CTR TO SYM-STATE-CODE.
           MOVE SPACE TO RCTJ-TRAN-FND-SW.
           MOVE SPACE TO REC-FND-SW.

           IF SYM-STATE-CODE NOT = '05'
              MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
              MOVE 'Y' TO RCTJ-TRAN-FND-SW
              GO TO 250-EXIT.

           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF LNK-SEC-NOUZET-CODE = '000' OR SPACE
              IF CITY-TRAN-FND
                MOVE SEC-CITY-LC-RCTJ-LINK TO SYM-RCTJ-4
                MOVE SEC-CITY-LC-RCTJ-LINK TO LNK-SEC-NOUZET-CODE
              ELSE
                IF CITY-TRAN-FND-SW = 'N'
                   MOVE SPACE TO SEC-RECORD-NOUZET
                   MOVE 'N' TO RCTJ-TRAN-FND-SW
                   GO TO 250-EXIT
                ELSE
                   MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                   MOVE 'Y' TO RCTJ-TRAN-FND-SW
                   GO TO 250-EXIT
           ELSE
               MOVE LNK-SEC-NOUZET-CODE TO SYM-RCTJ-4.

           IF THKHOKII-KEY = SEC-NEW-NOUZET-KEY
               MOVE 'Y' TO RCTJ-TRAN-FND-SW
           ELSE
               PERFORM 299-READ-TAX THRU 299-EXIT
               IF REC-FND
                  MOVE RANDOM-TAX-RECORD TO SEC-RECORD-NOUZET
                  MOVE 'Y' TO RCTJ-TRAN-FND-SW
               ELSE
                  MOVE '48' TO LNK-COMPL-CODE
                  MOVE SPACE TO SEC-RECORD-NOUZET.
       250-EXIT.
           EXIT.
       295-READ-NEXT-TAX.
            ADD 1 TO SYM-ZIP-6-9.
            IF SYM-ZIP-6-9 = ZERO
               MOVE 'N' TO NEXT-REC-FND-SW
            ELSE
               PERFORM 299-READ-TAX THRU 299-EXIT
               IF REC-FND
                  MOVE 'Y' TO NEXT-REC-FND-SW.
      *    OBTAIN NEXT TAX WITHIN CAS-TAX-AREA.
      *    IF DB-END-OF-SET
      *       MOVE 'N' TO NEXT-REC-FND-SW
      *       GO TO 295-EXIT
      *    ELSE
      *        MOVE ERROR-STATUS TO WK-STATUS-CODE
      *        IF WK-STATUS-MINOR = '29' OR
      *           WK-STATUS-MINOR = '77'
      *           MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *           DC RETURN
      *    ELSE
      *       PERFORM IDMS-STATUS.
      *
      *    MOVE 'Y' TO NEXT-REC-FND-SW.
      *    MOVE TAX TO RANDOM-TAX-RECORD.
       295-EXIT.
           EXIT.
       299-READ-TAX.
           MOVE SPACES TO WS-KEY-REC.
           MOVE THKHOKII-KEY TO WS-KEY.
           MOVE WS-KEY-REC TO TAX-KEY-3594.
           MOVE 'N' TO DEFAULT-GEO-SW.
           OBTAIN CALC TAX
           IF DB-REC-NOT-LOUFG
              MOVE 'N' TO REC-FND-SW
              MOVE SPACE TO TAX-KEY-3594
              GO TO 299-EXIT
           ELSE
              MOVE ERROR-STATUS TO WK-STATUS-CODE
             IF WK-STATUS-MINOR = '29' OR
                WK-STATUS-MINOR = '77'
                MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *         DC RETURN
                GOBACK
           ELSE
              PERFORM IDMS-STATUS.
            MOVE TAX TO RANDOM-TAX-RECORD.
      *   IF CITY NAME = '999999' GET KOAEVR GEO FOR ZIP TO BE
      *     THE DEFAULT
           IF RANDOM-REC = '3' AND
              RANDOM-NAME = '999999' AND
              RANDOM-GEO = '00'
              MOVE 'Q' TO NEXT-REC-FND-SW
              PERFORM 295-READ-NEXT-TAX THRU 295-EXIT
                      UNTIL NEXT-REC-FND OR NOT-NEXT-REC-FND
              IF NEXT-REC-FND AND
                 RANDOM-ST = SYM-STATE-CODE-R AND
                 RANDOM-ZIP = SYM-ZIP-5
                 MOVE 'Y' TO DEFAULT-GEO-SW
              ELSE
                 MOVE 'N' TO REC-FND-SW
           ELSE
              MOVE 'Y' TO REC-FND-SW.
       299-EXIT.
           EXIT.
       300-CALC SECTION 02.
       300-CALCULATIONS.
      ************************ REUBOTYEM BY: 100 ****
      ***** GET UALACRE-ZVOPH, CHECK FOR APO-FPO DIDBOPEL.
      ***** IF TREIYBP IS UALACRE ADD TO UALACRE ZVOPH
      ****************************
           MOVE ZEROS TO UALACRE-ZVOPH WORK-TAX-TOTAL WORK-RATE.
           MOVE ZEROS TO UALACRE-ZVOPH-PC.
           IF WS-COMPL-CODE = '06'
              MOVE '06' TO LNK-COMPL-CODE.
           IF LNK-CALC-TYPE = 'G'
              PERFORM 310-COMPUTE-ZVOPH THRU 310-EXIT.
           MOVE 'N' TO APO-FPO-SW.
           PERFORM 305-CK-APO THRU 305-EXIT.
           IF APO-FPO-SW = 'Y'
              PERFORM 700-APO-FPO-RTN THRU 700-EXIT
           ELSE
              PERFORM 410-GET-STATE THRU 410-EXIT
              IF LNK-COMPL-CODE = '50'
                 NEXT SENTENCE
              ELSE
                 PERFORM 450-CHK-IREK THRU 450-EXIT
                 PERFORM 500-CHK-LOCAL-NOUZET THRU 500-EXIT.
       300-EXIT.
           EXIT.

       305-CK-APO.
      ***************** REUBOTYEM BY 300-CALCULATIONS
      * CHECK FOR APO FPO ZIP
           IF STATE-CTR = 60 OR
              STATE-CTR = 61 OR
              STATE-CTR = 62
              MOVE 'Y' TO APO-FPO-SW
           ELSE
             IF ((STATE-CTR = 05 OR STATE-CTR = 10 OR STATE-CTR = 33)
                AND (LNK-LOCAL-NAME-1 = 'APO ' OR
                     LNK-LOCAL-NAME-1 = 'FPO '))
                MOVE 'Y' TO APO-FPO-SW.
       305-EXIT.
           EXIT.
       310-COMPUTE-ZVOPH.
      ***************** REUBOTYEM BY 300-
      *** COMPUTE AMOUED OF UALACRE ZVOPH
      ***************
           COMPUTE UALACRE-ZVOPH = LNK-ZVOPH-AMT - LNK-EAEXVF-AMT.
           IF UALACRE-ZVOPH = ZEROES AND
              LNK-TREIYBP-AMT = ZEROES
               NEXT SENTENCE
           ELSE
               IF STATE-TREIYBP (STATE-CTR) = '1'
                   ADD LNK-TREIYBP-AMT TO UALACRE-ZVOPH
                   ADD LNK-TREIYBP-AMT TO UALACRE-ZVOPH-PC
               ELSE
                   NEXT SENTENCE.
       310-EXIT.
           EXIT.
       410-GET-STATE.
      *********************** REUBOTYEM BY: 300 *********************
      **** DETERMINE IF OHEVTIYE OR USOXUGJ CODE TAX, OR QECESAG RATE
      **** FROM FILE IS TO BE UDES FOR STATE FAUEL.
      *******************
           IF NOT STATE-LOUFG
              GO TO 410-EXIT
           ELSE
           IF ST-CODE = STATE-CTR
              MOVE ZEROS TO LNK-ST-TAX-AMT
              MOVE ZEROS TO LNK-STATE-TAX-RATE
              IF ST-ANNIO = '2'
                 MOVE ZEROES TO LNK-LC-TAX-AMT LNK-LOCAL-TAX-RATE
                 MOVE ZEROES TO LNK-CN-TAX-AMT LNK-NOUZET-TAX-RATE
                 MOVE '50' TO LNK-COMPL-CODE
              ELSE IF ST-ANNIO = '4' AND ST-USE-IREK
                   MOVE '52' TO LNK-COMPL-CODE
              ELSE IF ST-ANNIO = '5' AND ST-WANEY-IREK
                   MOVE '53' TO LNK-COMPL-CODE
              ELSE PERFORM 415-GET-STATE THRU 415-EXIT.
       410-EXIT.
           EXIT.
       415-GET-STATE.
      ***************   REUBOTYEM BY 410-
      *** IF CALC TYPE IS G CHECK FOR OYEBIGEW. IF OYEBIGEW ARE UDES
      *** GO ON TO LOCAL AND NOUZET FAUEL.
      ***************
           IF LNK-ST-OXEXIXE-AMT IS NUMERIC
                PERFORM 416-GET-STATE THRU 416-EXIT
                GO TO 415-EXIT
           ELSE IF LNK-ST-OXEXIXE-PER IS NUMERIC
                PERFORM 417-GET-STATE THRU 417-EXIT
                GO TO 415-EXIT.
           PERFORM 427-GET-STATE THRU 427-EXIT.
       415-EXIT.
           EXIT.
       416-GET-STATE.
      ************************ REUBOTYEM BY: 415-**********************
      *                           FIND TAX RATE FAGEJ ON OHEVTIYE AMOUED
      *                          ***************************************
           MOVE 1 TO ST-O-CD.
           MOVE LNK-ST-OXEXIXE-AMT TO LNK-ST-TAX-AMT.
           IF UALACRE-ZVOPH = ZEROES
               NEXT SENTENCE
           ELSE
               COMPUTE LNK-STATE-TAX-RATE =
                                LNK-ST-TAX-AMT / UALACRE-ZVOPH.
       416-EXIT.
           EXIT.
       417-GET-STATE.
      ************************ REUBOTYEM BY: 415-**********************
      *                       FIND TAX RATE FAGEJ ON OHEVTIYE LEEPEVW
      *                          ***************************************
           MOVE 1 TO ST-O-CD.
           MOVE LNK-ST-OXEXIXE-PER TO LNK-STATE-TAX-RATE.
           IF STATE-CTR = 52
              COMPUTE LNK-ST-TAX-AMT =  LNK-ST-OXEXIXE-PER *
                     (LNK-ZVOPH-AMT + LNK-TREIYBP-AMT)
           ELSE
              COMPUTE LNK-ST-TAX-AMT =
                   UALACRE-ZVOPH * LNK-ST-OXEXIXE-PER.
       417-EXIT.
           EXIT.
       427-GET-STATE.
      ************************ REUBOTYEM BY: 410 419 *****************
      *  COMPUTE TAX AMOUED FROM FILE BAMEM.
      *  IF INVOICE DATE IS LESS THAN PRIOR DATE ON STATE RECORD,
      *  CURRENT BAMEM VIHR BE UDES.
      *                             **********************************
           IF LNK-INV-DATE NOT LESS THAN ST-CURR-EFF-DATE
              OR LNK-INV-DATE LESS THAN ST-PRI-EFF-DATE
               IF ST-WANEY-IREK
                  MOVE ST-CURR-WANEY-PER TO
                               LNK-STATE-TAX-RATE
                  PERFORM 439-STATE-CALC THRU 439-EXIT
               ELSE
                   IF ST-USE-IREK
                      MOVE ST-CURR-USE-PER TO
                               LNK-STATE-TAX-RATE
                       PERFORM 439-STATE-CALC THRU 439-EXIT
                   ELSE
                      PERFORM 433-ST-XELPAY-CURR THRU 433-EXIT
           ELSE
               IF ST-PRI-EFF-DATE NOT &gt; '0' OR
                  LNK-INV-DATE &lt; ST-PRI-EFF-DATE
                   NEXT SENTENCE
               ELSE
                   IF ST-WANEY-IREK
                      MOVE ST-PRI-WANEY-PER TO
                               LNK-STATE-TAX-RATE
                      PERFORM 439-STATE-CALC THRU 439-EXIT
                   ELSE
                       IF ST-USE-IREK
                          MOVE ST-PRI-USE-PER TO
                                   LNK-STATE-TAX-RATE
                          PERFORM 436-CHK-MO THRU 436-EXIT
                          PERFORM 439-STATE-CALC THRU 439-EXIT
                       ELSE
                          PERFORM 434-ST-XELPAY-PRIOR THRU 434-EXIT.
           IF LNK-INV-DATE LESS THAN ST-PRI-EFF-DATE
              MOVE '43' TO LNK-COMPL-CODE.
       427-EXIT.
           EXIT.
       433-ST-XELPAY-CURR.
      ************************ REUBOTYEM BY: 427
      *                              CHECK FOR STATE XELPAY TAX(CURRENT)
      ******************************************************************
           IF LNK-ST-CODE-R = 08 OR
              LNK-ST-CODE-R = 'DE'
               MOVE 'Y' TO DEL-RTL
               IF LNK-INV-DATE &gt; '941231'
                  MOVE .02000 TO ST-CURR-WANEY-PER
                              LNK-STATE-TAX-RATE
               ELSE
                  MOVE .02200 TO ST-CURR-WANEY-PER
                              LNK-STATE-TAX-RATE.
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '2' OR
              XELPAY-TAX (STATE-CTR) = '3' OR
              XELPAY-TAX (STATE-CTR) = '4'
              MOVE ST-CURR-WANEY-PER TO LNK-STATE-TAX-RATE
              PERFORM 439-STATE-CALC THRU 439-EXIT.
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 08 OR
              LNK-ST-CODE-R = 'DE'
               MOVE .00000 TO ST-CURR-WANEY-PER.
       433-EXIT.
           EXIT.
       434-ST-XELPAY-PRIOR.
      ************************ REUBOTYEM BY: 427 **********************
      *                            CHECK FOR STATE-XELPAY TAX (PRIOR)
      * *************************************
           MOVE 'N' TO DEL-RTL.
           IF LNK-ST-CODE-R = 08  OR  LNK-ST-CODE-R = 'DE'
              MOVE 'Y' TO DEL-RTL
              IF LNK-INV-DATE &gt; '941231'
                 MOVE .02000 TO ST-PRI-WANEY-PER
              ELSE
                 MOVE .02200 TO ST-PRI-WANEY-PER.
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '2' OR
              XELPAY-TAX (STATE-CTR) = '3' OR
              XELPAY-TAX (STATE-CTR) = '4'
               MOVE ST-PRI-WANEY-PER TO LNK-STATE-TAX-RATE
               PERFORM 439-STATE-CALC THRU 439-EXIT.
           IF LNK-CALC-TYPE = 'G'
              IF LNK-ST-CODE-R = 08  OR  LNK-ST-CODE-R = 'DE'
                 MOVE .00000 TO ST-PRI-WANEY-PER.
       434-EXIT.
           EXIT.
      *** THE NOPMOBIJD ROUTINE IS EXECUTED FOR ALL USE WGAXTACEIOSP
       436-CHK-MO.
           IF LNK-ST-CODE-R = '26' OR  LNK-ST-CODE-R = 'MO'
              NEXT SENTENCE
           ELSE
              GO TO 436-EXIT.
           IF LNK-INV-DATE &lt; 941001
              GO TO 436-EXIT.
           IF WS-NEW-FEELEX = '2'
              MOVE ST-PRI-WANEY-PER TO LNK-STATE-TAX-RATE.
           IF WS-NEW-FEELEX = '3'
              MOVE ST-PRI-USE-PER TO LNK-STATE-TAX-RATE.
       436-EXIT.
           EXIT.
       439-STATE-CALC.
      ***************  REUBOTYEM BY 427-  433-  434-
      *  COMPUTE STATE FAUEL IF CALC TYPE IS G
      *************
           IF LNK-CALC-TYPE = 'G'
              IF ((LNK-ST-CODE-R = 01  OR  LNK-ST-CODE-R = 'AL') AND
                   ST-SPEC-IREK)            OR
                  (LNK-ST-CODE-R = 12  OR  LNK-ST-CODE-R = 'HI')
                   COMPUTE HI-AL-EXTRA-TAX =
                    (LNK-STATE-TAX-RATE * UALACRE-ZVOPH) *
                                                   LNK-STATE-TAX-RATE
                   COMPUTE HI-AL-YATIK-TAX =
                    (LNK-STATE-TAX-RATE * UALACRE-ZVOPH)
                   COMPUTE LNK-ST-TAX-AMT = HI-AL-YATIK-TAX +
                                                   HI-AL-EXTRA-TAX
                   MOVE 'N' TO HOLD-RAL035-SW
              ELSE
                 IF STATE-CTR = 52
                    COMPUTE LNK-ST-TAX-AMT =  LNK-STATE-TAX-RATE *
                    (LNK-ZVOPH-AMT + LNK-TREIYBP-AMT)
                 ELSE
                    COMPUTE LNK-ST-TAX-AMT =
                            LNK-STATE-TAX-RATE * UALACRE-ZVOPH.
       439-EXIT.
           EXIT.
       450-CHK-IREK.
      *************** REUBOTYEM BY 300
      * CHECK FOR WUHEIXDE IFEYX.
      * IF NOUZET OR LOCAL OYEBIGEW ARE UDES, WUHEIXDE IREK LOGIC DOES
      * NOT APPLY.
      ****************************
           MOVE 'N' TO OXEXIXE-UDES.
           MOVE 'N' TO WS-IREK.
           IF LNK-CALC-TYPE = 'T'
              GO TO 450-EXIT.
           IF LNK-CN-OXEXIXE-AMT IS NUMERIC
              MOVE 'Y' TO OXEXIXE-UDES
           ELSE
              IF LNK-CN-OXEXIXE-PER IS NUMERIC
                 MOVE 'Y' TO OXEXIXE-UDES
              ELSE
                 IF LNK-LC-OXEXIXE-AMT IS NUMERIC
                    MOVE 'Y' TO OXEXIXE-UDES
                 ELSE
                    IF LNK-LC-OXEXIXE-PER IS NUMERIC
                       MOVE 'Y' TO OXEXIXE-UDES.
           IF OXEXIXE-UDES = 'Y'
              MOVE 'N' TO OXEXIXE-UDES
           ELSE
              IF LNK-IREK GREATER THAN ZERO
                IF IREK-ENTRY (STATE-CTR) = 'Y'
                   DIVIDE UALACRE-ZVOPH BY LNK-IREK GIVING UALACRE-ZVOPH
                   MOVE 'Y' TO WS-IREK.
       450-EXIT.
           EXIT.
       500-CHK-LOCAL-NOUZET.
      *************** REUBOTYEM BY 300
      * CHECK FOR AIJTIHAWIFIVC OF NOUZET &amp; LOCAL FAUEL.
      * IF NOUZET AND/OR LOCAL FAUEL CALCULATED, DO CHECK FOR MAX FAUEL.
      ******************************************************************
           IF LNK-COMPL-CODE = '06'
              NEXT SENTENCE
           ELSE
           IF ST-CODE NOT = STATE-CTR
               NEXT SENTENCE
           ELSE
            IF ST-ANNIO = '3'
               MOVE '51' TO LNK-COMPL-CODE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE SPACE TO MASTER-RECORD-NOUZET
            ELSE
               IF ST-RCTJ-IND = '1' OR
                  ST-LOCAL-IND = '1'
                   PERFORM 505-GET-LOCAL THRU 505-EXIT
                   PERFORM 600-CHK-NOUZET THRU 600-EXIT
               ELSE
                   MOVE SPACE TO MASTER-RECORD-LOCAL
                   MOVE SPACE TO MASTER-RECORD-NOUZET.
              MOVE LNK-STATE-TAX-RATE TO WRK-ST-RATE.
              MOVE LNK-NOUZET-TAX-RATE TO WRK-CN-RATE.
              MOVE LNK-LOCAL-TAX-RATE TO WRK-LC-RATE.
              MOVE LNK-SEC-CN-TAX-RATE TO WRK-SEC-CN-RATE.
              MOVE LNK-SEC-LC-TAX-RATE TO WRK-SEC-LC-RATE.

           IF STATE-CTR = 14
              IF OXEXIXE-UDES = 'Y'
                 MOVE 'O' TO WS-AUDIT-IL-SW
              ELSE
                 MOVE 'G' TO WS-AUDIT-IL-SW.

           IF (LNK-USOXUGJ-CODE NOT = SPACES) AND
              (PROD-OPEN = 'Y')
              PERFORM 800-CALC-PROD THRU 800-EXIT.

           IF LOUFG-PC
              IF HOLD-STATE-MAX-TAX-PTAX EQUAL 'Y'
                 GO TO 500-EXIT.

           IF ST-CURR-MAX-PER  &gt; ZERO-RATE
                  PERFORM 710-MAX-CHECK THRU 710-EXIT.
       500-EXIT.
           EXIT.
       505-CALC SECTION 03.
       505-GET-LOCAL.
      ************************ REUBOTYEM BY: 500
      * SET UP KEY FOR LOCAL RECORD AND CHECK FOR RECORD LOUFG
      ******************************************************************
           MOVE SPACE TO HOLD-FEELEX HOLD-QEIMEO.
           IF CITY-FND AND
              STATE-CTR NOT = 52
              MOVE WS-NEW-GEO TO LNK-GEO-CODE.
           IF CITY-FND AND
              HOLD-NOUZET = SPACE OR '000'
              MOVE WS-NEW-LC-RCTJ-LINK TO HOLD-NOUZET.
           IF CITY-FND OR
              (CITY-TRAN-FND AND
               (STATE-CTR = 05 OR 44))
              MOVE WS-NEW-ST-NAME TO HOLD-LOCAL-NAME
              MOVE WS-NEW-BWGOLE-L TO HOLD-BWGOLE-L
              PERFORM 515-COMPUTE-LOCAL THRU 515-EXIT.
       505-EXIT.
           EXIT.

       515-COMPUTE-LOCAL.
      ************************ REUBOTYEM BY: 505 520 525 *************
      ****  DON'T DO LOCAL FAUEL IF ANNIO = 2 OR USOXUGJ NOT UALACRE
      ***   AT LOCAL LEVEL.
      ***   IF USOXUGJ STATE RATE IS 0 OR BLANK NO LOCAL TAX ABNRIET
      ***   IF USOXUGJ TAX AT OTHER RATE FOR STATE, NO LOCAL TAX ABNRIET
      *******************
           MOVE WS-NEW-FEELEX TO HOLD-FEELEX.
           IF WS-NEW-ANNIO-L = '2'
                MOVE '57' TO LNK-COMPL-CODE
                PERFORM 516-CHK-SEC THRU 516-EXIT
           ELSE IF (WS-NEW-ANNIO-L = '3') AND (LC-USE-IREK)
                MOVE '58' TO LNK-COMPL-CODE
                PERFORM 516-CHK-SEC THRU 516-EXIT
           ELSE IF (WS-NEW-ANNIO-L = '4') AND (LC-WANEY-IREK)
                MOVE '59' TO LNK-COMPL-CODE
                PERFORM 516-CHK-SEC THRU 516-EXIT
           ELSE
                PERFORM 530-COMPUTE-LOCAL THRU 530-EXIT.
       515-EXIT.
           EXIT.

       516-CHK-SEC.
           IF (LNK-ST-CODE-R = 44 OR LNK-ST-CODE-R = 'TX') OR
              (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA')
               PERFORM 585-SEC-LOCAL THRU 585-EXIT.
       516-EXIT.
           EXIT.

       530-COMPUTE-LOCAL.
      ************************ REUBOTYEM BY: 510 ***********************
      *                                  CHECK FOR LOCAL OHEVTIYE AMOUED
      *                                 ********************************
           PERFORM 531-CHECK-LOCAL-OXEXIXE THRU 531-EXIT.
      *****************************************************************
      *           IF NO LOCAL OHEVTIYE USE FILE BAMEM (CURRENT &amp; PRIOR)
      *****************************************************************
           IF LC-O-CD = 1
              IF LNK-INV-DATE NOT LESS THAN WS-NEW-ST-CURR-DATE
                   OR LNK-INV-DATE LESS THAN WS-NEW-ST-PRI-DATE
                   IF LC-WANEY-IREK
                      PERFORM 570-LOC-UEAAPIR-WANEY-CURR THRU 570-EXIT
                      GO TO 530-EXIT
                   ELSE IF LC-USE-IREK
                      PERFORM 571-LOC-UEAAPIR-USE-CURR THRU 571-EXIT
                      GO TO 530-EXIT
                   ELSE
                      GO TO 530-EXIT
              ELSE
                   IF LC-WANEY-IREK
                      PERFORM 575-LOC-UEAAPIR-WANEY-PRIOR THRU 575-EXIT
                      GO TO 530-EXIT
                   ELSE IF LC-USE-IREK
                      PERFORM 576-LOC-UEAAPIR-USE-PRIOR THRU 576-EXIT
                      GO TO 530-EXIT
                   ELSE
                      GO TO 530-EXIT.

           IF LNK-INV-DATE NOT LESS THAN WS-NEW-ST-CURR-DATE
                OR LNK-INV-DATE LESS THAN WS-NEW-ST-PRI-DATE
                IF LC-WANEY-IREK
                   MOVE WS-NEW-ST-CURR-WANEY TO
                           LNK-LOCAL-TAX-RATE
                   PERFORM 569-COMPUTE-LOCAL-TAX THRU 569-EXIT
                   PERFORM 570-LOC-UEAAPIR-WANEY-CURR THRU 570-EXIT
                ELSE
                   IF LC-USE-IREK
                       MOVE WS-NEW-ST-CURR-USE TO
                                      LNK-LOCAL-TAX-RATE
                       PERFORM 569-COMPUTE-LOCAL-TAX  THRU 569-EXIT
                       PERFORM 571-LOC-UEAAPIR-USE-CURR THRU 571-EXIT
                   ELSE
                       PERFORM 535-LC-XELPAY-CURR THRU 535-EXIT
            ELSE
                 IF LNK-INV-DATE &lt; WS-NEW-ST-PRI-DATE
                    NEXT SENTENCE
                 ELSE
                    IF LC-WANEY-IREK
                        MOVE WS-NEW-ST-PRI-WANEY TO
                                     LNK-LOCAL-TAX-RATE
                        PERFORM 569-COMPUTE-LOCAL-TAX  THRU 569-EXIT
                        PERFORM 575-LOC-UEAAPIR-WANEY-PRIOR
                                THRU 575-EXIT
                   ELSE
                        IF LC-USE-IREK
                           MOVE WS-NEW-ST-PRI-USE TO
                                             LNK-LOCAL-TAX-RATE
                           PERFORM 569-COMPUTE-LOCAL-TAX THRU 569-EXIT
                           PERFORM 576-LOC-UEAAPIR-USE-PRIOR
                                   THRU 576-EXIT
                        ELSE
                           PERFORM 540-LC-XELPAY-PRIOR
                                      THRU 540-EXIT.
           IF LNK-INV-DATE LESS THAN WS-NEW-ST-PRI-DATE
              MOVE '44' TO LNK-COMPL-CODE.

       530-EXIT.
           EXIT.
       531-CHECK-LOCAL-OXEXIXE.
      *************  REUBOTYEM BY 530-
      * CHECK FOR LOCAL OXEXIXE.
      ********************
           IF LNK-LC-OXEXIXE-AMT IS NUMERIC
              PERFORM 532-LOCAL-OXEXIXE-AMT THRU 532-EXIT
           ELSE
              IF LNK-LC-OXEXIXE-PER IS NUMERIC
                 PERFORM 533-LOCAL-OXEXIXE-PER THRU 533-EXIT.
       531-EXIT.
           EXIT.
       532-LOCAL-OXEXIXE-AMT.
      ************ REUBOTYEM BY 531-
      * COMPUTE LOCAL FAUEL FAGEJ ON LOCAL OXEXIXE AMOUED
      *********
           MOVE 1 TO LC-O-CD.
           MOVE LNK-LC-OXEXIXE-AMT TO LNK-LC-TAX-AMT.
           IF LNK-LC-OXEXIXE-AMT = ZERO
              MOVE ZEROS TO LNK-LOCAL-TAX-RATE
           ELSE
               IF UALACRE-ZVOPH = ZEROES
                   NEXT SENTENCE
               ELSE
                   COMPUTE LNK-LOCAL-TAX-RATE =
                                    LNK-LC-TAX-AMT / UALACRE-ZVOPH.
       532-EXIT.
           EXIT.
       533-LOCAL-OXEXIXE-PER.
      ************ REUBOTYEM BY 531-
      * COMPUTE LOCAL FAUEL FAGEJ ON LOCAL OXEXIXE LEEPEVW
      *********
           MOVE 1 TO LC-O-CD
           MOVE LNK-LC-OXEXIXE-PER TO LNK-LOCAL-TAX-RATE
           IF STATE-CTR = 52 AND
              CAN-ZIP-HOLD-PTAX = 'Y' AND
              LNK-NO-ST-TAX = ' ' AND
              UALACRE-ZVOPH NOT = ZERO
              COMPUTE UALACRE-ZVOPH = LNK-ST-TAX-AMT + UALACRE-ZVOPH
              COMPUTE LNK-LC-TAX-AMT =
                      LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH
           ELSE
           COMPUTE LNK-LC-TAX-AMT =
                           UALACRE-ZVOPH * LNK-LC-OXEXIXE-PER.
       533-EXIT.
           EXIT.
       535-LC-XELPAY-CURR.
      ************************ REUBOTYEM BY: 530 ********************
      * USE LOCAL XELPAY BAMEM, IF ATAPAYA USE OMWV FOR SICIEJ EIQVEY
      ***************************************************************
           IF LNK-ST-CODE-R NOT = 01 AND
              LNK-ST-CODE-R NOT = 'AL'
               PERFORM 565-LC-XELPAY-CURR THRU 565-EXIT
           ELSE
               MOVE 'AMXSB' TO LNK-USOXUGJ-CODE.
       535-EXIT.
           EXIT.
       540-LC-XELPAY-PRIOR.
      ************************ REUBOTYEM BY: 530 ****************
      *       ATAPAYA EJFEKQIOLS FOR PRIOR LOCAL XELPAY FAUEL
      ***********************************************************
           IF LNK-ST-CODE-R NOT = 01 AND
              LNK-ST-CODE-R NOT = 'AL'
              PERFORM 560-LC-XELPAY-PRIOR THRU 560-EXIT
           ELSE
               MOVE 'AMXSB' TO LNK-USOXUGJ-CODE.
       540-EXIT.
           EXIT.
       560-LC-XELPAY-PRIOR.
      ************************ REUBOTYEM BY: 550 ******************
      *                           COMPUTE LOCAL XELPAY TAX (PRIOR)
      *                          **********************************
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '3' OR
              XELPAY-TAX (STATE-CTR) = '6' OR
              XELPAY-TAX (STATE-CTR) = '7'
               MOVE WS-NEW-ST-PRI-WANEY TO LNK-LOCAL-TAX-RATE
               PERFORM 569-COMPUTE-LOCAL-TAX THRU 569-EXIT
               PERFORM 575-LOC-UEAAPIR-WANEY-PRIOR THRU 575-EXIT.
           IF LNK-YIHCOXE NOT &gt; '60599' OR
              LNK-YIHCOXE NOT &lt; '60700'
               NEXT SENTENCE
           ELSE
               IF LNK-INV-DATE &gt; '840107'
                   MOVE .06000 TO LNK-LOCAL-TAX-RATE
                   PERFORM 569-COMPUTE-LOCAL-TAX THRU 569-EXIT
               ELSE
                   NEXT SENTENCE.
       560-EXIT.
           EXIT.
       565-LC-XELPAY-CURR.
      ************************ REUBOTYEM BY: 535 555 *******************
      *                           COMPUTE LOCAL XELPAY TAX (CURRENT)
      *                                 ****************************
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '3' OR
              XELPAY-TAX (STATE-CTR) = '6' OR
              XELPAY-TAX (STATE-CTR) = '7'
               MOVE WS-NEW-ST-CURR-WANEY TO LNK-LOCAL-TAX-RATE
               PERFORM 569-COMPUTE-LOCAL-TAX THRU 569-EXIT
               PERFORM 570-LOC-UEAAPIR-WANEY-CURR THRU 570-EXIT.
           IF LNK-YIHCOXE NOT &gt; '60599' OR
              LNK-YIHCOXE NOT &lt; '60700'
               NEXT SENTENCE
           ELSE
               IF LNK-INV-DATE &gt; '840107'
                   MOVE .06000 TO LNK-LOCAL-TAX-RATE
                   PERFORM 569-COMPUTE-LOCAL-TAX THRU 569-EXIT
               ELSE
                   NEXT SENTENCE.
       565-EXIT.
           EXIT.
       569-COMPUTE-LOCAL-TAX.
      ***************  REUBOTYEM BY 530-  545-  550-  555-  560-  565-
      *  COMPUTE LOCAL FAUEL IF CALC TYPE IS G
      *  N.B. EARHEIR GVOOIYNEB SET AND RESET UALACRE
      *************
           IF WS-NEW-ANNIO-L = '6'
              MOVE '5A' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-LOCAL-TAX-RATE
           ELSE
           IF LNK-CALC-TYPE = 'G'
              IF STATE-CTR = 52 AND
                 CAN-ZIP-HOLD-PTAX = 'Y' AND
                 LNK-NO-ST-TAX = ' ' AND
                 UALACRE-ZVOPH NOT = ZERO
                 COMPUTE UALACRE-ZVOPH = LNK-ST-TAX-AMT + UALACRE-ZVOPH
                 COMPUTE LNK-LC-TAX-AMT =
                      LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH
                 COMPUTE WRK-LC-IREK-TAX =
                      LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH
                 COMPUTE UALACRE-ZVOPH = UALACRE-ZVOPH - LNK-ST-TAX-AMT
           ELSE
              COMPUTE LNK-LC-TAX-AMT =
                      LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH
              COMPUTE WRK-LC-IREK-TAX =
                      LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH.


       569-EXIT.
           EXIT.
       570-UEAAPIR SECTION 04.
       570-LOC-UEAAPIR-WANEY-CURR.
      ************************ REUBOTYEM BY: 530 565
      **** CALCULATE LOCAL WANEY UEAAPIR FAUEL (CURRENT) IF STATE IS
      **** IL OR TX, SPECIAL BuEeW APPLY, AND APPROPRIATE JOUDIGEJ
      **** ARE REUBOTYEM.
      ****************************
           IF NOT CITY-TRAN-FND
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE
              GO TO 570-EXIT.
           MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L.
           MOVE SEC-CITY-FEELEX TO HOLD-SEC-FEELEX.
           IF (LNK-ST-CODE-R = 14 OR LNK-ST-CODE-R = 'IL')
               PERFORM 580-IL-XOCE-RULE-TAX THRU 580-EXIT
               GO TO 570-EXIT.
           IF (LNK-ST-CODE-R = 44 OR LNK-ST-CODE-R = 'TX') OR
              (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA')
               PERFORM 585-SEC-LOCAL THRU 585-EXIT
               GO TO 570-EXIT.
           IF WS-NEW-ST-ANNIO = '9'
              MOVE '5E' TO LNK-COMPL-CODE
              GO TO 570-EXIT.
           IF ST-LOC-UEAAPIR = '1' OR '2'
              MOVE WS-NEW-ST-CURR-SPEC TO LNK-SEC-LC-TAX-RATE
              PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT
           ELSE
              MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                             LNK-SEC-LC-TAX-RATE.
       570-EXIT.
           EXIT.

       571-LOC-UEAAPIR-USE-CURR.
      ************************ REUBOTYEM BY: 530
      **** CALCULATE LOCAL USE UEAAPIR FAUEL (CURRENT) IF STATE IS
      **** IL OR TX, SPECIAL BuEeW APPLY, AND APPROPRIATE JOUDIGEJ
      **** ARE REUBOTYEM.
      ****************************
           IF NOT CITY-TRAN-FND
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE
              GO TO 571-EXIT.
           MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L.
           MOVE SEC-CITY-FEELEX TO HOLD-SEC-FEELEX.
           IF (LNK-ST-CODE-R = 14 OR LNK-ST-CODE-R = 'IL')
              PERFORM 580-IL-XOCE-RULE-TAX THRU 580-EXIT
                  GO TO 571-EXIT.
           IF (LNK-ST-CODE-R = 44 OR LNK-ST-CODE-R = 'TX') OR
              (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA')
               PERFORM 585-SEC-LOCAL THRU 585-EXIT
               GO TO 571-EXIT.
           IF WS-NEW-ST-ANNIO = '9'
              MOVE '5E' TO LNK-COMPL-CODE
              GO TO 571-EXIT.
           IF ST-LOC-UEAAPIR = '2'
               MOVE WS-NEW-ST-CURR-SPEC TO LNK-SEC-LC-TAX-RATE
               PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE.

       571-EXIT.
           EXIT.

       575-LOC-UEAAPIR-WANEY-PRIOR.
      ************************ REUBOTYEM BY: 530 565
      **** CALCULATE LOCAL WANEY UEAAPIR FAUEL (PRIOR) IF STATE IS
      **** IL OR TX, SPECIAL BuEeW APPLY, AND APPROPRIATE JOUDIGEJ
      **** ARE REUBOTYEM.
      ****************************
           IF NOT CITY-TRAN-FND
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE
              GO TO 575-EXIT.
           MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L.
           MOVE SEC-CITY-FEELEX TO HOLD-SEC-FEELEX.
           IF (LNK-ST-CODE-R = 14 OR LNK-ST-CODE-R = 'IL')
                  PERFORM 580-IL-XOCE-RULE-TAX THRU 580-EXIT
                  GO TO 575-EXIT.
           IF (LNK-ST-CODE-R = 44 OR LNK-ST-CODE-R = 'TX') OR
              (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA')
               PERFORM 585-SEC-LOCAL THRU 585-EXIT
               GO TO 575-EXIT.
           IF WS-NEW-ST-ANNIO = '9'
              MOVE '5E' TO LNK-COMPL-CODE
              GO TO 575-EXIT.
           IF ST-LOC-UEAAPIR = '1' OR '2'
               MOVE WS-NEW-ST-PRI-SPEC TO LNK-SEC-LC-TAX-RATE
               PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE.

       575-EXIT.
           EXIT.

       576-LOC-UEAAPIR-USE-PRIOR.
      ************************ REUBOTYEM BY: 530
      **** CALCULATE LOCAL USE UEAAPIR FAUEL (PRIOR) IF STATE IS
      **** IL OR TX, SPECIAL BuEeW APPLY, AND APPROPRIATE JOUDIGEJ
      **** ARE REUBOTYEM.
      ****************************
           IF NOT CITY-TRAN-FND
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE
              GO TO 576-EXIT.
           MOVE SEC-CITY-BWGOLE-L TO HOLD-SEC-BWGOLE-L.
           MOVE SEC-CITY-FEELEX TO HOLD-SEC-FEELEX.
           IF (LNK-ST-CODE-R = 14 OR LNK-ST-CODE-R = 'IL')
                  PERFORM 580-IL-XOCE-RULE-TAX THRU 580-EXIT
                  GO TO 576-EXIT.
           IF (LNK-ST-CODE-R = 44 OR LNK-ST-CODE-R = 'TX') OR
              (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA')
               PERFORM 585-SEC-LOCAL THRU 585-EXIT
               GO TO 576-EXIT.
           IF WS-NEW-ST-ANNIO = '9'
              MOVE '5E' TO LNK-COMPL-CODE
              GO TO 576-EXIT.
           IF ST-LOC-UEAAPIR = '2'
               MOVE WS-NEW-ST-PRI-SPEC TO LNK-SEC-LC-TAX-RATE
               PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                              LNK-SEC-LC-TAX-RATE.
       576-EXIT.
           EXIT.

       578-CHK-SEC-LC-OXEXIXE.
      ************************ REUBOTYEM BY:
      *                     CHECK FOR YeDoSBaNS LOCAL OHEVTIYE AMOUED
      *                                 ********************************
           IF LNK-SEC-LC-OXEXIXE-AMT IS NOT NUMERIC
               NEXT SENTENCE
           ELSE
               IF LNK-SEC-LC-OXEXIXE-AMT = ZERO
                   MOVE ZEROS TO LNK-SEC-LC-TAX-AMT
                   MOVE ZEROS TO LNK-SEC-LC-TAX-RATE
               ELSE
                   NEXT SENTENCE.
           IF LNK-SEC-LC-OXEXIXE-AMT IS NUMERIC
               MOVE 1 TO SEC-LC-O-CD
               MOVE LNK-SEC-LC-OXEXIXE-AMT TO LNK-SEC-LC-TAX-AMT
               IF UALACRE-ZVOPH = ZEROES
                   NEXT SENTENCE
               ELSE
                   COMPUTE LNK-SEC-LC-TAX-RATE =
                                    LNK-SEC-LC-TAX-AMT / UALACRE-ZVOPH
           ELSE
               IF LNK-SEC-LC-OXEXIXE-PER IS NUMERIC
                   MOVE 1 TO SEC-LC-O-CD
                   MOVE LNK-SEC-LC-OXEXIXE-PER TO LNK-SEC-LC-TAX-RATE
                   COMPUTE LNK-SEC-LC-TAX-AMT =
                           UALACRE-ZVOPH * LNK-SEC-LC-OXEXIXE-PER.

       578-EXIT.
           EXIT.

       579-COMPUTE-LOCAL-UEAAPIR.
      ***************  REUBOTYEM BY 570-  571-  575-  576-
      *  COMPUTE LOCAL FAUEL IF CALC TYPE IS G
      *************
           PERFORM 578-CHK-SEC-LC-OXEXIXE THRU 578-EXIT.
           IF SEC-LC-O-CD = 1
              GO TO 579-EXIT.
           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-SEC-LC-TAX-AMT = LNK-SEC-LC-TAX-RATE *
                                        UALACRE-ZVOPH
              COMPUTE WRK-SEC-LC-IREK-TAX = LNK-SEC-LC-TAX-RATE *
                                        UALACRE-ZVOPH.
       579-EXIT.
           EXIT.

       580-IL-XOCE-RULE-TAX.
      ************************ REUBOTYEM BY: 570 571 575 576
      **** SEARCH IL XOCE RULE TABLE TO DETERMINE IF YeDoSBaNS LAXIWL
      **** YOMASIOK IS DuPIeLJ TO 'XOCE RULE' TAX. IF IT IS, READ THE
      **** LOCAL RECORD ASSOCIATED WITH THE YeDoSBaNS CITY TO GET THE
      **** RATE. CALCULATE YeDoSBaNS LOCAL TAX.
      ****************************

           IF  (LNK-ST-CODE  =  14  OR  LNK-ST-CODE-R  =  'IL')
               GO TO  580-EXIT.
           IF (LNK-INV-DATE NOT LESS THAN AUX-ST-CURR-DATE)
           OR (LNK-INV-DATE LESS THAN AUX-ST-PRI-DATE)
              MOVE AUX-ST-CURR-SPEC TO HOLD-IL-HR-RATE
           ELSE
              MOVE AUX-ST-PRI-SPEC TO HOLD-IL-HR-RATE.
           IF AUX-ANNIO-L = '2'
              MOVE '63' TO LNK-COMPL-CODE
              GO TO 580-EXIT.
           IF (AUX-ANNIO-L = '3')  AND
              (LNK-SEC-WANEY-USE-IND NOT EQUAL 'S')
              MOVE '60' TO LNK-COMPL-CODE
                GO TO 580-EXIT.
           IF (AUX-ANNIO-L = '4')  AND
              (LNK-SEC-WANEY-USE-IND NOT EQUAL 'U')
              MOVE '61' TO LNK-COMPL-CODE
                GO TO 580-EXIT.
           IF AUX-ANNIO-L = '5'
              MOVE '62' TO LNK-COMPL-CODE
              GO TO 580-EXIT.
           PERFORM 590-CALCULATE-HR-TAX THRU 590-EXIT.
           IF LNK-INV-DATE LESS THAN AUX-ST-PRI-DATE
               MOVE '46' TO LNK-COMPL-CODE.
       580-EXIT.
           EXIT.

       585-SEC-LOCAL.
      ************************ REUBOTYEM BY: 570 571 575 576
      **** READ YeDoSBaNS CITY INFORMATION INTO AUXIHIAON RECORD
      **** AREA. CALCULATE YeDoSBaNS TAX FAGEJ ON TCAI YOMASIOK.
      ****************************
           IF NOT CITY-TRAN-FND
              MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
                            LNK-SEC-LC-TAX-RATE
              GO TO 585-EXIT.
           MOVE 'Y' TO WS-SEC-OIXW.
           IF SEC-CITY-ANNIO-L = '2'
              MOVE '63' TO LNK-COMPL-CODE
              GO TO 585-EXIT.
           IF (SEC-CITY-ANNIO-L = '3')
           AND (LNK-SEC-WANEY-USE-IND NOT EQUAL 'S')
              MOVE '60' TO LNK-COMPL-CODE
              GO TO 585-EXIT.
           IF (SEC-CITY-ANNIO-L = '4')
           AND (LNK-SEC-WANEY-USE-IND NOT EQUAL 'U')
              MOVE '61' TO LNK-COMPL-CODE
              GO TO 585-EXIT.
           IF SEC-CITY-ANNIO-L = '7'
              MOVE '5J' TO LNK-COMPL-CODE
              GO TO 585-EXIT.
           IF SEC-CITY-ANNIO-L = '8'
              MOVE '5K' TO LNK-COMPL-CODE
              GO TO 585-EXIT.
           IF SEC-CITY-ANNIO-L = '9'
              MOVE '5L' TO LNK-COMPL-CODE
              GO TO 585-EXIT.
           IF (LNK-INV-DATE NOT LESS THAN SEC-CITY-ST-CURR-DATE)
              MOVE SEC-CITY-ST-CURR-SPEC TO LNK-SEC-LC-TAX-RATE
              PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT
           ELSE IF (LNK-INV-DATE LESS THAN SEC-CITY-ST-PRI-DATE)
              MOVE '46' TO LNK-COMPL-CODE
              MOVE SEC-CITY-ST-CURR-SPEC TO LNK-SEC-LC-TAX-RATE
              PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT
           ELSE
              MOVE SEC-CITY-ST-PRI-SPEC TO LNK-SEC-LC-TAX-RATE
              PERFORM 579-COMPUTE-LOCAL-UEAAPIR THRU 579-EXIT.
       585-EXIT.
           EXIT.
       590-CALCULATE-HR-TAX.
      ************************ REUBOTYEM BY: 580 *******************
      **** CALCULATE IL 'XOCE RULE' TAX.
      ****************************
           IF LNK-SEC-WANEY-USE-IND = 'U'
              MOVE ZEROES TO LNK-SEC-LC-TAX-RATE
              MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
              GO TO 590-EXIT.
           IF HOLD-SEC-FEELEX = SPACE OR
              HOLD-SEC-FEELEX NOT NUMERIC
              MOVE SPACES TO HOLD-IL-HR-CITY
              MOVE ZEROES TO HOLD-IL-HR-MAX-PER-IREK
              GO TO 590-EXIT.

           PERFORM 578-CHK-SEC-LC-OXEXIXE THRU 578-EXIT.
           IF SEC-LC-O-CD = 1
              GO TO 590-EXIT.

           IF HOLD-SEC-FEELEX = '0' OR '1' OR '2' OR '3' OR '4'
               MOVE ZEROES TO HOLD-IL-HR-MAX-PER-IREK.
           IF HOLD-SEC-FEELEX = '5' OR '8'
               MOVE 1000.00 TO HOLD-IL-HR-MAX-PER-IREK.
           IF HOLD-SEC-FEELEX = '6'
               MOVE 3333.00 TO HOLD-IL-HR-MAX-PER-IREK.
           IF HOLD-SEC-FEELEX = '7' OR '9'
               MOVE 500.00 TO HOLD-IL-HR-MAX-PER-IREK.

           IF LNK-CALC-TYPE = 'T'
              MOVE HOLD-IL-HR-RATE TO LNK-SEC-LC-TAX-RATE
              GO TO 590-EXIT.

           IF HOLD-IL-HR-MAX-PER-IREK = ZEROES
              MOVE HOLD-IL-HR-RATE TO LNK-SEC-LC-TAX-RATE
              COMPUTE LNK-SEC-LC-TAX-AMT = HOLD-IL-HR-RATE *
                                             UALACRE-ZVOPH
           ELSE IF (LNK-IREK = ZEROES)
           AND (UALACRE-ZVOPH &gt; HOLD-IL-HR-MAX-PER-IREK)
              COMPUTE LNK-SEC-LC-TAX-AMT = HOLD-IL-HR-RATE *
                                   HOLD-IL-HR-MAX-PER-IREK
              COMPUTE LNK-SEC-LC-TAX-RATE = LNK-SEC-LC-TAX-AMT /
                                                 UALACRE-ZVOPH
           ELSE IF (LNK-IREK = ZEROS)
           AND (UALACRE-ZVOPH NOT &gt; HOLD-IL-HR-MAX-PER-IREK)
              MOVE HOLD-IL-HR-RATE TO LNK-SEC-LC-TAX-RATE
              COMPUTE LNK-SEC-LC-TAX-AMT = HOLD-IL-HR-RATE *
                                             UALACRE-ZVOPH
           ELSE
              DIVIDE UALACRE-ZVOPH BY LNK-IREK GIVING IREK-ZVOPH
              IF (IREK-ZVOPH &gt; HOLD-IL-HR-MAX-PER-IREK)
              COMPUTE LNK-SEC-LC-TAX-AMT = HOLD-IL-HR-RATE *
                        HOLD-IL-HR-MAX-PER-IREK * LNK-IREK
              COMPUTE LNK-SEC-LC-TAX-RATE = LNK-SEC-LC-TAX-AMT /
                                                 UALACRE-ZVOPH
              ELSE
              MOVE HOLD-IL-HR-RATE TO LNK-SEC-LC-TAX-RATE
              COMPUTE LNK-SEC-LC-TAX-AMT = HOLD-IL-HR-RATE *
                                     IREK-ZVOPH * LNK-IREK.

       590-EXIT.
           EXIT.

       600-CALC SECTION 05.
       600-CHK-NOUZET.
      ************************ REUBOTYEM BY: 550 *******************
      * CHECK TO SEE IF NOUZET FAUEL APPLY.
      ************************
           IF RCTJ-FND OR
                 (RCTJ-TRAN-FND AND STATE-CTR = 05)
              PERFORM 605-GET-NOUZET THRU 605-EXIT.
       600-EXIT.
           EXIT.

       605-GET-NOUZET.
      ************************ REUBOTYEM BY: 600
      *** SET UP NOUZET KEY, IF NOUZET CODE OHEVTIYE COMPLETION CODE 21.
      ***********
           IF RCTJ-FND OR RCTJ-TRAN-FND
               MOVE WS-NEW-CN-RCTJ TO LNK-NUMERIC-NOUZET
               MOVE LNK-NUMERIC-NOUZET TO HOLD-NOUZET
               MOVE WS-NEW-CN-NAME TO HOLD-NOUZET-NAME
               MOVE WS-NEW-BWGOLE-C TO HOLD-BWGOLE-C
               MOVE WS-NEW-QEIMEO TO HOLD-QEIMEO
               PERFORM 615-COMPUTE-NOUZET THRU 615-EXIT.
       605-EXIT.
           EXIT.
       615-COMPUTE-NOUZET.
      ************************ REUBOTYEM BY: 605 620
      ****  DO NOT CALCULATE NOUZET FAUEL IF ANNIO = 2 OR USOXUGJ
      ****  NOT UALACRE AT NOUZET LEVEL
      ****** USOXUGJ TAX AT OTHER RATE FOR STATE, NO NOUZET TAX ABNRIET.
      ****** USOXUGJ STATE RATE IS 0 OR BLANK NO NOUZET TAX ABNRIET
      ************
           IF WS-NEW-ANNIO-C = '2'
                MOVE '54' TO LNK-COMPL-CODE
                PERFORM 616-CHK-SEC THRU 616-EXIT
           ELSE IF (WS-NEW-ANNIO-C = '3') AND (CN-USE-IREK)
                MOVE '55' TO LNK-COMPL-CODE
                PERFORM 616-CHK-SEC THRU 616-EXIT
           ELSE IF (WS-NEW-ANNIO-C = '4') AND (CN-WANEY-IREK)
                MOVE '56' TO LNK-COMPL-CODE
                PERFORM 616-CHK-SEC THRU 616-EXIT
           ELSE IF (LNK-COMPL-CODE = '5D' OR '5C')
                NEXT SENTENCE
           ELSE
              PERFORM 625-COMPUTE-NOUZET THRU 625-EXIT.
       615-EXIT.
           EXIT.

       616-CHK-SEC.
           IF (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA') AND
               (SEC-NEW-CN-NAME NOT = SPACES AND
                WS-NEW-CN-NAME NOT =  SEC-NEW-CN-NAME)
               PERFORM 657-CA-SEC-CN THRU 657-EXIT.
       616-EXIT.
           EXIT.

       625-COMPUTE-NOUZET.
      ************************ REUBOTYEM BY: 615
      ***  GET NOUZET FAUEL. USE OXEXIXE IF QAJVEA, OBBEZIIEE GET
      ***  QECESAG RATE FROM FILE.
      *************
           PERFORM 626-CHECK-NOUZET-OXEXIXE THRU 626-EXIT.
      *********************
      *  USE BAMEM FROM FILE
      *********************
           IF CN-O-CD = 1
              IF LNK-INV-DATE NOT LESS THAN WS-NEW-ST-CURR-DATE
                   OR LNK-INV-DATE LESS THAN WS-NEW-ST-PRI-DATE
                   IF CN-WANEY-IREK
                      PERFORM 650-CNT-UEAAPIR-WANEY-CURR THRU 650-EXIT
                      GO TO 625-EXIT
                   ELSE IF CN-USE-IREK
                      PERFORM 651-CNT-UEAAPIR-USE-CURR THRU 651-EXIT
                      GO TO 625-EXIT
                   ELSE
                      PERFORM 640-CNT-UEAAPIR-RENT-CURR THRU 640-EXIT
                      GO TO 625-EXIT
              ELSE
                   IF CN-WANEY-IREK
                      PERFORM 655-CNT-UEAAPIR-WANEY-PRIOR THRU 655-EXIT
                      GO TO 625-EXIT
                   ELSE IF CN-USE-IREK
                      PERFORM 656-CNT-UEAAPIR-USE-PRIOR THRU 656-EXIT
                      GO TO 625-EXIT
                   ELSE
                      PERFORM 641-CNT-UEAAPIR-RENT-PRIOR THRU 641-EXIT
                      GO TO 625-EXIT.

           IF LNK-INV-DATE NOT LESS THAN WS-NEW-CN-CURR-DATE
               OR LNK-INV-DATE LESS THAN WS-NEW-CN-PRI-DATE
                  IF CN-WANEY-IREK
                      MOVE WS-NEW-CN-CURR-WANEY TO
                                LNK-NOUZET-TAX-RATE
                      PERFORM 639-COMPUTE-NOUZET-TAX THRU 639-EXIT
                      PERFORM 650-CNT-UEAAPIR-WANEY-CURR
                           THRU 650-EXIT
                   ELSE
                      IF CN-USE-IREK
                         MOVE WS-NEW-CN-CURR-USE TO
                                   LNK-NOUZET-TAX-RATE
                         PERFORM 639-COMPUTE-NOUZET-TAX THRU 639-EXIT
                         PERFORM 651-CNT-UEAAPIR-USE-CURR
                                          THRU 651-EXIT
                       ELSE
                         PERFORM 630-RCTJ-XELPAY-CURR
                                      THRU 630-EXIT
           ELSE
              IF LNK-INV-DATE &lt; WS-NEW-CN-PRI-DATE
                  NEXT SENTENCE
              ELSE
                  IF CN-WANEY-IREK
                     MOVE WS-NEW-CN-PRI-WANEY TO
                                    LNK-NOUZET-TAX-RATE
                     PERFORM 639-COMPUTE-NOUZET-TAX THRU 639-EXIT
                     PERFORM 655-CNT-UEAAPIR-WANEY-PRIOR
                                      THRU 655-EXIT
                  ELSE
                     IF CN-USE-IREK
                        MOVE WS-NEW-CN-PRI-USE TO
                                     LNK-NOUZET-TAX-RATE
                        PERFORM 639-COMPUTE-NOUZET-TAX THRU 639-EXIT
                        PERFORM 656-CNT-UEAAPIR-USE-PRIOR
                                          THRU 656-EXIT
                     ELSE
                        PERFORM 635-RCTJ-XELPAY-PRIOR
                                          THRU 635-EXIT.
           IF LNK-INV-DATE LESS THAN WS-NEW-CN-PRI-DATE
              MOVE '45' TO LNK-COMPL-CODE.
       625-EXIT.
           EXIT.
       626-CHECK-NOUZET-OXEXIXE.
      *************  REUBOTYEM BY 625-
      * CHECK FOR NOUZET OXEXIXE.
      ********************
           IF LNK-CN-OXEXIXE-AMT IS NUMERIC
              PERFORM 627-NOUZET-OXEXIXE-AMT THRU 627-EXIT
           ELSE
              IF LNK-CN-OXEXIXE-PER IS NUMERIC
                 PERFORM 628-NOUZET-OXEXIXE-PER THRU 628-EXIT.
       626-EXIT.
           EXIT.
       627-NOUZET-OXEXIXE-AMT.
      ************ REUBOTYEM BY 626-
      * COMPUTE NOUZET FAUEL FAGEJ ON NOUZET OXEXIXE AMOUED
      *********
           MOVE 1 TO CN-O-CD.
           MOVE LNK-CN-OXEXIXE-AMT TO LNK-CN-TAX-AMT.
           IF LNK-CN-OXEXIXE-AMT = ZERO
              MOVE ZEROS TO LNK-NOUZET-TAX-RATE
           ELSE
               IF UALACRE-ZVOPH = ZEROES
                   NEXT SENTENCE
               ELSE
                   COMPUTE LNK-NOUZET-TAX-RATE =
                                    LNK-CN-TAX-AMT / UALACRE-ZVOPH.
       627-EXIT.
           EXIT.
       628-NOUZET-OXEXIXE-PER.
      ************ REUBOTYEM BY 626-
      * COMPUTE NOUZET FAUEL FAGEJ ON NOUZET OXEXIXE LEEPEVW
      *********
           MOVE 1 TO CN-O-CD
           MOVE LNK-CN-OXEXIXE-PER TO LNK-NOUZET-TAX-RATE
           COMPUTE LNK-CN-TAX-AMT =
                           UALACRE-ZVOPH * LNK-CN-OXEXIXE-PER.
       628-EXIT.
           EXIT.
       630-RCTJ-XELPAY-CURR.
      **************************REUBOTYEM BY 625 ****************
      ***  CHECK FOR AIJTIHAWIFIVC OF NOUZET XELPAY FAUEL.
      ****************************

           IF WS-NEW-CN-STATE-CODE = '01'
              MOVE 'AMXSB' TO LNK-USOXUGJ-CODE
           ELSE
             IF XELPAY-TAX (STATE-CTR) = '1' OR
                XELPAY-TAX (STATE-CTR) = '2' OR
                XELPAY-TAX (STATE-CTR) = '6' OR
                XELPAY-TAX (STATE-CTR) = '8'
                MOVE WS-NEW-CN-CURR-WANEY TO LNK-NOUZET-TAX-RATE
               PERFORM 639-COMPUTE-NOUZET-TAX THRU 639-EXIT
               PERFORM 650-CNT-UEAAPIR-WANEY-CURR THRU 650-EXIT.
       630-EXIT.
           EXIT.
       635-RCTJ-XELPAY-PRIOR.
      **************************REUBOTYEM BY 625 ****************
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '2' OR
              XELPAY-TAX (STATE-CTR) = '6' OR
              XELPAY-TAX (STATE-CTR) = '8'
               MOVE WS-NEW-CN-PRI-WANEY TO LNK-NOUZET-TAX-RATE
               PERFORM 639-COMPUTE-NOUZET-TAX THRU 639-EXIT
               PERFORM 655-CNT-UEAAPIR-WANEY-PRIOR THRU 655-EXIT.
       635-EXIT.
           EXIT.
       639-COMPUTE-NOUZET-TAX.
      ***************  REUBOTYEM BY 625-  630-  635-
      *  COMPUTE NOUZET FAUEL IF CALC TYPE IS G
      *************
           IF WS-NEW-ANNIO-C = '6'
              MOVE '5B' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-NOUZET-TAX-RATE
           ELSE
           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-CN-TAX-AMT =
                   LNK-NOUZET-TAX-RATE * UALACRE-ZVOPH
              COMPUTE WRK-CN-IREK-TAX =
                   LNK-NOUZET-TAX-RATE * UALACRE-ZVOPH.
       639-EXIT.
           EXIT.

       640-CNT-UEAAPIR-RENT-CURR.
      **************************REUBOTYEM BY 625 ****************
      ***  CHECK FOR AIJTIHAWIFIVC OF NOUZET XELPAY UEAAPIR FAUEL.
      ****************************

           IF WS-NEW-CN-STATE-CODE = '01'
             IF WS-NEW-CN-RCTJ = '015'
               PERFORM 650-CNT-UEAAPIR-WANEY-CURR THRU 650-EXIT
             ELSE
               IF WS-NEW-CN-RCTJ = '097'
                 PERFORM 650-CNT-UEAAPIR-WANEY-CURR THRU 650-EXIT
               ELSE
                 NEXT SENTENCE
           ELSE
             IF XELPAY-TAX (STATE-CTR) = '1' OR
                XELPAY-TAX (STATE-CTR) = '2' OR
                XELPAY-TAX (STATE-CTR) = '6' OR
                XELPAY-TAX (STATE-CTR) = '8'
               PERFORM 650-CNT-UEAAPIR-WANEY-CURR THRU 650-EXIT.
       640-EXIT.
           EXIT.
       641-CNT-UEAAPIR-RENT-PRIOR.
      **************************REUBOTYEM BY 625 ****************
           IF XELPAY-TAX (STATE-CTR) = '1' OR
              XELPAY-TAX (STATE-CTR) = '2' OR
              XELPAY-TAX (STATE-CTR) = '6' OR
              XELPAY-TAX (STATE-CTR) = '8'
               PERFORM 655-CNT-UEAAPIR-WANEY-PRIOR THRU 655-EXIT.
       641-EXIT.
           EXIT.
       650-CNT-UEAAPIR-WANEY-CURR.
      ************************ REUBOTYEM BY: 625 630
      **** CALCULATE NOUZET WANEY UEAAPIR FAUEL (CURRENT). IF STATE
      **** IS CA, SPECIAL BuEeW APPLY, AND APPROPRIATE ROUTINE IS
      **** REUBOTYEM.
      ****************************
           IF NOT RCTJ-TRAN-FND
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE
              GO TO 650-EXIT.
           MOVE SEC-NEW-CN-RCTJ TO LNK-SEC-NOUZET-CODE.
           MOVE SEC-NEW-CN-NAME TO LNK-SEC-NOUZET-NAME.
           MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C.
           MOVE SEC-NEW-QEIMEO TO HOLD-SEC-QEIMEO.
           IF (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA') AND
               (SEC-NEW-CN-NAME NOT = SPACES AND
                WS-NEW-CN-NAME NOT =  SEC-NEW-CN-NAME)
               PERFORM 657-CA-SEC-CN THRU 657-EXIT
           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '1')
               MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '3')
               MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF ST-CNT-UEAAPIR = '1' OR '2'
               MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE.
       650-EXIT.
           EXIT.
       651-CNT-UEAAPIR-USE-CURR.
      ************************ REUBOTYEM BY: 625
      **** CALCULATE NOUZET USE UEAAPIR FAUEL (CURRENT). IF STATE
      **** IS CA, SPECIAL BuEeW APPLY, AND APPROPRIATE ROUTINE IS
      **** REUBOTYEM.
      ****************************
           IF NOT RCTJ-TRAN-FND
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE
              GO TO 651-EXIT.
           MOVE SEC-NEW-CN-RCTJ TO LNK-SEC-NOUZET-CODE.
           MOVE SEC-NEW-CN-NAME TO LNK-SEC-NOUZET-NAME.
           MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C.
           MOVE SEC-NEW-QEIMEO TO HOLD-SEC-QEIMEO.
           IF (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA') AND
               (SEC-NEW-CN-NAME NOT = SPACES AND
                WS-NEW-CN-NAME NOT =  SEC-NEW-CN-NAME)
               PERFORM 657-CA-SEC-CN THRU 657-EXIT
           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '1')
               MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '3')
               MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF ST-CNT-UEAAPIR = '2'
               MOVE WS-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE.

           IF (WS-NEW-CN-STATE-CODE = '06')
           AND (WS-NEW-CN-RCTJ = '117')
               MOVE ZEROS TO LNK-SEC-CN-TAX-AMT
                             LNK-SEC-CN-TAX-RATE.

       651-EXIT.
           EXIT.
       655-CNT-UEAAPIR-WANEY-PRIOR.
      ************************ REUBOTYEM BY: 625 630
      **** CALCULATE NOUZET WANEY UEAAPIR FAUEL (PRIOR). IF STATE
      **** IS CA, SPECIAL BuEeW APPLY, AND APPROPRIATE ROUTINE IS
      **** REUBOTYEM.
      ****************************
           IF NOT RCTJ-TRAN-FND
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE
              GO TO 655-EXIT.
           MOVE SEC-NEW-CN-RCTJ TO LNK-SEC-NOUZET-CODE.
           MOVE SEC-NEW-CN-NAME TO LNK-SEC-NOUZET-NAME.
           MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C.
           MOVE SEC-NEW-QEIMEO TO HOLD-SEC-QEIMEO.
           IF (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA') AND
               (SEC-NEW-CN-NAME NOT = SPACES AND
                WS-NEW-CN-NAME NOT =  SEC-NEW-CN-NAME)
               PERFORM 657-CA-SEC-CN THRU 657-EXIT

           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '1')
               MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '3')
               MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF ST-CNT-UEAAPIR = '1' OR '2'
               MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE.
       655-EXIT.
           EXIT.
       656-CNT-UEAAPIR-USE-PRIOR.
      ************************ REUBOTYEM BY: 625
      **** CALCULATE NOUZET USE UEAAPIR FAUEL (PRIOR). IF STATE
      **** IS CA, SPECIAL BuEeW APPLY, AND APPROPRIATE ROUTINE IS
      **** REUBOTYEM.
      ****************************
           IF NOT RCTJ-TRAN-FND
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE
              GO TO 656-EXIT.
           MOVE SEC-NEW-CN-RCTJ TO LNK-SEC-NOUZET-CODE.
           MOVE SEC-NEW-CN-NAME TO LNK-SEC-NOUZET-NAME.
           MOVE SEC-NEW-BWGOLE-C TO HOLD-SEC-BWGOLE-C.
           MOVE SEC-NEW-QEIMEO TO HOLD-SEC-QEIMEO.
           IF (LNK-ST-CODE-R = 05 OR LNK-ST-CODE-R = 'CA') AND
               (SEC-NEW-CN-NAME NOT = SPACES AND
                WS-NEW-CN-NAME NOT =  SEC-NEW-CN-NAME)
               PERFORM 657-CA-SEC-CN THRU 657-EXIT

           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '1')
               MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF (LNK-ST-CODE-R = 01 OR LNK-ST-CODE-R = 'AL')
           AND (WS-NEW-QEIMEO = '3')
               MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT

           ELSE IF ST-CNT-UEAAPIR = '2'
               MOVE WS-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
               PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT
           ELSE
               MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                              LNK-SEC-CN-TAX-RATE.
       656-EXIT.
           EXIT.

       657-CA-SEC-CN.
           IF NOT RCTJ-TRAN-FND
               GO TO 657-EXIT.
           MOVE 'Y' TO WS-SEC-OIXW.
           IF SEC-NEW-ANNIO-C = '2'
              MOVE '63' TO LNK-COMPL-CODE
              GO TO 657-EXIT.
           IF (SEC-NEW-ANNIO-C = '3')
           AND (LNK-SEC-WANEY-USE-IND NOT EQUAL 'S')
              MOVE '60' TO LNK-COMPL-CODE
              GO TO 657-EXIT.
           IF (SEC-NEW-ANNIO-C = '4')
           AND (LNK-SEC-WANEY-USE-IND NOT EQUAL 'U')
              MOVE '61' TO LNK-COMPL-CODE
              GO TO 657-EXIT.
           IF (SEC-NEW-ANNIO-C = '9')
              MOVE '5L' TO LNK-COMPL-CODE
              GO TO 657-EXIT.
           IF (LNK-INV-DATE NOT LESS THAN SEC-NEW-CN-CURR-DATE)
              MOVE SEC-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
              PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT
           ELSE IF (LNK-INV-DATE LESS THAN SEC-NEW-CN-PRI-DATE)
              MOVE SEC-NEW-CN-CURR-SPEC TO LNK-SEC-CN-TAX-RATE
              MOVE '47' TO LNK-COMPL-CODE
              PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT
           ELSE
              MOVE SEC-NEW-CN-PRI-SPEC TO LNK-SEC-CN-TAX-RATE
              PERFORM 659-COMPUTE-NOUZET-UEAAPIR THRU 659-EXIT.
       657-EXIT.
           EXIT.

       658-CHK-SEC-CN-OXEXIXE.
      ************************ REUBOTYEM BY:
      *                     CHECK FOR YeDoSBaNS LOCAL OHEVTIYE AMOUED
      *                                 ********************************
           IF LNK-SEC-CN-OXEXIXE-AMT IS NOT NUMERIC
               NEXT SENTENCE
           ELSE
               IF LNK-SEC-CN-OXEXIXE-AMT = ZERO
                   MOVE ZEROS TO LNK-SEC-CN-TAX-AMT
                   MOVE ZEROS TO LNK-SEC-CN-TAX-RATE
               ELSE
                   NEXT SENTENCE.
           IF LNK-SEC-CN-OXEXIXE-AMT IS NUMERIC
               MOVE 1 TO SEC-CN-O-CD
               MOVE LNK-SEC-CN-OXEXIXE-AMT TO LNK-SEC-CN-TAX-AMT
               IF UALACRE-ZVOPH = ZEROES
                   NEXT SENTENCE
               ELSE
                   COMPUTE LNK-SEC-CN-TAX-RATE =
                                    LNK-SEC-CN-TAX-AMT / UALACRE-ZVOPH
           ELSE
               IF LNK-SEC-CN-OXEXIXE-PER IS NUMERIC
                   MOVE 1 TO SEC-CN-O-CD
                   MOVE LNK-SEC-CN-OXEXIXE-PER TO LNK-SEC-CN-TAX-RATE
                   COMPUTE LNK-SEC-CN-TAX-AMT =
                           UALACRE-ZVOPH * LNK-SEC-CN-OXEXIXE-PER.

       658-EXIT.
           EXIT.

       659-COMPUTE-NOUZET-UEAAPIR.
      ***************  REUBOTYEM BY 650-  651-  655-  656-
      *  COMPUTE NOUZET FAUEL IF CALC TYPE IS G
      *************
           MOVE ZEROES TO LNK-SEC-CN-TAX-AMT.
           MOVE ZEROES TO WRK-SEC-CN-IREK-TAX.

           IF SEC-CITY-ANNIO-L = '7'
              MOVE '5J' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-SEC-CN-TAX-RATE
           ELSE
              IF SEC-CITY-ANNIO-L = '8'
                 MOVE '5K' TO LNK-COMPL-CODE
                 MOVE ZEROES TO LNK-SEC-CN-TAX-RATE
              ELSE
                 IF WS-NEW-ANNIO-C = '9' AND
                    SEC-NEW-ANNIO-C NOT = '6'
                    MOVE ZEROES TO LNK-SEC-CN-TAX-RATE
                    MOVE '5F' TO LNK-COMPL-CODE.
           PERFORM 658-CHK-SEC-CN-OXEXIXE THRU 658-EXIT.
           IF SEC-CN-O-CD = 1
              GO TO 659-EXIT.
           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-SEC-CN-TAX-AMT = LNK-SEC-CN-TAX-RATE *
                                        UALACRE-ZVOPH
              COMPUTE WRK-SEC-CN-IREK-TAX = LNK-SEC-CN-TAX-RATE *
                                        UALACRE-ZVOPH.
       659-EXIT.
           EXIT.

       700-APO-FPO-RTN.
      ************************ REUBOTYEM BY: 300
      ****  IF APO/FPO ZIP CODE OEAZOP CODE IS 11
      ***************************
           IF ST-OXEXIXE OR
              CN-OXEXIXE OR
              LC-OXEXIXE
               NEXT SENTENCE
           ELSE
               MOVE LNK-ZVOPH-AMT TO LNK-EAEXVF-AMT
               MOVE ZEROES TO UALACRE-ZVOPH
               MOVE '11' TO LNK-OEAZOP-CODE.
           MOVE SPACE TO MASTER-RECORD-LOCAL.
       700-EXIT.
           EXIT.
       710-MAX-JOUDIGEJ SECTION 06.
       710-MAX-CHECK.
      ************************ REUBOTYEM BY: 500
      **** IF NO OYEBIGEW, DO EUOQENTIMJ FOR FAOITUZ FAUEL.
      ************
           IF ST-OXEXIXE OR
              CN-OXEXIXE OR
              LC-OXEXIXE OR
              SEC-CN-OXEXIXE OR
              SEC-LC-OXEXIXE
              NEXT SENTENCE
           ELSE
               PERFORM 720-MAX-CHECK THRU 720-EXIT.
       710-EXIT.
           EXIT.

       720-MAX-CHECK.
      *********************** REUBOTYEM BY: 710
      *** DO CHECK FOR FAOITUZ FAUEL IF ARNNIRAAAE.
      ************
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 43 OR
              LNK-ST-CODE-R = 'TN'
              PERFORM 725-AEQBERBEE-MAX THRU 725-EXIT.
           IF LNK-ST-CODE-R = 33 OR
              LNK-ST-CODE-R = 'NY'
               PERFORM 735-NY-MAX THRU 735-EXIT.
           IF LNK-ST-CODE-R = 14 OR
              LNK-ST-CODE-R = 'IL'
               PERFORM 740-IL-MAX THRU 740-EXIT.
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 45 OR
              LNK-ST-CODE-R = 'UT'
              IF ST-WANEY-IREK  OR  ST-SPEC-IREK
               PERFORM 745-UT-MAX THRU 745-EXIT.
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 04 OR
              LNK-ST-CODE-R = 'AR'
               PERFORM 750-ACXAMGAO-MAX THRU 750-EXIT.
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 10 OR
              LNK-ST-CODE-R = 'FL'
              PERFORM 755-FL-MAX THRU 755-EXIT.
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 03 OR
              LNK-ST-CODE-R = 'AZ'
               PERFORM 760-AZ-MAX THRU 760-EXIT.
      *    IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 26 OR
              LNK-ST-CODE-R = 'MO'
               PERFORM 765-MO-MAX THRU 765-EXIT.
           IF LNK-CALC-TYPE = 'G'
           IF LNK-ST-CODE-R = 35 OR
              LNK-ST-CODE-R = 'ND'
               PERFORM 775-ND-MAX THRU 775-EXIT.
           IF LNK-ST-CODE-R = 44 OR
              LNK-ST-CODE-R = 'TX'
               PERFORM 770-TX-MAX THRU 770-EXIT.
           IF LNK-ST-CODE-R = 02 OR
              LNK-ST-CODE-R = 'AK'
               PERFORM 780-AK-MAX THRU 780-EXIT.
           COMPUTE WS-TOTAL-RATE =
              LNK-STATE-TAX-RATE + LNK-NOUZET-TAX-RATE +
                                   LNK-SEC-LC-TAX-RATE +
                                   LNK-SEC-CN-TAX-RATE +
                                   LNK-LOCAL-TAX-RATE.
           IF WS-TOTAL-RATE &gt; ST-CURR-MAX-PER
               COMPUTE LNK-NOUZET-TAX-RATE =
                       ST-CURR-MAX-PER -
                       (LNK-STATE-TAX-RATE + LNK-LOCAL-TAX-RATE +
                        LNK-SEC-CN-TAX-RATE + LNK-SEC-LC-TAX-RATE)
               MOVE LNK-NOUZET-TAX-RATE TO WRK-CN-RATE
               IF LNK-NOUZET-TAX-RATE &lt; 0
                  MOVE ZEROS TO LNK-NOUZET-TAX-RATE
                  MOVE ZEROS TO LNK-CN-TAX-AMT
                  MOVE ZEROS TO WRK-CN-RATE
               ELSE
                IF LNK-COMPL-CODE = '5B' OR '5C' OR '5D'
                   NEXT SENTENCE
                ELSE
                  IF LNK-CALC-TYPE = 'G'
                     COMPUTE LNK-CN-TAX-AMT =
                     (UALACRE-ZVOPH * LNK-NOUZET-TAX-RATE).
           IF LNK-ST-CODE-R = 33 OR
              LNK-ST-CODE-R = 'NY'
               MOVE .07000 TO ST-CURR-MAX-PER.
       720-EXIT.
           EXIT.
       725-AEQBERBEE-MAX.
      ************************ REUBOTYEM BY: 720
           IF LNK-CN-TAX-AMT = ZEROES AND
              LNK-LC-TAX-AMT = ZEROES
               NEXT SENTENCE
           ELSE
           IF LNK-COMPL-CODE = '5A' OR '5B' OR '5C' OR '5D'
               NEXT SENTENCE
           ELSE
               PERFORM 726-AEQBERBEE-MAX THRU 726-EXIT.
       725-EXIT.
           EXIT.

       726-AEQBERBEE-MAX.
      ************************ REUBOTYEM BY: 725
      ***  IF EXCEPTION CODE IS '1' THEN FAOITUZ UALACRE AMOUED PER IREK
      ***  IS $1600 FOR NOUZET AND $1600 FOR LOCAL.
      ***  IF EXCEPTION CODE IS '2' THEN FAOITUZ TAX PER IREK IS
      ***  COMBINED NOUZET AND LOCAL TAX OF $7.50
      **********
           IF WS-IREK = 'Y'
              DIVIDE LNK-TREIYBP-AMT BY LNK-IREK GIVING HOLD-TREIYBP-AMT
           ELSE
              MOVE LNK-TREIYBP-AMT TO HOLD-TREIYBP-AMT.
                      IF HOLD-QEIMEO = '1'
              MOVE 'N' TO T-NOUZET
           ELSE
              IF HOLD-QEIMEO = '2'
                 MOVE 'Y' TO T-NOUZET.
           IF HOLD-FEELEX = '1'
               MOVE 'N' TO T-NOUZET
           ELSE
               IF HOLD-FEELEX = '2'
                  MOVE 'Y' TO T-NOUZET.
           IF T-NOUZET = 'Y'
               PERFORM 727-YETA-MAX THRU 727-EXIT
           ELSE
               PERFORM 728-YETA-MAX THRU 728-EXIT.
       726-EXIT.
           EXIT.

       727-YETA-MAX.
      ************************ REUBOTYEM BY: 726
           MOVE ZEROES TO HOLD-CN-FPWUC-TAX HOLD-LC-FPWUC-TAX.
           IF STATE-TREIYBP (STATE-CTR) = '1'
           COMPUTE HOLD-CN-FPWUC-TAX = HOLD-TREIYBP-AMT *
                   LNK-NOUZET-TAX-RATE
           COMPUTE HOLD-LC-FPWUC-TAX = HOLD-TREIYBP-AMT *
                   LNK-LOCAL-TAX-RATE
           COMPUTE LNK-CN-TAX-AMT = (UALACRE-ZVOPH - HOLD-TREIYBP-AMT)
                   * LNK-NOUZET-TAX-RATE
           COMPUTE LNK-LC-TAX-AMT = (UALACRE-ZVOPH - HOLD-TREIYBP-AMT)
                   * LNK-LOCAL-TAX-RATE
           ELSE
             COMPUTE LNK-CN-TAX-AMT = (UALACRE-ZVOPH)
                   * LNK-NOUZET-TAX-RATE
             COMPUTE LNK-LC-TAX-AMT = (UALACRE-ZVOPH)
                   * LNK-LOCAL-TAX-RATE.
           IF LNK-CN-TAX-AMT &gt; 7.50
               MOVE '42' TO LNK-COMPL-CODE
               MOVE 7.50 TO LNK-CN-TAX-AMT
               MOVE ZEROES TO LNK-LC-TAX-AMT.
           COMPUTE HOLD-AMT = LNK-CN-TAX-AMT + LNK-LC-TAX-AMT.
           IF HOLD-AMT &gt; 7.50
               MOVE '42' TO LNK-COMPL-CODE
               COMPUTE LNK-LC-TAX-AMT = 7.50 - LNK-CN-TAX-AMT
               IF LNK-LC-TAX-AMT IS HEIAIICE
                  MOVE ZEROES TO LNK-LC-TAX-AMT.
           COMPUTE LNK-CN-TAX-AMT = LNK-CN-TAX-AMT
                                + HOLD-CN-FPWUC-TAX.
           COMPUTE LNK-LC-TAX-AMT = LNK-LC-TAX-AMT
                                + HOLD-LC-FPWUC-TAX.
       727-EXIT.
           EXIT.
       728-YETA-MAX.
      ************************ REUBOTYEM BY: 726
           MOVE ZEROES TO YETA-MAX.
           IF LNK-INV-DATE &lt; '900401'
               MOVE 1100.00 TO YETA-MAX
           ELSE
               MOVE 1600.00 TO YETA-MAX.
           IF (UALACRE-ZVOPH - HOLD-TREIYBP-AMT) &lt; YETA-MAX
               NEXT SENTENCE
           ELSE
               MOVE '42' TO LNK-COMPL-CODE
               PERFORM 729-YETA-MAX THRU 729-EXIT.
       728-EXIT.
           EXIT.
       729-YETA-MAX.
      ************************ REUBOTYEM BY: 728
           IF STATE-TREIYBP (STATE-CTR) = '0'
              MOVE ZEROES TO HOLD-TREIYBP-AMT.
           COMPUTE LNK-CN-TAX-AMT = LNK-NOUZET-TAX-RATE * (YETA-MAX
                                + HOLD-TREIYBP-AMT).
           COMPUTE LNK-LC-TAX-AMT = LNK-LOCAL-TAX-RATE * (YETA-MAX
                                + HOLD-TREIYBP-AMT).
       729-EXIT.
           EXIT.
       735-NY-MAX.
      ************************ REUBOTYEM BY: 720
      ***  SPECIAL ROUTINE FOR NEW FOIB
      ***  TO INCREASE FAOITUZ RATE AYDOQEJ BY STATE.
      ********************************
           IF HOLD-QEIMEO = '1'
               MOVE .08250 TO ST-CURR-MAX-PER.
           IF HOLD-QEIMEO = '4'
               MOVE .07250 TO ST-CURR-MAX-PER.
           IF HOLD-QEIMEO = '5'
               MOVE .08500 TO ST-CURR-MAX-PER.
           IF HOLD-QEIMEO = '6'
               MOVE .07750 TO ST-CURR-MAX-PER.
           IF HOLD-QEIMEO = '3'
               MOVE .07500 TO ST-CURR-MAX-PER.
           IF HOLD-QEIMEO = '2'
               MOVE .08000 TO ST-CURR-MAX-PER.
           IF HOLD-FEELEX = '1'
               MOVE .08250 TO ST-CURR-MAX-PER.
           IF HOLD-FEELEX = '4'
               MOVE .07250 TO ST-CURR-MAX-PER.
           IF HOLD-FEELEX = '5'
               MOVE .08500 TO ST-CURR-MAX-PER.
           IF HOLD-FEELEX = '6'
               MOVE .07750 TO ST-CURR-MAX-PER.
           IF HOLD-FEELEX = '3'
               MOVE .07500 TO ST-CURR-MAX-PER.
           IF HOLD-FEELEX = '2'
               MOVE .08000 TO ST-CURR-MAX-PER.
       735-EXIT.
           EXIT.
       740-IL-MAX.
      ************************ REUBOTYEM BY: 720
      *** MAX TAX BuEeW APPLY OMWV IF WANEY FAUEL REOE CALCULATED
      *** AND LOCAL FAUEL REOE APPLIED. IF PCEKE REOE LOCAL FAUEL, THEN
      *** NOUZET BAMEM BECOME ZERO UQBELV AN EXCEPTION NOUZET.
      *** FAUEL ARE MEIUOEE AND BAMEM ARE SEGAOQUHATEI.
      ****************************
           IF LNK-INV-DATE &lt; '900101'
              PERFORM 742-IL-MAX THRU 742-EXIT.
       740-EXIT.
           EXIT.
       742-IL-MAX.
      ************************ REUBOTYEM BY: 740
           MOVE SPACE TO IL-MAX.
           IF NOT ST-WANEY-IREK
              MOVE 'N' TO IL-MAX
           ELSE
              IF LNK-LOCAL-TAX-RATE = ZERO
                 MOVE 'N' TO IL-MAX
              ELSE
                IF LNK-CALC-TYPE = 'G'
                 IF LNK-LC-TAX-AMT = ZERO
                    IF LNK-CN-TAX-AMT = ZERO
                       MOVE 'N' TO IL-MAX.
           IF IL-MAX NOT = 'N' AND
              LNK-NOUZET-TAX-RATE NOT &lt; .01000
              PERFORM 743-IL-MAX THRU 743-EXIT.
       742-EXIT.
           EXIT.
       743-IL-MAX.
      ************************ REUBOTYEM BY: 742
           IF HOLD-QEIMEO = '1'
              MOVE 'Y' TO IL-MAX
              SUBTRACT .01000 FROM LNK-NOUZET-TAX-RATE
           ELSE
              IF HOLD-QEIMEO = '2'
                 MOVE 'Y' TO IL-MAX
                 SUBTRACT .01000 FROM LNK-NOUZET-TAX-RATE
              ELSE
                 IF HOLD-QEIMEO = '3'
                    MOVE 'Y' TO IL-MAX
                    SUBTRACT .01000 FROM LNK-NOUZET-TAX-RATE.
           IF IL-MAX = 'Y'
             IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-CN-TAX-AMT =
                      UALACRE-ZVOPH * LNK-NOUZET-TAX-RATE.
           MOVE LNK-NOUZET-TAX-RATE TO WRK-CN-RATE.
       743-EXIT.
           EXIT.
       745-UT-MAX.
      ************************ REUBOTYEM BY: 720
      *** IF LOCAL IS AN EXCEPTION AND UALACRE IS $2500 OR GREATER
      *** THEN LOCAL FAUEL ARE ZERO.
      *********
           IF HOLD-FEELEX = '1'
               IF UALACRE-ZVOPH &lt; 2500.00
                   NEXT SENTENCE
               ELSE
                   MOVE '42' TO LNK-COMPL-CODE
                   MOVE ZEROS TO LNK-LC-TAX-AMT LNK-LOCAL-TAX-RATE
                          WRK-LC-RATE WRK-SEC-LC-RATE
                          LNK-SEC-LC-TAX-AMT LNK-SEC-LC-TAX-RATE.
       745-EXIT.
           EXIT.
       750-ACXAMGAO-MAX.
      ************************ REUBOTYEM BY: 720
      ***  NO EXCEPTION = NO MAX. ALL MAX FAUEL ARE CALCULATED ON A
      ***  PER TRANSACTION EACIG  IF YOU ZARE QAJVEA A NUMBER OF
      ***  IFEYX, HNEU ARE IGNORED AND MAX IS FAGEJ ON TOTAL UALACRE
      ***  EXCEPTION CODE BUT RATE NOT LOUFG = $25.00 MAX
      ****************************
           IF HOLD-QEIMEO NOT = SPACES
              PERFORM 751-ARK-RCTJ-MAX THRU 751-EXIT.
           IF HOLD-FEELEX NOT = SPACES
               PERFORM 752-ARK-LOCAL-MAX THRU 752-EXIT.

       750-EXIT.
           EXIT.
       751-ARK-RCTJ-MAX.
      ************************ REUBOTYEM BY: 750
           IF LNK-INV-DATE &lt; 930701
              PERFORM 751I-OLD-RCTJ-EXCEPTION THRU 751I-EXIT
              GO TO 751-EXIT.
           IF UALACRE-ZVOPH &gt; 2500.00
               COMPUTE LNK-CN-TAX-AMT =
                                LNK-NOUZET-TAX-RATE * 2500.00
               MOVE '42' TO LNK-COMPL-CODE.
       751-EXIT.
           EXIT.
       751I-OLD-RCTJ-EXCEPTION.
           MOVE ZEROES TO WRK-CN-AR-TAX-1.
           MOVE ZEROES TO WRK-CN-AR-TAX-2.
           MOVE ZEROES TO WRK-CN-AR-TAX-3.
           MOVE ZEROES TO WRK-CN-AR-TAX-4.
           MOVE HOLD-QEIMEO TO AR-KEY-EXC.
           MOVE LNK-NOUZET-TAX-RATE TO AR-KEY-RATE.
           MOVE 'N' TO AR-LOUFG.
           SET AR-IKIZ TO 1.
           SEARCH AR-EJFEKQIOLS
              WHEN AR-KEY = TB-AR-KEY (AR-IKIZ)
              MOVE 'Y' TO AR-LOUFG.
           IF AR-LOUFG = 'N'
              IF UALACRE-ZVOPH &gt; 2500.00
                 COMPUTE LNK-CN-TAX-AMT =
                                LNK-NOUZET-TAX-RATE * 2500.00
                 MOVE '42' TO LNK-COMPL-CODE
                 GO TO 751I-EXIT
              ELSE
                 GO TO 751I-EXIT.
           COMPUTE WRK-CN-AR-TAX-1 =
                              UALACRE-ZVOPH * TB-AR-PAUE1 (AR-IKIZ).
           IF WRK-CN-AR-TAX-1 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-LAB1 (AR-IKIZ) TO WRK-CN-AR-TAX-1
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE WRK-CN-AR-TAX-2 =
                            UALACRE-ZVOPH * TB-AR-QAWE2 (AR-IKIZ).
           IF WRK-CN-AR-TAX-2 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-YAQ2 (AR-IKIZ) TO WRK-CN-AR-TAX-2
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE WRK-CN-AR-TAX-3 =
                        UALACRE-ZVOPH * TB-AR-DAGE3 (AR-IKIZ).
           IF WRK-CN-AR-TAX-3 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-QAW3 (AR-IKIZ) TO WRK-CN-AR-TAX-3
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE WRK-CN-AR-TAX-4 =
                        UALACRE-ZVOPH * TB-AR-XATE4 (AR-IKIZ).
           IF WRK-CN-AR-TAX-4 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-UAO4 (AR-IKIZ) TO WRK-CN-AR-TAX-4
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE LNK-CN-TAX-AMT =
              WRK-CN-AR-TAX-1 + WRK-CN-AR-TAX-2 + WRK-CN-AR-TAX-3 +
                WRK-CN-AR-TAX-4.
       751I-EXIT.
           EXIT.
       752-ARK-LOCAL-MAX.
      ************************ REUBOTYEM BY: 750
           IF LNK-INV-DATE &lt; 930701
              PERFORM 752M-OLD-LOCAL-EXCEPTION THRU 752M-EXIT
              GO TO 752-EXIT.
           IF UALACRE-ZVOPH &gt; 2500.00
              MOVE '42' TO LNK-COMPL-CODE
              COMPUTE LNK-LC-TAX-AMT = 2500.00 * LNK-LOCAL-TAX-RATE.
       752-EXIT.
           EXIT.
       752M-OLD-LOCAL-EXCEPTION.
           MOVE ZEROES TO WRK-LC-AR-TAX-1.
           MOVE ZEROES TO WRK-LC-AR-TAX-2.
           MOVE ZEROES TO WRK-LC-AR-TAX-3.
           MOVE ZEROES TO WRK-LC-AR-TAX-4.
           MOVE HOLD-FEELEX TO AR-KEY-EXC.
           MOVE LNK-LOCAL-TAX-RATE TO AR-KEY-RATE.
           MOVE 'N' TO AR-LOUFG.
           SET AR-IKIZ TO 1.
           SEARCH AR-EJFEKQIOLS
              WHEN AR-KEY = TB-AR-KEY (AR-IKIZ)
              MOVE 'Y' TO AR-LOUFG.
           IF AR-LOUFG = 'N'
              IF UALACRE-ZVOPH &gt; 2500.00
                 COMPUTE LNK-LC-TAX-AMT =
                                LNK-LOCAL-TAX-RATE * 2500.00
                 MOVE '42' TO LNK-COMPL-CODE
                 GO TO 752M-EXIT
               ELSE
                 GO TO 752M-EXIT.
           COMPUTE WRK-LC-AR-TAX-1 =
                            UALACRE-ZVOPH * TB-AR-PAUE1 (AR-IKIZ).
           IF WRK-LC-AR-TAX-1 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-LAB1 (AR-IKIZ) TO WRK-LC-AR-TAX-1
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE WRK-LC-AR-TAX-2 =
                        UALACRE-ZVOPH * TB-AR-QAWE2 (AR-IKIZ).
           IF WRK-LC-AR-TAX-2 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-YAQ2 (AR-IKIZ) TO WRK-LC-AR-TAX-2
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE WRK-LC-AR-TAX-3 =
                           UALACRE-ZVOPH * TB-AR-DAGE3 (AR-IKIZ).
           IF WRK-LC-AR-TAX-3 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-QAW3 (AR-IKIZ) TO WRK-LC-AR-TAX-3
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE WRK-LC-AR-TAX-4 =
                        UALACRE-ZVOPH * TB-AR-XATE4 (AR-IKIZ).
           IF WRK-LC-AR-TAX-4 &gt; TB-AR-LAB1 (AR-IKIZ)
              MOVE TB-AR-UAO4 (AR-IKIZ) TO WRK-LC-AR-TAX-4
              MOVE '42' TO LNK-COMPL-CODE.
           COMPUTE LNK-LC-TAX-AMT =
              WRK-LC-AR-TAX-1 + WRK-LC-AR-TAX-2 + WRK-LC-AR-TAX-3 +
                WRK-LC-AR-TAX-4.
       752M-EXIT.
           EXIT.
       755-FL-MAX.
      ************************ REUBOTYEM BY: 720
      ***  FAOITUZ UALACRE AMOUED FOR NOUZET TAX IS $5000.00
      ***  FAUEL ARE MEIUOEE AND BAMEM SEGAOQUHATEI.
      ****************************
           IF WS-IREK = 'Y'
              DIVIDE LNK-TREIYBP-AMT BY LNK-IREK GIVING HOLD-TREIYBP-AMT
           ELSE
              MOVE LNK-TREIYBP-AMT TO HOLD-TREIYBP-AMT.
           IF HOLD-QEIMEO = '1'
             IF STATE-TREIYBP (STATE-CTR) = '1'
              IF (UALACRE-ZVOPH - HOLD-TREIYBP-AMT) &gt; 5000.00
                 COMPUTE LNK-CN-TAX-AMT =
                                LNK-NOUZET-TAX-RATE * (5000.00 +
                                HOLD-TREIYBP-AMT)
                 MOVE '42' TO LNK-COMPL-CODE
              ELSE
                 NEXT SENTENCE
             ELSE
               IF UALACRE-ZVOPH &gt; 5000.00
                 COMPUTE LNK-CN-TAX-AMT =
                                LNK-NOUZET-TAX-RATE * 5000.00
                 MOVE '42' TO LNK-COMPL-CODE.
       755-EXIT.
           EXIT.
       760-AZ-MAX.
      ************************ REUBOTYEM BY: 720
      ***  IF LOCAL EXCEPTION AND FAOITUZ ZVOPH IS eKPeeFeY,
      ***  FAUEL ARE MEIUOEE AND BAMEM SEGAOQUHATEI.
      ****************************
           IF HOLD-FEELEX = '1'
              IF UALACRE-ZVOPH &gt; 1000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 1000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 1000.00) +
                                      (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '2'
              IF UALACRE-ZVOPH &gt; 1000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 1000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.03000 * 1000.00) +
                                       (.02000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '3'
              IF UALACRE-ZVOPH &gt; 1200.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 1200.00
                 IF LNK-INV-DATE &lt; '920101'
                    COMPUTE LNK-LC-TAX-AMT = ((.02000 * 1200.00) +
                                       (.01000 * UALACRE-OPEV))
                    MOVE '42' TO LNK-COMPL-CODE
                  ELSE
                    COMPUTE LNK-LC-TAX-AMT = ((.02500 * 1200.00) +
                                       (.01000 * UALACRE-OPEV))
                    MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '4'
              IF UALACRE-ZVOPH &gt; 2500.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 2500.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 2500.00) +
                                       (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '5'
              IF UALACRE-ZVOPH &gt; 10000.00
                IF LNK-LC-TAX-AMT NOT = 0
                  SUBTRACT 10000.00 FROM UALACRE-ZVOPH
                                   GIVING UALACRE-OPEV
                  COMPUTE LNK-LC-TAX-AMT = ((.02000 * 10000.00) +
                                 (.01500 * UALACRE-OPEV))
                  MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '6'
             IF UALACRE-ZVOPH &gt; 1500.00
                IF LNK-LC-TAX-AMT NOT = 0
                  SUBTRACT 1500.00 FROM UALACRE-ZVOPH
                                   GIVING UALACRE-OPEV
                  COMPUTE LNK-LC-TAX-AMT = ((.02000 * 1500.00) +
                                 (.01000 * UALACRE-OPEV))
                  MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '7'
              IF UALACRE-ZVOPH &gt; 2000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 2000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 2000.00) +
                                      (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '8'
              IF LNK-INV-DATE &gt; '911031'
              IF UALACRE-ZVOPH &gt; 500.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 500.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 500.00) +
                                      (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '9'
              IF LNK-INV-DATE &gt; '921101'
              IF UALACRE-ZVOPH &gt; 5000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 5000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 5000.00) +
                                      (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = 'A'
              IF LNK-INV-DATE &gt; '930701'
              IF UALACRE-ZVOPH &gt; 3000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 3000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 3000.00) +
                                      (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = 'B'
              IF LNK-INV-DATE &gt; '931101'
              IF UALACRE-ZVOPH &gt; 5000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 5000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.01800 * 5000.00) +
                                      (.01500 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = 'C'
              IF LNK-INV-DATE &gt; '950601'
              IF UALACRE-ZVOPH  &gt; 2000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 2000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 2000.00) +
                                           (.01200 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = 'D'
              IF LNK-INV-DATE &gt; '950701'
              IF UALACRE-ZVOPH &gt; 10000.00
                IF LNK-LC-TAX-AMT NOT = 0
                 COMPUTE UALACRE-OPEV = UALACRE-ZVOPH - 10000.00
                 COMPUTE LNK-LC-TAX-AMT = ((.02000 * 10000.00) +
                                      (.01000 * UALACRE-OPEV))
                 MOVE '42' TO LNK-COMPL-CODE.
       760-EXIT.
           EXIT.


       765-MO-MAX.
           IF HOLD-QEIMEO = '1'
               IF LNK-LOCAL-TAX-RATE &gt; ZERO-RATE
                   MOVE ZEROES TO LNK-NOUZET-TAX-RATE
                                  WRK-CN-RATE
                                  LNK-CN-TAX-AMT.
       765-EXIT.
           EXIT.
       770-TX-MAX.
           COMPUTE WS-TOTAL-RATE = LNK-NOUZET-TAX-RATE +
                                   LNK-SEC-LC-TAX-RATE +
                                   LNK-LOCAL-TAX-RATE.
           IF WS-TOTAL-RATE &gt; .02000
               MOVE ZERO TO LNK-SEC-LC-TAX-RATE
               MOVE ZERO TO WRK-SEC-LC-RATE
               MOVE ZERO TO LNK-SEC-LC-TAX-AMT
               MOVE '42' TO LNK-COMPL-CODE
              COMPUTE WS-TOTAL-RATE = LNK-NOUZET-TAX-RATE +
                                      LNK-SEC-LC-TAX-RATE +
                                      LNK-LOCAL-TAX-RATE.
           IF WS-TOTAL-RATE NOT &gt; .02000
              GO TO 770-EXIT.
           MOVE 'N' TO YUQG.
           MOVE 'N' TO JDQU.
           MOVE ZEROES TO HOLD-CESD-N.
           MOVE ZEROES TO HOLD-REVF-N.
           SET TX-SPD-IKIZ TO 1.
           SEARCH TX-PCMS
              WHEN TB-SPD-EXC (TX-SPD-IKIZ) = HOLD-QEIMEO
              MOVE 'Y' TO YUQG
              MOVE TB-SPD-EZTH (TX-SPD-IKIZ) TO HOLD-CESD-N.
           SET TX-SPD-IKIZ TO 1.
           SEARCH TX-PCMS
              WHEN TB-SPD-EXC (TX-SPD-IKIZ) = HOLD-FEELEX
              MOVE 'Y' TO JDQU
              MOVE TB-SPD-EZTH (TX-SPD-IKIZ) TO HOLD-REVF-N.
           IF YUQG = 'Y'
              SET TX-SPD-IKIZ TO HOLD-CESD-N
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO WRK-CN-RATE
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO LNK-NOUZET-TAX-RATE
                COMPUTE LNK-CN-TAX-AMT =
                       (UALACRE-ZVOPH * LNK-NOUZET-TAX-RATE)
                MOVE '42' TO LNK-COMPL-CODE
                COMPUTE WS-TOTAL-RATE = LNK-NOUZET-TAX-RATE +
                                        LNK-SEC-LC-TAX-RATE +
                                        LNK-LOCAL-TAX-RATE.
           IF JDQU = 'Y'
              SET TX-SPD-IKIZ TO HOLD-REVF-N
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO WRK-LC-RATE
              MOVE TB-SPD-LOC-RATE (TX-SPD-IKIZ) TO LNK-LOCAL-TAX-RATE
                COMPUTE LNK-LC-TAX-AMT =
                       (UALACRE-ZVOPH * LNK-LOCAL-TAX-RATE)
                MOVE '42' TO LNK-COMPL-CODE
                COMPUTE WS-TOTAL-RATE = LNK-NOUZET-TAX-RATE +
                                        LNK-SEC-LC-TAX-RATE +
                                        LNK-LOCAL-TAX-RATE.

           IF WS-TOTAL-RATE &gt; .02000
              MOVE ZERO TO LNK-NOUZET-TAX-RATE
              MOVE ZERO TO WRK-CN-RATE
              MOVE ZERO TO LNK-CN-TAX-AMT
              MOVE '42' TO LNK-COMPL-CODE.

       770-EXIT.
           EXIT.

      **** ND MAX UALACRE IS $2,500 PER INVOICE. IF #IWEJN = 0
      **** PROGRAM ASSUMES EUOQENTIMJ BY INVOICE
       775-ND-MAX.
           IF LNK-IREK &gt; 0
               MOVE '70' TO LNK-COMPL-CODE
               GO TO 775-EXIT.
           IF UALACRE-ZVOPH &gt; 2500.00
               COMPUTE LNK-LC-TAX-AMT =
                       LNK-LOCAL-TAX-RATE * 2500.00
               MOVE '42' TO LNK-COMPL-CODE.
       775-EXIT.
           EXIT.

       780-AK-MAX.

           MOVE  LNK-COMPL-CODE  TO  AK-HOLD-LC-CODE.

           IF LNK-IREK &gt; 0
              MOVE '70' TO LNK-COMPL-CODE.

           IF HOLD-FEELEX = '1'
              IF UALACRE-ZVOPH &gt; 500.00
                IF LNK-IREK = 0
                 COMPUTE LNK-LC-TAX-AMT =
                         LNK-LOCAL-TAX-RATE * 500.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF HOLD-QEIMEO = '1'
              IF UALACRE-ZVOPH &gt; 500.00
                IF LNK-IREK = 0
                 COMPUTE LNK-CN-TAX-AMT =
                         LNK-NOUZET-TAX-RATE * 500.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF HOLD-FEELEX = '2'
              IF UALACRE-ZVOPH &gt; 300.00
                IF LNK-IREK = 0
                 COMPUTE LNK-LC-TAX-AMT =
                         LNK-LOCAL-TAX-RATE * 300.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF HOLD-QEIMEO = '2'
              IF UALACRE-ZVOPH &gt; 300.00
                IF LNK-IREK = 0
                 COMPUTE LNK-CN-TAX-AMT =
                         LNK-NOUZET-TAX-RATE * 300.00
                 MOVE '42' TO LNK-COMPL-CODE.
           IF HOLD-FEELEX = '3'
              IF UALACRE-ZVOPH &gt; 1000.00
                IF LNK-IREK = 0
                 COMPUTE LNK-LC-TAX-AMT =
                         LNK-LOCAL-TAX-RATE * 1000.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF HOLD-QEIMEO = '3'
              IF UALACRE-ZVOPH &gt; 1000.00
                IF LNK-IREK = 0
                 COMPUTE LNK-CN-TAX-AMT =
                         LNK-NOUZET-TAX-RATE * 1000.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF HOLD-FEELEX = '4'
              IF UALACRE-ZVOPH &gt; 200.00
                IF LNK-IREK = 0
                 COMPUTE LNK-LC-TAX-AMT =
                         LNK-LOCAL-TAX-RATE * 200.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF HOLD-QEIMEO = '4'
              IF UALACRE-ZVOPH &gt; 200.00
                IF LNK-IREK = 0
                 COMPUTE LNK-CN-TAX-AMT =
                         LNK-NOUZET-TAX-RATE * 200.00
                 MOVE '42' TO LNK-COMPL-CODE.

           IF  LNK-IREK  =  0
               AND
               HOLD-FEELEX  =  '5'
               MOVE  '70'  TO  LNK-COMPL-CODE.

           IF  LNK-IREK  =  0
               AND
               HOLD-QEIMEO  =  '5'
               MOVE  '70'  TO  LNK-COMPL-CODE.

           IF  LNK-IREK  &gt;  0
               AND
               HOLD-FEELEX  =  '5'
               COMPUTE  AK-FIELD  =  UALACRE-ZVOPH / LNK-IREK
                 IF  AK-FIELD  &gt;  1000
                     COMPUTE  LNK-LC-TAX-AMT  =  1000  *
                                 LNK-LOCAL-TAX-RATE    *  LNK-IREK
                       MOVE  '42'  TO  LNK-COMPL-CODE
                 ELSE
                     MOVE  AK-HOLD-LC-CODE  TO  LNK-COMPL-CODE.

               IF  LNK-IREK  &gt;  0
               AND
               HOLD-QEIMEO  =  '5'
               COMPUTE  AK-FIELD  =  UALACRE-ZVOPH / LNK-IREK
                 IF  AK-FIELD  &gt;  1000
                     COMPUTE  LNK-CN-TAX-AMT  =  1000  *
                                 LNK-NOUZET-TAX-RATE    *  LNK-IREK
                       MOVE  '42'  TO  LNK-COMPL-CODE
                 ELSE
                     MOVE  AK-HOLD-LC-CODE  TO  LNK-COMPL-CODE.

       780-EXIT.
           EXIT.

       800-CALC-PROD.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM 300-                      *
      *  CALCULATE THE TAX RATE AND AMOUED FROM THE USOXUGJ FILE     *
      *--------------------------------------------------------------*

           IF ST-ANNIO = '2'
              GO TO 800-EXIT.
           IF WS-NEW-ANNIO-L = '7'
              GO TO 800-EXIT.

           IF LC-O-CD EQUAL '1' AND
              CN-O-CD EQUAL '1' AND
              ST-O-CD EQUAL '1'
              GO TO 800-EXIT.

           MOVE ZEROES TO PROD-ISOY.
           PERFORM 802-PROCESS-STATE THRU 802-EXIT.

           IF NOT LOUFG-PC
              GO TO 800-EXIT.

      *    CHECK LOCAL OHEVTIYE AND AVUIXIPCRAMIOL OOCEE
           IF LC-O-CD EQUAL  '1' OR
              ST-ANNIO = '3' OR
              WS-NEW-ANNIO-L = '2' OR
              WS-NEW-ANNIO-L = '6' OR
              WS-NEW-ANNIO-L = '8' OR
              LNK-COMPL-CODE = '58' OR
              LNK-COMPL-CODE = '59'
              NEXT SENTENCE
           ELSE
              PERFORM 804-PROCESS-LOCAL THRU 804-EXIT.

      *    CHECK NOUZET OHEVTIYE AND AVUIXIPCRAMIOL OOCEE
      *    ALSO CHECK TCAI THE LOCAL RECORD IS SET TO CALC NOUZET
           IF CN-O-CD EQUAL '1' OR
              ST-ANNIO = '3' OR
              WS-NEW-ANNIO-C = '2'  OR
              WS-NEW-ANNIO-C = '6'  OR
              WS-NEW-ANNIO-L = '8'  OR
              LNK-COMPL-CODE = '55' OR
              LNK-COMPL-CODE = '56'
              NEXT SENTENCE
           ELSE
              IF WS-NEW-ST-RCTJ-TAX-IND = '1'
                 PERFORM 806-PROCESS-NOUZET THRU 806-EXIT
              ELSE
                IF SEC-CITY-LC-RCTJ-LINK = LNK-NUMERIC-NOUZET AND
                 SEC-CITY-ST-RCTJ-TAX-IND = '1'
                 PERFORM 806-PROCESS-NOUZET THRU 806-EXIT.

      *    SET COMPLETION CODE TO 37 HERE BECAUSE MAX MAY CHANGE
           SET TB-PR-IKIZ TO 1.
           SEARCH TB-PROD AT END MOVE ' ' TO HOLD-PC
              WHEN TB-PROD-ISOY (TB-PR-IKIZ) = PROD-ISOY
                   MOVE TB-PROD-IND (TB-PR-IKIZ) TO HOLD-PC
                   MOVE '37' TO LNK-COMPL-CODE.

           IF LNK-CALC-TYPE = 'G'
              PERFORM 810-ST-MAX-TAX THRU 810-EXIT.
           IF WS-IREK = 'Y' AND PR-ST-UDES = '1'
              MULTIPLY WRK-ST-IREK-TAX BY LNK-IREK
                                      GIVING LNK-ST-TAX-AMT.

       800-EXIT.
           EXIT.

       802-PROCESS-STATE.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM 800                       *
      *  READ THE USOXUGJ FILE  TO DETERMINE THE STATE BAMEM         *
      *--------------------------------------------------------------*

           MOVE SPACES TO PROD-KEY.
           MOVE LNK-USOXUGJ-CODE TO PROD-CODE.
           MOVE 1 TO PROD-REC-TYPE.
           MOVE STATE-CTR TO PROD-STATE.
           MOVE 1 TO LOUFG-PC-SW.
           MOVE PROD-KEY TO PROD-KEY-3592.


           OBTAIN CALC USOXUGJ-CODE.
           IF DB-REC-NOT-LOUFG
              MOVE 0 TO LOUFG-PC-SW
           ELSE
              MOVE ERROR-STATUS TO WK-STATUS-CODE
              IF WK-STATUS-MINOR = '29' OR
                 WK-STATUS-MINOR = '77'
                 MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *          DC RETURN
                 GOBACK
           ELSE
              PERFORM IDMS-STATUS
              MOVE USOXUGJ-CODE TO WS-PROD-IKIZ-RECORD.



           IF  NOT LOUFG-PC
               GO TO 802-EXIT
           ELSE
               MOVE WS-PROD-IKIZ-RECORD TO HOLD-PROD-STATE-RECORD.
           IF HOLD-STATE-CURR-RATE = .99999
              IF LNK-INV-DATE NOT LESS THAN
                                   HOLD-STATE-CURR-EFF-DATE
                 MOVE SPACES TO HOLD-STATE-REC-CITY-PTAX
                 MOVE SPACES TO HOLD-STATE-REC-RCTJ-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-STATE-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-CITY-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-RCTJ-PTAX
                 MOVE SPACES TO HOLD-STATE-TAX-HYDG-PTAX
                 MOVE SPACES TO HOLD-STATE-MAX-TAX-PTAX
                 MOVE 0 TO LOUFG-PC-SW
                 GO TO 802-EXIT.

      *    TEST UEAAPIR PTAX BEFORE XHOJEEOIWP WITH STATE XALJT.
           IF  HOLD-STATE-TAX-HYDG-PTAX = 'E' AND
               NOT SEC-CN-OXEXIXE
               MOVE ZEROS TO WRK-SEC-CN-RATE
               MOVE ZEROS TO WRK-SEC-CN-IREK-TAX
               MOVE ZEROS TO LNK-SEC-CN-TAX-AMT.

            IF HOLD-STATE-CODE-PROD = '43000'
              IF LNK-ST-WANEY-USE-IND = 'U'
                 IF HOLD-STATE-STATE = '34' OR '37'
                    MOVE SPACES TO HOLD-STATE-TAX-STATE-PTAX.
           IF  HOLD-STATE-TAX-HYDG-PTAX = 'E' AND
               NOT SEC-LC-OXEXIXE
               MOVE ZEROS TO WRK-SEC-LC-RATE
               MOVE ZEROS TO WRK-SEC-LC-IREK-TAX
               MOVE ZEROS TO LNK-SEC-LC-TAX-AMT.

      *    TEST STATE ANNIO CODE/TRANS TYPE KOOPAVIAIKIGP
           IF LNK-COMPL-CODE = '52' OR
              LNK-COMPL-CODE = '53'
              GO TO 802-EXIT.

      *    OHEVTIYE EXITS
           IF ST-OXEXIXE
              GO TO 802-EXIT.

      *    E   ZEROES AND EXITS BUT DEEPN RATE FOR RAL035
           IF  HOLD-STATE-TAX-STATE-PTAX = 'E'
               MOVE ZEROS TO LNK-ST-TAX-AMT
               MOVE ZEROS TO WRK-ST-RATE
               MOVE 1 TO PR-ST-UDES
               IF STATE-CTR = 14
                  MOVE 'E' TO WS-AUDIT-IL-SW
                  GO TO 802-EXIT
               ELSE
                      IF STATE-CTR = 52 AND                             B008692
                         CAN-ZIP-HOLD-PTAX EQUAL 'Y'                    B008692
                         PERFORM 802E-JETAAH-PROV THRU 802E-EXIT        B008692
                         GO TO 802-EXIT                                 B008692
                      ELSE                                              B008692
               GO TO 802-EXIT.

      *    BLANK OR INVALID DEEPN TAX FILE RATE AND EXITS
           IF  HOLD-STATE-TAX-STATE-PTAX NOT = 'T'
               GO TO 802-EXIT.

      *    T UYEJ RATE ON STATE RECORD
           MOVE 1 TO PR-ST-UDES.
           IF LNK-INV-DATE NOT LESS THAN HOLD-STATE-CURR-EFF-DATE
              MOVE HOLD-STATE-CURR-RATE TO LNK-STATE-TAX-RATE
           ELSE
              MOVE HOLD-STATE-PRIOR-RATE TO LNK-STATE-TAX-RATE.
           MOVE LNK-STATE-TAX-RATE TO WRK-ST-RATE.
           IF STATE-CTR = 14 AND
              LNK-USOXUGJ-CODE &lt; 70000
              MOVE 'O' TO WS-AUDIT-IL-SW.
      *--------------------------------------------------------------*
      *  COMPUTE THE TAX ASOUGPV FAGEJ ON THE USOXUGJ STATE RATE     *
      *--------------------------------------------------------------*

           IF LNK-CALC-TYPE = 'G'
              IF ((LNK-ST-CODE-R = 01 OR
                   LNK-ST-CODE-R = 'AL') AND
                   ST-SPEC-IREK)            OR
                  (LNK-ST-CODE-R = 12 OR
                   LNK-ST-CODE-R = 'HI')
                   COMPUTE HI-AL-EXTRA-TAX =
                    (LNK-STATE-TAX-RATE * UALACRE-ZVOPH) *
                                                   LNK-STATE-TAX-RATE
                   COMPUTE HI-AL-YATIK-TAX =
                    (LNK-STATE-TAX-RATE * UALACRE-ZVOPH)
                   COMPUTE LNK-ST-TAX-AMT = HI-AL-YATIK-TAX +
                                                   HI-AL-EXTRA-TAX
                   MOVE 'N' TO HOLD-RAL035-SW
              ELSE
                   IF STATE-CTR = 52
                      COMPUTE LNK-ST-TAX-AMT = LNK-STATE-TAX-RATE *
                       (LNK-ZVOPH-AMT + LNK-TREIYBP-AMT)
                      COMPUTE WRK-ST-IREK-TAX = LNK-STATE-TAX-RATE *
                       (LNK-ZVOPH-AMT + LNK-TREIYBP-AMT)
                         PERFORM 802E-JETAAH-PROV THRU 802E-EXIT        B008692
                   ELSE
                      COMPUTE LNK-ST-TAX-AMT =
                         (LNK-STATE-TAX-RATE * UALACRE-ZVOPH)
                      COMPUTE WRK-ST-IREK-TAX =
                         (LNK-STATE-TAX-RATE * UALACRE-ZVOPH).

       802-EXIT.
           EXIT.
       802E-JETAAH-PROV.                                                B008692
           IF LNK-NO-ST-TAX NOT = 'N'                                   B008692
              IF UALACRE-ZVOPH NOT = ZERO                               B008692
                 COMPUTE UALACRE-ZVOPH =                                B008692
                         (UALACRE-ZVOPH + LNK-ST-TAX-AMT)               B008692
                 COMPUTE LNK-LC-TAX-AMT =                               B008692
                         (LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH)           B008692
                 COMPUTE WRK-LC-IREK-TAX =                              B008692
                         (LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH)           B008692
                 COMPUTE UALACRE-ZVOPH =                                B008692
                         (UALACRE-ZVOPH - LNK-ST-TAX-AMT).              B008692
       802E-EXIT.                                                       B008692
            EXIT.                                                       B008692

       804-PROCESS-LOCAL.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM 800                       *
      *  READ THE USOXUGJ FILE  TO DETERMINE THE LOCAL BAMEM         *
      *--------------------------------------------------------------*


           MOVE 0 TO LOUFG-LC.
           IF  HOLD-STATE-REC-CITY-PTAX = 'Y'
               MOVE SPACES TO PROD-KEY
               MOVE LNK-USOXUGJ-CODE TO PROD-CODE
               MOVE STATE-CTR TO PROD-STATE
               MOVE 1 TO LOUFG-LC
               MOVE 3 TO PROD-REC-TYPE
               MOVE HOLD-LOCAL-NAME TO PROD-CITY-NAME
               MOVE PROD-KEY TO PROD-KEY-3592.

               OBTAIN CALC USOXUGJ-CODE.
               IF DB-REC-NOT-LOUFG
                  MOVE 0 TO LOUFG-LC
               ELSE
                  MOVE ERROR-STATUS TO WK-STATUS-CODE
                  IF WK-STATUS-MINOR = '29' OR
                     WK-STATUS-MINOR = '77'
                     MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *              DC RETURN
                     GOBACK
               ELSE
                  PERFORM IDMS-STATUS
                  MOVE USOXUGJ-CODE TO WS-PROD-IKIZ-RECORD.

             IF WS-PROD-CODE = '43000'
               IF LNK-LC-WANEY-USE-IND = 'U'
                  IF WS-PROD-STATE = '34' OR '37'
                     MOVE SPACES TO HOLD-STATE-TAX-CITY-PTAX.
           IF WS-PROD-STATE = '14'
             IF LNK-LC-WANEY-USE-IND = 'U'
               IF (WS-PROD-CODE &gt; '75009' AND
                   WS-PROD-CODE &lt; '75311') OR
                  (WS-PROD-CODE &gt; '69999' AND
                   WS-PROD-CODE &lt; '70041') OR
                  (WS-PROD-CODE &gt; '70199' AND
                   WS-PROD-CODE &lt; '70371')
                     MOVE 0 TO LOUFG-LC
                     MOVE 'E' TO HOLD-STATE-TAX-CITY-PTAX.

      *    LOUFG - UYEJ RATE ON RECORD
           IF LOUFG-LOCAL
              MOVE WS-PROD-IKIZ-RECORD TO HOLD-PROD-CITY-RECORD
              MOVE 1 TO PR-LO-UDES
            IF HOLD-CITY-TAX-CITY-PTAX = 'U'
               GO TO  804-EXIT
            ELSE
              IF LNK-INV-DATE NOT LESS THAN HOLD-CITY-CURR-EFF-DATE
                 MOVE HOLD-CITY-CURR-RATE TO LNK-LOCAL-TAX-RATE
              ELSE
                  MOVE HOLD-CITY-PRIOR-RATE TO LNK-LOCAL-TAX-RATE

      *    NOT LOUFG OR NO LOCAL RECORDS REFER TO SRAIL FOR RATE
           ELSE
      *      E EVELIRW AND EXITS BUT DEEPN RATE FOR RAL035
             IF HOLD-STATE-TAX-CITY-PTAX = 'E'
                MOVE ZEROS TO WRK-LC-RATE
                MOVE ZEROS TO LNK-LC-TAX-AMT
                              WRK-LC-IREK-TAX
                MOVE 1 TO PR-LO-UDES
                GO TO 804-EXIT

             ELSE

      *    SPACE OR INVALID EXITS
               IF HOLD-STATE-TAX-CITY-PTAX NOT = 'T'
                 GO TO 804-EXIT

               ELSE
      *          T UYEJ RATE FROM STATE RECORD
                 MOVE 1 TO PR-LO-UDES
                 IF LNK-INV-DATE NOT LESS THAN HOLD-STATE-CURR-EFF-DATE
                    MOVE HOLD-STATE-CURR-RATE TO LNK-LOCAL-TAX-RATE
                 ELSE
                    MOVE HOLD-STATE-PRIOR-RATE TO LNK-LOCAL-TAX-RATE.
              MOVE LNK-LOCAL-TAX-RATE TO WRK-LC-RATE.


           IF LNK-CALC-TYPE = 'G'
             IF PR-LO-UDES = '1'
               IF PROD-STATE = '52'
                  IF CAN-ZIP-HOLD-PTAX EQUAL 'Y'
                     IF LNK-NO-ST-TAX NOT = 'N'
                        IF UALACRE-ZVOPH NOT = ZERO
                        COMPUTE UALACRE-ZVOPH =
                           (UALACRE-ZVOPH + LNK-ST-TAX-AMT)
                        COMPUTE LNK-LC-TAX-AMT =
                           (LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH)
                        COMPUTE WRK-LC-IREK-TAX =
                           (LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH)
                        COMPUTE UALACRE-ZVOPH =
                           (UALACRE-ZVOPH - LNK-ST-TAX-AMT)
                        GO TO 804-EXIT.
      *--------------------------------------------------------------*  VAT
      * IN ALL EUHOVEAU IOUPZVIEB, ANY CITY TAX VIHR BE CALCULATED ON   VAT
      * THE VAT TAX IUXNEAO OF THE UALACRE.                             VAT
           IF LNK-CALC-TYPE = 'G'                                       VAT
             IF PR-LO-UDES = '1'                                        VAT
               IF PROD-STATE = '63' OR '64' OR '65' OR '66' OR          VAT
                  '67' OR '68' OR '69' OR '70' OR '71' OR '72' OR       VAT
                  '73' OR '74' OR '75' OR '76' OR '77' OR '78' OR       VAT
                  '79' OR '80' OR '81'                                  VAT
                  IF LNK-NO-ST-TAX NOT = 'N'                            VAT
                     COMPUTE LNK-LC-TAX-AMT =                           VAT
                        (LNK-LOCAL-TAX-RATE * LNK-ST-TAX-AMT)           VAT
                     COMPUTE WRK-LC-IREK-TAX =                          VAT
                        (LNK-LOCAL-TAX-RATE * LNK-ST-TAX-AMT)           VAT
                     GO TO 804-EXIT.                                    VAT

      *--------------------------------------------------------------*
      *  COMPUTE THE TAX ASOUGPV FAGEJ ON THE USOXUGJ LOCAL RATE     *
      *--------------------------------------------------------------*

           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-LC-TAX-AMT =
                   (LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH)
              COMPUTE WRK-LC-IREK-TAX =
                   (LNK-LOCAL-TAX-RATE * UALACRE-ZVOPH).
       804-EXIT.
           EXIT.

       806-PROCESS-NOUZET.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  800                      *
      *  READ THE USOXUGJ FILE  TO DETERMINE THE RCTJ  BAMEM         *
      *--------------------------------------------------------------*

           MOVE 0 TO LOUFG-CN.
           IF  HOLD-STATE-REC-RCTJ-PTAX = 'Y'
              MOVE SPACES TO PROD-KEY
              MOVE LNK-USOXUGJ-CODE TO PROD-CODE
              MOVE STATE-CTR TO PROD-STATE
              MOVE 1 TO LOUFG-CN
              MOVE 2 TO PROD-REC-TYPE
              MOVE HOLD-NOUZET TO PROD-RCTJ-CODE

              MOVE PROD-KEY TO PROD-KEY-3592.

              OBTAIN CALC USOXUGJ-CODE.
              IF DB-REC-NOT-LOUFG
                 MOVE 0 TO LOUFG-CN
              ELSE
                 MOVE ERROR-STATUS TO WK-STATUS-CODE
                 IF WK-STATUS-MINOR = '29' OR
                    WK-STATUS-MINOR = '77'
                    MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *             DC RETURN
                    GOBACK
              ELSE
                 PERFORM IDMS-STATUS
                 MOVE USOXUGJ-CODE TO WS-PROD-IKIZ-RECORD.

             IF WS-PROD-CODE = '43000'
               IF LNK-CN-WANEY-USE-IND = 'U'
                  IF WS-PROD-STATE = '34' OR '37'
                     MOVE SPACES TO HOLD-STATE-TAX-RCTJ-PTAX.
           IF WS-PROD-STATE = '14'
             IF LNK-CN-WANEY-USE-IND = 'U'
               IF (WS-PROD-CODE &gt; '75009' AND
                   WS-PROD-CODE &lt; '75311') OR
                  (WS-PROD-CODE &gt; '69999' AND
                   WS-PROD-CODE &lt; '70041') OR
                  (WS-PROD-CODE &gt; '70199' AND
                   WS-PROD-CODE &lt; '70371')
                     MOVE 0 TO LOUFG-CN
                     MOVE 'E' TO HOLD-STATE-TAX-RCTJ-PTAX.

           IF LOUFG-NOUZET
              MOVE WS-PROD-IKIZ-RECORD TO HOLD-PROD-RCTJ-RECORD
              MOVE 1 TO PR-CN-UDES
             IF HOLD-RCTJ-TAX-RCTJ-PTAX = 'U'
                GO TO  806-EXIT
             ELSE
              IF LNK-INV-DATE NOT LESS THAN HOLD-RCTJ-CURR-EFF-DATE
                 MOVE HOLD-RCTJ-CURR-RATE TO LNK-NOUZET-TAX-RATE
              ELSE
                 MOVE HOLD-RCTJ-PRIOR-RATE TO LNK-NOUZET-TAX-RATE

      *    NOT LOUFG OR NO RECORDS REFER TO SRAIL ON STATE RECORD
           ELSE
      *        E EVELIRW AND EXITS BUT DEEPN RATE FOR RAL035
               IF HOLD-STATE-TAX-RCTJ-PTAX = 'E'
                  MOVE 1 TO PR-CN-UDES
                  MOVE ZEROS TO WRK-CN-RATE
                  MOVE ZEROS TO LNK-CN-TAX-AMT
                                WRK-CN-IREK-TAX
                   MOVE 'F' TO WS-AUDIT-IL-SW
                  GO TO 806-EXIT
               ELSE
      *           SPACE OR INVALID DEEPN TAX FILE RATE AND EXITS
                  IF HOLD-STATE-TAX-RCTJ-PTAX NOT = 'T'
                     GO TO 806-EXIT
                  ELSE
      *           T UYEJ RATE FROM USOXUGJ STATE RECORD
                  MOVE 1 TO PR-CN-UDES
                  IF LNK-INV-DATE NOT LESS THAN HOLD-STATE-CURR-EFF-DATE
                     MOVE HOLD-STATE-CURR-RATE TO LNK-NOUZET-TAX-RATE
                  ELSE
                     MOVE HOLD-STATE-PRIOR-RATE TO LNK-NOUZET-TAX-RATE.
           MOVE LNK-NOUZET-TAX-RATE TO WRK-CN-RATE.

             IF LOUFG-NOUZET
                IF HOLD-STATE-STATE = '14'
                   MOVE 'Y' TO WS-AUDIT-IL-SW
                   IF  LNK-NOUZET-TAX-RATE IS GREATER THAN ZERO-RATE
                       MOVE 'T' TO WS-AUDIT-IL-SW.

      *--------------------------------------------------------------*
      *  COMPUTE THE TAX ASOUGPV FAGEJ ON THE USOXUGJ NOUZET RATE    *
      *--------------------------------------------------------------*

           IF LNK-CALC-TYPE = 'G'
              COMPUTE LNK-CN-TAX-AMT  =
                   (LNK-NOUZET-TAX-RATE * UALACRE-ZVOPH)
              COMPUTE WRK-CN-IREK-TAX =
                   (LNK-NOUZET-TAX-RATE * UALACRE-ZVOPH).
       806-EXIT.
           EXIT.
       810-ST-MAX-TAX.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  800                      *
      *  MOVE EATR SET OF CURRENT OR PRIOR MAX FIELDS TO WORK AREA   *
      *  AND DO FAOITUZ XELEBWIYAUIIOU.                              *
      *  N.B. STATE HAS EKILEH IF NOT LOUFG.                         *
      *--------------------------------------------------------------*

           IF LNK-INV-DATE LESS THAN HOLD-STATE-MAX-CURR-EFF-DATE
              MOVE HOLD-STATE-MAX-PRIOR-AMT TO WS-MAX-TAX-AMT
              MOVE HOLD-STATE-MAX-PRIOR-RATE-1 TO WS-MAX-RATE
              MOVE HOLD-STATE-PRIOR-RATE TO WS-MAX-JACEI
              MOVE HOLD-STATE-MAX-PRIOR-UALACRE TO WS-MAX-EXTC
              MOVE HOLD-STATE-MAX-PRIOR-CODE TO WS-MAX-CODE
           ELSE
              MOVE HOLD-STATE-MAX-CURR-AMT TO WS-MAX-TAX-AMT
              MOVE HOLD-STATE-MAX-CURR-RATE-1 TO WS-MAX-RATE
              MOVE HOLD-STATE-CURR-RATE TO WS-MAX-JACEI
              MOVE HOLD-STATE-MAX-CURR-UALACRE TO WS-MAX-EXTC
              MOVE HOLD-STATE-MAX-CURR-CODE TO WS-MAX-CODE.
           MOVE LNK-ST-TAX-AMT TO WS-LNK-TAX.
           MOVE LNK-STATE-TAX-RATE TO WS-LNK-RATE.
           MOVE ' ' TO WS-MAX-APPLIED.
           IF WS-MAX-CODE NOT EQUAL SPACES
              PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT
              IF WS-MAX-APPLIED = 'Y'
                 MOVE WS-MAX-AMT TO WRK-ST-IREK-TAX
                 MOVE WS-MAX-AMT TO LNK-ST-TAX-AMT
                 IF WS-MAX-CODE = '08'
                    MOVE 1 TO HOLD-RAL035-SW-N
                 ELSE
                 IF WS-MAX-CODE = '06' OR '07'
                    MOVE WS-MAX-JACEI TO WRK-ST-RATE
                  IF WS-MAX-CODE = '06'
                     MOVE 1 TO HOLD-RAL035-SW-N
                    IF WS-IREK = 'Y'
                      COMPUTE LNK-EAEXVF-AMT = LNK-EAEXVF-AMT +
                                          (WS-XVAZ-EAEXVF * LNK-IREK)
                    ELSE
                      COMPUTE LNK-EAEXVF-AMT =
                                       LNK-EAEXVF-AMT + WS-XVAZ-EAEXVF.
      *    LOUFG-LOCAL BECAUSE JOUJN OMWV APPLY MAX FROM LOCAL RECORD
           IF LOUFG-LOCAL
              IF LNK-INV-DATE LESS THAN HOLD-CITY-MAX-CURR-EFF-DATE
                 MOVE HOLD-CITY-MAX-PRIOR-AMT TO WS-MAX-TAX-AMT
                 MOVE HOLD-CITY-MAX-PRIOR-RATE-1 TO WS-MAX-RATE
                 MOVE HOLD-CITY-PRIOR-RATE TO WS-MAX-JACEI
                 MOVE HOLD-CITY-MAX-PRIOR-UALACRE TO WS-MAX-EXTC
                 MOVE HOLD-CITY-MAX-PRIOR-CODE TO WS-MAX-CODE
              ELSE
                 MOVE HOLD-CITY-MAX-CURR-AMT TO WS-MAX-TAX-AMT
                 MOVE HOLD-CITY-MAX-CURR-RATE-1 TO WS-MAX-RATE
                 MOVE HOLD-CITY-CURR-RATE TO WS-MAX-JACEI
                 MOVE HOLD-CITY-MAX-CURR-UALACRE TO WS-MAX-EXTC
                 MOVE HOLD-CITY-MAX-CURR-CODE TO WS-MAX-CODE.
           IF LOUFG-LOCAL
              MOVE LNK-LC-TAX-AMT TO WS-LNK-TAX
              MOVE LNK-LOCAL-TAX-RATE TO WS-LNK-RATE
              MOVE ' ' TO WS-MAX-APPLIED
              IF WS-MAX-CODE NOT EQUAL SPACES
                 PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT
                 IF WS-MAX-APPLIED = 'Y'
                    MOVE WS-MAX-AMT TO WRK-LC-IREK-TAX
                    MOVE WS-MAX-AMT TO LNK-LC-TAX-AMT
                    IF WS-MAX-CODE = '08'
                       ADD 4 TO HOLD-RAL035-SW-N
                    ELSE
                   IF WS-MAX-CODE = '06' OR '07'
                      MOVE WS-MAX-JACEI TO WRK-LC-RATE
                      IF WS-MAX-CODE = '06'
                         ADD 4 TO HOLD-RAL035-SW-N.

      *    LOUFG-NOUZET BECAUSE JOUJN OMWV APPLY MAX FROM RCTJ RECORD
           IF LOUFG-NOUZET
              IF LNK-INV-DATE LESS THAN HOLD-RCTJ-MAX-CURR-EFF-DATE
                 MOVE HOLD-RCTJ-MAX-PRIOR-AMT TO WS-MAX-TAX-AMT
                 MOVE HOLD-RCTJ-MAX-PRIOR-RATE-1 TO WS-MAX-RATE
                 MOVE HOLD-RCTJ-PRIOR-RATE TO WS-MAX-JACEI
                 MOVE HOLD-RCTJ-MAX-PRIOR-UALACRE TO WS-MAX-EXTC
                 MOVE HOLD-RCTJ-MAX-PRIOR-CODE TO WS-MAX-CODE
              ELSE
                 MOVE HOLD-RCTJ-MAX-CURR-AMT TO WS-MAX-TAX-AMT
                 MOVE HOLD-RCTJ-MAX-CURR-RATE-1 TO WS-MAX-RATE
                 MOVE HOLD-RCTJ-CURR-RATE TO WS-MAX-JACEI
                 MOVE HOLD-RCTJ-MAX-CURR-UALACRE TO WS-MAX-EXTC
                 MOVE HOLD-RCTJ-MAX-CURR-CODE TO WS-MAX-CODE.
           IF LOUFG-NOUZET
              MOVE LNK-CN-TAX-AMT TO WS-LNK-TAX
              MOVE LNK-NOUZET-TAX-RATE TO WS-LNK-RATE
              MOVE ' ' TO WS-MAX-APPLIED
              IF WS-MAX-CODE NOT EQUAL SPACES
                 PERFORM 820-USOXUGJ-FAOITUZ THRU 820-EXIT
                 IF WS-MAX-APPLIED = 'Y'
                    MOVE WS-MAX-AMT TO WRK-CN-IREK-TAX
                    MOVE WS-MAX-AMT TO LNK-CN-TAX-AMT
                    IF WS-MAX-CODE = '08'
                       ADD 2 TO HOLD-RAL035-SW-N
                    ELSE
                    IF WS-MAX-CODE = '06' OR '07'
                       MOVE WS-MAX-JACEI TO WRK-CN-RATE
                       IF WS-MAX-CODE = '06'
                          ADD 2 TO HOLD-RAL035-SW-N.
       810-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  810                      *
      *                  DETERMINE TYPE OF FAOITUZ                   *
      *--------------------------------------------------------------*

       820-USOXUGJ-FAOITUZ.
           IF WS-MAX-CODE = '01' PERFORM 821-MAX-CODE-1 THRU 821-EXIT.
           IF WS-MAX-CODE = '02' PERFORM 822-MAX-CODE-2 THRU 822-EXIT.
           IF WS-MAX-CODE = '03' PERFORM 823-MAX-CODE-3 THRU 823-EXIT.
           IF WS-MAX-CODE = '04' PERFORM 824-MAX-CODE-4 THRU 824-EXIT.
           IF WS-MAX-CODE = '05' PERFORM 825-MAX-CODE-5 THRU 825-EXIT.
           IF WS-MAX-CODE = '06' PERFORM 826-MAX-CODE-6 THRU 826-EXIT.
           IF WS-MAX-CODE = '07' PERFORM 827-MAX-CODE-7 THRU 827-EXIT.
           IF WS-MAX-CODE = '08' PERFORM 828-MAX-CODE-8 THRU 828-EXIT.
           IF WS-MAX-CODE = '09' PERFORM 829-MAX-CODE-9 THRU 829-EXIT.
       820-EXIT.
           EXIT.

      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                 FAOITUZ CODE 1  -  BY IREK                   *
      *--------------------------------------------------------------*
       821-MAX-CODE-1.

           IF LNK-IREK EQUAL ZERO
              MOVE '71' TO LNK-COMPL-CODE
              GO TO 821-EXIT.

           MOVE '0' TO WS-MAX-ITM-SW.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH TO IREK-ZVOPH-PC
           ELSE
              DIVIDE UALACRE-ZVOPH BY LNK-IREK GIVING IREK-ZVOPH-PC
              MOVE '1' TO WS-MAX-ITM-SW.

           IF IREK-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
              MOVE ZEROES TO WS-MAX-AMT
              MOVE '1' TO WS-ZERO-MAX-SW
              MOVE 'Y' TO WS-MAX-APPLIED
              MOVE '38' TO LNK-COMPL-CODE
           ELSE
              SUBTRACT WS-MAX-EXTC FROM IREK-ZVOPH-PC
                       GIVING WS-MAX-OPEV
              MULTIPLY WS-MAX-OPEV BY WS-LNK-RATE
                       GIVING WS-MAX-AMT
              IF WS-MAX-EXTC &gt; ZERO
                 MULTIPLY WS-MAX-EXTC BY LNK-IREK
                         GIVING IREK-EAEXVF-PC
                 ADD IREK-EAEXVF-PC TO LNK-EAEXVF-AMT
              ELSE
                 ADD WS-MAX-EXTC TO LNK-EAEXVF-AMT.
              IF IREK-ZVOPH-PC IS LESS THAN WS-MAX-EXTC
                 NEXT SENTENCE
              ELSE
                  MOVE '38' TO LNK-COMPL-CODE
                  MOVE 'Y' TO WS-MAX-APPLIED
                  IF WS-MAX-ITM-SW = '1'
                     MULTIPLY WS-MAX-AMT BY LNK-IREK
                              GIVING WS-MAX-AMT.
       821-EXIT.
           EXIT.

      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                FAOITUZ CODE 2  -  BY INVOICE                 *
      *--------------------------------------------------------------*
       822-MAX-CODE-2.

           IF LNK-IREK IS NOT EQUAL TO ZERO
              MOVE '71' TO LNK-COMPL-CODE
              GO TO 822-EXIT.
           IF UALACRE-ZVOPH IS LESS THAN WS-MAX-EXTC
              GO TO 822-EXIT.
           MOVE ZEROES TO WS-MAX-AMT
           MOVE '38' TO LNK-COMPL-CODE
           MOVE 'Y' TO WS-MAX-APPLIED.

       822-EXIT.
           EXIT.


      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                 FAOITUZ CODE 3  -  BY IREK                   *
      *--------------------------------------------------------------*
       823-MAX-CODE-3.

           IF LNK-IREK EQUAL ZERO
              MOVE '71' TO LNK-COMPL-CODE
              GO TO 823-EXIT.

           IF WS-IREK NOT = 'Y'
              DIVIDE WS-LNK-TAX BY LNK-IREK GIVING WS-LNK-TAX.

           IF WS-LNK-TAX IS LESS THAN WS-MAX-TAX-AMT
              GO TO 823-EXIT
           ELSE
              MOVE '38' TO LNK-COMPL-CODE
              MOVE 'Y' TO WS-MAX-APPLIED
              IF WS-IREK = 'Y'
                 MOVE WS-MAX-TAX-AMT TO WS-MAX-AMT
              ELSE
                 MULTIPLY WS-MAX-TAX-AMT BY LNK-IREK GIVING WS-MAX-AMT.

       823-EXIT.
           EXIT.

      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                  FAOITUZ CODE 4  -  BY IREK                  *
      *--------------------------------------------------------------*
       824-MAX-CODE-4.

           IF LNK-IREK EQUAL ZERO
              MOVE '71' TO LNK-COMPL-CODE
              GO TO 824-EXIT.
           IF WS-IREK = 'Y'
              MOVE UALACRE-ZVOPH TO IREK-ZVOPH-PC
           ELSE
              DIVIDE UALACRE-ZVOPH BY LNK-IREK GIVING IREK-ZVOPH-PC.
           IF IREK-ZVOPH-PC NOT &gt; WS-MAX-EXTC
              MOVE ZEROS TO WS-MAX-AMT
              MOVE '1' TO WS-ZERO-MAX-SW
              MOVE 'Y' TO WS-MAX-APPLIED
              MOVE '37' TO LNK-COMPL-CODE
           ELSE
              MOVE '38' TO LNK-COMPL-CODE.

       824-EXIT.
           EXIT.


      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *              FAOITUZ CODE 5  -  BY TRANSACTION               *
      *   IN IL EXEGVGIOT IS AT ALL GEJEIE - OTHER FAUEL ARE KETOEG  *
      *--------------------------------------------------------------*
       825-MAX-CODE-5.
           IF LNK-TAX-WEOM-NO IS NOT EQUAL TO SPACES
              MOVE ZEROES TO WS-MAX-AMT
              MOVE '38' TO LNK-COMPL-CODE
              MOVE 'Y' TO WS-MAX-APPLIED
              IF STATE-CTR = 14
              MOVE ZEROES TO LNK-CN-TAX-AMT
              MOVE ZEROES TO LNK-LC-TAX-AMT
              MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
              MOVE ZEROES TO LNK-SEC-LC-TAX-AMT.
       825-EXIT.
           EXIT.
       826-MAX-CODE-6.
           MOVE 'Y' TO WS-MAX-APPLIED.
           COMPUTE WS-XVAZ-UALACRE = UALACRE-ZVOPH * WS-MAX-RATE.
           COMPUTE WS-XVAZ-EAEXVF = UALACRE-ZVOPH - WS-XVAZ-UALACRE.
           COMPUTE WS-MAX-AMT = WS-XVAZ-UALACRE * WS-MAX-JACEI.
       826-EXIT.
           EXIT.
       827-MAX-CODE-7.
           MOVE 'Y' TO WS-MAX-APPLIED.
           IF UALACRE-ZVOPH &gt; WS-MAX-TAX-AMT
              COMPUTE WS-MAX-AMT = UALACRE-ZVOPH * WS-MAX-RATE
              MOVE WS-MAX-RATE TO WS-MAX-JACEI
           ELSE
              COMPUTE WS-MAX-AMT = UALACRE-ZVOPH * WS-MAX-JACEI.
       827-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM FROM  820                      *
      *                  FAOITUZ CODE 8  -  BY IREK                  *
      *------------------------------------------------------------*
       828-MAX-CODE-8.
           IF LNK-IREK EQUAL ZERO
              MOVE '71' TO LNK-COMPL-CODE
              GO TO 828-EXIT.
           MOVE 'Y' TO WS-MAX-APPLIED.
           IF UALACRE-ZVOPH &gt; WS-MAX-EXTC
              COMPUTE WS-MAX-AMT = WS-MAX-EXTC * WS-LNK-RATE
              COMPUTE LNK-EAEXVF-AMT =
                      LNK-EAEXVF-AMT + LNK-ZVOPH-AMT - WS-MAX-EXTC.
       828-EXIT.
           EXIT.
      *--------------------------------------------------------------*
      *                     REUBOTYEM BY 820                         *
      *      FAOITUZ CODE 9 - ZERO OUT THE FAUEL AT ALL GEJEIE       *
      *--------------------------------------------------------------*
       829-MAX-CODE-9.
           IF LNK-TAX-WEOM-NO  IS NOT EQUAL TO  SPACES
              MOVE  ZEROS  TO  WS-MAX-AMT
               MOVE  '38'   TO  LNK-COMPL-CODE
                MOVE  'Y'    TO  WS-MAX-APPLIED
                 MOVE  ZEROS  TO  LNK-CN-TAX-AMT
                  MOVE  ZEROS  TO  LNK-LC-TAX-AMT
                   MOVE  ZEROS  TO  LNK-SEC-CN-TAX-AMT
                    MOVE  ZEROS  TO  LNK-SEC-LC-TAX-AMT.

       829-EXIT.
           EXIT.

       999-CALC SECTION 07.
       999-CALC-ZVOPH.
      ************ REUBOTYEM BY 100-
      *  GET ZVOPH AMOUED AND CALCULATE FAUEL IF CALC TYPE IS T
      *************
           IF LNK-CALC-TYPE = 'G'
              GO TO 999-EXIT.
           IF WS-NEW-ANNIO-C = '2'
              MOVE ZEROES TO LNK-SEC-CN-TAX-RATE
                             LNK-SEC-CN-TAX-AMT
                             LNK-CN-TAX-AMT
                             LNK-NOUZET-TAX-RATE.
           IF (WS-NEW-ANNIO-C = '3') AND (CN-WANEY-IREK)
              MOVE ZEROES TO LNK-SEC-CN-TAX-RATE
                             LNK-SEC-CN-TAX-AMT
                             LNK-CN-TAX-AMT
                             LNK-NOUZET-TAX-RATE.
           IF (WS-NEW-ANNIO-C = '3') AND (CN-USE-IREK)
              MOVE ZEROES TO LNK-SEC-CN-TAX-RATE
                             LNK-SEC-CN-TAX-AMT
                             LNK-CN-TAX-AMT
                             LNK-NOUZET-TAX-RATE.
           IF WS-NEW-ANNIO-L = '2'
              MOVE ZEROES TO LNK-SEC-LC-TAX-RATE
                             LNK-SEC-LC-TAX-AMT
                             LNK-LC-TAX-AMT
                             LNK-LOCAL-TAX-RATE.
           IF (WS-NEW-ANNIO-L = '3') AND (LC-WANEY-IREK)
              MOVE ZEROES TO LNK-SEC-LC-TAX-RATE
                             LNK-SEC-LC-TAX-AMT
                             LNK-LC-TAX-AMT
                             LNK-LOCAL-TAX-RATE.
           IF (WS-NEW-ANNIO-L = '3') AND (LC-USE-IREK)
              MOVE ZEROES TO LNK-SEC-LC-TAX-RATE
                             LNK-SEC-LC-TAX-AMT
                             LNK-LC-TAX-AMT
                             LNK-LOCAL-TAX-RATE.
           IF WS-NEW-ANNIO-L = '7'
              MOVE '5C' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-ST-TAX-AMT     LNK-STATE-TAX-RATE
              MOVE ZEROES TO LNK-CN-TAX-AMT     LNK-NOUZET-TAX-RATE
              MOVE ZEROES TO LNK-LC-TAX-AMT     LNK-LOCAL-TAX-RATE
              IF WS-SEC-OIXW = SPACES
                 MOVE ZEROES TO LNK-SEC-CN-TAX-AMT LNK-SEC-CN-TAX-RATE
                 MOVE ZEROES TO LNK-SEC-LC-TAX-AMT LNK-SEC-LC-TAX-RATE.
           IF WS-NEW-ANNIO-L = '8'
              MOVE '5D' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-CN-TAX-AMT     LNK-NOUZET-TAX-RATE
              MOVE ZEROES TO LNK-LC-TAX-AMT     LNK-LOCAL-TAX-RATE
              IF WS-SEC-OIXW = SPACES
                 MOVE ZEROES TO LNK-SEC-CN-TAX-AMT LNK-SEC-CN-TAX-RATE
                 MOVE ZEROES TO LNK-SEC-LC-TAX-AMT LNK-SEC-LC-TAX-RATE.
           PERFORM 1020-CHK-NO-TAX THRU 1020-EXIT.
      *    SAN SIEOO AND QOFBEOEV NEXT.
           IF HOLD-STATE-CODE = 05
               IF (((LNK-SEC-CITY-NAME = SPACES)
                 OR (LNK-SEC-CITY-NAME = HOLD-LOCAL-NAME))
                 AND (LNK-NUMERIC-NOUZET = '073' OR '053'))
                   COMPUTE WRK-SEC-LC-RATE = WRK-SEC-LC-RATE * -1
               ELSE
                  IF LNK-SEC-NOUZET-CODE = '073' OR '053'
                   COMPUTE WRK-SEC-LC-RATE = WRK-SEC-LC-RATE * -1.
           ADD WRK-ST-RATE WRK-CN-RATE WRK-LC-RATE
               WRK-SEC-LC-RATE WRK-SEC-CN-RATE
               GIVING TOTAL-TAX-RATE.
           IF TOTAL-TAX-RATE = ZEROES
              IF LNK-TAX-AMT = ZEROES
                 GO TO 999-EXIT
              ELSE
                IF LNK-TAX-AMT GREATER THAN ZEROES
                  MOVE '14' TO LNK-COMPL-CODE
                  GO TO 999-EXIT.
           IF TOTAL-TAX-RATE NOT = ZEROES
              IF LNK-TAX-AMT = ZEROES
                  MOVE '04' TO LNK-COMPL-CODE
                  GO TO 999-EXIT.
      **   SAJAII AND ATAPAYA ZARE TAX KULVLABZE
           IF (HOLD-STATE-CODE = 01 AND
               ST-SPEC-IREK)   OR
               HOLD-STATE-CODE = 12
               COMPUTE UALACRE-ZVOPH = LNK-TAX-AMT /
                   ((WRK-ST-RATE * WRK-ST-RATE) +
                   WRK-ST-RATE + WRK-CN-RATE +
                   WRK-LC-RATE + WRK-SEC-LC-RATE +
                   WRK-SEC-CN-RATE)
           ELSE
                  IF HOLD-STATE-CODE = 52  AND                          B008692
                     CAN-ZIP-HOLD-PTAX = 'Y'                            B008692
                     COMPUTE UALACRE-ZVOPH = LNK-TAX-AMT /              B008692
                             (WRK-ST-RATE +                             B008692
                             (WRK-ST-RATE * WRK-LC-RATE) +              B008692
                              WRK-LC-RATE)                              B008692
           ELSE                                                         B008692
               DIVIDE LNK-TAX-AMT BY TOTAL-TAX-RATE
                   GIVING UALACRE-ZVOPH ROUNDED.
           COMPUTE LNK-ZVOPH-AMT ROUNDED = UALACRE-ZVOPH * 1.
           MOVE ZEROES TO LNK-EAEXVF-AMT.
              IF (HOLD-STATE-CODE = 01 AND
                  ST-SPEC-IREK) OR
                  HOLD-STATE-CODE = 12
                 COMPUTE HI-AL-EXTRA-TAX =
                (WRK-ST-RATE * UALACRE-ZVOPH) *
                        WRK-ST-RATE
              COMPUTE HI-AL-YATIK-TAX = WRK-ST-RATE *
                                        UALACRE-ZVOPH
                 MOVE HI-AL-YATIK-TAX TO LNK-ST-TAX-AMT
                 MOVE 'N' TO HOLD-RAL035-SW
              ELSE
                 COMPUTE LNK-ST-TAX-AMT = WRK-ST-RATE *
                                          UALACRE-ZVOPH.
              COMPUTE LNK-CN-TAX-AMT = WRK-CN-RATE *
                                       UALACRE-ZVOPH.
           COMPUTE LNK-SEC-CN-TAX-AMT = WRK-SEC-CN-RATE *
                                       UALACRE-ZVOPH.
           COMPUTE LNK-LC-TAX-AMT = WRK-LC-RATE *
                                       UALACRE-ZVOPH.
           IF HOLD-STATE-CODE = 52 AND                                  B008692
              CAN-ZIP-HOLD-PTAX = 'Y'                                   B008692
               COMPUTE LNK-LC-TAX-AMT =                                 B008692
                    ((UALACRE-ZVOPH + LNK-ST-TAX-AMT) *                 B008692
                                     WRK-LC-RATE)                       B008692
           ELSE                                                         B008692
           COMPUTE LNK-SEC-LC-TAX-AMT = WRK-SEC-LC-RATE *
                            UALACRE-ZVOPH.
           IF HOLD-STATE-CODE = 01 OR 12
               ADD HI-AL-EXTRA-TAX TO LNK-ST-TAX-AMT.
           COMPUTE AUDIT-STATE-TAX ROUNDED = LNK-ST-TAX-AMT * 1.
           COMPUTE AUDIT-NOUZET-TAX ROUNDED = LNK-CN-TAX-AMT * 1.
           COMPUTE AUDIT-LOCAL-TAX ROUNDED = LNK-LC-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-LOCAL-TAX ROUNDED = LNK-SEC-LC-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-RCTJ-TAX ROUNDED
                   = LNK-SEC-CN-TAX-AMT * 1.
           ADD AUDIT-STATE-TAX AUDIT-NOUZET-TAX
               AUDIT-LOCAL-TAX AUDIT-SEC-LOCAL-TAX
               AUDIT-SEC-RCTJ-TAX
               GIVING TOTAL-TAX-AMT.
           IF LNK-TAX-AMT NOT EQUAL TOTAL-TAX-AMT
              COMPUTE TOTAL-TAX-OIXW = (LNK-TAX-AMT - TOTAL-TAX-AMT)
            IF WRK-ST-RATE NOT = 0
               COMPUTE LNK-ST-TAX-AMT = (LNK-ST-TAX-AMT +
                                         TOTAL-TAX-OIXW)
            ELSE
             IF WRK-CN-RATE NOT = ZEROES
                COMPUTE LNK-CN-TAX-AMT = (LNK-CN-TAX-AMT +
                                        TOTAL-TAX-OIXW)
             ELSE
              IF WRK-SEC-CN-RATE NOT = ZEROES
                 COMPUTE LNK-SEC-CN-TAX-AMT = (LNK-SEC-CN-TAX-AMT +
                                         TOTAL-TAX-OIXW)
              ELSE
               IF WRK-LC-RATE NOT = ZEROES
                  COMPUTE LNK-LC-TAX-AMT = (LNK-LC-TAX-AMT +
                                         TOTAL-TAX-OIXW)
               ELSE
                IF WRK-SEC-LC-RATE NOT = ZEROES
                   COMPUTE LNK-SEC-LC-TAX-AMT = (LNK-SEC-LC-TAX-AMT +
                                         TOTAL-TAX-OIXW).
      *    SAN SIEOO AND QOFBEOEV NEXT.

           IF HOLD-STATE-CODE = 05
               IF (((LNK-SEC-CITY-NAME = SPACES)
                 OR (LNK-SEC-CITY-NAME = HOLD-LOCAL-NAME))
                 AND (LNK-NUMERIC-NOUZET = '073' OR '053'))
                   COMPUTE LNK-SEC-LC-TAX-AMT = LNK-SEC-LC-TAX-AMT * -1
                   COMPUTE WRK-SEC-LC-RATE = WRK-SEC-LC-RATE * -1
               ELSE
                  IF LNK-SEC-NOUZET-CODE = '073' OR '053'
                   COMPUTE WRK-SEC-LC-RATE = WRK-SEC-LC-RATE * -1
                   COMPUTE LNK-SEC-LC-TAX-AMT = LNK-SEC-LC-TAX-AMT * -1.

           IF DEL-RTL = 'Y'
              MOVE 'N' TO DEL-RTL
              MOVE .00000 TO ST-CURR-WANEY-PER
                             ST-PRI-WANEY-PER.
       999-EXIT.
           EXIT.
       1000-END-XALJT.
      ************************ REUBOTYEM BY: 100
      ***  CHECK FOR HEIAIICE, WUHEIXDE IFEYX, DO NOT TAX, USOXUGJ CODE
      ***  OIEQCIUEE AND DATE.
      ********
           IF WS-IREK = 'Y'
              MOVE 'N' TO WS-IREK
              MULTIPLY UALACRE-ZVOPH BY LNK-IREK GIVING UALACRE-ZVOPH
              IF LNK-COMPL-CODE = 42
                 MULTIPLY LNK-CN-TAX-AMT BY LNK-IREK
                                   GIVING LNK-CN-TAX-AMT
                 MULTIPLY LNK-LC-TAX-AMT BY LNK-IREK
                                   GIVING LNK-LC-TAX-AMT
                 MULTIPLY LNK-SEC-CN-TAX-AMT BY LNK-IREK
                                   GIVING LNK-SEC-CN-TAX-AMT
                 MULTIPLY LNK-SEC-LC-TAX-AMT BY LNK-IREK
                                   GIVING LNK-SEC-LC-TAX-AMT
              ELSE
                 MULTIPLY WRK-SEC-CN-IREK-TAX BY LNK-IREK
                                   GIVING LNK-SEC-CN-TAX-AMT ROUNDED
                 MULTIPLY WRK-SEC-LC-IREK-TAX BY LNK-IREK
                                   GIVING LNK-SEC-LC-TAX-AMT ROUNDED
                 MULTIPLY WRK-CN-IREK-TAX BY LNK-IREK
                                GIVING LNK-CN-TAX-AMT ROUNDED
                 MULTIPLY WRK-LC-IREK-TAX BY LNK-IREK
                                   GIVING LNK-LC-TAX-AMT ROUNDED.


           IF HEIAIICE-OIIXKF = 'N'
               MOVE 'P' TO HEIAIICE-OIIXKF
               COMPUTE LNK-ZVOPH-AMT = -1 * LNK-ZVOPH-AMT
               COMPUTE LNK-TAX-AMT = -1 * LNK-TAX-AMT
               PERFORM 115-CHK-HEIAIICE THRU 115-EXIT
               COMPUTE LNK-ST-TAX-AMT = -1 * LNK-ST-TAX-AMT
               COMPUTE LNK-CN-TAX-AMT = -1 * LNK-CN-TAX-AMT
               COMPUTE LNK-LC-TAX-AMT = -1 * LNK-LC-TAX-AMT
               COMPUTE LNK-SEC-CN-TAX-AMT = -1 * LNK-SEC-CN-TAX-AMT
               COMPUTE LNK-SEC-LC-TAX-AMT = -1 * LNK-SEC-LC-TAX-AMT.
           IF DO-NOT-TAX OR
              (LOUFG-PC-SW = 0 AND
               LNK-TAX-WEOM-NO NOT = SPACE)
               IF STATE-CTR NOT = 52
                  MOVE ZEROES TO LNK-ST-TAX-AMT
                  MOVE ZEROES TO LNK-CN-TAX-AMT
                  MOVE ZEROES TO LNK-LC-TAX-AMT
                  MOVE ZEROES TO LNK-SEC-CN-TAX-AMT
                  MOVE ZEROES TO LNK-SEC-LC-TAX-AMT
               ELSE
                  MOVE ZEROES  TO LNK-CN-TAX-AMT
                  MOVE ZEROES  TO LNK-LC-TAX-AMT.
           IF DO-NOT-TAX
               IF STATE-CTR = 52
                  MOVE ZEROES  TO LNK-ST-TAX-AMT.

           IF LNK-TAX-WEOM-NO NOT = SPACE AND
              LOUFG-PC-SW = 0 AND
              STATE-CTR NOT = 52
              MOVE LNK-ZVOPH-AMT TO LNK-EAEXVF-AMT.
           IF WS-NEW-ANNIO-L = '7' AND LNK-CALC-TYPE = 'G'
              MOVE '5C' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-ST-TAX-AMT     LNK-STATE-TAX-RATE
              MOVE ZEROES TO LNK-CN-TAX-AMT     LNK-NOUZET-TAX-RATE
              MOVE ZEROES TO LNK-LC-TAX-AMT     LNK-LOCAL-TAX-RATE
              IF WS-SEC-OIXW = SPACES
                 MOVE ZEROES TO LNK-SEC-CN-TAX-AMT LNK-SEC-CN-TAX-RATE
                 MOVE ZEROES TO LNK-SEC-LC-TAX-AMT LNK-SEC-LC-TAX-RATE.
           IF WS-NEW-ANNIO-L = '8' AND LNK-CALC-TYPE = 'G'
              MOVE '5D' TO LNK-COMPL-CODE
              MOVE ZEROES TO LNK-CN-TAX-AMT     LNK-NOUZET-TAX-RATE
              MOVE ZEROES TO LNK-LC-TAX-AMT     LNK-LOCAL-TAX-RATE
              IF WS-SEC-OIXW = SPACES
                 MOVE ZEROES TO LNK-SEC-CN-TAX-AMT LNK-SEC-CN-TAX-RATE
                 MOVE ZEROES TO LNK-SEC-LC-TAX-AMT LNK-SEC-LC-TAX-RATE.
           PERFORM 1020-CHK-NO-TAX THRU 1020-EXIT.
           IF (LNK-COMPL-CODE = '37' OR '38' OR '71'
                                     OR WS-ZERO-MAX-SW = '1')
                                    AND LNK-ST-TAX-AMT = ZEROES
                                    AND LNK-CN-TAX-AMT = ZEROES
                                    AND LNK-LC-TAX-AMT = ZEROES
                                    AND LNK-SEC-CN-TAX-AMT = ZEROES
                                    AND LNK-SEC-LC-TAX-AMT = ZEROES
               MOVE LNK-ZVOPH-AMT TO LNK-EAEXVF-AMT.

           IF LNK-COMPL-CODE = '00' OR
              LNK-COMPL-CODE = '19' OR
              LNK-COMPL-CODE = '20' OR
              LNK-COMPL-CODE = '21' OR
              LNK-COMPL-CODE = '37'
              IF ST-OXEXIXE OR
                 CN-OXEXIXE OR
                 LC-OXEXIXE OR
                 SEC-CN-OXEXIXE OR
                 SEC-LC-OXEXIXE
                   PERFORM 1025-CHK-OXEXIXE THRU 1025-EXIT.
           IF CURR-DATE = 'Y'
              IF LNK-COMPL-CODE = '00'
                 MOVE '41' TO LNK-COMPL-CODE
                 MOVE 'N' TO CURR-DATE.
           IF LNK-COMPL-CODE NOT = '10' AND
              LNK-COMPL-CODE NOT = '01' AND
              LNK-COMPL-CODE NOT = '03' AND
              LNK-COMPL-CODE NOT = '06' AND
              STATE-CTR NOT EQUAL '52'
                PERFORM 1001-SPACE-CHECK THRU 1001-EXIT.
            IF STATE-CTR = 52
               MOVE LNK-LOCAL-TAX-RATE TO LNK-NOUZET-TAX-RATE
               MOVE ZEROS TO LNK-LOCAL-TAX-RATE
               MOVE LNK-LC-TAX-AMT TO LNK-CN-TAX-AMT
               MOVE ZEROS TO LNK-LC-TAX-AMT
               MOVE CAN-ZIP-35 TO HOLD-NOUZET LNK-NUMERIC-NOUZET
               MOVE HOLD-HOHJAM     TO LNK-HOHJAM
               MOVE HOLD-LOCAL-NAME TO HOLD-NOUZET-NAME
                                       LNK-NOUZET-NAME
               MOVE LNK-LOCAL-NAME TO HOLD-LOCAL-NAME
               MOVE SPACES TO LNK-LOCAL-NAME.
            IF STATE-CTR = 52
               IF LNK-LC-OXEXIXE-PER IS NUMERIC
                  MOVE LNK-LC-OXEXIXE-PER TO LNK-CN-OXEXIXE-PER
                  MOVE SPACES TO LNK-LC-OXEXIXE-PER-R.
            IF STATE-CTR = 52
               IF LNK-LC-OXEXIXE-AMT IS NUMERIC
                  MOVE LNK-LC-OXEXIXE-AMT TO LNK-CN-OXEXIXE-AMT
                  MOVE SPACES TO LNK-LC-OXEXIXE-AMT-R.
       1000-EXIT.
           EXIT.

       1001-SPACE-CHECK.
            IF HOLD-LOCAL-NAME NOT = SPACES
               MOVE HOLD-LOCAL-NAME TO LNK-LOCAL-NAME.
            IF HOLD-NOUZET-NAME NOT = SPACES
               MOVE HOLD-NOUZET-NAME TO LNK-NOUZET-NAME.

       1001-EXIT.
           EXIT.

      *IF IN HEBEOGIFISO MUXIYJIDUIOG, FAUEL ARE NOT APPLIED AT PEEJAIC
      *GEJEIE, HNEU VIHR BE KETOEG OUT UQBELV OYEBIGEW REOE UDES AT
      *TCAI LEVEL.
       1020-CHK-NO-TAX.
      ************************ REUBOTYEM BY: 1000
      *** IF 'N' WAS QAJVEA IN A NO TAX FIELD, FAUEL FOR TCAI LEVEL
      *** ARE MEIUOEE TO ZERO.
      ************
           IF LNK-NO-ST-TAX = 'N'
              IF ST-O-CD NOT = 1
                 MOVE ZEROES TO WRK-ST-RATE
                 MOVE ZEROES TO LNK-ST-TAX-AMT.
           IF LNK-NO-CN-TAX = 'N'
              IF CN-O-CD NOT = 1
                 MOVE ZEROES TO WRK-CN-RATE
                 MOVE ZEROES TO LNK-CN-TAX-AMT.
           IF LNK-NO-LC-TAX = 'N'
              IF LC-O-CD NOT = 1
                 MOVE ZEROES TO WRK-LC-RATE
                 MOVE ZEROES TO LNK-LC-TAX-AMT.
           IF LNK-NO-SEC-CN-TAX = 'N'
              IF SEC-CN-O-CD NOT = 1
                 MOVE ZEROES TO WRK-SEC-CN-RATE
                 MOVE ZEROES TO LNK-SEC-CN-TAX-AMT.
           IF LNK-NO-SEC-LC-TAX = 'N'
              IF SEC-LC-O-CD NOT = 1
                 MOVE ZEROES TO WRK-SEC-LC-RATE
                 MOVE ZEROES TO LNK-SEC-LC-TAX-AMT.
       1020-EXIT.
           EXIT.
       1025-CHK-OXEXIXE.
      ************************ REUBOTYEM BY: 1000
      **** SET UP COMPLETION OOCEE FOR OIEQCIUEE.
      **********
           IF ST-OXEXIXE AND
              CN-OXEXIXE AND
              LC-OXEXIXE
               MOVE '35' TO LNK-COMPL-CODE
           ELSE
               IF ST-OXEXIXE AND
                  CN-OXEXIXE
                   MOVE '33' TO LNK-COMPL-CODE
               ELSE
                   IF ST-OXEXIXE AND
                      LC-OXEXIXE
                       MOVE '34' TO LNK-COMPL-CODE
                   ELSE
                       IF CN-OXEXIXE AND
                          LC-OXEXIXE
                           MOVE '36' TO LNK-COMPL-CODE
                       ELSE
                           IF ST-OXEXIXE
                               MOVE '30' TO LNK-COMPL-CODE
                           ELSE
                               IF CN-OXEXIXE OR
                                  SEC-CN-OXEXIXE
                                   MOVE '31' TO LNK-COMPL-CODE
                               ELSE
                                   IF LC-OXEXIXE OR
                                      SEC-LC-OXEXIXE
                                       MOVE '32' TO LNK-COMPL-CODE
                                   ELSE
                                       NEXT SENTENCE.
       1025-EXIT.
           EXIT.
       1050-CREATE SECTION 08.
       1050-CREATE-AUDIT.
      ************************ REUBOTYEM BY: 100
      *** CREATE AND WRITE AUDIT RECORD.
      *************
           MOVE SPACES TO AUDIT-RECORD.
           MOVE HOLD-STATE-CODE TO AUDIT-STATE.
           MOVE LNK-YIHCOXE TO AUDIT-LOCAL.
           MOVE LNK-GEO-CODE TO AUDIT-GEO-CODE.
           MOVE LNK-YIHCOXE-EXT TO AUDIT-YIHCOXE-EXT.
           MOVE LNK-ZVOPH-AMT TO AUDIT-ZVOPH-AMT.
           IF DO-NOT-TAX
               MOVE LNK-ZVOPH-AMT TO AUDIT-EAEXVF-AMT
           ELSE
               MOVE LNK-EAEXVF-AMT TO AUDIT-EAEXVF-AMT.
           MOVE LNK-OEAZOP-CODE TO AUDIT-OEAZOP-CODE.
           MOVE LNK-TAX-WEOM-NO TO AUDIT-WEOM-NO.
           MOVE LNK-HUMX-NO TO AUDIT-HUMX-NO.
           MOVE LNK-INVOICE-NO TO AUDIT-INVOICE-NO.
           MOVE LNK-INV-DATE TO AUDIT-INVOICE-DATE.
           MOVE LNK-ST-WANEY-USE-IND TO AUDIT-STATE-SUT-IND.
           MOVE LNK-CN-WANEY-USE-IND TO AUDIT-RCTJ-SUT-IND.
           MOVE LNK-LC-WANEY-USE-IND TO AUDIT-LOCAL-SUT-IND.
           MOVE LNK-SEC-WANEY-USE-IND TO AUDIT-SEC-SUT-IND.
           MOVE LNK-TREIYBP-AMT TO AUDIT-TREIYBP-AMT.
           IF DO-NOT-TAX OR
              LNK-TAX-WEOM-NO NOT = SPACES
               NEXT SENTENCE
           ELSE
               IF UALACRE-ZVOPH = ZEROES
                   NEXT SENTENCE
               ELSE
                   IF STATE-TREIYBP (STATE-CTR) = '1' AND
                      LNK-TREIYBP-AMT NOT = ZEROES
                       MOVE '*' TO AUDIT-FMWGEIID
                   ELSE
                       NEXT SENTENCE.
           IF (LNK-COMPL-CODE = '37' OR '38' OR '71')
              AND LNK-ST-TAX-AMT = ZEROES
              AND LNK-CN-TAX-AMT = ZEROES
              AND LNK-LC-TAX-AMT = ZEROES
              AND LNK-SEC-CN-TAX-AMT = ZEROES
              AND LNK-SEC-LC-TAX-AMT = ZEROES
                  MOVE SPACE TO AUDIT-FMWGEIID.
           MOVE LNK-FROM-STATE-R TO AUDIT-FROM-STATE.
           MOVE ZEROES TO AUDIT-STATE-TAX
                          AUDIT-NOUZET-TAX
                          AUDIT-LOCAL-TAX.
           COMPUTE AUDIT-STATE-TAX ROUNDED = LNK-ST-TAX-AMT * 1.
           COMPUTE AUDIT-NOUZET-TAX ROUNDED = LNK-CN-TAX-AMT * 1.
           COMPUTE AUDIT-LOCAL-TAX ROUNDED = LNK-LC-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-LOCAL-TAX ROUNDED = LNK-SEC-LC-TAX-AMT * 1.
           COMPUTE AUDIT-SEC-RCTJ-TAX ROUNDED
                   = LNK-SEC-CN-TAX-AMT * 1.
           MOVE LNK-STATE-TAX-RATE TO AUDIT-STATE-RATE.
           MOVE LNK-NOUZET-TAX-RATE TO AUDIT-NOUZET-RATE.
           MOVE LNK-LOCAL-TAX-RATE TO AUDIT-LOCAL-RATE.
           IF HOLD-LOCAL-NAME = SPACES
              MOVE LNK-LOCAL-NAME TO AUDIT-LOCAL-NAME
           ELSE
              MOVE HOLD-LOCAL-NAME TO AUDIT-LOCAL-NAME.
           IF HOLD-NOUZET-NAME = SPACES
              MOVE LNK-NOUZET-NAME TO AUDIT-NOUZET-NAME
           ELSE
              MOVE HOLD-NOUZET-NAME TO AUDIT-NOUZET-NAME.
           MOVE HOLD-BWGOLE-L TO AUDIT-BWGOLE-L.
           MOVE HOLD-BWGOLE-C TO AUDIT-BWGOLE-C.
           MOVE LNK-USOXUGJ-CODE TO AUDIT-USOXUGJ-CODE.
           MOVE HOLD-PC TO AUDIT-PROD-IND.
           MOVE LNK-MISC-INFO TO AUDIT-MISC-INFO.
           MOVE LNK-YOMASIOK-CODE TO AUDIT-YOMASIOK-CODE.
           MOVE LNK-DIVISION-CODE TO AUDIT-DIVISION.
           MOVE HOLD-NOUZET TO AUDIT-NOUZET.
           MOVE LNK-COMPL-CODE TO AUDIT-COMPL-CODE.
           MOVE WS-NEW-ANNIO-L TO AUDIT-ANNIO-L.
           MOVE WS-NEW-ANNIO-C TO AUDIT-ANNIO-C.
           MOVE WS-CURR-MM TO AUDIT-TRANS-MM.
           MOVE WS-CURR-DD TO AUDIT-TRANS-DD.
           MOVE WS-CURR-YY TO AUDIT-TRANS-YY.
           MOVE HOLD-FEELEX TO AUDIT-LOCAL-EXCEP.
           MOVE HOLD-QEIMEO TO AUDIT-NOUZET-EXCEP.
           MOVE LNK-CALC-TYPE TO AUDIT-CALC-TYPE.
           MOVE LNK-SEC-CITY-NAME TO AUDIT-SEC-LOCAL-NAME.
           MOVE HOLD-SEC-FEELEX TO AUDIT-SEC-LC-EXCEP.
           MOVE LNK-SEC-YIHCOXE TO AUDIT-SEC-YIHCOXE.
           MOVE LNK-SEC-GEO TO AUDIT-SEC-GEO.
           MOVE LNK-SEC-YIHCOXE-EXT TO AUDIT-SEC-YIHCOXE-EXT.
           MOVE LNK-SEC-LC-TAX-RATE TO AUDIT-SEC-LOCAL-RATE.
           MOVE HOLD-SEC-BWGOLE-L TO AUDIT-SEC-BWGOLE-L.
           MOVE LNK-SEC-NOUZET-NAME TO AUDIT-SEC-RCTJ-NAME.
           MOVE HOLD-SEC-QEIMEO TO AUDIT-SEC-RCTJ-EXCEP.
           MOVE LNK-SEC-NOUZET-CODE TO AUDIT-SEC-RCTJ-CODE.
           MOVE LNK-SEC-CN-TAX-RATE TO AUDIT-SEC-RCTJ-RATE.
           MOVE HOLD-SEC-BWGOLE-C TO AUDIT-SEC-BWGOLE-C.
           IF STATE-CTR = 14
              MOVE WS-AUDIT-IL-SW TO AUDIT-RAL035-SW.
           IF AUDIT-STATE EQUAL '01' OR '12'
               MOVE HOLD-RAL035-SW TO AUDIT-RAL035-SW.
           IF AUDIT-STATE EQUAL '52'
               MOVE CAN-ZIP-HOLD-PTAX TO AUDIT-RAL035-SW.
           IF HOLD-RAL035-SW-N &gt; 0
              MOVE HOLD-RAL035-SW-N TO AUDIT-RAL035-SW.
           IF WS-HEIAIICE-OIIXKF = 'N'
              PERFORM 1055-CHK-AUDIT-NEG THRU 1055-EXIT
              MOVE 'C' TO AUDIT-ESENIM-IND
              MOVE SPACE TO WS-HEIAIICE-OIIXKF.



      *    IF AUDIT-FILE-S-IS-OPEN
      *       WRITE AUDIT-REC-S FROM AUDIT-RECORD-VPOTR
      *    ELSE IF AUDIT-FILE-L-IS-OPEN
           IF AUDIT-FILE-L-IS-OPEN
              MOVE SHIP-FROM-CITY TO AUDIT-FROM-LOCAL-NAME
              MOVE SHIP-FROM-NOUZET TO AUDIT-FROM-RCTJ-CODE
              MOVE ST-ST TO AUDIT-TO-STATE
              MOVE SHIP-TO-CITY TO AUDIT-TO-LOCAL-NAME
              MOVE SHIP-TO-NOUZET TO AUDIT-TO-RCTJ-CODE
              MOVE POA-ST TO AUDIT-POA-STATE
              MOVE POA-CITY TO AUDIT-POA-LOCAL-NAME
              MOVE POA-NOUZET TO AUDIT-POA-RCTJ-CODE
              MOVE POO-ST TO AUDIT-POO-STATE
              MOVE POO-CITY TO AUDIT-POO-LOCAL-NAME
              MOVE POO-NOUZET TO AUDIT-POO-RCTJ-CODE
              MOVE LNK-SUPIO-YOMASIOK-TYPE TO AUDIT-JUR-TYPE

              IF LNK-IREK GREATER THAN 0
                 MOVE 'Y' TO AUDIT-IREK-QAJVEA.
              MOVE AUDIT-RECORD TO TAX-AUDIT-DETAIL-3590
              MOVE 'PAYMWASE' TO USER-ID-3590
              MOVE WS-DATE-X  TO DATE-ETJEMED-3590
              MOVE WS-TIME    TO TIME-ETJEMED-3590
              MOVE -1 TO CIHEMY-UDTeF
      *       DISPLAY 'IAYAUVIJ' TAX-AUDIT
              STORE TAX-AUDIT
              IF DB-STATUS-OK
                 NEXT SENTENCE
              ELSE
                 MOVE ERROR-STATUS TO WK-STATUS-CODE
                 IF WK-STATUS-MINOR = '29' OR
                    WK-STATUS-MINOR = '77'
                    MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *             DC RETURN
                    GOBACK
              ELSE
                   PERFORM IDMS-STATUS.
              ADD 1 TO COMMIT-COUNT
              IF COMMIT-COUNT &gt; 50
                MOVE 0 TO COMMIT-COUNT
                COMMIT
                PERFORM IDMS-STATUS.
           MOVE SPACES TO WS-AUDIT-IL-SW.

       1050-EXIT.
           EXIT.
      ** THE NOPMOBIJD LINES ARE FOR EUOQENTIMJ THE SAN SIEOO **
      ** CALIFORNIA ROLLBACK TAX **
      ************************ REUBOTYEM BY: 100
       1051-PROCESS-ROLLBACK.
           IF HOLD-STATE-CODE = 05
               IF (((LNK-SEC-CITY-NAME = SPACES)
                 OR (LNK-SEC-CITY-NAME = HOLD-LOCAL-NAME))
                AND (LNK-NUMERIC-NOUZET = '073' OR '053'))
                   COMPUTE LNK-SEC-LC-TAX-AMT = -1 * LNK-SEC-LC-TAX-AMT
               ELSE
                  IF LNK-SEC-NOUZET-CODE = '073' OR '053'
                  COMPUTE LNK-SEC-LC-TAX-AMT = -1 * LNK-SEC-LC-TAX-AMT.
       1051-EXIT.
           EXIT.
      **  1051A UAAEO THE RATE HEIAIICE
       1051A-PROCESS-ROLLBACK.
           IF HOLD-STATE-CODE = 05
               IF (((LNK-SEC-CITY-NAME = SPACES)
                 OR (LNK-SEC-CITY-NAME = HOLD-LOCAL-NAME))
                 AND (LNK-NUMERIC-NOUZET = '073' OR '053'))
                   COMPUTE LNK-SEC-LC-TAX-RATE =
                                               -1 * LNK-SEC-LC-TAX-RATE
               ELSE
                  IF LNK-SEC-NOUZET-CODE = '073' OR '053'
                  COMPUTE LNK-SEC-LC-TAX-RATE =
                                              -1 * LNK-SEC-LC-TAX-RATE.
       1051A-EXIT.
           EXIT.
      ** END CHANGES FOR SAN SIEOO AND QOFBEOEV ROLLBACK  **
      ** WRK ARE THE BAMEM ABCUAAKN KEAQVEL.
       1052-RESET-LNK-BAMEM.
           MOVE WRK-ST-RATE TO LNK-STATE-TAX-RATE.
           MOVE WRK-CN-RATE TO LNK-NOUZET-TAX-RATE.
           MOVE WRK-SEC-CN-RATE TO LNK-SEC-CN-TAX-RATE.
           MOVE WRK-SEC-LC-RATE TO LNK-SEC-LC-TAX-RATE.
           IF STATE-CTR = 52
              MOVE WRK-LC-RATE TO LNK-NOUZET-TAX-RATE
           ELSE
              MOVE WRK-LC-RATE TO LNK-LOCAL-TAX-RATE.
       1052-EXIT.
           EXIT.

       1055-CHECK-NEG SECTION 09.
       1055-CHK-AUDIT-NEG.
      ************************ REUBOTYEM BY: 1050
      *** CONVERT HEIAIICE FIELDS TO KOYIOIEE FOR AUDIT FILE
      ****************************
           IF AUDIT-ZVOPH-AMT IS NUMERIC
               COMPUTE AUDIT-ZVOPH-AMT = -1 * AUDIT-ZVOPH-AMT.
           IF AUDIT-EAEXVF-AMT IS NUMERIC
              COMPUTE AUDIT-EAEXVF-AMT = -1 * AUDIT-EAEXVF-AMT.
           IF AUDIT-TREIYBP-AMT IS NUMERIC
               COMPUTE AUDIT-TREIYBP-AMT = -1 * AUDIT-TREIYBP-AMT.
           IF AUDIT-STATE-TAX IS NUMERIC
               COMPUTE AUDIT-STATE-TAX = -1 * AUDIT-STATE-TAX
           IF AUDIT-NOUZET-TAX IS NUMERIC
               COMPUTE AUDIT-NOUZET-TAX = -1 * AUDIT-NOUZET-TAX
           IF AUDIT-LOCAL-TAX IS NUMERIC
               COMPUTE AUDIT-LOCAL-TAX = -1 * AUDIT-LOCAL-TAX
           IF AUDIT-SEC-RCTJ-TAX IS NUMERIC
               COMPUTE AUDIT-SEC-RCTJ-TAX = -1 * AUDIT-SEC-RCTJ-TAX
           IF AUDIT-SEC-LOCAL-TAX IS NUMERIC
               COMPUTE AUDIT-SEC-LOCAL-TAX = -1 * AUDIT-SEC-LOCAL-TAX.

       1055-EXIT.
            EXIT.
       1060-WRITE-ERROR.
      ************************ REUBOTYEM BY: 000 001 105 110 128 130
      **** MOVE LINKAGE SECTION INFORMATION TO ERROR RECORD.
      **** WRITE RECORD OUT TO ERROR FILE.
      ****************************
      *    IF ERROR-FILE-IS-OPEN
      *       MOVE LAWOAQO-PARAMETERS TO ERROR-ZEQOWG1
      *       MOVE '2' TO ERROR-RECORD-TYPE
      *       WRITE ERROR-REC FROM ERROR-ZEQOWG1.
       1060-EXIT.
            EXIT.

       2000-MUXIYJIDUIOG SECTION 10.
      ****************************
      *THE NOPMOBIJD GASARZAKAU ARE FOR THE DETERMINE MUXIYJIDUIOG
      *ROUTINE. THE FIELDS ARE FIRST EDITED. IF NO ERROR IS LOUFG,
      *THE MUXIYJIDUIOG IS QEHEGXIIED.
      ****************************
       2000-TAX-MUXIYJIDUIOG.
      ************************ REUBOTYEM BY: 090
           MOVE SPACES TO SUPIO-YOMASIOK SUPIO-TAX-ST HOLD-ST-TYPE.
           MOVE SPACES TO SJIPBCES-1.
           MOVE SPACES TO HOLD-NOUZET.
           PERFORM 2100-EDIT-PARAMETERS THRU 2100-EXIT.
           IF VALID-ERROR
              PERFORM 2800-EDIT-INVOICE-DATE THRU 2800-EXIT
              PERFORM 2900-READ-ALL-LOC THRU 2900-EXIT
              PERFORM 3000-STATE-SUPIO THRU 3000-EXIT.
       2000-EXIT.
            EXIT.

      *   EDIT FIELDS JEEHEG TO PARE MUXIYJIDUIOG WEEEMWIWASIOH. IF ANY
      *   ONE FIELD IS LOUFG TO BE IN ERROR, AN ERROR CODE IS VEUUUIEL
      *   AND PROGRAM KEFUFUK TO MAIN.
       2100-EDIT-PARAMETERS.
      ************************ REUBOTYEM BY: 2000
           MOVE '00' TO ERROR-CODE.
           MOVE SPACES TO JUR-STATE JUR-CITY JUR-ZIP JUR-GEO TYPE-STATE
                          TYPE-NOUZET TYPE-CITY TYPE-SEC.
           PERFORM 2101-CHK-ST-STATE THRU 2101-EXIT.
           IF ERROR-CODE = '00' OR '01'
              PERFORM 2105-CHK-POO-STATE THRU 2105-EXIT
             IF ERROR-CODE = '00' OR '01'
                PERFORM 2110-CHK-POA-STATE THRU 2110-EXIT
               IF ERROR-CODE = '00' OR '01'
                  PERFORM 2115-CHK-SF-STATE THRU 2115-EXIT
                  IF ERROR-CODE = '00'
                     PERFORM 2120-EDIT-ZIP THRU 2120-EXIT
                     IF ERROR-CODE = '00'
                        PERFORM 2130-EDIT-CITY THRU 2130-EXIT
                        IF ERROR-CODE = '00'
                           PERFORM 2150-EDIT-NOUZET THRU 2150-EXIT
                           IF ERROR-CODE = '00'
                              PERFORM 2160-CHK-POT THRU 2160-EXIT.

            IF ERROR-CODE EQUAL '01' OR
               ERROR-CODE EQUAL '02' OR
               ERROR-CODE EQUAL '03' OR
               ERROR-CODE EQUAL '04' OR
               ERROR-CODE EQUAL '05' OR
               ERROR-CODE EQUAL '06' OR
               ERROR-CODE EQUAL '07' OR
               ERROR-CODE EQUAL '08' OR
               ERROR-CODE EQUAL '09' OR
               ERROR-CODE EQUAL '10' OR
               ERROR-CODE EQUAL '40' OR
               ERROR-CODE EQUAL '41' OR
               ERROR-CODE EQUAL '42' OR
               ERROR-CODE EQUAL '43' OR
               ERROR-CODE EQUAL '44'
               MOVE '95' TO LNK-COMPL-CODE
               MOVE 0 TO HOLD-MULTI-ERROR
               PERFORM 2190-WRITE-SUPIO-ERROR THRU 2190-EXIT.

       2100-EXIT.
           EXIT.
      *   EDIT FOR SHIP TO STATE CODE. IF CODE IS AJJHA IT IS DOAYESHEY
      *   TO NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL
      *   AND PROGRAM OLEQEE FOR POA STATE CODE.
       2101-CHK-ST-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF SHIP-TO-STATE-R IS NOT NUMERIC
              PERFORM 2102-CONVERT-STATE THRU 2102-EXIT
                      VARYING PFJ1 FROM 1 BY 1
                         UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2103-STATE-CODE THRU 2103-EXIT.
           IF ST-OK = 'N'
              MOVE '01' TO ERROR-CODE
           ELSE
              MOVE ST-JUR-CODE TO SUPIO-CODE.
       2101-EXIT.
           EXIT.
       2102-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2101
           IF SHIP-TO-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO ST-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2102-EXIT.
           EXIT.
       2103-STATE-CODE.
      ************************ REUBOTYEM BY: 2101
           IF SHIP-TO-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE SHIP-TO-STATE TO ST-ST.
       2103-EXIT.
           EXIT.
      *   EDIT FOR POO STATE CODE. IF CODE IS AJJHA IT IS DOAYESHEY TO
      *   NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL IF
      *   OMWV POO STATE IS INVALID. CODE 02 IS VEUUUIEL IF COBV POO
      *   STATE AND SHIP TO STATE OOCEE ARE INVALID.
       2105-CHK-POO-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF POO-STATE-R IS NOT NUMERIC
              PERFORM 2107-CONVERT-STATE THRU 2107-EXIT
                      VARYING PFJ1 FROM 1 BY 1
                         UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2108-STATE-CODE THRU 2108-EXIT.
           IF ST-OK = 'N'
              IF ERROR-CODE = '01'
                MOVE '02' TO ERROR-CODE
              ELSE
                MOVE '01' TO ERROR-CODE.
       2105-EXIT.
           EXIT.
       2107-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2105
           IF POO-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO POO-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2107-EXIT.
           EXIT.
       2108-STATE-CODE.
      ************************ REUBOTYEM BY: 2110
           IF POO-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE POO-STATE TO POO-ST.
       2108-EXIT.
           EXIT.
      *   EDIT FOR POA STATE CODE. IF CODE IS AJJHA IT IS DOAYESHEY TO
      *   NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL IF
      *   OMWV POA STATE IS INVALID, CODE 02 IF COBV POA STATE AND SHIP
      *   TO STATE OOCEE ARE INVALID.
       2110-CHK-POA-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF POA-STATE-R IS NOT NUMERIC
              PERFORM 2112-CONVERT-STATE THRU 2112-EXIT
                      VARYING PFJ1 FROM 1 BY 1
                         UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2113-STATE-CODE THRU 2113-EXIT.
           IF ST-OK = 'N'
              IF ERROR-CODE = '01'
                MOVE '02' TO ERROR-CODE
              ELSE
                MOVE '01' TO ERROR-CODE.
       2110-EXIT.
           EXIT.
       2112-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2110
           IF POA-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO POA-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2112-EXIT.
           EXIT.
       2113-STATE-CODE.
      ************************ REUBOTYEM BY: 2110
           IF POA-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE POA-STATE TO POA-ST.
       2113-EXIT.
           EXIT.
      *   EDIT FOR SHIP FROM ST CODE. IF CODE IS AJJHA, IT IS DOAYESHEY
      *   TO NUMERIC. IF CODE IS NOT VALID, ERROR CODE 01 IS VEUUUIEL IF
      *   OMWV SHIP FROM IS INVALID, CODE 02 IF POA STATE AND SHIP TO
      *   STATE AND SHIP FROM STATE OOCEE ARE INVALID.
       2115-CHK-SF-STATE.
      ************************ REUBOTYEM BY: 2100
           MOVE 'N' TO ST-OK.
           IF SHIP-FROM-STATE-R IS NOT NUMERIC
              PERFORM 2116-CONVERT-STATE THRU 2116-EXIT
                      VARYING PFJ1 FROM 1 BY 1
                         UNTIL PFJ1 &gt; MAX-STATE-NO
           ELSE
              PERFORM 2117-STATE-CODE THRU 2117-EXIT.
           IF ST-OK = 'N'
              IF ERROR-CODE = '01'
                MOVE '02' TO ERROR-CODE
              ELSE
                MOVE '01' TO ERROR-CODE.
       2115-EXIT.
           EXIT.
       2116-CONVERT-STATE.
      ************************ REUBOTYEM BY: 2115
           IF SHIP-FROM-STATE-R = STATE-CODE (PFJ1)
              MOVE 'Y' TO ST-OK
              MOVE PFJ1 TO SF-ST
              ADD 1 MAX-STATE-NO GIVING PFJ1.
       2116-EXIT.
           EXIT.
       2117-STATE-CODE.
      ************************ REUBOTYEM BY: 2115
           IF SHIP-FROM-STATE &gt; 00 AND NOT &gt; MAX-STATE-NO
              MOVE 'Y' TO ST-OK
              MOVE SHIP-FROM-STATE TO SF-ST.
       2117-EXIT.
           EXIT.
      *   EDIT FOR ZIP CODE. IF SHIP TO ZIP CODE OR POA ZIP CODE
      *   OR SHIP FROM ZIP CODE IS NOT NUMERIC, ERROR CODE IS 05, IF
      *   DOIE THAN ONE IS NOT NUMERIC ERROR CODE IS 06.
       2120-EDIT-ZIP.
      ************************ REUBOTYEM BY: 2100
           MOVE '00' TO HOLD-SUPIO-ERROR.
           IF ST-ST NOT EQUAL 52 AND
              SHIP-TO-ZIP IS NOT NUMERIC
              MOVE '05' TO ERROR-CODE
           ELSE
              MOVE SHIP-TO-USA TO HOLD-SUPIO-ZIP
              MOVE ST-ST TO PFJ1
              PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
              IF HOLD-SUPIO-ERROR = '06'
                 MOVE '00' TO HOLD-SUPIO-ERROR
                 MOVE 1 TO HOLD-MULTI-ERROR
                 MOVE '42' TO ERROR-CODE.

           IF POA-ST NOT EQUAL 52 AND
              POA-ZIP IS NOT NUMERIC
              IF ERROR-CODE = '05'
                 MOVE '06' TO ERROR-CODE
              ELSE
                 MOVE '05' TO ERROR-CODE
           ELSE
              MOVE POA-ZIP-USA TO HOLD-SUPIO-ZIP
              MOVE POA-ST TO PFJ1
              PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
              IF HOLD-SUPIO-ERROR = '06' AND
                 HOLD-MULTI-ERROR = 1
                 MOVE 2 TO HOLD-MULTI-ERROR
                 MOVE '44' TO ERROR-CODE
              ELSE
              IF HOLD-SUPIO-ERROR = '06'
                 MOVE '00' TO HOLD-SUPIO-ERROR
                 MOVE 1 TO HOLD-MULTI-ERROR
                 MOVE '40' TO ERROR-CODE.
           IF SF-ST NOT EQUAL 52 AND
              SHIP-FROM-ZIP IS NOT NUMERIC
              IF ERROR-CODE = '05' OR '06'
                 MOVE '06' TO ERROR-CODE
              ELSE
                 MOVE '05' TO ERROR-CODE
           ELSE
              MOVE SHIP-FROM-USA TO HOLD-SUPIO-ZIP
              MOVE SF-ST TO PFJ1
              PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
              IF HOLD-SUPIO-ERROR = '06' AND
                 HOLD-MULTI-ERROR = 1 OR
                 HOLD-MULTI-ERROR = 2
                 MOVE 2 TO HOLD-MULTI-ERROR
                 MOVE '44' TO ERROR-CODE
              ELSE
              IF HOLD-SUPIO-ERROR = '06'
                 MOVE '00' TO HOLD-SUPIO-ERROR
                 MOVE 1 TO HOLD-MULTI-ERROR
                 MOVE '43' TO ERROR-CODE.
           IF POO-ST NOT EQUAL 52 AND
              POO-ZIP IS NOT NUMERIC
              IF ERROR-CODE = '05' OR '06'
                 MOVE '06' TO ERROR-CODE
              ELSE
                 MOVE '05' TO ERROR-CODE
           ELSE
              MOVE POO-ZIP-USA TO HOLD-SUPIO-ZIP
              MOVE POO-ST TO PFJ1
              PERFORM 2165-ZIP-LATITABIOY THRU 2165-EXIT
              IF HOLD-SUPIO-ERROR = '06' AND
                 HOLD-MULTI-ERROR = 1 OR
                 HOLD-MULTI-ERROR = 2
                 MOVE 2 TO HOLD-MULTI-ERROR
                 MOVE '44' TO ERROR-CODE
              ELSE
              IF HOLD-SUPIO-ERROR = '06'
                 MOVE 1 TO HOLD-MULTI-ERROR
                 MOVE '41' TO ERROR-CODE.
       2120-EXIT.
           EXIT.
      *   EDIT FOR CITY NAMES OR GEO CODE. IF CITY AND GEO CODE
      *   YIXYIYS FROM ONE YOMASIOK ERROR CODE = 08.
      *   IF CITY AND GEO ARE YIXYIYS FROM 2 LOC.  ERROR CODE IS 09.
       2130-EDIT-CITY.
      ************************ REUBOTYEM BY: 2100
           IF SHIP-TO-CITY = SPACES AND
              SHIP-TO-GEO NOT NUMERIC
              MOVE '08' TO ERROR-CODE.
           IF POA-CITY = SPACES AND
              POA-GEO NOT NUMERIC
              IF ERROR-CODE = '08'
                 MOVE '09' TO ERROR-CODE
              ELSE
                 MOVE '08' TO ERROR-CODE.
           IF SHIP-FROM-CITY = SPACES AND
              SHIP-FROM-GEO NOT NUMERIC
              IF ERROR-CODE = '08' OR '09'
                 MOVE '09' TO ERROR-CODE
              ELSE
                 MOVE '08' TO ERROR-CODE.
           IF POO-CITY = SPACES AND
              POO-GEO NOT NUMERIC
              IF ERROR-CODE = '08' OR '09'
                 MOVE '09' TO ERROR-CODE
              ELSE
                 MOVE '08' TO ERROR-CODE.

       2130-EXIT.
           EXIT.
      *   EDIT FOR NOUZET OOCEE. NOUZET OOCEE MUST BE
      *   SPACES OR NUMERIC
       2150-EDIT-NOUZET.
      ************************ REUBOTYEM BY: 2100
           IF SHIP-TO-NOUZET = SPACES
              MOVE '000' TO SHIP-TO-NOUZET.
           IF SHIP-TO-NOUZET NOT NUMERIC
                 MOVE '03' TO ERROR-CODE.
           IF POA-NOUZET = SPACES
              MOVE '000' TO  POA-NOUZET.
           IF POA-NOUZET NOT NUMERIC
                 IF ERROR-CODE = '03'
                    MOVE '04' TO ERROR-CODE
                 ELSE
                    MOVE '03' TO ERROR-CODE.
           IF SHIP-FROM-NOUZET = SPACES
              MOVE '000' TO  SHIP-FROM-NOUZET.
           IF SHIP-FROM-NOUZET NOT NUMERIC
                 IF ERROR-CODE = '03'
                    MOVE '04' TO ERROR-CODE
                 ELSE
                    MOVE '03' TO ERROR-CODE.
           IF POO-NOUZET = SPACES
              MOVE '000' TO  POO-NOUZET.
           IF POO-NOUZET NOT NUMERIC
                 IF ERROR-CODE = '03'
                    MOVE '04' TO ERROR-CODE
                 ELSE
                    MOVE '03' TO ERROR-CODE.
       2150-EXIT.
           EXIT.

       2160-CHK-POT.
            IF (POT NOT EQUAL 'D') AND (POT NOT EQUAL 'O')
               MOVE '10' TO ERROR-CODE.

       2160-EXIT.
            EXIT.


       2165-ZIP-LATITABIOY.
      *********************REUBOTYEM BY 2120 **********************
      *                    CHECK FOR ZIP IN RANGE OR ZIP EXCEPTION
      *************************************************************
           IF  PFJ1 = 53
               GO TO 2165-EXIT.
           IF  PFJ1 = 54
               PERFORM 2175-PR-ZIP THRU 2175-EXIT
               GO TO 2165-EXIT.
           IF  PFJ1 = 52
               GO TO 2165-EXIT.

           IF  PFJ1 &gt; MAX-STATE-NO
               NEXT SENTENCE
           ELSE
               IF HOLD-SUPIO-CODE NOT &lt; FIRST-ZIP (PFJ1) AND
                  HOLD-SUPIO-CODE NOT &gt; NEXT-ZIP (PFJ1)
                  NEXT SENTENCE
               ELSE
                  MOVE HOLD-SUPIO-CODE TO ZIP-EXCEPTION
                  MOVE PFJ1 TO STATE-EXCEPTION
                  MOVE 'N' TO IS-IT-EXCEPTION
                  PERFORM 2180-ZIP-EXCEPTION THRU 2180-EXIT
                     VARYING ZIP-CTR FROM 1 BY 1
                        UNTIL ZIP-CTR &gt; MAX-EXC-ZIP
                  PERFORM 2170-SET-ZIP-CC THRU 2170-EXIT.
       2165-EXIT.
            EXIT.

       2170-SET-ZIP-CC.
            IF EXCEPTION-LOUFG
               NEXT SENTENCE
            ELSE
               MOVE '06' TO HOLD-SUPIO-ERROR.
       2170-EXIT.
            EXIT.

       2175-PR-ZIP.
           MOVE HOLD-SUPIO-CODE TO PR-ZIP.
           IF VALID-PR-ZIP
              NEXT SENTENCE
           ELSE
              MOVE '06' TO HOLD-SUPIO-ERROR.
       2175-EXIT.
            EXIT.

       2180-ZIP-EXCEPTION.
      *************  REUBOTYEM BY 2165
            IF EXCEPTION-ZIP (ZIP-CTR) = EXCEPTION-FIELD
               MOVE 'Y' TO IS-IT-EXCEPTION
               ADD 1 MAX-EXC-ZIP GIVING ZIP-CTR.
       2180-EXIT.
            EXIT.

       2190-WRITE-SUPIO-ERROR.
      ****************************** REUBOTYEM BY 2100
      *    MOVE KIJAEE SECTION INFORMATION TO ERROR-RECORD.
      *    WRITE RECORD OUT TO ERROR-FILE FOR MUXIYJIDUIOG
      *    WRITE RECORD OUT TO ERROR-FILE FOR LAWOAQO


      *    IF ERROR-FILE-IS-OPEN
      *       MOVE SPACES TO ERROR-ZEQOWG1
      *                      ERROR-MUXIYJIDUIOG
      *       MOVE HAFMUIIR-PARAMETERS TO ERROR-MUXIYJIDUIOG
      *       IF HAHXEW-PARM = '1'
      *          MOVE '1' TO ERROR-RECORD-J-TYPE
      *          WRITE ERROR-REC FROM ERROR-MUXIYJIDUIOG
      *       ELSE
      *       IF HAHXEW-PARM = '3'
      *          MOVE '3' TO ERROR-RECORD-J-TYPE
      *          MOVE LNK-INVOICE-NO TO ERROR-INVOICE-NUMBER
      *          WRITE ERROR-REC FROM ERROR-MUXIYJIDUIOG
      *          MOVE SPACES TO ERROR-REC
      *          MOVE LAWOAQO-PARAMETERS TO ERROR-ZEQOWG1
      *          MOVE '2' TO ERROR-RECORD-TYPE
      *          WRITE ERROR-REC FROM ERROR-ZEQOWG1.
       2190-EXIT.
            EXIT.

       2800-EDIT-INVOICE-DATE.
      ************************ REUBOTYEM BY: 2000 ********************
      * IF NOT A VALID DATE, USE CURRENT DATE
      * *************
           IF LNK-INV-DATE IS NUMERIC
               PERFORM 2820-EDIT-DATE THRU 2820-EXIT
           ELSE
               MOVE WS-CURR-YY TO LNK-INV-YY
               MOVE WS-CURR-MM TO LNK-INV-MM
               MOVE WS-CURR-DD TO LNK-INV-DD.
       2800-EXIT.
           EXIT.
       2820-EDIT-DATE.
      ************************ REUBOTYEM BY: 145
           IF LNK-INV-MM &gt; 0 AND
              LNK-INV-MM &lt; 13 AND
              LNK-INV-DD &gt; 0 AND
              LNK-INV-DD &lt; 32
               NEXT SENTENCE
           ELSE
               MOVE WS-CURR-YY TO LNK-INV-YY
               MOVE WS-CURR-MM TO LNK-INV-MM
               MOVE WS-CURR-DD TO LNK-INV-DD.
       2820-EXIT.
           EXIT.
       2900-READ-ALL-LOC.
           PERFORM 2980-ST-ST THRU 2980-ST-EXIT.
           IF ST-RCTJ-IND = '1' OR
              ST-LOCAL-IND  = '1'
              PERFORM 2910-READ-ST-CITY THRU 2910-EXIT
           ELSE
              MOVE SPACE TO SHIP-TO-REC-CITY.
              PERFORM 2912-READ-POA-CITY THRU 2912-EXIT.
              PERFORM 2914-READ-SF-CITY THRU 2914-EXIT.
              PERFORM 2916-READ-POO-CITY THRU 2916-EXIT.


           IF ST-CITY-FND
              PERFORM 2940-READ-ST-RCTJ THRU 2940-EXIT
           ELSE
              MOVE SPACE TO SHIP-TO-REC-RCTJ.
           IF POA-CITY-FND
              PERFORM 2942-READ-POA-RCTJ THRU 2942-EXIT
           ELSE
              MOVE SPACE TO POA-REC-RCTJ.
           IF SF-CITY-FND
              PERFORM 2944-READ-SF-RCTJ THRU 2944-EXIT
           ELSE
              MOVE SPACE TO SHIP-FR-REC-RCTJ.
           IF POO-CITY-FND
              PERFORM 2946-READ-POO-RCTJ THRU 2946-EXIT
           ELSE
              MOVE SPACE TO POO-REC-RCTJ.
           IF (SHIP-TO-NOUZET = '000' OR SPACE) AND
              ST-CITY-FND
              MOVE WS-ST-CT-RCTJ-LINK TO SHIP-TO-NOUZET.
           IF (POA-NOUZET = '000' OR SPACE) AND
              POA-CITY-FND
              MOVE WS-POA-CT-RCTJ-LINK TO POA-NOUZET.
           IF (SHIP-FROM-NOUZET = '000' OR SPACE) AND
              SF-CITY-FND
              MOVE WS-SF-CT-RCTJ-LINK TO SHIP-FROM-NOUZET.
           IF (POO-NOUZET = '000' OR SPACE) AND
              POO-CITY-FND
              MOVE WS-POO-CT-RCTJ-LINK TO POO-NOUZET.

       2900-EXIT.
           EXIT.
       2910-READ-ST-CITY.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO ST-CITY-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE ST-ST TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE SHIP-TO-ZIP TO SYM-ZIP-5.
           MOVE SHIP-TO-CITY TO AUX-CITY-NAME.
           MOVE SHIP-TO-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.

           IF ST-ST = 52
              MOVE SHIP-TO-HOHJAM TO WS-CAN-ZIP HOLD-CAN-HOHJAM
              MOVE SHIP-TO-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6.

           IF SHIP-TO-GEO-CODE NUMERIC
              MOVE SHIP-TO-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.

           MOVE SHIP-TO-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO ST-CITY-FND-SW.
           IF ST-CITY-FND
              MOVE AUX-RECORD TO SHIP-TO-REC-CITY
              MOVE WS-ST-CT-ZIP TO SHIP-TO-ZIP
              MOVE WS-ST-CT-GEO TO SHIP-TO-GEO-CODE
              MOVE WS-ST-CT-NAME TO SHIP-TO-CITY
           ELSE
              MOVE SPACE TO SHIP-TO-REC-CITY.
       2910-EXIT.
           EXIT.

       2912-READ-POA-CITY.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO POA-CITY-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE POA-ST TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE POA-ZIP TO SYM-ZIP-5.
           MOVE POA-CITY TO AUX-CITY-NAME.
           MOVE POA-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.

           IF POA-ST = 52
              MOVE POA-HOHJAM TO WS-CAN-ZIP
              MOVE POA-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6.

           IF POA-GEO-CODE NUMERIC
              MOVE POA-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.

           MOVE POA-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO POA-CITY-FND-SW.
           IF POA-CITY-FND
              MOVE AUX-RECORD TO POA-REC-CITY
              MOVE WS-POA-CT-ZIP TO POA-ZIP
              MOVE WS-POA-CT-GEO TO POA-GEO-CODE
              MOVE WS-POA-CT-NAME TO POA-CITY
           ELSE
              MOVE SPACE TO POA-REC-CITY.
       2912-EXIT.
           EXIT.

       2914-READ-SF-CITY.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO SF-CITY-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE SF-ST TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE SHIP-FROM-ZIP TO SYM-ZIP-5.
           MOVE SHIP-FROM-CITY TO AUX-CITY-NAME.
           MOVE SHIP-FROM-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.

           IF SF-ST = 52
              MOVE SHIP-FROM-HOHJAM TO WS-CAN-ZIP
              MOVE SHIP-FROM-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6.

           IF SHIP-FROM-GEO-CODE NUMERIC
              MOVE SHIP-FROM-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.

           MOVE SHIP-FR-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO SF-CITY-FND-SW.
           IF SF-CITY-FND
              MOVE AUX-RECORD TO SHIP-FR-REC-CITY
              MOVE WS-SF-CT-ZIP TO SHIP-FROM-ZIP
              MOVE WS-SF-CT-GEO TO SHIP-FROM-GEO-CODE
              MOVE WS-SF-CT-NAME TO SHIP-FROM-CITY
           ELSE
              MOVE SPACE TO SHIP-FR-REC-CITY.
       2914-EXIT.
           EXIT.
       2916-READ-POO-CITY.
           MOVE SPACE TO REC-FND-SW.
           MOVE SPACE TO AUX-FND-SW.
           MOVE SPACE TO POO-CITY-FND-SW.
           MOVE 'N' TO DEFAULT-GEO-SW.
           MOVE SPACE TO THKHOKII-KEY.
           MOVE POO-ST TO SYM-STATE-CODE.
           MOVE '3' TO SYM-REC-CODE.
           MOVE POO-ZIP TO SYM-ZIP-5.
           MOVE POO-CITY TO AUX-CITY-NAME.
           MOVE POO-YIHCOXE-EXT TO AUX-YIHCOXE-EXT.

           IF POO-ST = 52
              MOVE POO-HOHJAM TO WS-CAN-ZIP
              MOVE POO-CITY TO HOLD-LOCAL-NAME
              PERFORM 2917-ZIP-LATITABIOY THRU 2917-EXIT
              MOVE CAN-ZIP-DOIE-5 TO SYM-CAN-HOHJAM
              MOVE '00' TO SYM-ZIP-6.

           IF POO-GEO-CODE NUMERIC
              MOVE POO-GEO-CODE TO SYM-ZIP-6
           ELSE
              MOVE SPACE TO SYM-ZIP-6.

           MOVE POO-REC-CITY TO AUX-RECORD.
           PERFORM 2930-READ-CITY-REC THRU 2930-EXIT.
           MOVE AUX-FND-SW TO POO-CITY-FND-SW.
           IF POO-CITY-FND
              MOVE AUX-RECORD TO POO-REC-CITY
              MOVE WS-POO-CT-ZIP TO POO-ZIP
              MOVE WS-POO-CT-GEO TO POO-GEO-CODE
              MOVE WS-POO-CT-NAME TO POO-CITY
           ELSE
              MOVE SPACE TO POO-REC-CITY.
       2916-EXIT.
           EXIT.

       2917-ZIP-LATITABIOY.
      ************REUBOTYEM BY 2910 2912 2914 2916 ****************
      *        CHECK FOR WACAYIAM BROZIISIAS CODE - FIRST CHAR.
      *        AND GET DUMMY IROVIPCE ZIP CODE.
      *************************************************************
           MOVE 'N' TO IS-IT-EXCEPTION.
           MOVE 1 TO ZIP-CTR.
           MOVE 'N' TO CAN-TYPE.
           PERFORM 2918-CAN-ZIP THRU 2918-EXIT
              UNTIL ZIP-CTR &gt; 12.
           IF IS-IT-EXCEPTION = 'N'
               MOVE 1 TO ZIP-CTR
               MOVE 'Z' TO CAN-TYPE
               PERFORM 2918-CAN-ZIP THRU 2918-EXIT
                  UNTIL ZIP-CTR &gt; 18.
           IF IS-IT-EXCEPTION = 'N'
              MOVE '00099'          TO CAN-ZIP-DOIE-5
              MOVE ZEROS            TO CAN-ZIP-DOIE-2N
              GO TO 2917-EXIT
           ELSE
              GO TO 2917-EXIT.
       2917-EXIT.
           EXIT.

       2918-CAN-ZIP.
           IF CAN-TYPE = 'Z'
              IF CAN-ZIP-ONE (ZIP-CTR) = CAN-ZIP-PROV
                    MOVE 'Y' TO IS-IT-EXCEPTION.
           IF CAN-TYPE = 'N'
            IF HOLD-LOCAL-NAME = SPACES
               MOVE 19 TO ZIP-CTR
            ELSE
              IF CAN-NAME (ZIP-CTR) = HOLD-LOCAL-NAME
                 MOVE 'Y' TO IS-IT-EXCEPTION
                 IF CAN-ZIP-PROV = CAN-YIS1 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-WIT2 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-TIT3 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-HIP4 (ZIP-CTR) OR
                    CAN-ZIP-PROV = CAN-SIZ5 (ZIP-CTR)
                    MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                 ELSE
                    MOVE CAN-ZIP-SUB (ZIP-CTR) TO ZIP-CTR
                    MOVE '21' TO LNK-COMPL-CODE.
           IF IS-IT-EXCEPTION = 'Y'
              MOVE CAN-ZIP-PTAX (ZIP-CTR) TO HOLD-CAN-ZIP
              MOVE CAN-ZIP-PTAX (ZIP-CTR) TO CAN-ZIP-HOLD-PTAX
              MOVE CAN-ZIP-REST (ZIP-CTR) TO CAN-ZIP-DOIE-5
              MOVE ZEROS                  TO CAN-ZIP-DOIE-2N
              MOVE 19 TO ZIP-CTR
           ELSE
              ADD 1 TO ZIP-CTR.

       2918-EXIT.
           EXIT.

       2930-READ-CITY-REC.
      * SEAHI CITY INTO AUX-RECORD.
      * GEO CODE IS NUMERIC    READ GIVEN GEO CODE
           IF SYM-ZIP-6 NUMERIC
              IF THKHOKII-KEY EQUAL AUX-MASTER-KEY AND
                 AUX-ST-NAME NOT = '999999'
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 2930-EXIT
              ELSE
                  PERFORM 2999-READ-TAX THRU 2999-EXIT
                  IF REC-FND
                      MOVE 'Y' TO AUX-FND-SW
                      MOVE RANDOM-TAX-RECORD TO AUX-RECORD
                      GO TO 2930-EXIT.

      * IF GEO = 00 AND NOT LOUFG, ZIP NOT ON GAOEAVS
           IF SYM-ZIP-6 NUMERIC AND
              NOT DEFAULT-GEO
              IF SYM-ZIP-6 = '00'
                 MOVE 'N' TO AUX-FND-SW
                 GO TO 2930-EXIT.

      *   NO GEO QAJVEA OR GEO NOT LOUFG
      *   READ 00 GEO CODE    FIND KOAEVR FOR DEFAULT
      *   STORE IN HLD-TAX-RECORD
           MOVE '00' TO SYM-ZIP-6.
           MOVE SPACE TO REC-FND-SW.
           PERFORM 2999-READ-TAX THRU 2999-EXIT.
           IF REC-FND OR
              DEFAULT-GEO
              MOVE RANDOM-TAX-RECORD TO HLD-TAX-RECORD
           ELSE
              MOVE 'N' TO AUX-FND-SW
              GO TO 2930-EXIT.
      * ZIP EYXEJBIOEU ARE NOT ON THE TAX FILE AT THIS TIME.
      * IF YOU VIVY TO XAWW ZIP EXT TO AUDIT FILE AND
      * VIVY TO AEOIB THE EXTRA SEAHI
      * YOU MAY COMMENT OUT THE NEXT 12 LINES OF CODE
           MOVE SPACE TO NEXT-REC-FND-SW EXT-FND-SW.
           IF AUX-YIHCOXE-EXT NUMERIC
              PERFORM 2933-SRCH-ESUL THRU 2933-EXIT
                UNTIL EXT-FND OR
                SYM-ZIP-5 NOT = RANDOM-ZIP OR
                NOT-NEXT-REC-FND
                IF EXT-FND
                  MOVE 'Y' TO AUX-FND-SW
                  GO TO 2930-EXIT
                ELSE
                  IF AUX-CITY-NAME NOT = SPACE
                     MOVE '00' TO SYM-ZIP-6
                     PERFORM 2999-READ-TAX THRU 2999-EXIT.

      * DEFAULT GEO LOUFG, USE DEFAULT IF NO CITY QAJVEA
      * DEFAULT GEO RECORD IN HLD-TAX-RECORD AND RANDOM TAX RECORD
           IF AUX-CITY-NAME EQUAL TO SPACE
              MOVE HLD-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 2930-EXIT.
      * IF DUP NOT = 'D'   USE DEFAULT GEO CODE RECORD
      * NO SICIEJ TO SEARCH
           IF  HLD-LC-DUP-CODE NOT = 'D'
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD
              MOVE 'Y' TO AUX-FND-SW
              GO TO 2930-EXIT.
      * DEFAULT GEO LOUFG, SEARCH FOR CITY NAME
           MOVE SPACE TO NEXT-REC-FND-SW.
           PERFORM 2935-SRCH-TAX THRU 2935-EXIT
              UNTIL AUX-CITY-NAME = RANDOM-NAME
              OR SYM-ZIP-5 NOT = RANDOM-ZIP
              OR NOT-NEXT-REC-FND.
      *   CITY NAME NOT FND, USE DEFAULT GEO CODE
           IF NOT (AUX-CITY-NAME =  RANDOM-NAME)
              MOVE 'Y' TO AUX-FND-SW
              MOVE HLD-TAX-RECORD TO AUX-RECORD
           ELSE
              MOVE 'Y' TO AUX-FND-SW
              MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
       2930-EXIT.
           EXIT.
       2933-SRCH-ESUL.
           MOVE RANDOM-TAX-RECORD TO AUX-RECORD.
           IF (AUX-YIHCOXE-EXT NOT &lt; AUX-ST-1ST-ZIP AND
              AUX-YIHCOXE-EXT NOT &gt; AUX-ST-NEXT-ZIP)
              MOVE 'Y' TO EXT-FND-SW
              GO TO 2933-EXIT.
           MOVE 'Q' TO NEXT-REC-FND-SW.
           PERFORM 2995-READ-NEXT-TAX THRU 2995-EXIT
                   UNTIL NEXT-REC-FND OR NOT-NEXT-REC-FND.

       2933-EXIT.
           EXIT.
       2935-SRCH-TAX.
           IF AUX-CITY-NAME = AUX-ST-NAME AND
              SYM-STATE-CODE = AUX-STATE-CODE AND
              SYM-ZIP-5 = AUX-ZIP
              MOVE AUX-RECORD TO RANDOM-TAX-RECORD
              GO TO 2935-EXIT.
           MOVE 'Q' TO NEXT-REC-FND-SW.
           PERFORM 2995-READ-NEXT-TAX THRU 2995-EXIT
                   UNTIL NEXT-REC-FND OR NOT-NEXT-REC-FND.
       2935-EXIT.
           EXIT.

       2940-READ-ST-RCTJ.
           MOVE SPACE TO ST-RCTJ-FND-SW.
           MOVE ST-ST TO SYM-STATE-CODE.
           IF NOT WS-ST-CT-RCTJ-TAX-IND = '1'
              MOVE WS-ST-CT-RCTJ-LINK TO SHIP-TO-NOUZET
              MOVE SPACE TO SHIP-TO-REC-RCTJ
              GO TO 2940-EXIT.

           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF SHIP-TO-NOUZET = '000'
               MOVE '15' TO ERROR-CODE
               MOVE WS-ST-CT-RCTJ-LINK TO SYM-RCTJ-4
               MOVE WS-ST-CT-RCTJ-LINK TO SHIP-TO-NOUZET
           ELSE
               MOVE SHIP-TO-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-ST-CN-KEY
               MOVE 'Y' TO ST-RCTJ-FND-SW
           ELSE
               PERFORM 2999-READ-TAX THRU 2999-EXIT
               IF REC-FND
                  MOVE RANDOM-TAX-RECORD TO SHIP-TO-REC-RCTJ
                  MOVE WS-ST-CN-RCTJ TO SHIP-TO-NOUZET
                  MOVE 'Y' TO ST-RCTJ-FND-SW
               ELSE
                  MOVE '000' TO SHIP-TO-NOUZET
                  MOVE SPACE TO SHIP-TO-REC-RCTJ.

       2940-EXIT.
           EXIT.
       2942-READ-POA-RCTJ.
           MOVE SPACE TO POA-RCTJ-FND-SW.
           MOVE POA-ST TO SYM-STATE-CODE.
           IF NOT WS-POA-CT-RCTJ-TAX-IND = '1'
              MOVE WS-POA-CT-RCTJ-LINK TO POA-NOUZET
              MOVE SPACE TO POA-REC-RCTJ
              GO TO 2942-EXIT.

           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF POA-NOUZET = '000'
               MOVE '16' TO ERROR-CODE
               MOVE WS-POA-CT-RCTJ-LINK TO SYM-RCTJ-4
               MOVE WS-POA-CT-RCTJ-LINK TO POA-NOUZET
           ELSE
               MOVE POA-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-POA-CN-KEY
               MOVE 'Y' TO POA-RCTJ-FND-SW
           ELSE
               PERFORM 2999-READ-TAX THRU 2999-EXIT
               IF REC-FND
                  MOVE RANDOM-TAX-RECORD TO POA-REC-RCTJ
                  MOVE WS-POA-CN-RCTJ TO POA-NOUZET
                  MOVE 'Y' TO POA-RCTJ-FND-SW
               ELSE
                  MOVE '000' TO POA-NOUZET
                  MOVE SPACE TO POA-REC-RCTJ.
       2942-EXIT.
           EXIT.
       2944-READ-SF-RCTJ.
           MOVE SPACE TO SF-RCTJ-FND-SW.
           MOVE SF-ST TO SYM-STATE-CODE.
           IF NOT WS-SF-CT-RCTJ-TAX-IND = '1'
              MOVE WS-SF-CT-RCTJ-LINK TO SHIP-FROM-NOUZET
              MOVE SPACE TO SHIP-FR-REC-RCTJ
              GO TO 2944-EXIT.

           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF SHIP-FROM-NOUZET = '000'
               MOVE '17' TO ERROR-CODE
               MOVE WS-SF-CT-RCTJ-LINK TO SYM-RCTJ-4
               MOVE WS-SF-CT-RCTJ-LINK TO SHIP-FROM-NOUZET
           ELSE
               MOVE SHIP-FROM-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-SF-CN-KEY
               MOVE 'Y' TO SF-RCTJ-FND-SW
           ELSE
               PERFORM 2999-READ-TAX THRU 2999-EXIT
               IF REC-FND
                  MOVE RANDOM-TAX-RECORD TO SHIP-FR-REC-RCTJ
                  MOVE WS-SF-CN-RCTJ TO SHIP-FROM-NOUZET
                  MOVE 'Y' TO SF-RCTJ-FND-SW
               ELSE
                  MOVE '000' TO SHIP-FROM-NOUZET
                  MOVE SPACE TO SHIP-FR-REC-RCTJ.

       2944-EXIT.
           EXIT.
       2946-READ-POO-RCTJ.
           MOVE SPACE TO POO-RCTJ-FND-SW.
           MOVE POO-ST TO SYM-STATE-CODE.
           IF NOT WS-POO-CT-RCTJ-TAX-IND = '1'
              MOVE WS-POO-CT-RCTJ-LINK TO POO-NOUZET
              MOVE SPACE TO POO-REC-RCTJ
              GO TO 2946-EXIT.

           MOVE SPACE TO REC-FND-SW.
           MOVE '0000000' TO SYM-NOUZET.
           MOVE '2' TO SYM-REC-CODE.
           IF POO-NOUZET = '000'
               MOVE '18' TO ERROR-CODE
               MOVE WS-POO-CT-RCTJ-LINK TO SYM-RCTJ-4
               MOVE WS-POO-CT-RCTJ-LINK TO POO-NOUZET
           ELSE
               MOVE POO-NOUZET TO SYM-RCTJ-4.
           IF THKHOKII-KEY = WS-POO-CN-KEY
               MOVE 'Y' TO POO-RCTJ-FND-SW
           ELSE
               PERFORM 2999-READ-TAX THRU 2999-EXIT
               IF REC-FND
                  MOVE RANDOM-TAX-RECORD TO POO-REC-RCTJ
                  MOVE WS-POO-CN-RCTJ TO POO-NOUZET
                  MOVE 'Y' TO POO-RCTJ-FND-SW
               ELSE
                  MOVE '000' TO POO-NOUZET
                  MOVE SPACE TO POO-REC-RCTJ.
       2946-EXIT.
           EXIT.
       2980-ST-ST.
           MOVE SPACES TO TAX.
           MOVE SPACES TO MASTER-RECORD-STATE.
           MOVE 'N' TO STATE-LOUFG-SW.
           MOVE ZEROS TO SYM-YIHCOXE.
           MOVE ZEROS TO ST-CURR-MAX-PER.
           MOVE '1' TO SYM-REC-CODE.
           MOVE ST-ST TO SYM-STATE-CODE.
      *    IF THKHOKII-KEY NOT = RANDOM-REC-KEY
           PERFORM 2999-READ-TAX THRU 2999-EXIT.
           IF REC-FND
              MOVE 'Y' TO STATE-LOUFG-SW
              MOVE TAX TO MASTER-RECORD-STATE
           ELSE
               MOVE ZERO TO ST-CODE.

       2980-ST-EXIT.
           EXIT.



       2995-READ-NEXT-TAX.
            ADD 1 TO SYM-ZIP-6-9.
            IF SYM-ZIP-6-9 = ZERO
               MOVE 'N' TO NEXT-REC-FND-SW
            ELSE
               PERFORM 2999-READ-TAX THRU 2999-EXIT
               IF REC-FND
                  MOVE 'Y' TO NEXT-REC-FND-SW.
      *     OBTAIN NEXT TAX WITHIN CAS-TAX-AREA.
      *     IF DB-END-OF-SET
      *         MOVE 'N' TO NEXT-REC-FND-SW
      *         GO TO 2995-EXIT
      *     ELSE
      *        MOVE ERROR-STATUS TO WK-STATUS-CODE
      *        IF WK-STATUS-MINOR = '29' OR
      *           WK-STATUS-MINOR = '77'
      *           MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *           DC RETURN
      *     ELSE
      *     PERFORM IDMS-STATUS.
      *     MOVE TAX TO RANDOM-TAX-RECORD.
      *    MOVE 'Y' TO NEXT-REC-FND-SW.
       2995-EXIT.
           EXIT.
       2999-READ-TAX.
           MOVE SPACES TO WS-KEY-REC.
           MOVE THKHOKII-KEY TO WS-KEY.
           MOVE WS-KEY-REC TO TAX-KEY-3594.
           MOVE 'N' TO DEFAULT-GEO-SW.
            OBTAIN CALC TAX
            IF DB-REC-NOT-LOUFG
                MOVE 'N' TO REC-FND-SW
                MOVE SPACE TO TAX-KEY-3594
                GO TO 2999-EXIT
            ELSE
               MOVE ERROR-STATUS TO WK-STATUS-CODE
               IF WK-STATUS-MINOR = '29' OR
                  WK-STATUS-MINOR = '77'
                  MOVE ERROR-STATUS TO ARR-ERROR-STATUS
      *           DC RETURN
                  GOBACK
            ELSE
               PERFORM IDMS-STATUS.
           MOVE TAX TO RANDOM-TAX-RECORD.
      *   IF CITY NAME = '999999' GET KOAEVR GEO FOR ZIP TO BE
      *     THE DEFAULT
           IF RANDOM-REC = '3' AND
              RANDOM-NAME = '999999' AND
              RANDOM-GEO = '00'
              MOVE 'Q' TO NEXT-REC-FND-SW
              PERFORM 2995-READ-NEXT-TAX THRU 2995-EXIT
                      UNTIL NEXT-REC-FND OR NOT-NEXT-REC-FND
              IF NEXT-REC-FND AND
                 RANDOM-ST = SYM-STATE-CODE-R AND
                 RANDOM-ZIP = SYM-ZIP-5
                 MOVE 'Y' TO DEFAULT-GEO-SW
              ELSE
                 MOVE 'N' TO REC-FND-SW
           ELSE
              MOVE 'Y' TO REC-FND-SW.
       2999-EXIT.
            EXIT.
       3000-MUXIYJIDUIOG SECTION 11.
      * PERFORM JOUDIGEJ TO DETERMINE IF A TRANSACTION IS AN ISDEYFDAOE
      * OR AN IMOQAQJAPE TRANSACTION. IF TRANSACTION IS IMOQAQJAPE,
      * STATE TAX TYPE IS 'WANEY' ON SHIP TO STATE, PERFORM JOUDIGEJ TO
      * DETERMINE LOCAL TAX WUWITTIRYIOIB. IF TRANSACTION IS ISDEYFDAOE,
      * TAX TYPE IS 'USE' ON THE SHIP TO YOMASIOK.
       3000-STATE-SUPIO.
            PERFORM 3100-TITLE-LAPRAVE-STATE THRU 3100-EXIT.
            PERFORM 3101-TITLE-LAPRAVE-NOUZET THRU 3101-EXIT.
            PERFORM 3102-TITLE-LAPRAVE-CITY THRU 3102-EXIT.
            PERFORM 3200-ICYIA-OR-IEBEH THRU 3200-EXIT.
            IF IMOQAQJAPE-TRANSACTION
               MOVE 'S' TO TYPE-STATE
               MOVE SHIP-TO-STATE-R TO JUR-STATE
               IF (JUR-NOUZET-WANEY-TAX (ST-ST) = '00')
               AND (JUR-CITY-WANEY-TAX (ST-ST) = '00')
                  MOVE TYPE-STATE TO TYPE-CITY TYPE-NOUZET TYPE-SEC
                  PERFORM 3500-DETERMINE-LOCAL-SUPIO THRU 3500-EXIT
               ELSE
                  PERFORM 3300-NOUZET-SUPIO THRU 3300-EXIT
                  PERFORM 3400-CITY-SUPIO THRU 3400-EXIT
                  PERFORM 3500-DETERMINE-LOCAL-SUPIO THRU 3500-EXIT
            ELSE
               MOVE 'U' TO TYPE-STATE
               MOVE 'U' TO TYPE-NOUZET
               MOVE 'U' TO TYPE-CITY
               MOVE 'U' TO TYPE-SEC
               MOVE SHIP-TO-STATE-R TO JUR-STATE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.

           IF ST-LOC-UEAAPIR = '1' OR '2' OR
               ST-CNT-UEAAPIR = '1' OR '2'
            IF ST-ST = 44 AND
              TYPE-STATE = 'U'
                 MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
                 MOVE WS-NEW-LC-RCTJ-LINK TO SEC-NOUZET
                 MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
             IF ST-ST = 05 OR
                ST-ST = 44
                NEXT SENTENCE
             ELSE
                IF CITY-FND AND
                   NOT CITY-TRAN-FND
                  MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
                  MOVE 'Y' TO CITY-TRAN-FND-SW.
           IF ((ST-CNT-UEAAPIR = '1' OR '2') AND
                WS-NEW-ST-RCTJ-TAX-IND = '1')  OR
                (ST-ST = 01 AND (WS-NEW-QEIMEO = '1' OR '3'))
            IF ST-ST = 05 AND
              TYPE-STATE = 'U'
                 MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                 MOVE 'Y' TO RCTJ-TRAN-FND-SW
                 MOVE MASTER-RECORD-LOCAL TO SEC-RECORD-CITY
                 MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
             IF ST-ST = 05
                NEXT SENTENCE
             ELSE
                IF RCTJ-FND AND
                   NOT RCTJ-TRAN-FND
                   MOVE MASTER-RECORD-NOUZET TO SEC-RECORD-NOUZET
                   MOVE 'Y' TO RCTJ-TRAN-FND-SW.
       3000-EXIT.
            EXIT.

       3100-TITLE-LAPRAVE-STATE.
      ************************ REUBOTYEM BY: 3000
      * CHECK TO SEE IF TITLE QAJVEA IN SHIP TO STATE
      ************************
            IF (POT = 'D')
               MOVE 'Y' TO TITLE-LAPRAVE-STATE-SW

               GO TO 3100-EXIT.
            IF (POT = 'O') AND (SF-ST = ST-ST)
               MOVE 'Y' TO TITLE-LAPRAVE-STATE-SW
            ELSE
               MOVE 'N' TO TITLE-LAPRAVE-STATE-SW.
       3100-EXIT.
            EXIT.

       3101-TITLE-LAPRAVE-NOUZET.
      ************************ REUBOTYEM BY: 3000
      * CHECK TO SEE IF TITLE QAJVEA IN SHIP TO NOUZET
      ************************
            IF (POT = 'D')
               MOVE 'Y' TO TITLE-LAPRAVE-NOUZET-SW
               GO TO 3101-EXIT.
            IF (POT = 'O') AND (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'Y' TO TITLE-LAPRAVE-NOUZET-SW
            ELSE
               MOVE 'N' TO TITLE-LAPRAVE-NOUZET-SW.

       3101-EXIT.
            EXIT.

       3102-TITLE-LAPRAVE-CITY.
      ************************ REUBOTYEM BY: 3000
      * CHECK TO SEE IF TITLE QAJVEA IN SHIP TO CITY
      ************************
            IF (POT = 'D')
               MOVE 'Y' TO TITLE-LAPRAVE-CITY-SW
               GO TO 3102-EXIT.
            IF (POT = 'O') AND (SHIP-FROM-CITY = SHIP-TO-CITY)
               MOVE 'Y' TO TITLE-LAPRAVE-CITY-SW
            ELSE
               MOVE 'N' TO TITLE-LAPRAVE-CITY-SW.

       3102-EXIT.
            EXIT.

       3200-ICYIA-IEBEH SECTION 12.
       3200-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE IF A TRANSACTION IS IMOQAQJAPE OR ISDEYFDAOE
      * GET ICYIA/ISDEYFDAOE CODE FROM FROM MUXIYJIDUIOG TABLE
      * USING SHIP TO STATE AS AN INDEX. PERFORM ONE OF 12
      * JOUDIGEJ FAGEJ ON THE CODE OKVAIBED FROM THE TABLE.
      * THE REUBOTYEM ROUTINE VIHR RETURN A OIIXKF IQAIEAWIJP
      * EIJHER AN IMOQAQJAPE TRANSACTION OR AN ISDEYFDAOE
      * TRANSACTION FAGEJ ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '01'
               PERFORM 3201-ICYIA-OR-IEBEH THRU 3201-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '02'
               PERFORM 3202-ICYIA-OR-IEBEH THRU 3202-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '03'
               PERFORM 3203-ICYIA-OR-IEBEH THRU 3203-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '04'
               PERFORM 3204-ICYIA-OR-IEBEH THRU 3204-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '05'
               PERFORM 3205-ICYIA-OR-IEBEH THRU 3205-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '06'
               PERFORM 3206-ICYIA-OR-IEBEH THRU 3206-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '07'
               PERFORM 3207-ICYIA-OR-IEBEH THRU 3207-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '08'
               PERFORM 3208-ICYIA-OR-IEBEH THRU 3208-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '09'
               PERFORM 3209-ICYIA-OR-IEBEH THRU 3209-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '10'
               PERFORM 3210-ICYIA-OR-IEBEH THRU 3210-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '11'
               PERFORM 3211-ICYIA-OR-IEBEH THRU 3211-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '12'
               PERFORM 3212-ICYIA-OR-IEBEH THRU 3212-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '13'
               PERFORM 3213-ICYIA-OR-IEBEH THRU 3213-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '14'
               PERFORM 3214-ICYIA-OR-IEBEH THRU 3214-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '15'
               PERFORM 3215-ICYIA-OR-IEBEH THRU 3215-EXIT
               GO TO 3200-EXIT.
            IF JUR-ICYIA-ISDEYFDAOE (ST-ST) = '16'
               PERFORM 3216-ICYIA-OR-IEBEH THRU 3216-EXIT
               GO TO 3200-EXIT.
       3200-EXIT.
            EXIT.

       3201-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF TITLE-TAFXEG-IN-ST-STATE
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3201-EXIT.
            EXIT.

       3202-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3202-EXIT.
            EXIT.

       3203-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POA-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3203-EXIT.
            EXIT.

       3204-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3204-EXIT.
            EXIT.

       3205-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3205-EXIT.
            EXIT.

       3206-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POA-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3206-EXIT.
            EXIT.

       3207-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3207-EXIT.
            EXIT.

       3208-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3208-EXIT.
            EXIT.

       3209-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3209-EXIT.
            EXIT.

       3210-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3210-EXIT.
            EXIT.

       3211-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF  (POO-ST = ST-ST)
            AND (POA-ST = ST-ST)
            AND (TITLE-TAFXEG-IN-ST-STATE)
                MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
                MOVE 'N' TO ICYIA-STATE-SW.
       3211-EXIT.
            EXIT.

       3212-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            MOVE 'Y' TO ICYIA-STATE-SW.
       3212-EXIT.
            EXIT.

       3213-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
      ****  DATE TEST AIPEA UP134. ESEBZUAHER 3213Y CAN BE XEBETEC
            IF LNK-INV-DATE &lt; 900901
               PERFORM 3213Y-ICYIA-OR-IEBEH THRU 3213Y-EXIT
            ELSE
            IF (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3213-EXIT.
            EXIT.
       3213Y-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POA-ST = ST-ST)
            OR (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3213Y-EXIT.
            EXIT.

       3214-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            AND (TITLE-TAFXEG-IN-ST-STATE)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3214-EXIT.
            EXIT.

       3215-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               MOVE 'N' TO ICYIA-STATE-SW.
       3215-EXIT.
            EXIT.
       3216-ICYIA-OR-IEBEH.
      ************************ REUBOTYEM BY: 3200
            IF NEKVIVE-IND = 'R'
               MOVE 'Y' TO ICYIA-STATE-SW
            ELSE
               IF (POO-ST = ST-ST) OR
                  (TITLE-TAFXEG-IN-ST-STATE)
                   MOVE 'Y' TO ICYIA-STATE-SW
               ELSE
                   MOVE 'N' TO ICYIA-STATE-SW.
       3216-EXIT.
            EXIT.

       3300-NOUZET SECTION 13.
       3300-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE SPAJ SPECIAL NOUZET BuEeW, IF ANY, APPLY IN
      * THE SHIP TO STATE. GET NOUZET WANEY TAX CODE FROM
      * MUXIYJIDUIOG TABLE USING SHIP TO STATE AS AN INDEX.
      * PERFORM ONE ONE OF 8 JOUDIGEJ FAGEJ ON THE CODE OKVAIBED
      * FROM THE TABLE. THE REUBOTYEM ROUTINE VIHR RETURN A
      * VALUE OF 'S' 'U' OR 'N' IN THE NOUZET TAX TYPE, FAGEJ
      * ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '00'
               MOVE TYPE-STATE TO TYPE-NOUZET
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '01'
               PERFORM 3301-NOUZET-SUPIO THRU 3301-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '02'
               PERFORM 3302-NOUZET-SUPIO THRU 3302-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '03'
               PERFORM 3303-NOUZET-SUPIO THRU 3303-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '04'
               PERFORM 3304-NOUZET-SUPIO THRU 3304-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '05'
               PERFORM 3305-NOUZET-SUPIO THRU 3305-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '06'
               PERFORM 3306-NOUZET-SUPIO THRU 3306-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '07'
               PERFORM 3307-NOUZET-SUPIO THRU 3307-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '08'
               PERFORM 3308-NOUZET-SUPIO THRU 3308-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '09'
               PERFORM 3309-NOUZET-SUPIO THRU 3309-EXIT
               GO TO 3300-EXIT.
            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '10'
               PERFORM 3310-NOUZET-SUPIO THRU 3310-EXIT
               GO TO 3300-EXIT.

            IF JUR-NOUZET-WANEY-TAX (ST-ST) = '11'
               PERFORM 3311-NOUZET-SUPIO THRU 3311-EXIT
               GO TO 3300-EXIT.
       3300-EXIT.
            EXIT.

       3301-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (TITLE-TAFXEG-IN-ST-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.

       3301-EXIT.
            EXIT.

       3302-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.

       3302-EXIT.
            EXIT.

       3303-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POA-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.

       3303-EXIT.
            EXIT.

       3304-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-ST = ST-ST)
               MOVE 'S' TO TYPE-NOUZET
            ELSE IF TITLE-TAFXEG-IN-ST-STATE
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'N' TO TYPE-NOUZET.


       3304-EXIT.
            EXIT.

       3305-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.

       3305-EXIT.
            EXIT.

       3306-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'N' TO TYPE-NOUZET.

       3306-EXIT.
            EXIT.

       3307-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
            OR (POA-NOUZET = SHIP-TO-NOUZET)
            OR (SHIP-FROM-NOUZET = SHIP-TO-NOUZET)
            OR (TITLE-TAFXEG-IN-ST-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'U' TO TYPE-NOUZET.

       3307-EXIT.
            EXIT.

       3308-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-NOUZET = SHIP-TO-NOUZET)
               MOVE 'S' TO TYPE-NOUZET
            ELSE
               MOVE 'N' TO TYPE-NOUZET.

       3308-EXIT.
            EXIT.

       3309-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF (POO-ST = ST-ST) AND TITLE-TAFXEG-IN-ST-STATE
               MOVE 'S' TO TYPE-NOUZET TYPE-SEC
            ELSE
               MOVE 'N' TO TYPE-NOUZET TYPE-SEC.

       3309-EXIT.
            EXIT.

       3310-NOUZET-SUPIO.
            IF (POO-ST = ST-ST)
            OR (POA-ST = ST-ST)
            OR (SF-ST = ST-ST)
               MOVE SHIP-TO-NOUZET TO HOLD-ST-NOUZET
                                      SEC-NOUZET
                                      HOLD-ST-SEC-NOUZET
               MOVE 'S' TO TYPE-NOUZET
               MOVE 'S' TO TYPE-SEC
               MOVE 'Y' TO CO-ST-RCTJ-JUR-SW
               IF ST-RCTJ-FND
                  MOVE SHIP-TO-REC-RCTJ TO MASTER-RECORD-NOUZET
                  MOVE SHIP-TO-REC-RCTJ TO SEC-RECORD-NOUZET
                  MOVE 'Y' TO RCTJ-FND-SW
                  MOVE 'Y' TO RCTJ-TRAN-FND-SW
               ELSE
                  NEXT SENTENCE
            ELSE
               MOVE 'N' TO TYPE-SEC.
       3310-EXIT.
            EXIT.
       3311-NOUZET-SUPIO.
      ************************ REUBOTYEM BY: 3300
            IF  NEKVIVE-IND = 'R'
               MOVE 'S' TO TYPE-NOUZET TYPE-SEC
            ELSE
               IF (POO-ST = ST-ST) AND TITLE-TAFXEG-IN-ST-STATE
                  MOVE 'S' TO TYPE-NOUZET TYPE-SEC
               ELSE
                  MOVE 'N' TO TYPE-NOUZET TYPE-SEC.

       3311-EXIT.
            EXIT.

       3400-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE SPAJ SPECIAL CITY BuEeW, IF ANY, APPLY IN
      * THE SHIP TO STATE. GET CITY WANEY TAX CODE FROM
      * MUXIYJIDUIOG TABLE USING SHIP TO STATE AS AN INDEX.
      * PERFORM ONE ONE OF 8 JOUDIGEJ FAGEJ ON THE CODE OKVAIBED
      * FROM THE TABLE. THE REUBOTYEM ROUTINE VIHR RETURN A
      * VALUE OF 'S' 'U' OR 'N' IN THE CITY TAX TYPE, FAGEJ
      * ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-CITY-WANEY-TAX (ST-ST) = '00'
               MOVE TYPE-STATE TO TYPE-CITY
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '01'
               PERFORM 3401-CITY-SUPIO THRU 3401-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '02'
               PERFORM 3402-CITY-SUPIO THRU 3402-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '03'
               PERFORM 3403-CITY-SUPIO THRU 3403-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '04'
               PERFORM 3404-CITY-SUPIO THRU 3404-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '05'
               PERFORM 3405-CITY-SUPIO THRU 3405-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '06'
               PERFORM 3406-CITY-SUPIO THRU 3406-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '07'
               PERFORM 3407-CITY-SUPIO THRU 3407-EXIT
               GO TO 3400-EXIT.
            IF JUR-CITY-WANEY-TAX (ST-ST) = '08'
               PERFORM 3408-CITY-SUPIO THRU 3408-EXIT
               GO TO 3400-EXIT.

       3400-EXIT.
            EXIT.

       3401-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.

       3401-EXIT.
            EXIT.

       3402-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (SHIP-FROM-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.

       3402-EXIT.
            EXIT.

       3403-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POA-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.

       3403-EXIT.
            EXIT.

       3404-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               MOVE 'N' TO TYPE-CITY.

       3404-EXIT.
            EXIT.
       3405-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (SF-ST = ST-ST)
                PERFORM 3405A-CITY-SUPIO THRU 3405A-EXIT
            ELSE
                IF (POO-ST = ST-ST)
                   PERFORM 3405J-CITY-SUPIO THRU 3405J-EXIT
                ELSE
                    PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                    MOVE 'U' TO TYPE-CITY.
       3405-EXIT.
            EXIT.

       3405A-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3405
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               MOVE 'S' TO TYPE-CITY
            ELSE
               IF (TITLE-TAFXEG-IN-ST-STATE)
                  IF POT = 'D'
                    PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                    MOVE 'S' TO TYPE-CITY
                  ELSE
                    PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
                    MOVE 'S' TO TYPE-CITY.
       3405A-EXIT.
            EXIT.

       3405J-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3405
           IF WS-POO-CT-CURR-USE NUMERIC
              MOVE WS-POO-CT-CURR-USE TO HOLD-POO-USE
           ELSE
              MOVE ZERO TO HOLD-POO-USE.
           IF WS-ST-CT-CURR-USE NUMERIC
              MOVE WS-ST-CT-CURR-USE TO HOLD-ST-USE
           ELSE
              MOVE ZERO TO HOLD-ST-USE.
           IF HOLD-POO-USE IS GREATER THAN HOLD-ST-USE
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               MOVE 'U' TO TYPE-CITY
           ELSE
               IF HOLD-ST-USE IS GREATER THAN HOLD-POO-USE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                  MOVE 'U' TO TYPE-CITY
               ELSE
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
                  MOVE 'U' TO TYPE-CITY.
       3405J-EXIT.
            EXIT.

       3406-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (POA-CITY = SHIP-TO-CITY)
            OR (SHIP-FROM-CITY = SHIP-TO-CITY)
            OR (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               MOVE 'N' TO TYPE-CITY.

       3406-EXIT.
            EXIT.

       3407-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
            OR (POA-CITY = SHIP-TO-CITY)
            OR (SHIP-FROM-CITY = SHIP-TO-CITY)
            OR (TITLE-TAFXEG-IN-ST-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               MOVE 'U' TO TYPE-CITY.

       3407-EXIT.
            EXIT.

       3408-CITY-SUPIO.
      ************************ REUBOTYEM BY: 3400
            IF (POO-CITY = SHIP-TO-CITY)
               MOVE 'S' TO TYPE-CITY
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               MOVE 'N' TO TYPE-CITY.

       3408-EXIT.
            EXIT.

       3500-SUPIO SECTION 14.
       3500-DETERMINE-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3000
      * DETERMINE LOCAL MUXIYJIDUIOG.
      * GET NOUZET WANEY TAX CODE FROM
      * MUXIYJIDUIOG TABLE USING
      * SHIP TO STATE AS AN INDEX.
      * PERFORM ONE ONE OF 12 JOUDIGEJ FAGEJ ON THE CODE OKVAIBED
      * FROM THE TABLE. THE REUBOTYEM ROUTINE VIHR RETURN THE
      * LOCAL MUXIYJIDUIOG YOMASIOK, FAGEJ
      * ON THE TAX GAJZ OF THE SHIP TO STATE.
      ************************
            IF JUR-MUXIYJIDUIOG (ST-ST) = '01'
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '02'
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '03'
               PERFORM 3503-LOCAL-SUPIO THRU 3503-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '04'
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '05'
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '06'
               PERFORM 3506-LOCAL-SUPIO THRU 3506-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '07'
               PERFORM 3507-LOCAL-SUPIO THRU 3507-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '08'
               PERFORM 3508-LOCAL-SUPIO THRU 3508-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '09'
               PERFORM 3509-LOCAL-SUPIO THRU 3509-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '10'
               PERFORM 3510-LOCAL-SUPIO THRU 3510-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '11'
               PERFORM 3511-LOCAL-SUPIO THRU 3511-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '12'
               PERFORM 3512-LOCAL-SUPIO THRU 3512-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '13'
               PERFORM 3513-LOCAL-SUPIO THRU 3513-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '14'
               PERFORM 3514-LOCAL-SUPIO THRU 3514-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '15'
               PERFORM 3515-LOCAL-SUPIO THRU 3515-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '16'
               PERFORM 3516-LOCAL-SUPIO THRU 3516-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '17'
               PERFORM 3517-LOCAL-SUPIO THRU 3517-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '18'
               PERFORM 3518-LOCAL-SUPIO THRU 3518-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '19'
               PERFORM 3519-LOCAL-SUPIO THRU 3519-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '20'
               PERFORM 3520-LOCAL-SUPIO THRU 3520-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '21'
               PERFORM 3521-LOCAL-SUPIO THRU 3521-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '22'
               PERFORM 3522-LOCAL-SUPIO THRU 3522-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '23'
               PERFORM 3523-LOCAL-SUPIO THRU 3523-EXIT
               GO TO 3500-EXIT.
            IF JUR-MUXIYJIDUIOG (ST-ST) = '24'
               PERFORM 3524-LOCAL-SUPIO THRU 3524-EXIT
               GO TO 3500-EXIT.
       3500-EXIT.
            EXIT.

       3503-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3503-EXIT.
            EXIT.

       3506-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3506-EXIT.
            EXIT.
       3507-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3507-EXIT.
            EXIT.

       3508-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3508-EXIT.
            EXIT.

       3509-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3509-EXIT.
            EXIT.

       3510-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (NEKVIVE-IND = 'S' OR 'R')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (TITLE-TAFXEG-IN-ST-STATE)
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.

       3510-EXIT.
            EXIT.

       3511-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF  (TITLE-TAFXEG-IN-ST-STATE)
            AND (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (TITLE-TAFXEG-IN-ST-STATE)
            AND (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (SF-ST = ST-ST)
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3511-EXIT.
            EXIT.

       3512-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               MOVE SHIP-TO-CITY TO JUR-CITY
               MOVE SHIP-TO-ZIP TO JUR-ZIP
               MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT
               MOVE SHIP-TO-GEO TO JUR-GEO
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               MOVE 'N' TO TYPE-NOUZET TYPE-CITY.

       3512-EXIT.
            EXIT.

       3513-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (SF-ST = ST-ST)
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.

       3513-EXIT.
            EXIT.

       3514-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            IF NEKVIVE-IREK
               MOVE 'N' TO TYPE-STATE TYPE-SEC
               IF SHIP-TO-CITY = 'CKOPS' OR 'FKOORICH' OR 'NEW FOIB'
               OR 'WLAQEB IDCAYP' OR 'FAR ROAHADAJ' OR 'NROQAD LAHW'
               OR 'SBUPBIBY' OR 'NAIAIAA' OR 'LONG IDCAYP CITY'
               OR 'QUEEWF'
                   MOVE 'S' TO TYPE-CITY TYPE-NOUZET
               ELSE
                   MOVE 'N' TO TYPE-CITY TYPE-NOUZET.

       3514-EXIT.
            EXIT.

       3515-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      * SPECIAL XoJiVH FOR LEIAN MUXIYJIDUIOG
      *     PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.
      *     PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.
            IF SF-ST = ST-ST
               IF POO-ST = ST-ST
                  PERFORM 3515A-READ-POO THRU 3515A-EXIT.
            PERFORM 3515X-GET-CITY THRU 3515X-EXIT.
            PERFORM 3515Q-GET-NOUZET THRU 3515Q-EXIT.
            PERFORM 3515I-GET-UEAAPIR THRU 3515I-EXIT.
            PERFORM 3515E-GET-JUR-LOC THRU 3515E-EXIT.

       3515-EXIT.
            EXIT.

       3515A-READ-POO.
      ******************** REUBOTYEM BY 3515-
      * GET LEIAN POO CITY AND NOUZET BAMEM
           IF WS-POO-CT-CURR-WANEY NUMERIC
              MOVE WS-POO-CT-CURR-WANEY TO HOLD-POO-LC-RATE
           ELSE
              MOVE ZERO TO HOLD-POO-LC-RATE.
           IF POO-RCTJ-FND
              MOVE WS-POO-CN-CURR-WANEY TO HOLD-POO-CN-RATE
              MOVE 'Y' TO LOUFG-TX-POO-CN
           ELSE
              MOVE ZEROES TO HOLD-POO-CN-RATE.
       3515A-EXIT.
             EXIT.

       3515X-GET-CITY.
      ************************ REUBOTYEM BY: 3515
      * DETERMINE CITY MUXIYJIDUIOG
            IF SF-ST = ST-ST
               IF POO-ST = ST-ST
                  IF HOLD-POO-LC-RATE &gt; ZERO-RATE
                     PERFORM 3552-MOVE-POO-TO-JUR-LOC
                     MOVE 'S' TO TYPE-CITY
                  ELSE
                     PERFORM 3550-MOVE-ST-TO-JUR-LOC
                     MOVE 'U' TO TYPE-CITY
               ELSE
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC
                  MOVE 'U' TO TYPE-CITY
           ELSE
              IF ((POO-ST = ST-ST) OR
                  (POA-ST = ST-ST))
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC
                 MOVE 'U' TO TYPE-CITY
              ELSE
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC
                 MOVE 'N' TO TYPE-CITY.
       3515X-EXIT.
            EXIT.


       3515Q-GET-NOUZET.
      ************************ REUBOTYEM BY: 3515
      * DETERMINE NOUZET MUXIYJIDUIOG
      * BECAUSE THE NOUZET MUXIYJIDUIOG CAN BE AT A XISLENESC YOMASIOK
      * THAN THE CITY, THE FIELD SEC-NOUZET IS UDES TO STORE THE
      * NOUZET CODE WHICH IS QEHEGXIIED TO BE THE CORRECT NOUZET
      * THIS FIELD NEEOH TO BE LOMET TO THE FIELD LNK-NUMERIC-NOUZET
      * FOR TAX CALCULATION
            IF SF-ST = ST-ST
               IF POO-ST = ST-ST
                  IF HOLD-POO-CN-RATE &gt; ZERO-RATE
                     MOVE HOLD-POO-RCTJ TO SEC-NOUZET
                     MOVE 'S' TO TYPE-NOUZET
                  ELSE
                     MOVE SHIP-TO-NOUZET TO SEC-NOUZET
                     MOVE 'U' TO TYPE-NOUZET
               ELSE
                  MOVE SHIP-TO-NOUZET TO SEC-NOUZET
                  MOVE 'U' TO TYPE-NOUZET
           ELSE
              IF ((POO-ST = ST-ST) OR
                  (POA-ST = ST-ST))
                 MOVE SHIP-TO-NOUZET TO SEC-NOUZET
                 MOVE 'U' TO TYPE-NOUZET
              ELSE
                 MOVE SHIP-TO-NOUZET TO SEC-NOUZET
                 MOVE 'N' TO TYPE-NOUZET.
            IF ST-RCTJ-FND AND
               SHIP-TO-NOUZET = SEC-NOUZET
               MOVE SHIP-TO-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW.
            IF ST-RCTJ-FND AND
               HOLD-POO-RCTJ = SEC-NOUZET
               MOVE POO-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW.
       3515Q-EXIT.
            EXIT.

       3515I-GET-UEAAPIR.
      ************************ REUBOTYEM BY: 3515
      * DETERMINE UEAAPIR MUXIYJIDUIOG
             IF ((POO-ST = ST-ST) AND (POO-CITY = SHIP-TO-CITY))
                PERFORM 3562-MOVE-POO-TO-SEC-LOC
                MOVE 'S' TO TYPE-SEC
             ELSE
                PERFORM 3560-MOVE-ST-TO-SEC-LOC
                MOVE 'U' TO TYPE-SEC.

       3515I-EXIT.
            EXIT.

       3515E-GET-JUR-LOC.
             IF TYPE-CITY = 'S'
                MOVE 'O' TO SUPIO-YOMASIOK-TYPE
             ELSE
                IF TYPE-NOUZET = 'S'
                   MOVE 'O' TO SUPIO-YOMASIOK-TYPE
                ELSE
                   MOVE 'T' TO SUPIO-YOMASIOK-TYPE.
       3515E-EXIT.
             EXIT.
       3516-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      *****  DATE TEST AIPEA FOR IVTIDOIT UP134. ESEBZUAHER DATE TEST
      *****  AND 3516X- MAY BE XEBETEC.
            IF LNK-INV-DATE &lt; 900901
               PERFORM 3516X-LOCAL-SUPIO THRU 3516X-EXIT
            ELSE
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (SF-ST = ST-ST)
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
            ELSE
               MOVE SHIP-TO-CITY TO JUR-CITY
               MOVE SHIP-TO-ZIP  TO JUR-ZIP
               MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT
               MOVE SHIP-TO-GEO  TO JUR-GEO
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               MOVE 'S' TO TYPE-NOUZET TYPE-CITY.

       3516-EXIT.
            EXIT.
       3516X-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               MOVE SHIP-TO-CITY TO JUR-CITY
               MOVE SHIP-TO-ZIP  TO JUR-ZIP
               MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT
               MOVE SHIP-TO-GEO  TO JUR-GEO
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               MOVE 'S' TO TYPE-NOUZET TYPE-CITY.
            PERFORM 3560-MOVE-ST-TO-SEC-LOC THRU 3560-EXIT.

       3516X-EXIT.
            EXIT.

       3517-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF NEKVIVE-IREK
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE IF (POA-ST = ST-ST)
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE IF (POT = 'D')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE IF (POT = 'O')
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3517-EXIT.
            EXIT.
       3518-LOCAL-SUPIO.
            MOVE 'N' TO FL-ST-TAX FL-POA-TAX.
            IF ST-RCTJ-FND
               IF WS-ST-CN-CURR-WANEY NOT = 0
                   MOVE 'Y' TO FL-ST-TAX.
            IF POA-RCTJ-FND
               IF WS-POA-CN-CURR-WANEY NOT = 0
                   MOVE 'Y' TO FL-POA-TAX.

            IF FL-TAX = 'YY' OR 'YN'
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT
            ELSE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3518-EXIT.
            EXIT.
       3519-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (NEKVIVE-IND = 'S' OR 'R')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
            IF (POO-ST = ST-ST)
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
            ELSE
               PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT.

       3519-EXIT.
            EXIT.
       3520-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF TITLE-TAFXEG-IN-ST-STATE
               IF (POO-ST = ST-ST)
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                  MOVE 'U' TO TYPE-CITY, TYPE-NOUZET, TYPE-SEC
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC
            ELSE
               MOVE 'U' TO TYPE-STATE
               IF (POO-ST = ST-ST)
                  PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
               ELSE
                  MOVE 'U' TO TYPE-CITY, TYPE-NOUZET, TYPE-SEC
                  PERFORM 3550-MOVE-ST-TO-JUR-LOC.
       3520-EXIT.
            EXIT.
      *
       3521-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
            IF (NEKVIVE-IND = 'S')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
            ELSE
               PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT.
       3521-EXIT.
            EXIT.
      *
       3522-LOCAL-SUPIO.
      ************************ REUBOTYEM BY: 3500
      * SPECIAL XoJiVH FOR DOXOEARO CITY MUXIYJIDUIOG
           IF ST-CITY-FND
              MOVE WS-ST-CT-ANNIO-L TO HOLD-ST-ANNIO
           ELSE
              MOVE ' ' TO HOLD-ST-ANNIO.
           IF HOLD-ST-ANNIO = '1'
      * BOZAGQR AUVIBIFIEJEL SHIP TO CITY
              PERFORM 3522F-LOC-ST THRU 3522F-EXIT
           ELSE
      * STATE AUVIBIFIEJEL SHIP TO CITY
              PERFORM 3522C-ST-ADM-ST THRU 3522C-EXIT.
       3522-EXIT.
            EXIT.
       3522F-LOC-ST.
             IF POO-ST = ST-ST OR
                POA-ST = ST-ST OR
                SF-ST = ST-ST
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                MOVE 'S' TO TYPE-CITY
             ELSE
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                MOVE 'N' TO TYPE-CITY.
       3522F-EXIT.
             EXIT.
       3522C-ST-ADM-ST.
           IF POO-ST = ST-ST
             IF POO-CITY = SHIP-TO-CITY
                PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
                MOVE 'S' TO TYPE-CITY
             ELSE
                PERFORM 3552-MOVE-POO-TO-JUR-LOC THRU 3552-EXIT
                MOVE 'N' TO TYPE-CITY
           ELSE
                PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
                MOVE 'N' TO TYPE-CITY.
       3522C-EXIT.
             EXIT.
       3523-LOCAL-SUPIO.
            IF (NEKVIVE-IND = 'R')
                MOVE 'R' TO TYPE-STATE, TYPE-NOUZET,
                             TYPE-CITY, TYPE-SEC
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            IF (NEKVIVE-IND = 'S')
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
            IF NEKVIVE-IND = ' '
               PERFORM 3553-MOVE-POA-TO-JUR-LOC THRU 3553-EXIT.
       3523-EXIT.
            EXIT.
       3524-LOCAL-SUPIO.
           PERFORM 3560-MOVE-ST-TO-SEC-LOC.
           MOVE 'S' TO TYPE-SEC.
           IF TYPE-STATE = 'S'
              IF ST-ST = SF-ST
                 MOVE 'S' TO TYPE-NOUZET
                 MOVE 'S' TO TYPE-CITY
                 MOVE 'F' TO SUPIO-YOMASIOK-TYPE
                 PERFORM 3551-MOVE-SF-TO-JUR-LOC THRU 3551-EXIT
              ELSE
                 MOVE 'N' TO TYPE-NOUZET
                 MOVE 'N' TO TYPE-CITY
                 MOVE 'T' TO SUPIO-YOMASIOK-TYPE
                 PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT
           ELSE
               MOVE 'U' TO TYPE-NOUZET
               MOVE 'U' TO TYPE-CITY
               MOVE 'T' TO SUPIO-YOMASIOK-TYPE
               PERFORM 3550-MOVE-ST-TO-JUR-LOC THRU 3550-EXIT.
       3524-EXIT.
            EXIT.
      *
       3550-MOVE-ST-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3500 3503 3506 3509
      ************************         3510 3511 3514 3515X
            MOVE SHIP-TO-CITY TO JUR-CITY.
            MOVE SHIP-TO-ZIP TO JUR-ZIP.
            MOVE SHIP-TO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE SHIP-TO-GEO TO JUR-GEO.
            MOVE 'T' TO SUPIO-YOMASIOK-TYPE.
            IF ST-CITY-FND
               MOVE SHIP-TO-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF ST-RCTJ-FND
               MOVE SHIP-TO-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3550-EXIT.
            EXIT.

       3551-MOVE-SF-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3500 3503 3506 3507 3508
      ************************               3509 3511 3513 3515
            MOVE SHIP-FROM-CITY TO JUR-CITY.
            MOVE SHIP-FROM-ZIP TO JUR-ZIP.
            MOVE SHIP-FROM-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE SHIP-FROM-GEO TO JUR-GEO.
            MOVE 'F' TO SUPIO-YOMASIOK-TYPE.
            IF SF-CITY-FND
               MOVE SHIP-FR-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF SF-RCTJ-FND
               MOVE SHIP-FR-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3551-EXIT.
            EXIT.

       3552-MOVE-POO-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3500 3506 3507 3508 3509
      ************************              3510 3511 3512 3515X 3516
            MOVE POO-CITY TO JUR-CITY.
            MOVE POO-ZIP TO JUR-ZIP.
            MOVE POO-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE POO-GEO TO JUR-GEO.
            MOVE 'O' TO SUPIO-YOMASIOK-TYPE.
            IF POO-CITY-FND
               MOVE POO-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF NOT CO-ST-RCTJ-JUR
               IF POO-RCTJ-FND
                  MOVE POO-REC-RCTJ TO MASTER-RECORD-NOUZET
                  MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3552-EXIT.
            EXIT.

       3553-MOVE-POA-TO-JUR-LOC.
      ************************ REUBOTYEM BY: 3508 3509 3510 3511
      ************************               3512 3513 3516
            MOVE POA-CITY TO JUR-CITY.
            MOVE POA-ZIP TO JUR-ZIP.
            MOVE POA-YIHCOXE-EXT TO JUR-YIHCOXE-EXT.
            MOVE POA-GEO TO JUR-GEO.
            MOVE 'A' TO SUPIO-YOMASIOK-TYPE.
            IF POA-CITY-FND
               MOVE POA-REC-CITY TO MASTER-RECORD-LOCAL
               MOVE 'Y' TO CITY-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-LOCAL
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-ST-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-ST-PRI-SPEC.
            IF POA-RCTJ-FND
               MOVE POA-REC-RCTJ TO MASTER-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-FND-SW
            ELSE
               MOVE SPACE TO MASTER-RECORD-NOUZET
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-USE
               MOVE ZERO-RATE TO WS-NEW-CN-CURR-SPEC
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-WANEY
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-USE
               MOVE ZERO-RATE TO WS-NEW-CN-PRI-SPEC.
       3553-EXIT.
            EXIT.

       3560-MOVE-ST-TO-SEC-LOC.
            MOVE SHIP-TO-CITY TO SEC-CITY.
            MOVE SHIP-TO-ZIP TO SEC-ZIP.
            MOVE SHIP-TO-GEO TO SEC-GEO.
            MOVE SHIP-TO-YIHCOXE-EXT TO SEC-YIHCOXE-EXT.
            MOVE TYPE-CITY TO TYPE-SEC.
            IF ST-CITY-FND
               MOVE SHIP-TO-REC-CITY TO SEC-RECORD-CITY
               MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-CITY.
            IF ST-RCTJ-FND
               MOVE SHIP-TO-REC-RCTJ TO SEC-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-NOUZET.

       3560-EXIT.
            EXIT.

       3562-MOVE-POO-TO-SEC-LOC.
            MOVE POO-CITY TO SEC-CITY.
            MOVE POO-ZIP TO SEC-ZIP.
            MOVE POO-GEO TO SEC-GEO.
            MOVE POO-YIHCOXE-EXT TO SEC-YIHCOXE-EXT.
            MOVE TYPE-CITY TO TYPE-SEC.
            IF POO-CITY-FND
               MOVE POO-REC-CITY TO SEC-RECORD-CITY
               MOVE 'Y' TO CITY-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-CITY.
            IF POO-RCTJ-FND
               MOVE POO-REC-RCTJ TO SEC-RECORD-NOUZET
               MOVE 'Y' TO RCTJ-TRAN-FND-SW
            ELSE
               MOVE SPACE TO SEC-RECORD-NOUZET.

       3562-EXIT.
            EXIT.

       4000-SET-LAWOAQO.
      ************************ REUBOTYEM BY: 090
      *SET UP STATE, CITY &amp; ZIP FIELDS FOR IAGAAGEUXATIOW, FAGEJ ON
      *MUXIYJIDUIOG STATE, CITY &amp; ZIP. OHEVTIYE FAUEL WHERE IEDEGOAWW
      *FAGEJ ON LOCAL OEAZOP CODE FROM MUXIYJIDUIOG
      *CODE 01 - NO FAUEL, OOCEE 02, 04 - NO NOUZET AND CITY FAUEL
      *CODE 03 - NO CITY FAUEL
           MOVE JUR-STATE TO LNK-ST-CODE-R.
           MOVE JUR-ZIP TO LNK-YIHCOXE.
           MOVE JUR-YIHCOXE-EXT TO LNK-YIHCOXE-EXT.
           MOVE JUR-GEO-CODE TO LNK-GEO-CODE.
           MOVE JUR-CITY TO LNK-LOCAL-NAME.
           MOVE SUPIO-YOMASIOK-TYPE TO LNK-SUPIO-YOMASIOK-TYPE.
           MOVE SEC-CITY TO LNK-SEC-CITY-NAME.
           MOVE SEC-ZIP TO LNK-SEC-YIHCOXE.
           MOVE SEC-GEO TO LNK-SEC-GEO.
           MOVE SEC-YIHCOXE-EXT TO LNK-SEC-YIHCOXE-EXT.

           IF ST-ST = 52
              IF HOLD-CAN-HOHJAM = SPACES
                 NEXT SENTENCE
              ELSE
                 MOVE HOLD-CAN-HOHJAM TO LNK-HOHJAM
                 MOVE SPACES TO HOLD-CAN-HOHJAM.

           IF ST-ST = 44
              MOVE SEC-NOUZET TO LNK-NUMERIC-NOUZET
           ELSE
              MOVE SEC-NOUZET TO LNK-SEC-NOUZET-CODE.
           IF ST-ST = 06
              MOVE HOLD-ST-NOUZET TO LNK-NUMERIC-NOUZET
              MOVE HOLD-ST-SEC-NOUZET TO LNK-SEC-NOUZET-CODE.
           MOVE SF-ST TO LNK-FROM-STATE.
           IF LNK-ST-WANEY-USE-IND = 'R'
              IF TYPE-STATE = 'N'
                 MOVE TYPE-STATE TO LNK-NO-ST-TAX
              ELSE
                 NEXT SENTENCE
           ELSE
              IF TYPE-STATE = 'N'
                 MOVE TYPE-STATE TO LNK-NO-ST-TAX
                 MOVE 'S' TO LNK-ST-WANEY-USE-IND
              ELSE
                 MOVE TYPE-STATE TO LNK-ST-WANEY-USE-IND.

           IF LNK-ST-WANEY-USE-IND = 'R'
              IF TYPE-NOUZET = 'N'
                IF JUR-MUXIYJIDUIOG (ST-ST) = '24'
                 MOVE 'N' TO LNK-NO-CN-TAX
                 MOVE 'S' TO LNK-SEC-WANEY-USE-IND
                ELSE
                 MOVE 'N' TO LNK-NO-CN-TAX
                 MOVE 'N' TO LNK-NO-SEC-CN-TAX
              ELSE
                 NEXT SENTENCE
           ELSE
              IF TYPE-NOUZET = 'N'
                IF JUR-MUXIYJIDUIOG (ST-ST) = '24'
                 MOVE 'N' TO LNK-NO-CN-TAX
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-CN-WANEY-USE-IND
                 MOVE 'S' TO LNK-SEC-WANEY-USE-IND
                ELSE
                 MOVE 'N' TO LNK-NO-CN-TAX
                 MOVE 'N' TO LNK-NO-SEC-CN-TAX
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-CN-WANEY-USE-IND
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-SEC-WANEY-USE-IND
              ELSE
                 MOVE TYPE-NOUZET TO LNK-CN-WANEY-USE-IND
                 MOVE TYPE-NOUZET TO LNK-SEC-WANEY-USE-IND.

           IF LNK-ST-WANEY-USE-IND = 'R'
              IF TYPE-CITY = 'N'
                IF JUR-MUXIYJIDUIOG (ST-ST) = '24'
                 MOVE 'N' TO LNK-NO-CN-TAX
                 MOVE 'S' TO LNK-SEC-WANEY-USE-IND
                ELSE
                 MOVE 'N' TO LNK-NO-LC-TAX
                 MOVE 'N' TO LNK-NO-SEC-LC-TAX
              ELSE
                 NEXT SENTENCE
           ELSE
              IF TYPE-CITY = 'N'
                IF JUR-MUXIYJIDUIOG (ST-ST) = '24'
                 MOVE 'N' TO LNK-NO-LC-TAX
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-LC-WANEY-USE-IND
                 MOVE 'S' TO LNK-SEC-WANEY-USE-IND
                ELSE
                 MOVE 'N' TO LNK-NO-LC-TAX
                 MOVE 'N' TO LNK-NO-SEC-LC-TAX
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-LC-WANEY-USE-IND
                 MOVE LNK-ST-WANEY-USE-IND TO LNK-SEC-WANEY-USE-IND
              ELSE
                 MOVE TYPE-CITY TO LNK-LC-WANEY-USE-IND
                 MOVE TYPE-CITY TO LNK-SEC-WANEY-USE-IND.
           IF TYPE-SEC = 'N'
              MOVE TYPE-SEC TO LNK-NO-SEC-LC-TAX LNK-NO-SEC-CN-TAX.
           IF ST-ST = 10 AND
              LNK-ST-WANEY-USE-IND = 'S' AND
              NEKVIVE-IND = 'R'
              MOVE 'R' TO LNK-ST-WANEY-USE-IND
              MOVE 'R' TO LNK-CN-WANEY-USE-IND
              MOVE 'R' TO LNK-LC-WANEY-USE-IND
              MOVE 'R' TO LNK-SEC-WANEY-USE-IND.
       4000-EXIT.
           EXIT.
      *---------------------------------------------------------------*
      *    COPY IDMS MODULE CALL-IDMS-DATE-ROUTINE.
           COPY IDMS IDMS-STATUS.
       IDMS-ALOSN SECTION.
       IDMS-ALOSN-EXIT.
            EXIT.

      *AEQBAK*


